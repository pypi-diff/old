<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="IE=edge">
  <meta name="referrer" content="no-referrer" />
  <meta name="generator" content="diffoscope" />
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAADdgAAA3YBfdWCzAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAM8SURBVFiF7dZdaJZlGAfw3/O+e9XNjy3XllZzWImBxIpifqTgsmUHBSIeBNFBdRh0UHQ0xGdb66CFBIERZEFRQRRUw0HkQkLMYQSBdpCFWdgSP6jpNn2393k68Nn2bj3vXtb6UOh/cl/39b/u67mem/913zf/4z9GUDw5xNI8n5WIzW9m/QF2YluJmI8203mALzEvLWAerRs4Pz6vSIkZSlsYk0/GkaB0zEgyDgWMlijyWsJuS2fkQwu8pqpMTA0ypeiShG71Bp0rU8Q+A47MWEDgvHZbZl/Av4SpIgxVYB3IqwZDmoUuYkzosDaNchpAoFqkSmgjGPWzLieF1k3JHVsjvCJQHBYaSy9g1E3m+QImQiK9SbNGqJDzuiDZ0lggQJCsyelDq8BB47sbCWTsnvhG3kqcLL833eqF4hk1EOoTOjZjnnaRdq2l6KtMAyl4/g23bKJrun+Mt9uOq7nvqOVbebWYy9Adc1fM/R/3CO780dONbIeFPHsPw+ULeM5ZHTbXHfUtXpxOZzgT5z02UGsZThRzF/ilht9G+fr4zfbfccIxXIa7uVTup69i7LJXaEEqF3on1d9ludBLpVLOVoT1lky9QYtwQ6p3WAVqSyUslWwSbRrkPJrMtgn0iBVk7BPJ4sGE24EPQKW3jLgdzWKLBTbg0yTuZeGkDsp2gcUGDesHGQ/gK5G8nLMigWiCe3jCrnTRiJ9EYjm1ImsUEq5l8hScPXbpsVtlKhfan+pv0yD0ZqmU5XegGBmnDIo/pylj8oYLOP3Eab/v5Zmi6EtZ3vv1FU/2r7LioYSL2dNybbdiMdptFU57++20Vqh+iq/Tap1WpaWY611wmyWyUzxZDbIWTvEV1Ildn5agfBumoUMTtoisFvhebAAHZWxX0ChwTuScvHdVeVykToysMyJ7ittwbmj31J+6IrRDp5XTfBt1WJ+WYnZdMB0F3xlUgD5uDVj2Sa+a4SrzH+FeyHHmw17V112waBOZgP4WczkLZsILar1fpIliMU4XZoK/poE0XHl+N8v6QcGAUbVymnDIZVnzrTXqGzmnhKLxZX/niyiDjIJgwg4Se1GR/Y8idGPysh6fr0i1i/AHMWHgrwUJgNAAAAAASUVORK5CYII=" />
  <title>/srv/diffoscope/bin/diffoscope --no-progress tmp/secretflow-0.8.0b1-cp38-cp38-manylinux2014_x86_64.whl.zip tmp/secretflow-0.8.1b0-cp38-cp38-macosx_11_0_arm64.whl.zip --html versions/s/secretflow/0.8.0b1-0.8.1b0/index.html --text versions/s/secretflow/0.8.0b1-0.8.1b0/diff.txt --markdown versions/s/secretflow/0.8.0b1-0.8.1b0/diff.md</title>
<style>
body.diffoscope {
  background: white;
  color: black;
}
.diffoscope .footer {
  font-size: small;
}
.diffoscope .difference {
  border: outset #888 1px;
  background: #E8E8E8;
  background: rgba(0,0,0,.1);
  padding: 0.5em;
  margin: 0.5em 0;
}
.diffoscope .difference table {
  table-layout: fixed;
  width: 100%;
  border: 0;
}
.diffoscope .difference th,
.diffoscope .difference td {
  border: 0;
}
.diffoscope table.diff {
  border: 0;
  border-collapse:collapse;
  font-size:0.75em;
  font-family: 'Lucida Console', monospace;
  word-break: break-word;
}
.diffoscope table.diff tr:hover td {
  background: #FFFF00;
}
.diffoscope .line {
  color:#8080a0
}
.diffoscope th {
  background: black;
  color: white
}
.diffoscope .diffunmodified td {
  background: #D0D0E0
}
.diffoscope .diffhunk td {
  background: #A0A0A0
}
.diffoscope .diffadded td {
  background: #CCFFCC
}
.diffoscope .diffdeleted td {
  background: #FFCCCC
}
.diffoscope .diffchanged td {
  background: #FFFFA0
}
.diffoscope ins, del {
  background: #E0C880;
  text-decoration: none
}
.diffoscope .dp {
  color: #B08080
}
.diffoscope .comment {
  font-style: italic;
}
.diffoscope .comment.multiline {
  font-style: normal;
  font-family: monospace;
  white-space: pre;
}
.diffoscope .source {
  font-weight: bold;
}
.diffoscope .error {
  border: solid black 1px;
  background: red;
  color: white;
  padding: 0.2em;
}
.diffoscope .anchor {
  margin-left: 0.5em;
  font-size: 80%;
  color: #333;
  text-decoration: none;
  display: none;
}
.diffoscope .diffheader:hover .anchor {
  display: inline;
}
.diffoscope .diffcontrol, .diffoscope .diffcontrol-nochildren {
  float: left;
  margin-right: 0.3em;
  cursor: pointer;
  display: none; /* currently, only available in html-dir output where jquery is enabled */
}
.diffoscope .colines {
  width: 3em;
}
.diffoscope .coldiff {
  width: 99%;
}
.diffoscope .diffsize {
  float: right;
}
.diffoscope table.diff tr.ondemand td, .diffoscope div.ondemand-details {
  background: #f99;
  text-align: center;
  padding: 0.5em 0;
}
.diffoscope table.diff tr.ondemand:hover td, .diffoscope div.ondemand-details:hover {
  background: #faa;
  cursor: pointer;
}
</style>
</head>
<body class="diffoscope">
<div class="difference">
  <div class="diffheader">
  <div class="diffcontrol diffcontrol-double">⊟</div>
  <div><span class="diffsize">389 KB</span></div>
  <div><span class="source">tmp/secretflow-0.8.0b1-cp38-cp38-manylinux2014_x86_64.whl.zip</span> vs.</div>
  <div id="top"><span class="source">tmp/secretflow-0.8.1b0-cp38-cp38-macosx_11_0_arm64.whl.zip</span>
    <a class="anchor" href="#top">¶</a>
  </div>
  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">40.1 KB</span></div>
    <div id="zipinfo---"><span class="source">zipinfo {}</span>
      <a class="anchor" href="#zipinfo---">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 195 lines modified</td><td colspan="2">Offset 1, 230 lines modified</td></tr>
<tr class="diffchanged"><td class="diffline">1 </td><td class="diffpresent">Zip<span class="dp">·</span>file<span class="dp">·</span>size:<span class="dp">·</span>1<del>1</del>4<del>80</del>7<del>5</del><span class="dp">·</span>bytes,<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>entries:<span class="dp">·</span><del>193</del></td><td class="diffline">1 </td><td class="diffpresent">Zip<span class="dp">·</span>file<span class="dp">·</span>size:<span class="dp">·</span>14<ins>61</ins>7<ins>6</ins><ins>0</ins><span class="dp">·</span>bytes,<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>entries:<span class="dp">·</span><ins>228</ins></td></tr>
<tr class="diffchanged"><td class="diffline">2 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<del>136</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/__init__.py</td><td class="diffline">2 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<ins>261</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>607<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/version.py</td></tr>
<tr class="diffchanged"><td class="diffline">3 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>754<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/__init__.py</td><td class="diffline">4 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>754<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">4 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>14806<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/base.py</td><td class="diffline">5 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>14806<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/base.py</td></tr>
<tr class="diffchanged"><td class="diffline">5 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1108<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/math_utils.py</td><td class="diffline">6 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1108<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/math_utils.py</td></tr>
<tr class="diffchanged"><td class="diffline">6 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<del>6347</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/ndarray.py</td><td class="diffline">7 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<ins>4878</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/ndarray.py</td></tr>
<tr class="diffchanged"><td class="diffline">7 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<del>586</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/split.py</td><td class="diffline">8 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<ins>420</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/split.py</td></tr>
<tr class="diffchanged"><td class="diffline">8 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>716<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/horizontal/__init__.py</td><td class="diffline">9 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>716<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/horizontal/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">9 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>15042<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/horizontal/dataframe.py</td><td class="diffline">10 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>15042<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/horizontal/dataframe.py</td></tr>
<tr class="diffchanged"><td class="diffline">10 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2557<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/horizontal/io.py</td><td class="diffline">11 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2557<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/horizontal/io.py</td></tr>
<tr class="diffchanged"><td class="diffline">11 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1555<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/horizontal/sampler.py</td><td class="diffline">12 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1555<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/horizontal/sampler.py</td></tr>
<tr class="diffchanged"><td class="diffline">12 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>627<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/io/__init__.py</td><td class="diffline">13 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>627<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/io/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">13 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2112<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/io/oss.py</td><td class="diffline">14 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2112<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/io/oss.py</td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<del>75</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/io/util.py</td><td class="diffline">15 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<ins>83</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/io/util.py</td></tr>
<tr class="diffchanged"><td class="diffline">15 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>691<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/mix/__init__.py</td><td class="diffline">16 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>691<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/mix/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>15054<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/mix/dataframe.py</td><td class="diffline">17 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>15054<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/mix/dataframe.py</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>716<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/vertical/__init__.py</td><td class="diffline">18 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>716<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/vertical/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2294<del>3</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/vertical/dataframe.py</td><td class="diffline">19 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2294<ins>4</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/vertical/dataframe.py</td></tr>
<tr class="diffchanged"><td class="diffline">19 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>6821<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/data/vertical/io.py</td><td class="diffline">20 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>6821<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/data/vertical/io.py</td></tr>
<tr class="diffchanged"><td class="diffline">20 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>745<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/__init__.py</td><td class="diffline">21 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>745<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">21 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>15193</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/driver.py</td><td class="diffline">22 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>22444</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/driver.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2981<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/device/global_state.py</td></tr>
<tr class="diffchanged"><td class="diffline">22 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1079<del>6</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/link.py</td><td class="diffline">24 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1079<ins>5</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/link.py</td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8100<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/proxy.py</td><td class="diffline">25 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8100<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/proxy.py</td></tr>
<tr class="diffchanged"><td class="diffline">24 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>894</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/__init__.py</td><td class="diffline">26 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>939</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>889<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/device/device/_utils.py</td></tr>
<tr class="diffchanged"><td class="diffline">25 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<del>920</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/base.py</td><td class="diffline">28 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<ins>264</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/base.py</td></tr>
<tr class="diffchanged"><td class="diffline">26 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>17158</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/heu.py</td><td class="diffline">29 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>22903</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/heu.py</td></tr>
<tr class="diffchanged"><td class="diffline">27 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>3545</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/heu_object.py</td><td class="diffline">30 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>6068</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/heu_object.py</td></tr>
<tr class="diffchanged"><td class="diffline">28 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>5201</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/pyu.py</td><td class="diffline">31 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>4693</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/pyu.py</td></tr>
<tr class="diffchanged"><td class="diffline">29 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>35<del>72</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/register.py</td><td class="diffline">32 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>35<ins>89</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/register.py</td></tr>
<tr class="diffchanged"><td class="diffline">30 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>47878</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/spu.py</td><td class="diffline">33 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>56627</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/spu.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>7655<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/device/device/teeu.py</td></tr>
<tr class="diffchanged"><td class="diffline">31 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2410<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/device/type_traits.py</td><td class="diffline">35 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2410<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/device/type_traits.py</td></tr>
<tr class="diffchanged"><td class="diffline">32 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>638<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/kernels/__init__.py</td><td class="diffline">36 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>638<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/kernels/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">33 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<del>528</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/kernels/heu.py</td><td class="diffline">37 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<ins>716</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/kernels/heu.py</td></tr>
<tr class="diffchanged"><td class="diffline">34 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>2205</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/kernels/pyu.py</td><td class="diffline">38 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>6837</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/kernels/pyu.py</td></tr>
<tr class="diffchanged"><td class="diffline">35 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<del>295</del>4<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/device/kernels/spu.py</td><td class="diffline">39 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<ins>437</ins>4<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/device/kernels/spu.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>923<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/device/kernels/teeu.py</td></tr>
<tr class="diffchanged"><td class="diffline">36 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>223</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/distributed/__init__.py</td><td class="diffline">41 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>784</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/distributed/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>5018</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/distributed/primitive.py</td><td class="diffline">42 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>6373</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/distributed/primitive.py</td></tr>
<tr class="diffchanged"><td class="diffline">38 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/__init__.py</td><td class="diffline">43 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">39 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/__init__.py</td><td class="diffline">44 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">40 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>654<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/__init__.py</td><td class="diffline">45 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>654<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">41 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9580<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_booster.py</td><td class="diffline">46 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9580<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_booster.py</td></tr>
<tr class="diffchanged"><td class="diffline">42 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>7462<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_booster_worker.py</td><td class="diffline">47 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>7462<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_booster_worker.py</td></tr>
<tr class="diffchanged"><td class="diffline">43 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1116<del>5</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_decision_tree.py</td><td class="diffline">48 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1116<ins>6</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/homo_decision_tree.py</td></tr>
<tr class="diffchanged"><td class="diffline">44 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3043<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_param.py</td><td class="diffline">49 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3043<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_param.py</td></tr>
<tr class="diffchanged"><td class="diffline">45 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/__init__.py</td><td class="diffline">50 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">46 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4365<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/callback.py</td><td class="diffline">51 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4365<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/callback.py</td></tr>
<tr class="diffchanged"><td class="diffline">47 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>7192<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/core.py</td><td class="diffline">52 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>7192<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/core.py</td></tr>
<tr class="diffchanged"><td class="diffline">48 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>931<del>8</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/training.py</td><td class="diffline">53 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>931<ins>7</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/boost_core/training.py</td></tr>
<tr class="diffchanged"><td class="diffline">49 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/__init__.py</td><td class="diffline">54 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">50 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4429<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/criterion.py</td><td class="diffline">55 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4429<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/criterion.py</td></tr>
<tr class="diffchanged"><td class="diffline">51 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1855<del>6</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/decision_tree.py</td><td class="diffline">56 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1855<ins>7</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/decision_tree.py</td></tr>
<tr class="diffchanged"><td class="diffline">52 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9371<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/feature_histogram.py</td><td class="diffline">57 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9371<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/feature_histogram.py</td></tr>
<tr class="diffchanged"><td class="diffline">53 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2535<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/feature_importance.py</td><td class="diffline">58 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2535<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/feature_importance.py</td></tr>
<tr class="diffchanged"><td class="diffline">54 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4218<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/loss_function.py</td><td class="diffline">59 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4218<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/loss_function.py</td></tr>
<tr class="diffchanged"><td class="diffline">55 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2060<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/node.py</td><td class="diffline">60 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2060<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/node.py</td></tr>
<tr class="diffchanged"><td class="diffline">56 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9846<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/splitter.py</td><td class="diffline">61 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9846<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/splitter.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>677<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3472<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/model.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>17539<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/sgb.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>9768<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/label_holder.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2043<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/level_cache.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1139<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/params.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3212<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/preprocessing.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2785<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/distributed_tree.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1582<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/split_tree.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">73 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">74 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2600<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/boost.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1724<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/bucket_sum.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>930<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/grad.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">77 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1994<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/node_select.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">78 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1452<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/pred.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>776<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/random.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">80 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/split_tree_trainer/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">81 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4712<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/split_tree_trainer/order_map_context.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">82 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2446<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/split_tree_trainer/shuffler.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">83 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3828<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/split_tree_trainer/split_tree_trainer.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">84 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5057<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/split_tree_trainer/splitter.py</td></tr>
<tr class="diffchanged"><td class="diffline">57 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>66<del>0</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/__init__.py</td><td class="diffline">85 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>66<ins>1</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">58 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>20000</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/model.py</td><td class="diffline">86 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>19885</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/model.py</td></tr>
<tr class="diffchanged"><td class="diffline">59 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/__init__.py</td><td class="diffline">87 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">60 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>880<del>0</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/node_split.py</td><td class="diffline">88 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>880<ins>1</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/node_split.py</td></tr>
<tr class="diffchanged"><td class="diffline">61 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>10969</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/tree_worker.py</td><td class="diffline">89 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span>9885</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/tree_worker.py</td></tr>
<tr class="diffchanged"><td class="diffline">62 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1513<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/utils.py</td><td class="diffline">90 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1513<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/utils.py</td></tr>
<tr class="diffchanged"><td class="diffline">63 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>980<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/xgb_tree.py</td><td class="diffline">91 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>980<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/boost/ss_xgb_v/core/xgb_tree.py</td></tr>
<tr class="diffchanged"><td class="diffline">64 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1013<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/__init__.py</td><td class="diffline">92 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1013<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">65 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1173<del>7</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/fl_lr_mix.py</td><td class="diffline">93 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1173<ins>6</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/fl_lr_mix.py</td></tr>
<tr class="diffchanged"><td class="diffline">66 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>191<del>6</del>1<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/fl_lr_v.py</td><td class="diffline">94 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>191<ins>3</ins>1<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/fl_lr_v.py</td></tr>
<tr class="diffchanged"><td class="diffline">67 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>1375</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/linear_model.py</td><td class="diffline">95 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>3129</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/linear_model.py</td></tr>
<tr class="diffchanged"><td class="diffline">68 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>673<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/hess_sgd/__init__.py</td><td class="diffline">96 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>673<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/hess_sgd/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">69 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>13250<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/hess_sgd/model.py</td><td class="diffline">97 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>13250<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/hess_sgd/model.py</td></tr>
<tr class="diffchanged"><td class="diffline">70 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>639<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_glm/__init__.py</td><td class="diffline">98 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>639<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_glm/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">71 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>23754<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_glm/model.py</td><td class="diffline">99 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>23754<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_glm/model.py</td></tr>
<tr class="diffchanged"><td class="diffline">72 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>233<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/__init__.py</td><td class="diffline">100 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>233<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">73 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5287<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/distribution.py</td><td class="diffline">101 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5287<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/distribution.py</td></tr>
<tr class="diffchanged"><td class="diffline">74 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2950<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/link.py</td><td class="diffline">102 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2950<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_glm/core/link.py</td></tr>
<tr class="diffchanged"><td class="diffline">75 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>653<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_sgd/__init__.py</td><td class="diffline">103 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>653<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_sgd/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">76 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>17121</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/linear/ss_sgd/model.py</td><td class="diffline">104 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>21895</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/linear/ss_sgd/model.py</td></tr>
<tr class="diffchanged"><td class="diffline">77 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>698<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/__init__.py</td><td class="diffline">105 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>698<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">78 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>806<del>5</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/metrics.py</td><td class="diffline">106 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>806<ins>4</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/metrics.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">107 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/nn/applications/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">108 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5261<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-07<span class="dp">·</span>09:00<span class="dp">·</span>secretflow/ml/nn/applications/sl_deep_fm.py</td></tr>
<tr class="diffchanged"><td class="diffline">79 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/__init__.py</td><td class="diffline">109 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">80 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>174<del>1</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/compress.py</td><td class="diffline">110 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>174<ins>3</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/compress.py</td></tr>
<tr class="diffchanged"><td class="diffline">81 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>2</del>8<del>1</del>7<del>9</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/fl_model.py</td><td class="diffline">111 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>3</ins><ins>0</ins>8<ins>3</ins>7<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/fl_model.py</td></tr>
<tr class="diffchanged"><td class="diffline">82 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2152<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/strategy_dispatcher.py</td><td class="diffline">112 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2152<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/strategy_dispatcher.py</td></tr>
<tr class="diffchanged"><td class="diffline">83 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3279<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/utils.py</td><td class="diffline">113 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3279<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/utils.py</td></tr>
<tr class="diffchanged"><td class="diffline">84 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/__init__.py</td><td class="diffline">114 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">85 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/__init__.py</td><td class="diffline">115 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">86 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<del>0911</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/fl_base.py</td><td class="diffline">116 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<ins>2678</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/fl_base.py</td></tr>
<tr class="diffchanged"><td class="diffline">87 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4369<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/sampler.py</td><td class="diffline">117 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>4369<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/sampler.py</td></tr>
<tr class="diffchanged"><td class="diffline">88 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>90<del>5</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/__init__.py</td><td class="diffline">118 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>90<ins>4</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">89 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>407<del>2</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_g.py</td><td class="diffline">119 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>407<ins>3</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_g.py</td></tr>
<tr class="diffchanged"><td class="diffline">90 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>410<del>4</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_u.py</td><td class="diffline">120 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>410<ins>5</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_u.py</td></tr>
<tr class="diffchanged"><td class="diffline">91 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>383<del>3</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_w.py</td><td class="diffline">121 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>383<ins>4</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_w.py</td></tr>
<tr class="diffchanged"><td class="diffline">92 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>467<del>6</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_prox.py</td><td class="diffline">122 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>467<ins>7</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_prox.py</td></tr>
<tr class="diffchanged"><td class="diffline">93 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5579<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_scr.py</td><td class="diffline">123 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5579<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_scr.py</td></tr>
<tr class="diffchanged"><td class="diffline">94 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5453<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_stc.py</td><td class="diffline">124 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5453<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_stc.py</td></tr>
<tr class="diffchanged"><td class="diffline">95 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/__init__.py</td><td class="diffline">125 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>585<span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">96 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<del>1627</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/fl_base.py</td><td class="diffline">126 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<ins>3406</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/fl_base.py</td></tr>
<tr class="diffchanged"><td class="diffline">97 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>360<del>7</del><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<del>3</del><span class="dp">·</span>0<del>2</del>:<del>15</del><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/sampler.py</td><td class="diffline">127 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span>2.0<span class="dp">·</span>unx<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>360<ins>6</ins><span class="dp">·</span>b-<span class="dp">·</span>defN<span class="dp">·</span>23-Apr-0<ins>7</ins><span class="dp">·</span>0<ins>9</ins>:<ins>00</ins><span class="dp">·</span>secretflow/ml/nn/fl/backend/torch/sampler.py</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; -1/41006 bytes (-0.00%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">6.77 KB</span></div>
    <div id="zipnote---"><span class="source">zipnote {}</span>
      <a class="anchor" href="#zipnote---">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 10 lines modified</td><td colspan="2">Offset 1, 13 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/__init__.py</td><td class="diffline">1 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">2 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/version.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/__init__.py</td><td class="diffline">5 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">6 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/base.py</td><td class="diffline">7 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/base.py</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">8 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/math_utils.py</td><td class="diffline">9 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/data/math_utils.py</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 54, 23 lines modified</td><td colspan="2">Offset 57, 29 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/__init__.py</td><td class="diffline">57 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">58 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/driver.py</td><td class="diffline">59 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/driver.py</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">60 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/global_state.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/link.py</td><td class="diffline">63 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/link.py</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">64 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/proxy.py</td><td class="diffline">65 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/proxy.py</td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">66 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/__init__.py</td><td class="diffline">67 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">68 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/_utils.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/base.py</td><td class="diffline">71 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/base.py</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">72 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/heu.py</td><td class="diffline">73 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/heu.py</td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">74 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">68 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/heu_object.py</td><td class="diffline">75 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/heu_object.py</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 81, 14 lines modified</td><td colspan="2">Offset 90, 17 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/register.py</td><td class="diffline">90 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/register.py</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">91 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/spu.py</td><td class="diffline">92 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/spu.py</td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">93 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">94 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/teeu.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">95 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">85 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/type_traits.py</td><td class="diffline">96 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/device/type_traits.py</td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">97 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">87 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/__init__.py</td><td class="diffline">98 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">88 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">99 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/heu.py</td><td class="diffline">100 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/heu.py</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 96, 14 lines modified</td><td colspan="2">Offset 108, 17 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">96 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/pyu.py</td><td class="diffline">108 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/pyu.py</td></tr>
<tr class="diffunmodified"><td class="diffline">97 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">109 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">98 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/spu.py</td><td class="diffline">110 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/spu.py</td></tr>
<tr class="diffunmodified"><td class="diffline">99 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">111 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">112 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/device/kernels/teeu.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">113 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">100 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/distributed/__init__.py</td><td class="diffline">114 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/distributed/__init__.py</td></tr>
<tr class="diffunmodified"><td class="diffline">101 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">115 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">102 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/distributed/primitive.py</td><td class="diffline">116 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/distributed/primitive.py</td></tr>
<tr class="diffunmodified"><td class="diffline">103 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">117 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">104 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/__init__.py</td><td class="diffline">118 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/__init__.py</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 159, 14 lines modified</td><td colspan="2">Offset 174, 83 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">159 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/node.py</td><td class="diffline">174 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/node.py</td></tr>
<tr class="diffunmodified"><td class="diffline">160 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">175 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">161 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/splitter.py</td><td class="diffline">176 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/homo_boost/tree_core/splitter.py</td></tr>
<tr class="diffunmodified"><td class="diffline">162 </td><td class="diffpresent">Comment:<span class="dp">·</span></td><td class="diffline">177 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">178 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">180 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/model.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">181 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">182 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/sgb.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">183 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">184 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">185 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">186 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/label_holder.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">187 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">188 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/level_cache.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">189 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">190 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/params.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">191 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">192 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/preprocessing.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">193 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">194 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">195 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">196 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/distributed_tree.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">197 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">198 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/distributed_tree/split_tree.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">199 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">200 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/__init__.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">201 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">202 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/boost.py</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">203 </td><td class="diffpresent">Comment:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">204 </td><td class="diffpresent">Filename:<span class="dp">·</span>secretflow/ml/boost/sgb_v/core/pure_numpy_ops/bucket_sum.py</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 3348/6913 bytes (48.43%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.04 KB</span></div>
    <div id="secretflow-__init__.py"><span class="source">secretflow/__init__.py</span>
      <a class="anchor" href="#secretflow-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 15 lines modified</td><td colspan="2">Offset 8, 25 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span>data,<span class="dp">·</span>device,<span class="dp">·</span>ml,<span class="dp">·</span>preprocessing,<span class="dp">·</span>security,<span class="dp">·</span>utils</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.version<span class="dp">·</span>import<span class="dp">·</span>__version__<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>type:<span class="dp">·</span>ignore</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ml,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocessing,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>security,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>utils,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.device<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>.device<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 27, 14 lines modified</td><td colspan="2">Offset 37, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reveal,</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reveal,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shutdown,</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shutdown,</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>to,</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>to,</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">)</td><td class="diffline">41 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">42 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;protos&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;kuscia&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;data&#x27;,</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;data&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;device&#x27;,</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;device&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml&#x27;,</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;preprocessing&#x27;,</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;preprocessing&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;security&#x27;,</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;security&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;utils&#x27;,</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;utils&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;HEU&#x27;,</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;HEU&#x27;,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 47, 8 lines modified</td><td colspan="2">Offset 59, 9 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SPUObject&#x27;,</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SPUObject&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;init&#x27;,</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;init&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;proxy&#x27;,</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;proxy&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;reveal&#x27;,</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;reveal&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;shutdown&#x27;,</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;shutdown&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;to&#x27;,</td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;to&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;wait&#x27;,</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;wait&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;component&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">]</td><td class="diffline">67 </td><td class="diffpresent">]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">843 B</span></div>
    <div id="secretflow-data-base.py"><span class="source">secretflow/data/base.py</span>
      <a class="anchor" href="#secretflow-data-base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 19 lines modified</td><td colspan="2">Offset 10, 19 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>Union</del>,<span class="dp">·</span>List,<span class="dp">·</span><del>Cal</del><del>lable</del></td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>Cal</ins><ins>lable</ins>,<span class="dp">·</span>List,<span class="dp">·</span><ins>Union</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>pandas.core.indexes.base<span class="dp">·</span>import<span class="dp">·</span>Index</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>jax.tree_util<span class="dp">·</span>import<span class="dp">·</span>tree_map</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>jax.tree_util<span class="dp">·</span>import<span class="dp">·</span>tree_map</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>pandas.core.indexes.base<span class="dp">·</span>import<span class="dp">·</span>Index</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.io.util<span class="dp">·</span>import<span class="dp">·</span>to_csv_wrapper</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.io.util<span class="dp">·</span>import<span class="dp">·</span>to_csv_wrapper</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>reveal</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>DataFrameBase(ABC):</td><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>DataFrameBase(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstract<span class="dp">·</span>base<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>horizontal,<span class="dp">·</span>vertical<span class="dp">·</span>and<span class="dp">·</span>mixed<span class="dp">·</span>partitioned<span class="dp">·</span>DataFrame&quot;&quot;&quot;</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstract<span class="dp">·</span>base<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>horizontal,<span class="dp">·</span>vertical<span class="dp">·</span>and<span class="dp">·</span>mixed<span class="dp">·</span>partitioned<span class="dp">·</span>DataFrame&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">15.1 KB</span></div>
    <div id="secretflow-data-ndarray.py"><span class="source">secretflow/data/ndarray.py</span>
      <a class="anchor" href="#secretflow-data-ndarray.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 36 lines modified</td><td colspan="2">Offset 8, 33 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>random</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>copy<span class="dp">·</span>import<span class="dp">·</span>deepcopy</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>copy<span class="dp">·</span>import<span class="dp">·</span>deepcopy</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union,<span class="dp">·</span>Optional</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Optional,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">21 </td><td class="diffpresent"><del>from<span class="dp">·</span>sklearn.model_selection<span class="dp">·</span></del>import<span class="dp">·</span><del>t</del><del>r</del>a<del>in_t</del><del>est_s</del>p<del>li</del><del>t</del><span class="dp">·</span>as<span class="dp">·</span><del>_tra</del><del>i</del>n<del>_test_s</del>p<del>lit</del></td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span><ins>j</ins>a<ins>x.num</ins>p<ins>y</ins><span class="dp">·</span>as<span class="dp">·</span><ins>j</ins>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.io<span class="dp">·</span>import<span class="dp">·</span>util<span class="dp">·</span>as<span class="dp">·</span>io_util</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.io<span class="dp">·</span>import<span class="dp">·</span>util<span class="dp">·</span>as<span class="dp">·</span>io_util</td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject,<span class="dp">·</span>reveal<del>,<span class="dp">·</span>SPU,<span class="dp">·</span>to</del></td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span><ins>SPU,<span class="dp">·</span></ins>PYUObject,<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>.math_utils<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>.math_utils<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffdeleted"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_squares,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_abs,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_ratio_abs,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_squares,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_abs,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_abs,</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_ratio_abs,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_ratio_abs,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_of_difference_squares,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_abs,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_ratio_abs,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sum_of_difference_squares,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">)</td><td class="diffline">30 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">#<span class="dp">·</span>下面的函数是同时支持水平和垂直的。</td><td class="diffline">31 </td><td class="diffpresent">#<span class="dp">·</span>下面的函数是同时支持水平和垂直的。</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">__ndarray<span class="dp">·</span>=<span class="dp">·</span>&quot;__ndarray_type__&quot;</td><td class="diffline">32 </td><td class="diffpresent">__ndarray<span class="dp">·</span>=<span class="dp">·</span>&quot;__ndarray_type__&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">@unique</td><td class="diffline">33 </td><td class="diffpresent">@unique</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 274, 53 lines modified</td><td colspan="2">Offset 271, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">274 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts[device]<span class="dp">·</span>=<span class="dp">·</span>device(_get_item)(idx,<span class="dp">·</span>data)</td><td class="diffline">271 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts[device]<span class="dp">·</span>=<span class="dp">·</span>device(_get_item)(idx,<span class="dp">·</span>data)</td></tr>
<tr class="diffunmodified"><td class="diffline">275 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>m<span class="dp">·</span>==<span class="dp">·</span>__ndarray<span class="dp">·</span>and<span class="dp">·</span>len(file_names)<span class="dp">·</span>==<span class="dp">·</span>1:</td><td class="diffline">272 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>m<span class="dp">·</span>==<span class="dp">·</span>__ndarray<span class="dp">·</span>and<span class="dp">·</span>len(file_names)<span class="dp">·</span>==<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">276 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>FedNdarray(partitions=parts,<span class="dp">·</span>partition_way=partition_way)</td><td class="diffline">273 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>FedNdarray(partitions=parts,<span class="dp">·</span>partition_way=partition_way)</td></tr>
<tr class="diffunmodified"><td class="diffline">277 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>result[m]<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(partitions=parts,<span class="dp">·</span>partition_way=partition_way)</td><td class="diffline">274 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>result[m]<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(partitions=parts,<span class="dp">·</span>partition_way=partition_way)</td></tr>
<tr class="diffunmodified"><td class="diffline">278 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>result</td><td class="diffline">275 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>result</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">279 </td><td class="diffpresent">def<span class="dp">·</span>train_test_split(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">280 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>FedNdarray,<span class="dp">·</span>ratio:<span class="dp">·</span>float,<span class="dp">·</span>random_state:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>shuffle=True</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">281 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[FedNdarray,<span class="dp">·</span>FedNdarray]:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">282 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Split<span class="dp">·</span>data<span class="dp">·</span>into<span class="dp">·</span>train<span class="dp">·</span>and<span class="dp">·</span>test<span class="dp">·</span>dataset.</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">283 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">284 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Data<span class="dp">·</span>to<span class="dp">·</span>split.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">285 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ratio:<span class="dp">·</span>Train<span class="dp">·</span>dataset<span class="dp">·</span>ratio.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">286 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state:<span class="dp">·</span>Controls<span class="dp">·</span>the<span class="dp">·</span>shuffling<span class="dp">·</span>applied<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>applying<span class="dp">·</span>the<span class="dp">·</span>split.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">287 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle:<span class="dp">·</span>Whether<span class="dp">·</span>or<span class="dp">·</span>not<span class="dp">·</span>to<span class="dp">·</span>shuffle<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>splitting.</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">288 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">289 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Tuple<span class="dp">·</span>of<span class="dp">·</span>train<span class="dp">·</span>and<span class="dp">·</span>test<span class="dp">·</span>dataset.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">290 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">291 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>data.partitions,<span class="dp">·</span>&quot;Data<span class="dp">·</span>partitions<span class="dp">·</span>are<span class="dp">·</span>None<span class="dp">·</span>or<span class="dp">·</span>empty.&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">292 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>0<span class="dp">·</span>&lt;<span class="dp">·</span>ratio<span class="dp">·</span>&lt;<span class="dp">·</span>1,<span class="dp">·</span>f&quot;Invalid<span class="dp">·</span>split<span class="dp">·</span>ratio<span class="dp">·</span>{ratio},<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>in<span class="dp">·</span>(0,<span class="dp">·</span>1)&quot;</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">293 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>random_state<span class="dp">·</span>is<span class="dp">·</span>None:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">294 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state<span class="dp">·</span>=<span class="dp">·</span>random.randint(0,<span class="dp">·</span>2**32<span class="dp">·</span>-<span class="dp">·</span>1)</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">295 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(random_state,<span class="dp">·</span>int),<span class="dp">·</span>f&quot;random_state<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>an<span class="dp">·</span>integer&quot;</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">296 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>split(*args,<span class="dp">·</span>**kwargs)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[np.ndarray,<span class="dp">·</span>np.ndarray]:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">297 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(args[0].shape)<span class="dp">·</span>==<span class="dp">·</span>0:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">298 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>np.array(None),<span class="dp">·</span>np.array(None)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">299 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>results<span class="dp">·</span>=<span class="dp">·</span>_train_test_split(*args,<span class="dp">·</span>**kwargs)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">300 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>results[0],<span class="dp">·</span>results[1]</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">301 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts_train,<span class="dp">·</span>parts_test<span class="dp">·</span>=<span class="dp">·</span>{},<span class="dp">·</span>{}</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">302 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>part<span class="dp">·</span>in<span class="dp">·</span>data.partitions.items():</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">303 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts_train[device],<span class="dp">·</span>parts_test[device]<span class="dp">·</span>=<span class="dp">·</span>device(split)(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">304 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part,<span class="dp">·</span>train_size=ratio,<span class="dp">·</span>random_state=random_state,<span class="dp">·</span>shuffle=shuffle</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">305 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">306 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">307 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray(parts_train,<span class="dp">·</span>data.partition_way),</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">308 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray(parts_test,<span class="dp">·</span>data.partition_way),</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">309 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">310 </td><td class="diffpresent">def<span class="dp">·</span>shuffle(data:<span class="dp">·</span>FedNdarray):</td><td class="diffline">276 </td><td class="diffpresent">def<span class="dp">·</span>shuffle(data:<span class="dp">·</span>FedNdarray):</td></tr>
<tr class="diffunmodified"><td class="diffline">311 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Random<span class="dp">·</span>shuffle<span class="dp">·</span>data.</td><td class="diffline">277 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Random<span class="dp">·</span>shuffle<span class="dp">·</span>data.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">312 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">278 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">313 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>shuffled.</td><td class="diffline">279 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>shuffled.</td></tr>
<tr class="diffunmodified"><td class="diffline">314 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">280 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">315 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rng<span class="dp">·</span>=<span class="dp">·</span>np.random.default_rng()</td><td class="diffline">281 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rng<span class="dp">·</span>=<span class="dp">·</span>np.random.default_rng()</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 354, 31 lines modified</td><td colspan="2">Offset 312, 31 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">354 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_len<span class="dp">·</span>=<span class="dp">·</span>len(y.partitions.keys())</td><td class="diffline">312 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_len<span class="dp">·</span>=<span class="dp">·</span>len(y.partitions.keys())</td></tr>
<tr class="diffunmodified"><td class="diffline">355 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y_len<span class="dp">·</span>==<span class="dp">·</span>1:</td><td class="diffline">313 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y_len<span class="dp">·</span>==<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">356 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>partition<span class="dp">·</span>in<span class="dp">·</span>y.partitions.items():</td><td class="diffline">314 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>partition<span class="dp">·</span>in<span class="dp">·</span>y.partitions.items():</td></tr>
<tr class="diffunmodified"><td class="diffline">357 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>simulate_double_value_replacer_handle:</td><td class="diffline">315 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>simulate_double_value_replacer_handle:</td></tr>
<tr class="diffunmodified"><td class="diffline">358 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(len_1_handle_function)(partition,<span class="dp">·</span>d)</td><td class="diffline">316 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(len_1_handle_function)(partition,<span class="dp">·</span>d)</td></tr>
<tr class="diffunmodified"><td class="diffline">359 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(len_1_handle_function)(partition)</td><td class="diffline">317 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(len_1_handle_function)(partition)</td></tr>
<tr class="diffunmodified"><td class="diffline">360 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>y_len<span class="dp">·</span>&gt;<span class="dp">·</span>1:</td><td class="diffline">318 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>y_len<span class="dp">·</span>&gt;<span class="dp">·</span>1:</td></tr>
<tr class="diffchanged"><td class="diffline">361 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>spu_device<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;A<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required&quot;</td><td class="diffline">319 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>spu_device<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;A<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required&quot;</td></tr>
<tr class="diffchanged"><td class="diffline">362 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[to(spu_device<del>,<span class="dp">·</span>partition</del>)<span class="dp">·</span>for<span class="dp">·</span>partition<span class="dp">·</span>in<span class="dp">·</span>y.partitions.values()]</td><td class="diffline">320 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[<ins>partition.</ins>to(spu_device)<span class="dp">·</span>for<span class="dp">·</span>partition<span class="dp">·</span>in<span class="dp">·</span>y.partitions.values()]</td></tr>
<tr class="diffunmodified"><td class="diffline">363 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>simulate_double_value_replacer_handle:</td><td class="diffline">321 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>simulate_double_value_replacer_handle:</td></tr>
<tr class="diffunmodified"><td class="diffline">364 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>spu_device(handle_function)(obj_list,<span class="dp">·</span>d)</td><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>spu_device(handle_function)(obj_list,<span class="dp">·</span>d)</td></tr>
<tr class="diffunmodified"><td class="diffline">365 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>spu_device(handle_function)(obj_list)</td><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>spu_device(handle_function)(obj_list)</td></tr>
<tr class="diffunmodified"><td class="diffline">366 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">367 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>0</td><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>0</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">368 </td><td class="diffpresent">def<span class="dp">·</span>mean(y:<span class="dp">·</span>FedNdarray,<span class="dp">·</span>spu_device:<span class="dp">·</span>Optional[SPU]<span class="dp">·</span>=<span class="dp">·</span>None):</td><td class="diffline">326 </td><td class="diffpresent">def<span class="dp">·</span>mean(y:<span class="dp">·</span>FedNdarray,<span class="dp">·</span>spu_device:<span class="dp">·</span>Optional[SPU]<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffunmodified"><td class="diffline">369 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Mean<span class="dp">·</span>of<span class="dp">·</span>all<span class="dp">·</span>elements</td><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Mean<span class="dp">·</span>of<span class="dp">·</span>all<span class="dp">·</span>elements</td></tr>
<tr class="diffunmodified"><td class="diffline">370 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">328 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">371 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>FedNdarray</td><td class="diffline">329 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">372 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_device:<span class="dp">·</span>SPU</td><td class="diffline">330 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_device:<span class="dp">·</span>SPU</td></tr>
<tr class="diffunmodified"><td class="diffline">373 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>party,<span class="dp">·</span>then<span class="dp">·</span>a<span class="dp">·</span>PYUObject<span class="dp">·</span>is<span class="dp">·</span>returned.</td><td class="diffline">331 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>party,<span class="dp">·</span>then<span class="dp">·</span>a<span class="dp">·</span>PYUObject<span class="dp">·</span>is<span class="dp">·</span>returned.</td></tr>
<tr class="diffunmodified"><td class="diffline">374 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>multiple<span class="dp">·</span>parties,<span class="dp">·</span>then</td><td class="diffline">332 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>multiple<span class="dp">·</span>parties,<span class="dp">·</span>then</td></tr>
<tr class="diffchanged"><td class="diffline">375 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>a<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required<span class="dp">·</span>and<span class="dp">·</span>a<span class="dp">·</span>SPUObject<span class="dp">·</span>is<span class="dp">·</span>returned.</td><td class="diffline">333 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required<span class="dp">·</span>and<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPUObject<span class="dp">·</span>is<span class="dp">·</span>returned.</td></tr>
<tr class="diffunmodified"><td class="diffline">376 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>empty<span class="dp">·</span>return<span class="dp">·</span>0.</td><td class="diffline">334 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>empty<span class="dp">·</span>return<span class="dp">·</span>0.</td></tr>
<tr class="diffunmodified"><td class="diffline">377 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">335 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">378 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_mean(obj_list:<span class="dp">·</span>List[np.ndarray]):</td><td class="diffline">336 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_mean(obj_list:<span class="dp">·</span>List[np.ndarray]):</td></tr>
<tr class="diffunmodified"><td class="diffline">379 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sums<span class="dp">·</span>=<span class="dp">·</span>jnp.array([jnp.sum(obj)<span class="dp">·</span>for<span class="dp">·</span>obj<span class="dp">·</span>in<span class="dp">·</span>obj_list])</td><td class="diffline">337 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sums<span class="dp">·</span>=<span class="dp">·</span>jnp.array([jnp.sum(obj)<span class="dp">·</span>for<span class="dp">·</span>obj<span class="dp">·</span>in<span class="dp">·</span>obj_list])</td></tr>
<tr class="diffunmodified"><td class="diffline">380 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sizes<span class="dp">·</span>=<span class="dp">·</span>jnp.array([obj.size<span class="dp">·</span>for<span class="dp">·</span>obj<span class="dp">·</span>in<span class="dp">·</span>obj_list])</td><td class="diffline">338 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sizes<span class="dp">·</span>=<span class="dp">·</span>jnp.array([obj.size<span class="dp">·</span>for<span class="dp">·</span>obj<span class="dp">·</span>in<span class="dp">·</span>obj_list])</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 10673/15454 bytes (69.06%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.26 KB</span></div>
    <div id="secretflow-data-split.py"><span class="source">secretflow/data/split.py</span>
      <a class="anchor" href="#secretflow-data-split.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 45 lines modified</td><td colspan="2">Offset 8, 42 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.model_selection<span class="dp">·</span>import<span class="dp">·</span>train_test_split<span class="dp">·</span>as<span class="dp">·</span>_train_test_split</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.model_selection<span class="dp">·</span>import<span class="dp">·</span>train_test_split<span class="dp">·</span>as<span class="dp">·</span>_train_test_split</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal.dataframe<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal.dataframe<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical.dataframe<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical.dataframe<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>train_test_split(</td><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>train_test_split(</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Union[VDataFrame,<span class="dp">·</span>HDataFrame,<span class="dp">·</span>FedNdarray],</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Union[VDataFrame,<span class="dp">·</span>HDataFrame,<span class="dp">·</span>FedNdarray],</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size=None,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size=None,</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state=1234,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state=1234,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=True,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=True,</td></tr>
<tr class="diffdeleted"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stratify=None,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[object,<span class="dp">·</span>object]:</td><td class="diffline">29 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[object,<span class="dp">·</span>object]:</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Split<span class="dp">·</span>data<span class="dp">·</span>into<span class="dp">·</span>train<span class="dp">·</span>and<span class="dp">·</span>test<span class="dp">·</span>dataset.</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Split<span class="dp">·</span>data<span class="dp">·</span>into<span class="dp">·</span>train<span class="dp">·</span>and<span class="dp">·</span>test<span class="dp">·</span>dataset.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>:<span class="dp">·</span>DataFrame<span class="dp">·</span>to<span class="dp">·</span>split,<span class="dp">·</span>supported<span class="dp">·</span>are:<span class="dp">·</span>VDataFrame,HDataFrame,FedNdarray.</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>:<span class="dp">·</span>DataFrame<span class="dp">·</span>to<span class="dp">·</span>split,<span class="dp">·</span>supported<span class="dp">·</span>are:<span class="dp">·</span>VDataFrame,HDataFrame,FedNdarray.</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size<span class="dp">·</span>(float):<span class="dp">·</span>test<span class="dp">·</span>dataset<span class="dp">·</span>size,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>None.</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size<span class="dp">·</span>(float):<span class="dp">·</span>test<span class="dp">·</span>dataset<span class="dp">·</span>size,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>None.</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size<span class="dp">·</span>(float):<span class="dp">·</span>train<span class="dp">·</span>dataset<span class="dp">·</span>size,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>None.</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size<span class="dp">·</span>(float):<span class="dp">·</span>train<span class="dp">·</span>dataset<span class="dp">·</span>size,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>None.</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state<span class="dp">·</span>(int):<span class="dp">·</span>Controls<span class="dp">·</span>the<span class="dp">·</span>shuffling<span class="dp">·</span>applied<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>applying<span class="dp">·</span>the<span class="dp">·</span>split.</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state<span class="dp">·</span>(int):<span class="dp">·</span>Controls<span class="dp">·</span>the<span class="dp">·</span>shuffling<span class="dp">·</span>applied<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>applying<span class="dp">·</span>the<span class="dp">·</span>split.</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle<span class="dp">·</span>(bool):<span class="dp">·</span>Whether<span class="dp">·</span>or<span class="dp">·</span>not<span class="dp">·</span>to<span class="dp">·</span>shuffle<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>splitting,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>True.</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle<span class="dp">·</span>(bool):<span class="dp">·</span>Whether<span class="dp">·</span>or<span class="dp">·</span>not<span class="dp">·</span>to<span class="dp">·</span>shuffle<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>before<span class="dp">·</span>splitting,<span class="dp">·</span>default<span class="dp">·</span>is<span class="dp">·</span>True.</td></tr>
<tr class="diffdeleted"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stratify<span class="dp">·</span>(array-like):<span class="dp">·</span>If<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>split<span class="dp">·</span>in<span class="dp">·</span>a<span class="dp">·</span>stratified<span class="dp">·</span>fashion,<span class="dp">·</span>using<span class="dp">·</span>this<span class="dp">·</span>as<span class="dp">·</span>the<span class="dp">·</span>class<span class="dp">·</span>labels.</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>splitting<span class="dp">·</span>:<span class="dp">·</span>list,<span class="dp">·</span>length=2<span class="dp">·</span>*<span class="dp">·</span>len(arrays)</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>splitting<span class="dp">·</span>:<span class="dp">·</span>list,<span class="dp">·</span>length=2<span class="dp">·</span>*<span class="dp">·</span>len(arrays)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>from<span class="dp">·</span>secret.data.split<span class="dp">·</span>import<span class="dp">·</span>train_test_split</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>from<span class="dp">·</span>secret.data.split<span class="dp">·</span>import<span class="dp">·</span>train_test_split</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 109, 15 lines modified</td><td colspan="2">Offset 106, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part_data<span class="dp">·</span>=<span class="dp">·</span>part.data</td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part_data<span class="dp">·</span>=<span class="dp">·</span>part.data</td></tr>
<tr class="diffunmodified"><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts_train[device],<span class="dp">·</span>parts_test[device]<span class="dp">·</span>=<span class="dp">·</span>device(split)(</td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts_train[device],<span class="dp">·</span>parts_test[device]<span class="dp">·</span>=<span class="dp">·</span>device(split)(</td></tr>
<tr class="diffunmodified"><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part_data,</td><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part_data,</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size=train_size,</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_size=train_size,</td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size=test_size,</td><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_size=test_size,</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state=random_state,</td><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_state=random_state,</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=shuffle,</td><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=shuffle,</td></tr>
<tr class="diffdeleted"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stratify=stratify,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data,<span class="dp">·</span>VDataFrame):</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data,<span class="dp">·</span>VDataFrame):</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>VDataFrame(</td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>VDataFrame(</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={pyu:<span class="dp">·</span>Partition(data=part)<span class="dp">·</span>for<span class="dp">·</span>pyu,<span class="dp">·</span>part<span class="dp">·</span>in<span class="dp">·</span>parts_train.items()},</td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={pyu:<span class="dp">·</span>Partition(data=part)<span class="dp">·</span>for<span class="dp">·</span>pyu,<span class="dp">·</span>part<span class="dp">·</span>in<span class="dp">·</span>parts_train.items()},</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aligned=data.aligned,</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aligned=data.aligned,</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>VDataFrame(</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>VDataFrame(</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">853 B</span></div>
    <div id="secretflow-data-io-util.py"><span class="source">secretflow/data/io/util.py</span>
      <a class="anchor" href="#secretflow-data-io-util.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 15, 16 lines modified</td><td colspan="2">Offset 15, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>builtins</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>builtins</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>urllib.parse<span class="dp">·</span>import<span class="dp">·</span>urlparse</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>urllib.parse<span class="dp">·</span>import<span class="dp">·</span>urlparse</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.data.io.oss<span class="dp">·</span>as<span class="dp">·</span>oss</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">def<span class="dp">·</span>open(filepath:<span class="dp">·</span>Union[str,<span class="dp">·</span>Path],<span class="dp">·</span>mode=&#x27;rb&#x27;):</td><td class="diffline">20 </td><td class="diffpresent">def<span class="dp">·</span>open(filepath:<span class="dp">·</span>Union[str,<span class="dp">·</span>Path],<span class="dp">·</span>mode=&#x27;rb&#x27;):</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Open<span class="dp">·</span>a<span class="dp">·</span>oss/http/https<span class="dp">·</span>file.</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Open<span class="dp">·</span>a<span class="dp">·</span>oss/http/https<span class="dp">·</span>file.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>filepath:<span class="dp">·</span>The<span class="dp">·</span>file<span class="dp">·</span>path,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>be<span class="dp">·</span>an<span class="dp">·</span>oss,<span class="dp">·</span>or<span class="dp">·</span>pathlib.Path<span class="dp">·</span>object.</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>filepath:<span class="dp">·</span>The<span class="dp">·</span>file<span class="dp">·</span>path,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>be<span class="dp">·</span>an<span class="dp">·</span>oss,<span class="dp">·</span>or<span class="dp">·</span>pathlib.Path<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mode:<span class="dp">·</span>optional.<span class="dp">·</span>open<span class="dp">·</span>mode.</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mode:<span class="dp">·</span>optional.<span class="dp">·</span>open<span class="dp">·</span>mode.</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 33, 14 lines modified</td><td colspan="2">Offset 31, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>the<span class="dp">·</span>file<span class="dp">·</span>object.</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>the<span class="dp">·</span>file<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>isinstance(filepath,<span class="dp">·</span>str):</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>isinstance(filepath,<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>filepath</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>filepath</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>o<span class="dp">·</span>=<span class="dp">·</span>urlparse(filepath)</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>o<span class="dp">·</span>=<span class="dp">·</span>urlparse(filepath)</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>o.scheme<span class="dp">·</span>==<span class="dp">·</span>&#x27;oss&#x27;:</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>o.scheme<span class="dp">·</span>==<span class="dp">·</span>&#x27;oss&#x27;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>secretflow.data.io.oss<span class="dp">·</span>as<span class="dp">·</span>oss</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>oss.open(filepath,<span class="dp">·</span>mode)</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>oss.open(filepath,<span class="dp">·</span>mode)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>builtins.open(filepath,<span class="dp">·</span>mode)</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>builtins.open(filepath,<span class="dp">·</span>mode)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent">def<span class="dp">·</span>is_local_file(uri:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td><td class="diffline">40 </td><td class="diffpresent">def<span class="dp">·</span>is_local_file(uri:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>uri<span class="dp">·</span>and<span class="dp">·</span>not<span class="dp">·</span>urlparse(uri).scheme</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>uri<span class="dp">·</span>and<span class="dp">·</span>not<span class="dp">·</span>urlparse(uri).scheme</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">543 B</span></div>
    <div id="secretflow-data-vertical-dataframe.py"><span class="source">secretflow/data/vertical/dataframe.py</span>
      <a class="anchor" href="#secretflow-data-vertical-dataframe.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 13, 14 lines modified</td><td colspan="2">Offset 13, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Union</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>pandas.core.indexes.base<span class="dp">·</span>import<span class="dp">·</span>Index</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>pandas.core.indexes.base<span class="dp">·</span>import<span class="dp">·</span>Index</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>DataFrameBase,<span class="dp">·</span>Partition</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>DataFrameBase,<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>Device,<span class="dp">·</span>reveal</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>Device,<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError,<span class="dp">·</span>NotFoundError</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError,<span class="dp">·</span>NotFoundError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">@dataclass</td><td class="diffline">22 </td><td class="diffpresent">@dataclass</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">17.3 KB</span></div>
    <div id="secretflow-device-driver.py"><span class="source">secretflow/device/driver.py</span>
      <a class="anchor" href="#secretflow-device-driver.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 38 lines modified</td><td colspan="2">Offset 10, 41 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pathlib</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>wraps</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>wraps</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Dict,<span class="dp">·</span>Iterable,<span class="dp">·</span>List,<span class="dp">·</span>Optional,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Dict,<span class="dp">·</span>Iterable,<span class="dp">·</span>List,<span class="dp">·</span>Optional,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>fed</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>fed</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>jax</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>jax</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>multiprocess</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>multiprocess</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>ray</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>ray</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>global_state</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.logging<span class="dp">·</span>import<span class="dp">·</span>set_logging_level</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.logging<span class="dp">·</span>import<span class="dp">·</span>set_logging_level</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.ray_compatibility<span class="dp">·</span>import<span class="dp">·</span>ray_version_less_than_2_0_0</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>.device<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>.device<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUIO,</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUIO,</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject,</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEEUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">)</td><td class="diffline">39 </td><td class="diffpresent">)</td></tr>
<tr class="diffdeleted"><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>.device.base<span class="dp">·</span>import<span class="dp">·</span>MoveConfig</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">def<span class="dp">·</span>with_device(</td><td class="diffline">40 </td><td class="diffpresent">def<span class="dp">·</span>with_device(</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dev:<span class="dp">·</span>Device,</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dev:<span class="dp">·</span>Device,</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*,</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*,</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>static_argnames:<span class="dp">·</span>Union[str,<span class="dp">·</span>Iterable[str],<span class="dp">·</span>None]<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>static_argnames:<span class="dp">·</span>Union[str,<span class="dp">·</span>Iterable[str],<span class="dp">·</span>None]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 67, 33 lines modified</td><td colspan="2">Offset 70, 29 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>wrapper(fn):</td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>wrapper(fn):</td></tr>
<tr class="diffunmodified"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>dev(fn,<span class="dp">·</span>num_returns=num_returns,<span class="dp">·</span>static_argnames=static_argnames)</td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>dev(fn,<span class="dp">·</span>num_returns=num_returns,<span class="dp">·</span>static_argnames=static_argnames)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>wrapper</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>wrapper</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">70 </td><td class="diffpresent">def<span class="dp">·</span>to(device:<span class="dp">·</span>Device,<span class="dp">·</span>data:<span class="dp">·</span>Any<del>,<span class="dp">·</span>spu_vis:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&#x27;secret&#x27;</del>):</td><td class="diffline">73 </td><td class="diffpresent">def<span class="dp">·</span>to(device:<span class="dp">·</span>Device,<span class="dp">·</span>data:<span class="dp">·</span>Any):</td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>object<span class="dp">·</span>conversion.</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>object<span class="dp">·</span>conversion.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device<span class="dp">·</span>(Device):<span class="dp">·</span>Target<span class="dp">·</span>device.</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device<span class="dp">·</span>(Device):<span class="dp">·</span>Target<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>DeviceObject<span class="dp">·</span>or<span class="dp">·</span>plaintext<span class="dp">·</span>data.</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>DeviceObject<span class="dp">·</span>or<span class="dp">·</span>plaintext<span class="dp">·</span>data.</td></tr>
<tr class="diffdeleted"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_vis<span class="dp">·</span>(str):<span class="dp">·</span>Deivce<span class="dp">·</span>object<span class="dp">·</span>visibility,<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>only.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secret:<span class="dp">·</span>Secret<span class="dp">·</span>sharing<span class="dp">·</span>with<span class="dp">·</span>protocol<span class="dp">·</span>spdz-2k,<span class="dp">·</span>aby3,<span class="dp">·</span>etc.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>public:<span class="dp">·</span>Public<span class="dp">·</span>sharing,<span class="dp">·</span>which<span class="dp">·</span>means<span class="dp">·</span>data<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>replicated<span class="dp">·</span>to<span class="dp">·</span>each<span class="dp">·</span>node.</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject:<span class="dp">·</span>Target<span class="dp">·</span>device<span class="dp">·</span>object.</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject:<span class="dp">·</span>Target<span class="dp">·</span>device<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffdeleted"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_vis<span class="dp">·</span>==<span class="dp">·</span>&#x27;secret&#x27;<span class="dp">·</span>or<span class="dp">·</span>spu_vis<span class="dp">·</span>==<span class="dp">·</span>&#x27;public&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;spu_vis<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>public<span class="dp">·</span>or<span class="dp">·</span>secret&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data,<span class="dp">·</span>DeviceObject):</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data,<span class="dp">·</span>DeviceObject):</td></tr>
<tr class="diffchanged"><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r<del>eturn<span class="dp">·</span>dat</del>a<del>.to(dev</del>i<del>c</del>e<del>,</del><span class="dp">·</span><del>Mo</del>v<del>eCo</del><del>nf</del>i<del>g(sp</del>u<del>_vis</del><del>=spu_vis))</del></td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rai<ins>s</ins>e<span class="dp">·</span><ins>In</ins>v<ins>al</ins>i<ins>dArg</ins>u<ins>mentError(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;You<span class="dp">·</span>should<span class="dp">·</span>use<span class="dp">·</span>`DeviceObject.to(device)`<span class="dp">·</span>directly<span class="dp">·</span>to&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;transfer<span class="dp">·</span>DeviceObject<span class="dp">·</span>to<span class="dp">·</span>another<span class="dp">·</span>device.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>PYU):</td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>PYU):</td></tr>
<tr class="diffunmodified"><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(lambda<span class="dp">·</span>x:<span class="dp">·</span>x)(data)</td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>device(lambda<span class="dp">·</span>x:<span class="dp">·</span>x)(data)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU):</td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU):</td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>ValueError(</td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>ValueError(</td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;You<span class="dp">·</span>cannot<span class="dp">·</span>put<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>SPU<span class="dp">·</span>directly,<span class="dp">·</span>&quot;</td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;You<span class="dp">·</span>cannot<span class="dp">·</span>put<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>SPU<span class="dp">·</span>directly,<span class="dp">·</span>&quot;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 144, 21 lines modified</td><td colspan="2">Offset 143, 24 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.append(ref)</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.append(ref)</td></tr>
<tr class="diffunmodified"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(x,<span class="dp">·</span>SPUObject):</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(x,<span class="dp">·</span>SPUObject):</td></tr>
<tr class="diffunmodified"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffunmodified"><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.shares_name[0],<span class="dp">·</span>(ray.ObjectRef,<span class="dp">·</span>fed.FedObject)</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.shares_name[0],<span class="dp">·</span>(ray.ObjectRef,<span class="dp">·</span>fed.FedObject)</td></tr>
<tr class="diffunmodified"><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;shares_name<span class="dp">·</span>in<span class="dp">·</span>spu<span class="dp">·</span>obj<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>ObjectRef<span class="dp">·</span>or<span class="dp">·</span>FedObject,<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(x.shares_name[0])}<span class="dp">·</span>&quot;</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;shares_name<span class="dp">·</span>in<span class="dp">·</span>spu<span class="dp">·</span>obj<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>ObjectRef<span class="dp">·</span>or<span class="dp">·</span>FedObject,<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(x.shares_name[0])}<span class="dp">·</span>&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.append(x.meta)</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.append(x.meta)</td></tr>
<tr class="diffunmodified"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.extend(x.device.outfeed_shares(x.shares_name))</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.extend(x.device.outfeed_shares(x.shares_name))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(x,<span class="dp">·</span>TEEUObject):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object_refs.append(x.data)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.debug(f&#x27;Getting<span class="dp">·</span>teeu<span class="dp">·</span>data<span class="dp">·</span>from<span class="dp">·</span>TEEU<span class="dp">·</span>{x.device.party}.&#x27;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cur_idx<span class="dp">·</span>=<span class="dp">·</span>0</td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cur_idx<span class="dp">·</span>=<span class="dp">·</span>0</td></tr>
<tr class="diffunmodified"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object<span class="dp">·</span>=<span class="dp">·</span>sfd.get(all_object_refs)</td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>all_object<span class="dp">·</span>=<span class="dp">·</span>sfd.get(all_object_refs)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>x<span class="dp">·</span>in<span class="dp">·</span>flatten_val:</td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>x<span class="dp">·</span>in<span class="dp">·</span>flatten_val:</td></tr>
<tr class="diffchanged"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>PYUObject<del>)<span class="dp">·</span>o</del><del>r</del><span class="dp">·</span><del>isi</del><del>nstanc</del>e<del>(x</del>,<span class="dp">·</span><del>H</del>EUObject):</td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span><ins>(</ins>PYUObject<ins>,</ins><span class="dp">·</span><ins>HEUObj</ins>e<ins>ct</ins>,<span class="dp">·</span><ins>T</ins><ins>E</ins>EUObject<ins>)</ins>):</td></tr>
<tr class="diffunmodified"><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val.append(all_object[cur_idx])</td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val.append(all_object[cur_idx])</td></tr>
<tr class="diffunmodified"><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cur_idx<span class="dp">·</span>+=<span class="dp">·</span>1</td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cur_idx<span class="dp">·</span>+=<span class="dp">·</span>1</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(x,<span class="dp">·</span>SPUObject):</td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(x,<span class="dp">·</span>SPUObject):</td></tr>
<tr class="diffunmodified"><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>io<span class="dp">·</span>=<span class="dp">·</span>SPUIO(x.device.conf,<span class="dp">·</span>x.device.world_size)</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>io<span class="dp">·</span>=<span class="dp">·</span>SPUIO(x.device.conf,<span class="dp">·</span>x.device.world_size)</td></tr>
<tr class="diffunmodified"><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta<span class="dp">·</span>=<span class="dp">·</span>all_object[cur_idx]</td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta<span class="dp">·</span>=<span class="dp">·</span>all_object[cur_idx]</td></tr>
<tr class="diffunmodified"><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares<span class="dp">·</span>=<span class="dp">·</span>[all_object[cur_idx<span class="dp">·</span>+<span class="dp">·</span>i<span class="dp">·</span>+<span class="dp">·</span>1]<span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(x.device.world_size)]</td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares<span class="dp">·</span>=<span class="dp">·</span>[all_object[cur_idx<span class="dp">·</span>+<span class="dp">·</span>i<span class="dp">·</span>+<span class="dp">·</span>1]<span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(x.device.world_size)]</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 170, 30 lines modified</td><td colspan="2">Offset 172, 33 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val.append(x)</td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>new_flatten_val.append(x)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jax.tree_util.tree_unflatten(tree,<span class="dp">·</span>new_flatten_val)</td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jax.tree_util.tree_unflatten(tree,<span class="dp">·</span>new_flatten_val)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">172 </td><td class="diffpresent">def<span class="dp">·</span>wait(objects:<span class="dp">·</span>Any):</td><td class="diffline">174 </td><td class="diffpresent">def<span class="dp">·</span>wait(objects:<span class="dp">·</span>Any):</td></tr>
<tr class="diffunmodified"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Wait<span class="dp">·</span>for<span class="dp">·</span>device<span class="dp">·</span>objects<span class="dp">·</span>until<span class="dp">·</span>all<span class="dp">·</span>are<span class="dp">·</span>ready<span class="dp">·</span>or<span class="dp">·</span>error<span class="dp">·</span>occurrency.</td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Wait<span class="dp">·</span>for<span class="dp">·</span>device<span class="dp">·</span>objects<span class="dp">·</span>until<span class="dp">·</span>all<span class="dp">·</span>are<span class="dp">·</span>ready<span class="dp">·</span>or<span class="dp">·</span>error<span class="dp">·</span>occurrency.</td></tr>
<tr class="diffdeleted"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NOTE:<span class="dp">·</span>This<span class="dp">·</span>function<span class="dp">·</span>uses<span class="dp">·</span>reveal<span class="dp">·</span>internally,<span class="dp">·</span>but<span class="dp">·</span>won&#x27;t<span class="dp">·</span>reveal<span class="dp">·</span>result<span class="dp">·</span>to<span class="dp">·</span>public.<span class="dp">·</span>So<span class="dp">·</span>this<span class="dp">·</span>is<span class="dp">·</span>secure<span class="dp">·</span>to<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>as<span class="dp">·</span>synchronization<span class="dp">·</span>semantics.</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NOTE:<span class="dp">·</span>This<span class="dp">·</span>function<span class="dp">·</span>uses<span class="dp">·</span>reveal<span class="dp">·</span>internally,<span class="dp">·</span>but<span class="dp">·</span>won&#x27;t<span class="dp">·</span>reveal<span class="dp">·</span>result<span class="dp">·</span>to</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>public.<span class="dp">·</span>So<span class="dp">·</span>this<span class="dp">·</span>is<span class="dp">·</span>secure<span class="dp">·</span>to<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>as<span class="dp">·</span>synchronization<span class="dp">·</span>semantics.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>objects:<span class="dp">·</span>struct<span class="dp">·</span>of<span class="dp">·</span>device<span class="dp">·</span>objects.</td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>objects:<span class="dp">·</span>struct<span class="dp">·</span>of<span class="dp">·</span>device<span class="dp">·</span>objects.</td></tr>
<tr class="diffdeleted"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td></tr>
<tr class="diffunmodified"><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>spu<span class="dp">·</span>=<span class="dp">·</span>sf.SPU()</td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>spu<span class="dp">·</span>=<span class="dp">·</span>sf.SPU()</td></tr>
<tr class="diffunmodified"><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>spu_value<span class="dp">·</span>=<span class="dp">·</span>spu(some_function)(some_value)</td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>spu_value<span class="dp">·</span>=<span class="dp">·</span>spu(some_function)(some_value)</td></tr>
<tr class="diffunmodified"><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>alice_value<span class="dp">·</span>=<span class="dp">·</span>spu_value.to(alice)</td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>alice_value<span class="dp">·</span>=<span class="dp">·</span>spu_value.to(alice)</td></tr>
<tr class="diffunmodified"><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>synchronization</td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>synchronization</td></tr>
<tr class="diffunmodified"><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sf.wait(alice(some_save_value_function_locally)(alice_value))</td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sf.wait(alice(some_save_value_function_locally)(alice_value))</td></tr>
<tr class="diffunmodified"><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>TODO(@xibin.wxb):<span class="dp">·</span>support<span class="dp">·</span>HEUObject</td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>TODO(@xibin.wxb):<span class="dp">·</span>support<span class="dp">·</span>HEUObject</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 13217/17624 bytes (74.99%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">598 B</span></div>
    <div id="secretflow-device-link.py"><span class="source">secretflow/device/link.py</span>
      <a class="anchor" href="#secretflow-device-link.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 183, 15 lines modified</td><td colspan="2">Offset 183, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>break</td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>break</td></tr>
<tr class="diffunmodified"><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._cv.wait()</td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._cv.wait()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>list(vals.values())[0]<span class="dp">·</span>if<span class="dp">·</span>is_single<span class="dp">·</span>else<span class="dp">·</span>list(vals.values())</td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>list(vals.values())[0]<span class="dp">·</span>if<span class="dp">·</span>is_single<span class="dp">·</span>else<span class="dp">·</span>list(vals.values())</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">186 </td><td class="diffpresent">class<span class="dp">·</span>Link:</td><td class="diffline">186 </td><td class="diffpresent">class<span class="dp">·</span>Link:</td></tr>
<tr class="diffchanged"><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;A<span class="dp">·</span>helper<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>communication<span class="dp">·</span>inside<span class="dp">·</span>actor<span class="dp">·</span>between<span class="dp">·</span>se<del>r</del>veral<span class="dp">·</span>actors.</td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;A<span class="dp">·</span>helper<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>communication<span class="dp">·</span>inside<span class="dp">·</span>actor<span class="dp">·</span>between<span class="dp">·</span>several<span class="dp">·</span>actors.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>You<span class="dp">·</span>should<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>class<span class="dp">·</span>directly<span class="dp">·</span>but<span class="dp">·</span>inherit<span class="dp">·</span>it<span class="dp">·</span>and<span class="dp">·</span>decorate<span class="dp">·</span>your</td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>You<span class="dp">·</span>should<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>class<span class="dp">·</span>directly<span class="dp">·</span>but<span class="dp">·</span>inherit<span class="dp">·</span>it<span class="dp">·</span>and<span class="dp">·</span>decorate<span class="dp">·</span>your</td></tr>
<tr class="diffunmodified"><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>child<span class="dp">·</span>class<span class="dp">·</span>with<span class="dp">·</span>:py:meth:`~secretflow.device.proxy`.</td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>child<span class="dp">·</span>class<span class="dp">·</span>with<span class="dp">·</span>:py:meth:`~secretflow.device.proxy`.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples</td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples</td></tr>
<tr class="diffunmodified"><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>--------</td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>--------</td></tr>
<tr class="diffunmodified"><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>proxy</td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>proxy</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">453 B</span></div>
    <div id="secretflow-device-device-__init__.py"><span class="source">secretflow/device/device/__init__.py</span>
      <a class="anchor" href="#secretflow-device-device-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 14, 8 lines modified</td><td colspan="2">Offset 14, 9 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.heu<span class="dp">·</span>import<span class="dp">·</span>HEU</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.heu<span class="dp">·</span>import<span class="dp">·</span>HEU</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.heu_object<span class="dp">·</span>import<span class="dp">·</span>HEUObject</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.heu_object<span class="dp">·</span>import<span class="dp">·</span>HEUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>DeviceType,<span class="dp">·</span>register</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>DeviceType,<span class="dp">·</span>register</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.spu<span class="dp">·</span>import<span class="dp">·</span>SPU,<span class="dp">·</span>SPUIO,<span class="dp">·</span>SPUCompilerNumReturnsPolicy,<span class="dp">·</span>SPUObject,<span class="dp">·</span>SPUValueMeta</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.spu<span class="dp">·</span>import<span class="dp">·</span>SPU,<span class="dp">·</span>SPUIO,<span class="dp">·</span>SPUCompilerNumReturnsPolicy,<span class="dp">·</span>SPUObject,<span class="dp">·</span>SPUValueMeta</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>.teeu<span class="dp">·</span>import<span class="dp">·</span>TEEU,<span class="dp">·</span>TEEUData,<span class="dp">·</span>TEEUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision,<span class="dp">·</span>spu_fxp_size</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision,<span class="dp">·</span>spu_fxp_size</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">3.06 KB</span></div>
    <div id="secretflow-device-device-base.py"><span class="source">secretflow/device/device/base.py</span>
      <a class="anchor" href="#secretflow-device-device-base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 20 lines modified</td><td colspan="2">Offset 9, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>DeviceType,<span class="dp">·</span>dispatch</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>DeviceType,<span class="dp">·</span>dispatch<ins>,<span class="dp">·</span>register</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">class<span class="dp">·</span>Device(ABC):</td><td class="diffline">16 </td><td class="diffpresent">class<span class="dp">·</span>Device(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>device_type:<span class="dp">·</span>DeviceType):</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>device_type:<span class="dp">·</span>DeviceType):</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstraction<span class="dp">·</span>device<span class="dp">·</span>base<span class="dp">·</span>class.</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstraction<span class="dp">·</span>device<span class="dp">·</span>base<span class="dp">·</span>class.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 37, 40 lines modified</td><td colspan="2">Offset 33, 16 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__call__(self,<span class="dp">·</span>fn,<span class="dp">·</span>**kwargs):</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__call__(self,<span class="dp">·</span>fn,<span class="dp">·</span>**kwargs):</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Set<span class="dp">·</span>up<span class="dp">·</span>``fn``<span class="dp">·</span>for<span class="dp">·</span>scheduling<span class="dp">·</span>to<span class="dp">·</span>this<span class="dp">·</span>device&quot;&quot;&quot;</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Set<span class="dp">·</span>up<span class="dp">·</span>``fn``<span class="dp">·</span>for<span class="dp">·</span>scheduling<span class="dp">·</span>to<span class="dp">·</span>this<span class="dp">·</span>device&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent">def<span class="dp">·</span>_name_of_to(device_type:<span class="dp">·</span>DeviceType):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>f&#x27;to_{device_type.name}&#x27;</td></tr>
<tr class="diffdeleted"><td class="diffline">41 </td><td class="diffpresent">@dataclass</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">42 </td><td class="diffpresent">class<span class="dp">·</span>MoveConfig:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_vis:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&#x27;secret&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;spu_vis<span class="dp">·</span>(str):<span class="dp">·</span>Deivce<span class="dp">·</span>object<span class="dp">·</span>visibility,<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>only.<span class="dp">·</span>Value<span class="dp">·</span>can<span class="dp">·</span>be:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>secret:<span class="dp">·</span>Secret<span class="dp">·</span>sharing<span class="dp">·</span>with<span class="dp">·</span>protocol<span class="dp">·</span>spdz-2k,<span class="dp">·</span>aby3,<span class="dp">·</span>etc.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>public:<span class="dp">·</span>Public<span class="dp">·</span>sharing,<span class="dp">·</span>which<span class="dp">·</span>means<span class="dp">·</span>data<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>replicated<span class="dp">·</span>to<span class="dp">·</span>each<span class="dp">·</span>node.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&#x27;auto&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Where<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>located&quot;&quot;&quot;</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_encoder:<span class="dp">·</span>Union[</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.IntegerEncoder,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.FloatEncoder,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BigintEncoder,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BatchEncoder,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.IntegerEncoderParams,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.FloatEncoderParams,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BigintEncoderParams,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BatchEncoderParams,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]<span class="dp">·</span>=<span class="dp">·</span>None</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Do<span class="dp">·</span>encode<span class="dp">·</span>before<span class="dp">·</span>move<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>heu&quot;&quot;&quot;</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>None</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;file<span class="dp">·</span>path<span class="dp">·</span>to<span class="dp">·</span>record<span class="dp">·</span>audit<span class="dp">·</span>log&quot;&quot;&quot;</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent">class<span class="dp">·</span>DeviceObject(ABC):</td><td class="diffline">39 </td><td class="diffpresent">class<span class="dp">·</span>DeviceObject(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>device:<span class="dp">·</span>Device):</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>device:<span class="dp">·</span>Device):</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstraction<span class="dp">·</span>device<span class="dp">·</span>object<span class="dp">·</span>base<span class="dp">·</span>class.</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstraction<span class="dp">·</span>device<span class="dp">·</span>object<span class="dp">·</span>base<span class="dp">·</span>class.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 79, 24 lines modified</td><td colspan="2">Offset 51, 29 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device<span class="dp">·</span>=<span class="dp">·</span>device</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device<span class="dp">·</span>=<span class="dp">·</span>device</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@property</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@property</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>device_type(self):</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>device_type(self):</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Get<span class="dp">·</span>underlying<span class="dp">·</span>device<span class="dp">·</span>type&quot;&quot;&quot;</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Get<span class="dp">·</span>underlying<span class="dp">·</span>device<span class="dp">·</span>type&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.device.device_type</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.device.device_type</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>to(self,<span class="dp">·</span>device:<span class="dp">·</span>Device,<span class="dp">·</span><del>co</del><del>nfi</del>g<del>:<span class="dp">·</span></del><del>MoveConfi</del>g<del><span class="dp">·</span>=<span class="dp">·</span>Non</del><del>e</del>):</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>to(self,<span class="dp">·</span>device:<span class="dp">·</span>Device,<span class="dp">·</span><ins>*ar</ins>g<ins>s,<span class="dp">·</span>**kwar</ins>g<ins>s</ins>):</td></tr>
<tr class="diffunmodified"><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>object<span class="dp">·</span>conversion.</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>object<span class="dp">·</span>conversion.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device<span class="dp">·</span>(Device):<span class="dp">·</span>Target<span class="dp">·</span>device</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device<span class="dp">·</span>(Device):<span class="dp">·</span>Target<span class="dp">·</span>device</td></tr>
<tr class="diffunmodified"><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config:<span class="dp">·</span>configuration<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>data<span class="dp">·</span>movement</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config:<span class="dp">·</span>configuration<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>data<span class="dp">·</span>movement</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject:<span class="dp">·</span>Target<span class="dp">·</span>device<span class="dp">·</span>object.</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject:<span class="dp">·</span>Target<span class="dp">·</span>device<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>dispatch(_name_of_to(device.device_type),<span class="dp">·</span>self,<span class="dp">·</span>device,<span class="dp">·</span>*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffdeleted"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config,<span class="dp">·</span>(type(None),<span class="dp">·</span>MoveConfig)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;config<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>MoveConfig<span class="dp">·</span>type,<span class="dp">·</span>got<span class="dp">·</span>{type(config)},<span class="dp">·</span>value={config}&quot;</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>dispatch(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;to&#x27;,<span class="dp">·</span>self,<span class="dp">·</span>device,<span class="dp">·</span>config<span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>MoveConfig()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent">def<span class="dp">·</span>register_to(from_device_type,<span class="dp">·</span>to_device_type):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Register<span class="dp">·</span>to<span class="dp">·</span>as<span class="dp">·</span>device<span class="dp">·</span>kernel.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from_device_type:<span class="dp">·</span>the<span class="dp">·</span>source<span class="dp">·</span>device<span class="dp">·</span>type.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>to_device_type:<span class="dp">·</span>the<span class="dp">·</span>dest<span class="dp">·</span>device<span class="dp">·</span>type.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>register(device_type=from_device_type,<span class="dp">·</span>op_name=_name_of_to(to_device_type))</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">11.6 KB</span></div>
    <div id="secretflow-device-device-heu.py"><span class="source">secretflow/device/device/heu.py</span>
      <a class="anchor" href="#secretflow-device-device-heu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 7, 21 lines modified</td><td colspan="2">Offset 7, 24 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>reduce</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>reduce</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>jax.tree_util</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>ray</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>cloudpickle<span class="dp">·</span>as<span class="dp">·</span>pickle</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>cloudpickle<span class="dp">·</span>as<span class="dp">·</span>pickle</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>jax.tree_util</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>ray</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>spu</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>spu</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td><td class="diffline">25 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>PartyNotFoundError</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>PartyNotFoundError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 31, 14 lines modified</td><td colspan="2">Offset 34, 35 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_datatype_to_numpy,</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_datatype_to_numpy,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_datatype_to_spu,</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_datatype_to_spu,</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_fxp_precision,</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_fxp_precision,</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_fxp_size,</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_fxp_size,</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">)</td><td class="diffline">38 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">@dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">class<span class="dp">·</span>HEUMoveConfig:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&#x27;auto&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Where<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>located&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_encoder:<span class="dp">·</span>Union[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.IntegerEncoder,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.FloatEncoder,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BigintEncoder,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.IntegerEncoderParams,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.FloatEncoderParams,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BigintEncoderParams,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BatchFloatEncoderParams,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>phe.BatchIntegerEncoderParams,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Do<span class="dp">·</span>encode<span class="dp">·</span>before<span class="dp">·</span>move<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>heu&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;file<span class="dp">·</span>path<span class="dp">·</span>to<span class="dp">·</span>record<span class="dp">·</span>audit<span class="dp">·</span>log&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent">class<span class="dp">·</span>HEUActor:</td><td class="diffline">56 </td><td class="diffpresent">class<span class="dp">·</span>HEUActor:</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_id,</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_id,</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party:<span class="dp">·</span>str,</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party:<span class="dp">·</span>str,</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hekit:<span class="dp">·</span>Union[hnp.HeKit,<span class="dp">·</span>hnp.DestinationHeKit],</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hekit:<span class="dp">·</span>Union[hnp.HeKit,<span class="dp">·</span>hnp.DestinationHeKit],</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cleartext_type:<span class="dp">·</span>np.dtype,</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cleartext_type:<span class="dp">·</span>np.dtype,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 51, 15 lines modified</td><td colspan="2">Offset 75, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party:<span class="dp">·</span>The<span class="dp">·</span>party<span class="dp">·</span>id</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party:<span class="dp">·</span>The<span class="dp">·</span>party<span class="dp">·</span>id</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hekit:<span class="dp">·</span>hnp.HeKit<span class="dp">·</span>for<span class="dp">·</span>sk_keeper<span class="dp">·</span>or<span class="dp">·</span>hnp.DestinationHeKit<span class="dp">·</span>for<span class="dp">·</span>evaluator</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hekit:<span class="dp">·</span>hnp.HeKit<span class="dp">·</span>for<span class="dp">·</span>sk_keeper<span class="dp">·</span>or<span class="dp">·</span>hnp.DestinationHeKit<span class="dp">·</span>for<span class="dp">·</span>evaluator</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoder:<span class="dp">·</span>Encode<span class="dp">·</span>cleartext<span class="dp">·</span>(float<span class="dp">·</span>value)<span class="dp">·</span>to<span class="dp">·</span>plaintext<span class="dp">·</span>(big<span class="dp">·</span>int<span class="dp">·</span>value).</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoder:<span class="dp">·</span>Encode<span class="dp">·</span>cleartext<span class="dp">·</span>(float<span class="dp">·</span>value)<span class="dp">·</span>to<span class="dp">·</span>plaintext<span class="dp">·</span>(big<span class="dp">·</span>int<span class="dp">·</span>value).</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>available<span class="dp">·</span>encoders:</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>available<span class="dp">·</span>encoders:</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.IntegerEncoder</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.IntegerEncoder</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.FloatEncoder</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.FloatEncoder</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.BigintEncoder</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.BigintEncoder</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.BatchIntegerEncoder</td></tr>
<tr class="diffchanged"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.BatchEncoder</td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>phe.Batch<ins>Float</ins>Encoder</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu_id<span class="dp">·</span>=<span class="dp">·</span>heu_id</td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu_id<span class="dp">·</span>=<span class="dp">·</span>heu_id</td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.hekit<span class="dp">·</span>=<span class="dp">·</span>hekit</td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.hekit<span class="dp">·</span>=<span class="dp">·</span>hekit</td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.encryptor<span class="dp">·</span>=<span class="dp">·</span>hekit.encryptor()</td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.encryptor<span class="dp">·</span>=<span class="dp">·</span>hekit.encryptor()</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.evaluator<span class="dp">·</span>=<span class="dp">·</span>hekit.evaluator()</td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.evaluator<span class="dp">·</span>=<span class="dp">·</span>hekit.evaluator()</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.cleartext_type<span class="dp">·</span>=<span class="dp">·</span>cleartext_type</td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.cleartext_type<span class="dp">·</span>=<span class="dp">·</span>cleartext_type</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 70, 15 lines modified</td><td colspan="2">Offset 95, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>ray.get(x)<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>ray.ObjectRef)<span class="dp">·</span>else<span class="dp">·</span>x,</td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>ray.get(x)<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>ray.ObjectRef)<span class="dp">·</span>else<span class="dp">·</span>x,</td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item,</td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item,</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>x.tolist()<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.ndarray)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>x.tolist()<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.ndarray)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>int(x)<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.int64)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>data[item]</td><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>data[item]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>setitem(self,<span class="dp">·</span>data,<span class="dp">·</span>key,<span class="dp">·</span>value):</td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>setitem(self,<span class="dp">·</span>data,<span class="dp">·</span>key,<span class="dp">·</span>value):</td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Delegate<span class="dp">·</span>of<span class="dp">·</span>hnp<span class="dp">·</span>ndarray.__setitem___()&quot;&quot;&quot;</td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Delegate<span class="dp">·</span>of<span class="dp">·</span>hnp<span class="dp">·</span>ndarray.__setitem___()&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(key,<span class="dp">·</span>np.ndarray):</td><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(key,<span class="dp">·</span>np.ndarray):</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<span class="dp">·</span>=<span class="dp">·</span>key.tolist()</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<span class="dp">·</span>=<span class="dp">·</span>key.tolist()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 91, 14 lines modified</td><td colspan="2">Offset 118, 127 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;data<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>hnp.ndarray<span class="dp">·</span>type,<span class="dp">·</span>real<span class="dp">·</span>type={type(data)}&quot;</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;data<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>hnp.ndarray<span class="dp">·</span>type,<span class="dp">·</span>real<span class="dp">·</span>type={type(data)}&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data.size<span class="dp">·</span>&gt;<span class="dp">·</span>0</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data.size<span class="dp">·</span>&gt;<span class="dp">·</span>0</td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;You<span class="dp">·</span>cannot<span class="dp">·</span>sum<span class="dp">·</span>an<span class="dp">·</span>empty<span class="dp">·</span>ndarray,<span class="dp">·</span>data.shape={data.rows}x{data.cols}&quot;</td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;You<span class="dp">·</span>cannot<span class="dp">·</span>sum<span class="dp">·</span>an<span class="dp">·</span>empty<span class="dp">·</span>ndarray,<span class="dp">·</span>data.shape={data.rows}x{data.cols}&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.evaluator.sum(data)</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.evaluator.sum(data)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>select_sum(self,<span class="dp">·</span>data,<span class="dp">·</span>item):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;sum<span class="dp">·</span>of<span class="dp">·</span>data<span class="dp">·</span>on<span class="dp">·</span>selected<span class="dp">·</span>elements&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data,<span class="dp">·</span>(hnp.PlaintextArray,<span class="dp">·</span>hnp.CiphertextArray)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;data<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>hnp.ndarray<span class="dp">·</span>type,<span class="dp">·</span>real<span class="dp">·</span>type={type(data)}&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data.size<span class="dp">·</span>&gt;<span class="dp">·</span>0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;You<span class="dp">·</span>cannot<span class="dp">·</span>select<span class="dp">·</span>sum<span class="dp">·</span>an<span class="dp">·</span>empty<span class="dp">·</span>ndarray,<span class="dp">·</span>data.shape={data.rows}x{data.cols}&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>ray.get(x)<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>ray.ObjectRef)<span class="dp">·</span>else<span class="dp">·</span>x,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>x.tolist()<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.ndarray)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.evaluator.select_sum(data,<span class="dp">·</span>item)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>batch_select_sum(self,<span class="dp">·</span>data,<span class="dp">·</span>item):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;sum<span class="dp">·</span>of<span class="dp">·</span>data<span class="dp">·</span>on<span class="dp">·</span>selected<span class="dp">·</span>elements&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data,<span class="dp">·</span>(hnp.PlaintextArray,<span class="dp">·</span>hnp.CiphertextArray)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;data<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>hnp.ndarray<span class="dp">·</span>type,<span class="dp">·</span>real<span class="dp">·</span>type={type(data)}&quot;</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 3937/11862 bytes (33.19%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">3.57 KB</span></div>
    <div id="secretflow-device-device-heu_object.py"><span class="source">secretflow/device/device/heu_object.py</span>
      <a class="anchor" href="#secretflow-device-device-heu_object.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 7, 19 lines modified</td><td colspan="2">Offset 7, 21 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>ray</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.tree_util</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>jax.tree_util</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>ray</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>DeviceObject</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>DeviceObject</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>dispatch</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>dispatch</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">class<span class="dp">·</span>HEUObject(DeviceObject):</td><td class="diffline">19 </td><td class="diffpresent">class<span class="dp">·</span>HEUObject(DeviceObject):</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;HEU<span class="dp">·</span>Object</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;HEU<span class="dp">·</span>Object</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>The<span class="dp">·</span>data<span class="dp">·</span>hold<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>Heu<span class="dp">·</span>object</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>The<span class="dp">·</span>data<span class="dp">·</span>hold<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>Heu<span class="dp">·</span>object</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 115, 7 lines modified</td><td colspan="2">Offset 117, 88 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>dump(self,<span class="dp">·</span>path):</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>dump(self,<span class="dp">·</span>path):</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Dump<span class="dp">·</span>ciphertext<span class="dp">·</span>into<span class="dp">·</span>files.&quot;&quot;&quot;</td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Dump<span class="dp">·</span>ciphertext<span class="dp">·</span>into<span class="dp">·</span>files.&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(self.location).dump.remote(self.data,<span class="dp">·</span>path)</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(self.location).dump.remote(self.data,<span class="dp">·</span>path)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>select_sum(self,<span class="dp">·</span>item):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Sum<span class="dp">·</span>of<span class="dp">·</span>HEUObject<span class="dp">·</span>selected<span class="dp">·</span>elements</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>x.data<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>PYUObject)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(self.location).select_sum.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>batch_select_sum(self,<span class="dp">·</span>item):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Sum<span class="dp">·</span>of<span class="dp">·</span>HEUObject<span class="dp">·</span>selected<span class="dp">·</span>elements</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>item<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>x:<span class="dp">·</span>x.data<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>PYUObject)<span class="dp">·</span>else<span class="dp">·</span>x,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(self.location).batch_select_sum.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>item</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>feature_wise_bucket_sum(self,<span class="dp">·</span>subgroup_map,<span class="dp">·</span>order_map,<span class="dp">·</span>bucket_num,<span class="dp">·</span>cumsum=False):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Sum<span class="dp">·</span>of<span class="dp">·</span>HEUObject<span class="dp">·</span>selected<span class="dp">·</span>elements</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>process_data(x):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>x</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>PYUObject):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>x.data</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>res</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>subgroup_map<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(process_data,<span class="dp">·</span>subgroup_map)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>order_map<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(process_data,<span class="dp">·</span>order_map)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_num<span class="dp">·</span>=<span class="dp">·</span>process_data(bucket_num)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(self.location).feature_wise_bucket_sum.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>subgroup_map,<span class="dp">·</span>order_map,<span class="dp">·</span>bucket_num,<span class="dp">·</span>cumsum</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>batch_feature_wise_bucket_sum(self,<span class="dp">·</span>subgroup_map,<span class="dp">·</span>order_map,<span class="dp">·</span>bucket_num,<span class="dp">·</span>cumsum=False):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Sum<span class="dp">·</span>of<span class="dp">·</span>HEUObject<span class="dp">·</span>selected<span class="dp">·</span>elements</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>process_data(x):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>x</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>PYUObject):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>x.data</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>res</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>subgroup_map<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(process_data,<span class="dp">·</span>subgroup_map)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>order_map<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(process_data,<span class="dp">·</span>order_map)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_num<span class="dp">·</span>=<span class="dp">·</span>process_data(bucket_num)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.get_participant(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>).batch_feature_wise_bucket_sum.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>subgroup_map,<span class="dp">·</span>order_map,<span class="dp">·</span>bucket_num,<span class="dp">·</span>cumsum</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.location,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.is_plain,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">4.3 KB</span></div>
    <div id="secretflow-device-device-pyu.py"><span class="source">secretflow/device/device/pyu.py</span>
      <a class="anchor" href="#secretflow-device-device-pyu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 53 lines modified</td><td colspan="2">Offset 8, 28 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>inspect</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>fed</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>fed</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>jax</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>jax</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>ray</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>ray</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.distributed<span class="dp">·</span>as<span class="dp">·</span>sfd</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.logging<span class="dp">·</span>import<span class="dp">·</span>LOG_FORMAT,<span class="dp">·</span>get_logging_level</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.logging<span class="dp">·</span>import<span class="dp">·</span>LOG_FORMAT,<span class="dp">·</span>get_logging_level</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>._utils<span class="dp">·</span>import<span class="dp">·</span>check_num_returns</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject,<span class="dp">·</span>DeviceType</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject,<span class="dp">·</span>DeviceType</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>_check_num_returns(fn):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>inspect.signature<span class="dp">·</span>fails<span class="dp">·</span>on<span class="dp">·</span>some<span class="dp">·</span>builtin<span class="dp">·</span>method<span class="dp">·</span>(e.g.<span class="dp">·</span>numpy.random.rand).</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>You<span class="dp">·</span>can<span class="dp">·</span>wrap<span class="dp">·</span>a<span class="dp">·</span>self<span class="dp">·</span>define<span class="dp">·</span>function<span class="dp">·</span>which<span class="dp">·</span>calls<span class="dp">·</span>builtin<span class="dp">·</span>function<span class="dp">·</span>inside</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>with<span class="dp">·</span>return<span class="dp">·</span>annotation<span class="dp">·</span>to<span class="dp">·</span>get<span class="dp">·</span>multi<span class="dp">·</span>returns<span class="dp">·</span>for<span class="dp">·</span>now.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>inspect.isbuiltin(fn):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig<span class="dp">·</span>=<span class="dp">·</span>inspect.signature(lambda<span class="dp">·</span>*arg,<span class="dp">·</span>**kwargs:<span class="dp">·</span>fn(*arg,<span class="dp">·</span>**kwargs))</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig<span class="dp">·</span>=<span class="dp">·</span>inspect.signature(fn)</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>sig.return_annotation<span class="dp">·</span>is<span class="dp">·</span>None<span class="dp">·</span>or<span class="dp">·</span>sig.return_annotation<span class="dp">·</span>==<span class="dp">·</span>sig.empty:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns<span class="dp">·</span>=<span class="dp">·</span>1</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hasattr(sig.return_annotation,<span class="dp">·</span>&#x27;_name&#x27;)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>sig.return_annotation._name<span class="dp">·</span>==<span class="dp">·</span>&#x27;Tuple&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns<span class="dp">·</span>=<span class="dp">·</span>len(sig.return_annotation.__args__)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(sig.return_annotation,<span class="dp">·</span>tuple):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns<span class="dp">·</span>=<span class="dp">·</span>len(sig.return_annotation)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_returns<span class="dp">·</span>=<span class="dp">·</span>1</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>num_returns</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent">class<span class="dp">·</span>PYUObject(DeviceObject):</td><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>PYUObject(DeviceObject):</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>device<span class="dp">·</span>object.</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>device<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Reference<span class="dp">·</span>to<span class="dp">·</span>underlying<span class="dp">·</span>data.</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Reference<span class="dp">·</span>to<span class="dp">·</span>underlying<span class="dp">·</span>data.</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 65, 28 lines modified</td><td colspan="2">Offset 40, 26 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent">class<span class="dp">·</span>PYU(Device):</td><td class="diffline">40 </td><td class="diffpresent">class<span class="dp">·</span>PYU(Device):</td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>device<span class="dp">·</span>doing<span class="dp">·</span>computation<span class="dp">·</span>in<span class="dp">·</span>single<span class="dp">·</span>domain.</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>device<span class="dp">·</span>doing<span class="dp">·</span>computation<span class="dp">·</span>in<span class="dp">·</span>single<span class="dp">·</span>domain.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Essentially<span class="dp">·</span>PYU<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>python<span class="dp">·</span>worker<span class="dp">·</span>who<span class="dp">·</span>can<span class="dp">·</span>execute<span class="dp">·</span>any<span class="dp">·</span>python<span class="dp">·</span>code.</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Essentially<span class="dp">·</span>PYU<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>python<span class="dp">·</span>worker<span class="dp">·</span>who<span class="dp">·</span>can<span class="dp">·</span>execute<span class="dp">·</span>any<span class="dp">·</span>python<span class="dp">·</span>code.</td></tr>
<tr class="diffunmodified"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>party:<span class="dp">·</span>str<del>,<span class="dp">·</span>node:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&quot;&quot;</del>):</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>party:<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>contructor.</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;PYU<span class="dp">·</span>contructor.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party<span class="dp">·</span>(str):<span class="dp">·</span>Party<span class="dp">·</span>name<span class="dp">·</span>where<span class="dp">·</span>this<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>located.</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party<span class="dp">·</span>(str):<span class="dp">·</span>Party<span class="dp">·</span>name<span class="dp">·</span>where<span class="dp">·</span>this<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>located.</td></tr>
<tr class="diffdeleted"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>node<span class="dp">·</span>(str,<span class="dp">·</span>optional):<span class="dp">·</span>Node<span class="dp">·</span>name<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>located.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>&quot;&quot;.</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(DeviceType.PYU)</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(DeviceType.PYU)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td></tr>
<tr class="diffdeleted"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.node<span class="dp">·</span>=<span class="dp">·</span>node</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__str__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>str:</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__str__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>str:</td></tr>
<tr class="diffchanged"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>f&#x27;{self.party}<del>_{self.node}</del>&#x27;</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>f&#x27;{self.party}&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__repr__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>str:</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__repr__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>str:</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>str(self)</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>str(self)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__eq__(self,<span class="dp">·</span>other):</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__eq__(self,<span class="dp">·</span>other):</td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>type(other)<span class="dp">·</span>==<span class="dp">·</span>type(self)<span class="dp">·</span>and<span class="dp">·</span>str(other)<span class="dp">·</span>==<span class="dp">·</span>str(self)</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>type(other)<span class="dp">·</span>==<span class="dp">·</span>type(self)<span class="dp">·</span>and<span class="dp">·</span>str(other)<span class="dp">·</span>==<span class="dp">·</span>str(self)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 116, 17 lines modified</td><td colspan="2">Offset 89, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>arg.data</td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>arg.data</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>arg</td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>arg</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args_,<span class="dp">·</span>kwargs_<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args_,<span class="dp">·</span>kwargs_<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_map(</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>arg:<span class="dp">·</span>try_get_data(arg,<span class="dp">·</span>self),<span class="dp">·</span>(args,<span class="dp">·</span>kwargs)</td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>arg:<span class="dp">·</span>try_get_data(arg,<span class="dp">·</span>self),<span class="dp">·</span>(args,<span class="dp">·</span>kwargs)</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_num_returns<span class="dp">·</span>=<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><del><span class="dp">·</span>_</del>check_num_returns(fn)<span class="dp">·</span>if<span class="dp">·</span>num_returns<span class="dp">·</span>is<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>num_returns</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>_num_retur</ins><ins>ns</ins><span class="dp">·</span><ins>=<span class="dp">·</span></ins>check_num_returns(fn)<span class="dp">·</span>if<span class="dp">·</span>num_returns<span class="dp">·</span>is<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>num_returns</td></tr>
<tr class="diffdeleted"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>(</td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sfd.remote(self._run)</td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sfd.remote(self._run)</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.party(self.party)</td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.party(self.party)</td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.options(num_returns=_num_returns)</td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.options(num_returns=_num_returns)</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.remote(fn,<span class="dp">·</span>*args_,<span class="dp">·</span>**kwargs_)</td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.remote(fn,<span class="dp">·</span>*args_,<span class="dp">·</span>**kwargs_)</td></tr>
<tr class="diffunmodified"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.debug(</td><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.debug(</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 138, 14 lines modified</td><td colspan="2">Offset 109, 34 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>_num_returns<span class="dp">·</span>==<span class="dp">·</span>1:</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>_num_returns<span class="dp">·</span>==<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(self,<span class="dp">·</span>data)</td><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(self,<span class="dp">·</span>data)</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>[PYUObject(self,<span class="dp">·</span>datum)<span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data]</td><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>[PYUObject(self,<span class="dp">·</span>datum)<span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>wrapper</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>wrapper</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>dump(self,<span class="dp">·</span>obj:<span class="dp">·</span>PYUObject,<span class="dp">·</span>path:<span class="dp">·</span>str):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>obj.device<span class="dp">·</span>==<span class="dp">·</span>self,<span class="dp">·</span>&quot;obj<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>owned<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>device.&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>fn(data,<span class="dp">·</span>path):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>cloudpickle<span class="dp">·</span>as<span class="dp">·</span>pickle</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(path,<span class="dp">·</span>&#x27;wb&#x27;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pickle.dump(data,<span class="dp">·</span>f)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.__call__(fn)(obj,<span class="dp">·</span>path)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>load(self,<span class="dp">·</span>path:<span class="dp">·</span>str):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>fn(path):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>cloudpickle<span class="dp">·</span>as<span class="dp">·</span>pickle</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(path,<span class="dp">·</span>&#x27;rb&#x27;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>pickle.load(f)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 339/4342 bytes (7.81%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.29 KB</span></div>
    <div id="secretflow-device-device-register.py"><span class="source">secretflow/device/device/register.py</span>
      <a class="anchor" href="#secretflow-device-device-register.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 14, 28 lines modified</td><td colspan="2">Offset 14, 28 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>IntEnum</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>IntEnum</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>NOTE:<span class="dp">·</span>Device<span class="dp">·</span>Conversion<span class="dp">·</span>Table</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>NOTE:<span class="dp">·</span>Device<span class="dp">·</span>Conversion<span class="dp">·</span>Table</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">#<span class="dp">·</span>+-------------------+---------------+---------+-------------+</td><td class="diffline">17 </td><td class="diffpresent">#<span class="dp">·</span>+-------------------+---------------+---------+-------------+</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span>TEE<del><span class="dp">·</span></del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">18 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span>TEE<ins>U</ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td><td class="diffline">19 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>PYU<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>share<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>encrypt<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypt<span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">20 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>PYU<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>share<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>encrypt<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypt<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td><td class="diffline">21 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>SPU<span class="dp">·</span>|<span class="dp">·</span>reconstruct<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>encrypt+add<span class="dp">·</span>|</td><td class="diffline">22 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>SPU<span class="dp">·</span>|<span class="dp">·</span>reconstruct<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>encrypt+add<span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td><td class="diffline">23 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>TEE<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>TEE<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td><td class="diffline">25 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>HEU<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>minus+decrypt<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">26 </td><td class="diffpresent">#<span class="dp">·</span>|<span class="dp">·</span>HEU<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span>minus+decrypt<span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td><td class="diffline">27 </td><td class="diffpresent">#<span class="dp">·</span>+-----+-------------+---------------+---------+-------------+</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">class<span class="dp">·</span>DeviceType(IntEnum):</td><td class="diffline">28 </td><td class="diffpresent">class<span class="dp">·</span>DeviceType(IntEnum):</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span>=<span class="dp">·</span>0<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Python<span class="dp">·</span>Unit</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span>=<span class="dp">·</span>0<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Python<span class="dp">·</span>Unit</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU<span class="dp">·</span>=<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Privacy<span class="dp">·</span>Preserving<span class="dp">·</span>Processing<span class="dp">·</span>Unit</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU<span class="dp">·</span>=<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Privacy<span class="dp">·</span>Preserving<span class="dp">·</span>Processing<span class="dp">·</span>Unit</td></tr>
<tr class="diffchanged"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEE<span class="dp">·</span>=<span class="dp">·</span>2<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Trusted<span class="dp">·</span>Execution<span class="dp">·</span>Environment</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEE<ins>U</ins><span class="dp">·</span>=<span class="dp">·</span>2<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Trusted<span class="dp">·</span>Execution<span class="dp">·</span>Environm<ins>ent<span class="dp">·</span>Proc</ins>e<ins>ssing<span class="dp">·</span>U</ins>n<ins>i</ins>t</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU<span class="dp">·</span>=<span class="dp">·</span>3<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Homomorphic<span class="dp">·</span>Encryption<span class="dp">·</span>Unit</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU<span class="dp">·</span>=<span class="dp">·</span>3<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Homomorphic<span class="dp">·</span>Encryption<span class="dp">·</span>Unit</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NUM<span class="dp">·</span>=<span class="dp">·</span>4<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Number<span class="dp">·</span>of<span class="dp">·</span>device<span class="dp">·</span>type</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NUM<span class="dp">·</span>=<span class="dp">·</span>4<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Number<span class="dp">·</span>of<span class="dp">·</span>device<span class="dp">·</span>type</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">class<span class="dp">·</span>Registrar:</td><td class="diffline">34 </td><td class="diffpresent">class<span class="dp">·</span>Registrar:</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>kernel<span class="dp">·</span>registry&quot;&quot;&quot;</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Device<span class="dp">·</span>kernel<span class="dp">·</span>registry&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">35.7 KB</span></div>
    <div id="secretflow-device-device-spu.py"><span class="source">secretflow/device/device/spu.py</span>
      <a class="anchor" href="#secretflow-device-device-spu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 47, 25 lines modified</td><td colspan="2">Offset 47, 37 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject,<span class="dp">·</span>DeviceType</td><td class="diffline">47 </td><td class="diffpresent">from<span class="dp">·</span>.base<span class="dp">·</span>import<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject,<span class="dp">·</span>DeviceType</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">from<span class="dp">·</span>.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td><td class="diffline">48 </td><td class="diffpresent">from<span class="dp">·</span>.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>dispatch</td><td class="diffline">49 </td><td class="diffpresent">from<span class="dp">·</span>.register<span class="dp">·</span>import<span class="dp">·</span>dispatch</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent">from<span class="dp">·</span>.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_datatype_to_heu,<span class="dp">·</span>spu_fxp_size</td><td class="diffline">50 </td><td class="diffpresent">from<span class="dp">·</span>.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_datatype_to_heu,<span class="dp">·</span>spu_fxp_size</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent">_LINK_DESC_NAMES<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">51 </td><td class="diffpresent">_LINK_DESC_NAMES<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;connect_retry_times&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;connect_retry_interval_ms&#x27;,</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;connect_retry_interval_ms&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;recv_timeout_ms&#x27;,</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;recv_timeout_ms&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;http_max_payload_size&#x27;,</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;http_max_payload_size&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;http_timeout_ms&#x27;,</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;http_timeout_ms&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;throttle_window_size&#x27;,</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;throttle_window_size&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;brpc_channel_protocol&#x27;,</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;brpc_channel_protocol&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;brpc_channel_connection_type&#x27;,</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;brpc_channel_connection_type&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent">]</td><td class="diffline">60 </td><td class="diffpresent">]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent">def<span class="dp">·</span>_fill_link_ssl_opts(tls_opts:<span class="dp">·</span>Dict,<span class="dp">·</span>link_ssl_opts:<span class="dp">·</span>spu_link.SSLOptions):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name,<span class="dp">·</span>value<span class="dp">·</span>in<span class="dp">·</span>tls_opts.items():</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>isinstance(name,<span class="dp">·</span>str)<span class="dp">·</span>and<span class="dp">·</span>name</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;tls<span class="dp">·</span>options<span class="dp">·</span>name<span class="dp">·</span>shall<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>valid<span class="dp">·</span>string<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(name)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(link_ssl_opts.cert,<span class="dp">·</span>name):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setattr(link_ssl_opts.cert,<span class="dp">·</span>name,<span class="dp">·</span>value)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(link_ssl_opts.verify,<span class="dp">·</span>name):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setattr(link_ssl_opts.verify,<span class="dp">·</span>name,<span class="dp">·</span>value)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">60 </td><td class="diffpresent">def<span class="dp">·</span>_fill_link_desc_attrs(link_desc:<span class="dp">·</span>Dict,<span class="dp">·</span>desc:<span class="dp">·</span>spu_link.Desc):</td><td class="diffline">70 </td><td class="diffpresent">def<span class="dp">·</span>_fill_link_desc_attrs(link_desc:<span class="dp">·</span>Dict,<span class="dp">·</span><ins>tls_opts:<span class="dp">·</span>Dict,<span class="dp">·</span></ins>desc:<span class="dp">·</span>spu_link.Desc):</td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>link_desc:</td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>link_desc:</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name,<span class="dp">·</span>value<span class="dp">·</span>in<span class="dp">·</span>link_desc.items():</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name,<span class="dp">·</span>value<span class="dp">·</span>in<span class="dp">·</span>link_desc.items():</td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>isinstance(name,<span class="dp">·</span>str)<span class="dp">·</span>and<span class="dp">·</span>name</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>isinstance(name,<span class="dp">·</span>str)<span class="dp">·</span>and<span class="dp">·</span>name</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;Link<span class="dp">·</span>desc<span class="dp">·</span>param<span class="dp">·</span>name<span class="dp">·</span>shall<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>valid<span class="dp">·</span>string<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(name)}.&#x27;</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;Link<span class="dp">·</span>desc<span class="dp">·</span>param<span class="dp">·</span>name<span class="dp">·</span>shall<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>valid<span class="dp">·</span>string<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(name)}.&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>name<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>_LINK_DESC_NAMES:</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>name<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>_LINK_DESC_NAMES:</td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>InvalidArgumentError(</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>InvalidArgumentError(</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 77, 14 lines modified</td><td colspan="2">Offset 89, 21 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>link_desc<span class="dp">·</span>or<span class="dp">·</span>&#x27;recv_timeout_ms&#x27;<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>link_desc.keys():</td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>link_desc<span class="dp">·</span>or<span class="dp">·</span>&#x27;recv_timeout_ms&#x27;<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>link_desc.keys():</td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>default<span class="dp">·</span>timeout<span class="dp">·</span>120s</td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>default<span class="dp">·</span>timeout<span class="dp">·</span>120s</td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>desc.recv_timeout_ms<span class="dp">·</span>=<span class="dp">·</span>120<span class="dp">·</span>*<span class="dp">·</span>1000</td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>desc.recv_timeout_ms<span class="dp">·</span>=<span class="dp">·</span>120<span class="dp">·</span>*<span class="dp">·</span>1000</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>link_desc<span class="dp">·</span>or<span class="dp">·</span>&#x27;http_timeout_ms&#x27;<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>link_desc.keys():</td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>link_desc<span class="dp">·</span>or<span class="dp">·</span>&#x27;http_timeout_ms&#x27;<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>link_desc.keys():</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>default<span class="dp">·</span>timeout<span class="dp">·</span>120s</td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>default<span class="dp">·</span>timeout<span class="dp">·</span>120s</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>desc.http_timeout_ms<span class="dp">·</span>=<span class="dp">·</span>120<span class="dp">·</span>*<span class="dp">·</span>1000</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>desc.http_timeout_ms<span class="dp">·</span>=<span class="dp">·</span>120<span class="dp">·</span>*<span class="dp">·</span>1000</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>tls_opts:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>server_opts<span class="dp">·</span>=<span class="dp">·</span>tls_opts.get(&#x27;server_ssl_opts&#x27;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>client_opts<span class="dp">·</span>=<span class="dp">·</span>tls_opts.get(&#x27;client_ssl_opts&#x27;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_fill_link_ssl_opts(server_opts,<span class="dp">·</span>desc.server_ssl_opts)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_fill_link_ssl_opts(client_opts,<span class="dp">·</span>desc.client_ssl_opts)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>desc.enable_ssl<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent">def<span class="dp">·</span>_plaintext_to_numpy(data:<span class="dp">·</span>Any)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td><td class="diffline">101 </td><td class="diffpresent">def<span class="dp">·</span>_plaintext_to_numpy(data:<span class="dp">·</span>Any)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;try<span class="dp">·</span>to<span class="dp">·</span>convert<span class="dp">·</span>anything<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>jax-friendly<span class="dp">·</span>numpy<span class="dp">·</span>array.</td><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;try<span class="dp">·</span>to<span class="dp">·</span>convert<span class="dp">·</span>anything<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>jax-friendly<span class="dp">·</span>numpy<span class="dp">·</span>array.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>data</td><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>data</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 94, 15 lines modified</td><td colspan="2">Offset 113, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>NOTE(junfeng):<span class="dp">·</span>jnp.asarray<span class="dp">·</span>would<span class="dp">·</span>transfer<span class="dp">·</span>int64s<span class="dp">·</span>to<span class="dp">·</span>int32s.</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>NOTE(junfeng):<span class="dp">·</span>jnp.asarray<span class="dp">·</span>would<span class="dp">·</span>transfer<span class="dp">·</span>int64s<span class="dp">·</span>to<span class="dp">·</span>int32s.</td></tr>
<tr class="diffunmodified"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>np.asarray(jnp.asarray(data))</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>np.asarray(jnp.asarray(data))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">96 </td><td class="diffpresent">@dataclass</td><td class="diffline">115 </td><td class="diffpresent">@dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">97 </td><td class="diffpresent">class<span class="dp">·</span>SPUValueMeta:</td><td class="diffline">116 </td><td class="diffpresent">class<span class="dp">·</span>SPUValueMeta:</td></tr>
<tr class="diffchanged"><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;The<span class="dp">·</span>metadata<span class="dp">·</span>of<span class="dp">·</span>a<span class="dp">·</span>SPU<span class="dp">·</span>value,<span class="dp">·</span>which<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>Numpy<span class="dp">·</span>array<span class="dp">·</span>or<span class="dp">·</span>equivalent.&quot;&quot;&quot;</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;The<span class="dp">·</span>metadata<span class="dp">·</span>of<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>value,<span class="dp">·</span>which<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>Numpy<span class="dp">·</span>array<span class="dp">·</span>or<span class="dp">·</span>equivalent.&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shape:<span class="dp">·</span>Sequence[int]</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shape:<span class="dp">·</span>Sequence[int]</td></tr>
<tr class="diffunmodified"><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dtype:<span class="dp">·</span>np.dtype</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dtype:<span class="dp">·</span>np.dtype</td></tr>
<tr class="diffunmodified"><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vtype:<span class="dp">·</span>spu.Visibility</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vtype:<span class="dp">·</span>spu.Visibility</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>the<span class="dp">·</span>following<span class="dp">·</span>meta<span class="dp">·</span>ensures<span class="dp">·</span>SPU<span class="dp">·</span>object<span class="dp">·</span>could<span class="dp">·</span>be<span class="dp">·</span>consumed<span class="dp">·</span>by<span class="dp">·</span>SPU<span class="dp">·</span>device.</td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>the<span class="dp">·</span>following<span class="dp">·</span>meta<span class="dp">·</span>ensures<span class="dp">·</span>SPU<span class="dp">·</span>object<span class="dp">·</span>could<span class="dp">·</span>be<span class="dp">·</span>consumed<span class="dp">·</span>by<span class="dp">·</span>SPU<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>protocol:<span class="dp">·</span>spu_pb2.ProtocolKind</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>protocol:<span class="dp">·</span>spu_pb2.ProtocolKind</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 114, 15 lines modified</td><td colspan="2">Offset 133, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device:<span class="dp">·</span>Device,</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device:<span class="dp">·</span>Device,</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta:<span class="dp">·</span>Union[ray.ObjectRef,<span class="dp">·</span>fed.FedObject],</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta:<span class="dp">·</span>Union[ray.ObjectRef,<span class="dp">·</span>fed.FedObject],</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares_name:<span class="dp">·</span>Sequence[Union[ray.ObjectRef,<span class="dp">·</span>fed.FedObject]],</td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares_name:<span class="dp">·</span>Sequence[Union[ray.ObjectRef,<span class="dp">·</span>fed.FedObject]],</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;SPUObject<span class="dp">·</span>refers<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>Python<span class="dp">·</span>Object<span class="dp">·</span>which<span class="dp">·</span>could<span class="dp">·</span>be<span class="dp">·</span>flattened<span class="dp">·</span>to<span class="dp">·</span>a</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;SPUObject<span class="dp">·</span>refers<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>Python<span class="dp">·</span>Object<span class="dp">·</span>which<span class="dp">·</span>could<span class="dp">·</span>be<span class="dp">·</span>flattened<span class="dp">·</span>to<span class="dp">·</span>a</td></tr>
<tr class="diffchanged"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>SPU<span class="dp">·</span>Values.<span class="dp">·</span>A<span class="dp">·</span>SPU<span class="dp">·</span>value<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>Numpy<span class="dp">·</span>array<span class="dp">·</span>or<span class="dp">·</span>equivalent.</td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>SPU<span class="dp">·</span>Values.<span class="dp">·</span>A<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>value<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>Numpy<span class="dp">·</span>array<span class="dp">·</span>or<span class="dp">·</span>equivalent.</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>e.g.</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>e.g.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1.<span class="dp">·</span>If<span class="dp">·</span>referred<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>is<span class="dp">·</span>[1,2,3]</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1.<span class="dp">·</span>If<span class="dp">·</span>referred<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>is<span class="dp">·</span>[1,2,3]</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Then<span class="dp">·</span>meta<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>referred<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>SPUValueMeta,<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>is</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Then<span class="dp">·</span>meta<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>referred<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>SPUValueMeta,<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>is</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>a<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>referrence<span class="dp">·</span>to<span class="dp">·</span>pieces<span class="dp">·</span>of<span class="dp">·</span>share<span class="dp">·</span>of<span class="dp">·</span>[1,2,3].</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>a<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>referrence<span class="dp">·</span>to<span class="dp">·</span>pieces<span class="dp">·</span>of<span class="dp">·</span>share<span class="dp">·</span>of<span class="dp">·</span>[1,2,3].</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2.<span class="dp">·</span>If<span class="dp">·</span>referred<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>is<span class="dp">·</span>{&#x27;a&#x27;:<span class="dp">·</span>1,<span class="dp">·</span>&#x27;b&#x27;:<span class="dp">·</span>[3,<span class="dp">·</span>np.array(...)]}</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2.<span class="dp">·</span>If<span class="dp">·</span>referred<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>is<span class="dp">·</span>{&#x27;a&#x27;:<span class="dp">·</span>1,<span class="dp">·</span>&#x27;b&#x27;:<span class="dp">·</span>[3,<span class="dp">·</span>np.array(...)]}</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 132, 16 lines modified</td><td colspan="2">Offset 151, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{&#x27;a&#x27;:<span class="dp">·</span>share1,<span class="dp">·</span>&#x27;b&#x27;:<span class="dp">·</span>[share2,<span class="dp">·</span>share3]}</td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{&#x27;a&#x27;:<span class="dp">·</span>share1,<span class="dp">·</span>&#x27;b&#x27;:<span class="dp">·</span>[share2,<span class="dp">·</span>share3]}</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3.<span class="dp">·</span>shares<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>ObjectRef<span class="dp">·</span>to<span class="dp">·</span>share<span class="dp">·</span>slices<span class="dp">·</span>while<span class="dp">·</span>these<span class="dp">·</span>share</td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3.<span class="dp">·</span>shares<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>ObjectRef<span class="dp">·</span>to<span class="dp">·</span>share<span class="dp">·</span>slices<span class="dp">·</span>while<span class="dp">·</span>these<span class="dp">·</span>share</td></tr>
<tr class="diffunmodified"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>slices<span class="dp">·</span>are<span class="dp">·</span>not<span class="dp">·</span>necessarily<span class="dp">·</span>located<span class="dp">·</span>at<span class="dp">·</span>SPU<span class="dp">·</span>device.<span class="dp">·</span>The<span class="dp">·</span>data<span class="dp">·</span>transfer</td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>slices<span class="dp">·</span>are<span class="dp">·</span>not<span class="dp">·</span>necessarily<span class="dp">·</span>located<span class="dp">·</span>at<span class="dp">·</span>SPU<span class="dp">·</span>device.<span class="dp">·</span>The<span class="dp">·</span>data<span class="dp">·</span>transfer</td></tr>
<tr class="diffunmodified"><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>would<span class="dp">·</span>only<span class="dp">·</span>happen<span class="dp">·</span>when<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>consumes<span class="dp">·</span>SPU<span class="dp">·</span>objects.</td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>would<span class="dp">·</span>only<span class="dp">·</span>happen<span class="dp">·</span>when<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>consumes<span class="dp">·</span>SPU<span class="dp">·</span>objects.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffdeleted"><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta:<span class="dp">·</span>Ref<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>metadata.</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>r</del>e<del>f</del><del>s<span class="dp">·</span>(Seque</del>n<del>ce</del>[ray.ObjectRef<del>])</del>:<span class="dp">·</span>Ref<del>s</del><span class="dp">·</span>to<span class="dp">·</span><del>s</del>h<del>ar</del>e<del>s<span class="dp">·</span>of<span class="dp">·</span></del>data.</td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>m</ins>e<ins>ta:<span class="dp">·</span>Unio</ins>n[ray.ObjectRe<ins>f,<span class="dp">·</span></ins>f<ins>ed.FedObjec</ins><ins>t]</ins>:<span class="dp">·</span>Ref<span class="dp">·</span>to<span class="dp">·</span><ins>t</ins>he<ins><span class="dp">·</span>meta</ins>data.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares_name:<span class="dp">·</span>Sequence[Union[ray.ObjectRef,<span class="dp">·</span>fed.FedObject]]:<span class="dp">·</span>names<span class="dp">·</span>of<span class="dp">·</span>shares<span class="dp">·</span>of<span class="dp">·</span>data<span class="dp">·</span>in<span class="dp">·</span>each<span class="dp">·</span>SPU<span class="dp">·</span>node.</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(device)</td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(device)</td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.meta<span class="dp">·</span>=<span class="dp">·</span>meta</td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.meta<span class="dp">·</span>=<span class="dp">·</span>meta</td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.shares_name<span class="dp">·</span>=<span class="dp">·</span>shares_name</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.shares_name<span class="dp">·</span>=<span class="dp">·</span>shares_name</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__del__(self):</td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__del__(self):</td></tr>
<tr class="diffunmodified"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(self,<span class="dp">·</span>&quot;shares_name&quot;):</td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(self,<span class="dp">·</span>&quot;shares_name&quot;):</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 165, 22 lines modified</td><td colspan="2">Offset 184, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>world_size<span class="dp">·</span>(int):<span class="dp">·</span>world_size<span class="dp">·</span>of<span class="dp">·</span>SPU<span class="dp">·</span>device.</td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>world_size<span class="dp">·</span>(int):<span class="dp">·</span>world_size<span class="dp">·</span>of<span class="dp">·</span>SPU<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.runtime_config<span class="dp">·</span>=<span class="dp">·</span>runtime_config</td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.runtime_config<span class="dp">·</span>=<span class="dp">·</span>runtime_config</td></tr>
<tr class="diffunmodified"><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.world_size<span class="dp">·</span>=<span class="dp">·</span>world_size</td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.world_size<span class="dp">·</span>=<span class="dp">·</span>world_size</td></tr>
<tr class="diffunmodified"><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.io<span class="dp">·</span>=<span class="dp">·</span>spu.Io(self.world_size,<span class="dp">·</span>self.runtime_config)</td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.io<span class="dp">·</span>=<span class="dp">·</span>spu.Io(self.world_size,<span class="dp">·</span>self.runtime_config)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>make_shares(self,<span class="dp">·</span>data:<span class="dp">·</span>Any,<span class="dp">·</span>vtype:<span class="dp">·</span>spu.Visibility)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[Any,<span class="dp">·</span>List[Any]]:</td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>make_shares(self,<span class="dp">·</span>data:<span class="dp">·</span>Any,<span class="dp">·</span>vtype:<span class="dp">·</span>spu.Visibility)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[Any,<span class="dp">·</span>List[Any]]:</td></tr>
<tr class="diffchanged"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Convert<span class="dp">·</span>a<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>to<span class="dp">·</span>meta<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>of<span class="dp">·</span>a<span class="dp">·</span>SPUObject.</td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Convert<span class="dp">·</span>a<span class="dp">·</span>Python<span class="dp">·</span>object<span class="dp">·</span>to<span class="dp">·</span>meta<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>of<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPUObject.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>Any<span class="dp">·</span>Python<span class="dp">·</span>object.</td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>(Any):<span class="dp">·</span>Any<span class="dp">·</span>Python<span class="dp">·</span>object.</td></tr>
<tr class="diffunmodified"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vtype<span class="dp">·</span>(Visibility):<span class="dp">·</span>Visibility</td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vtype<span class="dp">·</span>(Visibility):<span class="dp">·</span>Visibility</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffchanged"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Tuple[Any,<span class="dp">·</span>List[Any]]:<span class="dp">·</span>meta<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>of<span class="dp">·</span>a<span class="dp">·</span>SPUObject</td><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Tuple[Any,<span class="dp">·</span>List[Any]]:<span class="dp">·</span>meta<span class="dp">·</span>and<span class="dp">·</span>shares<span class="dp">·</span>of<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>flatten_value,<span class="dp">·</span>tree<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_flatten(data)</td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>flatten_value,<span class="dp">·</span>tree<span class="dp">·</span>=<span class="dp">·</span>jax.tree_util.tree_flatten(data)</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 31525/36538 bytes (86.28%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">499 B</span></div>
    <div id="secretflow-device-kernels-__init__.py"><span class="source">secretflow/device/kernels/__init__.py</span>
      <a class="anchor" href="#secretflow-device-kernels-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 9 lines modified</td><td colspan="2">Offset 8, 9 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span>heu,<span class="dp">·</span><del>sp</del>u,<span class="dp">·</span><del>py</del>u</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span>heu,<span class="dp">·</span><ins>py</ins>u,<span class="dp">·</span><ins>sp</ins>u</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.spu<span class="dp">·</span>import<span class="dp">·</span>psi_df</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.spu<span class="dp">·</span>import<span class="dp">·</span>psi_df</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">5.15 KB</span></div>
    <div id="secretflow-device-kernels-heu.py"><span class="source">secretflow/device/kernels/heu.py</span>
      <a class="anchor" href="#secretflow-device-kernels-heu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 11, 37 lines modified</td><td colspan="2">Offset 11, 73 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>spu<span class="dp">·</span>import<span class="dp">·</span>spu_pb2</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>spu<span class="dp">·</span>import<span class="dp">·</span>spu_pb2</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>(HEU,<span class="dp">·</span>PYU,<span class="dp">·</span>SPU,<span class="dp">·</span>Device,<span class="dp">·</span>DeviceObject,<span class="dp">·</span>DeviceType,</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent"><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><del>HEUOb</del><del>j</del>ec<del>t,<span class="dp">·</span>PYUOb</del><del>j</del>e<del>c</del>t<del>,<span class="dp">·</span>SPUObje</del>c<del>t</del><del>,</del><span class="dp">·</span><del>regis</del>t<del>e</del><del>r)</del></td><td class="diffline">16 </td><td class="diffpresent"><ins>from</ins><span class="dp">·</span><ins>s</ins>ec<ins>r</ins>et<ins>flow.devi</ins>c<ins>e</ins><span class="dp">·</span><ins>impor</ins>t<ins><span class="dp">·</span>(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceType,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>register,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.base<span class="dp">·</span>import<span class="dp">·</span>register_to</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<del>b</del><del>ase</del><span class="dp">·</span>import<span class="dp">·</span>MoveConfig</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<ins>heu</ins><span class="dp">·</span>import<span class="dp">·</span><ins>HEU</ins>MoveConfig</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent">@register_to(DeviceType.HEU,<span class="dp">·</span>DeviceType.HEU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_heu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>heu:<span class="dp">·</span>HEU,<span class="dp">·</span>config:<span class="dp">·</span>HEUMoveConfig<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(heu,<span class="dp">·</span>HEU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>HEU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(heu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config<span class="dp">·</span>=<span class="dp">·</span>HEUMoveConfig()</td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">@register(DeviceType.HEU)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">def<span class="dp">·</span>to(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>device:<span class="dp">·</span>Device,<span class="dp">·</span>config):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(device,<span class="dp">·</span>Device)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>HEU):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.device<span class="dp">·</span>is<span class="dp">·</span>device:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_same_heu(self,<span class="dp">·</span>config)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_other_heu(self,<span class="dp">·</span>device,<span class="dp">·</span>config)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>PYU):<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>pure<span class="dp">·</span>local<span class="dp">·</span>operation</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_pyu(self,<span class="dp">·</span>device,<span class="dp">·</span>config)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_spu(self,<span class="dp">·</span>device)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>ra</del>i<del>s</del><del>e</del><span class="dp">·</span><del>Val</del><del>u</del>e<del>Error</del><del>(</del>f<del>&#x27;Unexpected</del><del><span class="dp">·</span></del>device<span class="dp">·</span><del>typ</del><del>e:</del><span class="dp">·</span><del>{type(devi</del><del>c</del>e<del>)}</del><del>&#x27;)</del></td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<ins>f</ins><span class="dp">·</span><ins>s</ins>e<ins>l</ins>f<ins>.</ins>device<span class="dp">·</span><ins>is</ins><span class="dp">·</span><ins>h</ins>e<ins>u:</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_same_heu(self,<span class="dp">·</span>config)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>heu_to_other_heu(self,<span class="dp">·</span>heu,<span class="dp">·</span>config)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent">@register_to(DeviceType.HEU,<span class="dp">·</span>DeviceType.PYU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_pyu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>pyu:<span class="dp">·</span>PYU,<span class="dp">·</span>config:<span class="dp">·</span>HEUMoveConfig<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(pyu,<span class="dp">·</span>PYU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>a<span class="dp">·</span>PYU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(pyu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config<span class="dp">·</span>=<span class="dp">·</span>HEUMoveConfig()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>heu<span class="dp">·</span>-&gt;<span class="dp">·</span>heu(sk_keeper)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.location<span class="dp">·</span>!=<span class="dp">·</span>pyu.party:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>=<span class="dp">·</span>pyu.party</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self<span class="dp">·</span>=<span class="dp">·</span>self.to(self.device,<span class="dp">·</span>config)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>below<span class="dp">·</span>is<span class="dp">·</span>pure<span class="dp">·</span>local<span class="dp">·</span>operation</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.is_plain:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cleartext<span class="dp">·</span>=<span class="dp">·</span>self.device.get_participant(self.location).decode.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_encoder</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(pyu,<span class="dp">·</span>cleartext)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pyu.party<span class="dp">·</span>==<span class="dp">·</span>self.device.sk_keeper_name()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;Can<span class="dp">·</span>not<span class="dp">·</span>convert<span class="dp">·</span>to<span class="dp">·</span>PYU<span class="dp">·</span>device<span class="dp">·</span>{pyu.party}<span class="dp">·</span>without<span class="dp">·</span>secret<span class="dp">·</span>key&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>HEU<span class="dp">·</span>-&gt;<span class="dp">·</span>PYU:<span class="dp">·</span>Decrypt</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cleartext<span class="dp">·</span>=<span class="dp">·</span>self.device.sk_keeper.decrypt_and_decode.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_encoder</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(pyu,<span class="dp">·</span>cleartext)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent">@register_to(DeviceType.HEU,<span class="dp">·</span>DeviceType.SPU)</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_spu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>spu:<span class="dp">·</span>SPU):</td><td class="diffline">62 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_spu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>spu:<span class="dp">·</span>SPU):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(spu,<span class="dp">·</span>SPU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>SPU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(spu)}.&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu<span class="dp">·</span>=<span class="dp">·</span>self.device</td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu<span class="dp">·</span>=<span class="dp">·</span>self.device</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu.sk_keeper_name()<span class="dp">·</span>in<span class="dp">·</span>spu.actors.keys()</td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu.sk_keeper_name()<span class="dp">·</span>in<span class="dp">·</span>spu.actors.keys()</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;SPU<span class="dp">·</span>not<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>{heu.sk_keeper_name()}&#x27;</td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;SPU<span class="dp">·</span>not<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>{heu.sk_keeper_name()}&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_parties<span class="dp">·</span>=<span class="dp">·</span>list(heu.evaluator_names())<span class="dp">·</span>+<span class="dp">·</span>[heu.sk_keeper_name()]</td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_parties<span class="dp">·</span>=<span class="dp">·</span>list(heu.evaluator_names())<span class="dp">·</span>+<span class="dp">·</span>[heu.sk_keeper_name()]</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 90, 15 lines modified</td><td colspan="2">Offset 126, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>refs.insert(spu_actor_idx_for_keeper,<span class="dp">·</span>sk_keeper_data)</td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>refs.insert(spu_actor_idx_for_keeper,<span class="dp">·</span>sk_keeper_data)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>SPUObject(spu,<span class="dp">·</span>meta,<span class="dp">·</span>spu.infeed_shares(refs))</td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>SPUObject(spu,<span class="dp">·</span>meta,<span class="dp">·</span>spu.infeed_shares(refs))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">92 </td><td class="diffpresent">#<span class="dp">·</span>Data<span class="dp">·</span>flows<span class="dp">·</span>inside<span class="dp">·</span>the<span class="dp">·</span>HEU,<span class="dp">·</span>across<span class="dp">·</span>network</td><td class="diffline">128 </td><td class="diffpresent">#<span class="dp">·</span>Data<span class="dp">·</span>flows<span class="dp">·</span>inside<span class="dp">·</span>the<span class="dp">·</span>HEU,<span class="dp">·</span>across<span class="dp">·</span>network</td></tr>
<tr class="diffchanged"><td class="diffline">93 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_same_heu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>config:<span class="dp">·</span>MoveConfig):</td><td class="diffline">129 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_same_heu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>config:<span class="dp">·</span><ins>HEU</ins>MoveConfig):</td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.location<span class="dp">·</span>==<span class="dp">·</span>config.heu_dest_party:</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.location<span class="dp">·</span>==<span class="dp">·</span>config.heu_dest_party:</td></tr>
<tr class="diffunmodified"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>nothing<span class="dp">·</span>to<span class="dp">·</span>do</td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>nothing<span class="dp">·</span>to<span class="dp">·</span>do</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.is_plain:</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.is_plain:</td></tr>
<tr class="diffunmodified"><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>send</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>send</td></tr>
<tr class="diffunmodified"><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ct<span class="dp">·</span>=<span class="dp">·</span>self.device.get_participant(self.location).encrypt.remote(</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ct<span class="dp">·</span>=<span class="dp">·</span>self.device.get_participant(self.location).encrypt.remote(</td></tr>
<tr class="diffunmodified"><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_audit_log</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_audit_log</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 106, 42 lines modified</td><td colspan="2">Offset 142, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(self.device,<span class="dp">·</span>ct,<span class="dp">·</span>config.heu_dest_party,<span class="dp">·</span>is_plain=False)</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(self.device,<span class="dp">·</span>ct,<span class="dp">·</span>config.heu_dest_party,<span class="dp">·</span>is_plain=False)</td></tr>
<tr class="diffunmodified"><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>directly<span class="dp">·</span>send</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>directly<span class="dp">·</span>send</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(self.device,<span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_dest_party,<span class="dp">·</span>is_plain=False)</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(self.device,<span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_dest_party,<span class="dp">·</span>is_plain=False)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">110 </td><td class="diffpresent">#<span class="dp">·</span>The<span class="dp">·</span>two<span class="dp">·</span>HEU<span class="dp">·</span>have<span class="dp">·</span>different<span class="dp">·</span>pk/sk</td><td class="diffline">146 </td><td class="diffpresent">#<span class="dp">·</span>The<span class="dp">·</span>two<span class="dp">·</span>HEU<span class="dp">·</span>have<span class="dp">·</span>different<span class="dp">·</span>pk/sk</td></tr>
<tr class="diffchanged"><td class="diffline">111 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_other_heu(self:<span class="dp">·</span>DeviceObject,<span class="dp">·</span>dest_device:<span class="dp">·</span>HEU,<span class="dp">·</span>config):</td><td class="diffline">147 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_other_heu(self:<span class="dp">·</span>DeviceObject,<span class="dp">·</span>dest_device:<span class="dp">·</span>HEU,<span class="dp">·</span>config<ins>:<span class="dp">·</span>HEUMoveConfig</ins>):</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>NotImplementedError(&quot;Heu<span class="dp">·</span>object<span class="dp">·</span>cannot<span class="dp">·</span>flow<span class="dp">·</span>across<span class="dp">·</span>HEUs&quot;)</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>NotImplementedError(&quot;Heu<span class="dp">·</span>object<span class="dp">·</span>cannot<span class="dp">·</span>flow<span class="dp">·</span>across<span class="dp">·</span>HEUs&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">113 </td><td class="diffpresent">def<span class="dp">·</span>heu_to_pyu(self:<span class="dp">·</span>HEUObject,<span class="dp">·</span>device:<span class="dp">·</span>PYU,<span class="dp">·</span>config:<span class="dp">·</span>MoveConfig):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>heu<span class="dp">·</span>-&gt;<span class="dp">·</span>heu(sk_keeper)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.location<span class="dp">·</span>!=<span class="dp">·</span>device.party:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>=<span class="dp">·</span>device.party</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self<span class="dp">·</span>=<span class="dp">·</span>self.to(self.device,<span class="dp">·</span>config)</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>below<span class="dp">·</span>is<span class="dp">·</span>pure<span class="dp">·</span>local<span class="dp">·</span>operation</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.is_plain:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cleartext<span class="dp">·</span>=<span class="dp">·</span>self.device.get_participant(self.location).decode.remote(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_encoder</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(device,<span class="dp">·</span>cleartext)</td><td colspan="2"> </td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 236/5210 bytes (4.53%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">8.27 KB</span></div>
    <div id="secretflow-device-kernels-pyu.py"><span class="source">secretflow/device/kernels/pyu.py</span>
      <a class="anchor" href="#secretflow-device-kernels-pyu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 51 lines modified</td><td colspan="2">Offset 8, 201 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>spu<span class="dp">·</span>import<span class="dp">·</span>Visibility</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>(HEU,<span class="dp">·</span>PYU,<span class="dp">·</span>SPU,<span class="dp">·</span>SPUIO,<span class="dp">·</span>Device,<span class="dp">·</span>DeviceType,</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent"><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,<span class="dp">·</span>PYU</del><del>Objec</del>t<del>,</del><span class="dp">·</span><del>SPUObject,</del><del><span class="dp">·</span>re</del>gi<del>ste</del><del>r)</del></td><td class="diffline">14 </td><td class="diffpresent"><ins>impor</ins>t<span class="dp">·</span><ins>log</ins>gi<ins>ng</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>secrets</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Callable,<span class="dp">·</span>List,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>spu<span class="dp">·</span>import<span class="dp">·</span>Visibility</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">@register(DeviceType.PYU)</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent"><del>de</del>f<del><span class="dp">·</span></del><del>t</del>o<del>(self</del><del>:</del><span class="dp">·</span><del>PYUOb</del><del>j</del>ec<del>t,<span class="dp">·</span></del><del>d</del>e<del>vice:<span class="dp">·</span>D</del>evice<del>,</del><span class="dp">·</span><del>config):</del></td><td class="diffline">18 </td><td class="diffpresent">f<ins>r</ins>o<ins>m</ins><span class="dp">·</span><ins>s</ins>ec<ins>r</ins>e<ins>tflow.d</ins>evice<span class="dp">·</span><ins>import<span class="dp">·</span>(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUIO,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEEU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceType,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEEUData,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>TEEUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>global_state,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.base<span class="dp">·</span>import<span class="dp">·</span>register_to</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.heu<span class="dp">·</span>import<span class="dp">·</span>HEUMoveConfig</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">35 </td><td class="diffpresent">@register_to(DeviceType.PYU,<span class="dp">·</span>DeviceType.PYU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">36 </td><td class="diffpresent">def<span class="dp">·</span>pyu_to_pyu(self:<span class="dp">·</span>PYUObject,<span class="dp">·</span>pyu:<span class="dp">·</span>PYU)<span class="dp">·</span>-&gt;<span class="dp">·</span>PYUObject:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(pyu,<span class="dp">·</span>PYU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>a<span class="dp">·</span>PYU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(pyu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>PYUObject(pyu,<span class="dp">·</span>self.data)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">@register_to(DeviceType.PYU,<span class="dp">·</span>DeviceType.SPU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">def<span class="dp">·</span>pyu_to_spu(self:<span class="dp">·</span>PYUObject,<span class="dp">·</span>spu:<span class="dp">·</span>SPU,<span class="dp">·</span>spu_vis:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>&#x27;secret&#x27;)<span class="dp">·</span>-&gt;<span class="dp">·</span>SPUObject:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Transfer<span class="dp">·</span>pyuobject<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>spu.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self:<span class="dp">·</span>the<span class="dp">·</span>pyuobject<span class="dp">·</span>to<span class="dp">·</span>transfer.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu:<span class="dp">·</span>to<span class="dp">·</span>this<span class="dp">·</span>SPU<span class="dp">·</span>device.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_vis:<span class="dp">·</span>optional;<span class="dp">·</span>SPU<span class="dp">·</span>object<span class="dp">·</span>visibility.<span class="dp">·</span>Value<span class="dp">·</span>can<span class="dp">·</span>be:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>secret:<span class="dp">·</span>Secret<span class="dp">·</span>sharing<span class="dp">·</span>with<span class="dp">·</span>protocol<span class="dp">·</span>spdz-2k,<span class="dp">·</span>aby3,<span class="dp">·</span>etc.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>public:<span class="dp">·</span>Public<span class="dp">·</span>sharing,<span class="dp">·</span>which<span class="dp">·</span>means<span class="dp">·</span>data<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>replicated<span class="dp">·</span>to<span class="dp">·</span>each<span class="dp">·</span>node.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>the<span class="dp">·</span>transferred<span class="dp">·</span>SPUObject.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(spu,<span class="dp">·</span>SPU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>SPU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(spu)}&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>spu_vis<span class="dp">·</span>in<span class="dp">·</span>(&#x27;secret&#x27;,<span class="dp">·</span>&#x27;public&#x27;),<span class="dp">·</span>f&#x27;vis<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>public<span class="dp">·</span>or<span class="dp">·</span>secret&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vtype<span class="dp">·</span>=<span class="dp">·</span>Visibility.VIS_PUBLIC<span class="dp">·</span>if<span class="dp">·</span>spu_vis<span class="dp">·</span>==<span class="dp">·</span>&#x27;public&#x27;<span class="dp">·</span>else<span class="dp">·</span>Visibility.VIS_SECRET</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>run_spu_io(data,<span class="dp">·</span>runtime_config,<span class="dp">·</span>world_size,<span class="dp">·</span>vtype):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>io<span class="dp">·</span>=<span class="dp">·</span>SPUIO(runtime_config,<span class="dp">·</span>world_size)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>io.make_shares(data,<span class="dp">·</span>vtype)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>meta,<span class="dp">·</span>*shares<span class="dp">·</span>=<span class="dp">·</span>self.device(run_spu_io,<span class="dp">·</span>num_returns=(1<span class="dp">·</span>+<span class="dp">·</span>spu.world_size))(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>spu.conf,<span class="dp">·</span>spu.world_size,<span class="dp">·</span>vtype</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>SPUObject(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu,<span class="dp">·</span>meta.data,<span class="dp">·</span>spu.infeed_shares([share.data<span class="dp">·</span>for<span class="dp">·</span>share<span class="dp">·</span>in<span class="dp">·</span>shares])</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent">@register_to(DeviceType.PYU,<span class="dp">·</span>DeviceType.HEU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent">def<span class="dp">·</span>pyu_to_heu(self:<span class="dp">·</span>PYUObject,<span class="dp">·</span>heu:<span class="dp">·</span>HEU,<span class="dp">·</span>config:<span class="dp">·</span>HEUMoveConfig<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(heu,<span class="dp">·</span>HEU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>HEU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(heu)}&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config<span class="dp">·</span>=<span class="dp">·</span>HEUMoveConfig()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>==<span class="dp">·</span>&#x27;auto&#x27;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>=<span class="dp">·</span>list(heu.evaluator_names())[0]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>heu.get_participant(self.device.party).encode.remote(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data,<span class="dp">·</span>config.heu_encoder</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>HEUObject(heu,<span class="dp">·</span>data,<span class="dp">·</span>self.device.party,<span class="dp">·</span>True).to(heu,<span class="dp">·</span>config)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">74 </td><td class="diffpresent">@register_to(DeviceType.PYU,<span class="dp">·</span>DeviceType.TEEU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent">def<span class="dp">·</span>pyu_to_teeu(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self:<span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>teeu:<span class="dp">·</span>TEEU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>allow_funcs:<span class="dp">·</span>Union[Callable,<span class="dp">·</span>List[Callable]],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent">):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Transfer<span class="dp">·</span>a<span class="dp">·</span>PYUObject<span class="dp">·</span>to<span class="dp">·</span>TEEU.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Transfer<span class="dp">·</span>a<span class="dp">·</span>PYUObject<span class="dp">·</span>to<span class="dp">·</span>TEEU,<span class="dp">·</span>the<span class="dp">·</span>main<span class="dp">·</span>steps<span class="dp">·</span>are:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1)<span class="dp">·</span>Create<span class="dp">·</span>an<span class="dp">·</span>authority<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>function<span class="dp">·</span>and<span class="dp">·</span>enclave<span class="dp">·</span>through</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>the<span class="dp">·</span>authority<span class="dp">·</span>manager.<span class="dp">·</span>A<span class="dp">·</span>data<span class="dp">·</span>key<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>generated<span class="dp">·</span>for<span class="dp">·</span>next<span class="dp">·</span>step.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2)<span class="dp">·</span>Use<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>key<span class="dp">·</span>to<span class="dp">·</span>encrypt<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>with<span class="dp">·</span>AES-GCM.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self:<span class="dp">·</span>the<span class="dp">·</span>PYUObject<span class="dp">·</span>instance.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>teeu:<span class="dp">·</span>the<span class="dp">·</span>TEEU.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>allow_funcs:<span class="dp">·</span>the<span class="dp">·</span>function(s)<span class="dp">·</span>to<span class="dp">·</span>allow<span class="dp">·</span>using<span class="dp">·</span>this<span class="dp">·</span>PYUObject.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Function<span class="dp">·</span>not<span class="dp">·</span>in<span class="dp">·</span>this<span class="dp">·</span>list<span class="dp">·</span>can<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>PYUObject.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>A<span class="dp">·</span>TEEUObject<span class="dp">·</span>whose<span class="dp">·</span>underlying<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>ciphertext.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from<span class="dp">·</span>sdc.auth_frame<span class="dp">·</span>import<span class="dp">·</span>AuthFrame,<span class="dp">·</span>CredentialsConf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(<del>d</del>e<del>vi</del><del>ce</del>,<span class="dp">·</span><del>De</del><del>vice</del>),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>a<span class="dp">·</span><del>de</del><del>vice</del><span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(<del>d</del>e<del>vi</del><del>ce</del>)}&#x27;</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(<ins>t</ins>e<ins>eu</ins>,<span class="dp">·</span><ins>TEEU</ins>),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>a<span class="dp">·</span><ins>TEEU</ins><span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(<ins>t</ins>e<ins>eu</ins>)}&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.debug(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&#x27;Transfer<span class="dp">·</span>PYU<span class="dp">·</span>object<span class="dp">·</span>from<span class="dp">·</span>{self.device.party}<span class="dp">·</span>to<span class="dp">·</span>TEEU<span class="dp">·</span>of<span class="dp">·</span>{teeu.party}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>create_auth(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>Any,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>public_key:<span class="dp">·</span>str,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>private_key:<span class="dp">·</span>str,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tls_cert:<span class="dp">·</span>str,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tls_key:<span class="dp">·</span>str,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>allow_funcs:<span class="dp">·</span>Union[Callable,<span class="dp">·</span>List[Callable]],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>allow_enclaves:<span class="dp">·</span>List[str],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>auth_host:<span class="dp">·</span>str,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>auth_mr_enclave:<span class="dp">·</span>str,</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 3874/8400 bytes (46.12%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">7.8 KB</span></div>
    <div id="secretflow-device-kernels-spu.py"><span class="source">secretflow/device/kernels/spu.py</span>
      <a class="anchor" href="#secretflow-device-kernels-spu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 57 lines modified</td><td colspan="2">Offset 23, 64 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Device,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceType,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>DeviceType,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>register,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>register,</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">)</td><td class="diffline">29 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.base<span class="dp">·</span>import<span class="dp">·</span>register_to</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.heu<span class="dp">·</span>import<span class="dp">·</span>HEUMoveConfig</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">30 </td><td class="diffpresent">@register(DeviceType.SPU)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">31 </td><td class="diffpresent">def<span class="dp">·</span>to(self:<span class="dp">·</span>SPUObject,<span class="dp">·</span>device:<span class="dp">·</span>Device,<span class="dp">·</span>config):</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">32 </td><td class="diffpresent"><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>i<del>f<span class="dp">·</span>isinstan</del>ce<del>(d</del>evice<del>,<span class="dp">·</span></del>PYU)<del>:</del></td><td class="diffline">32 </td><td class="diffpresent"><ins>@reg</ins>i<ins>st</ins><ins>er_to(Devi</ins>c<ins>eTyp</ins>e<ins>.SPU,</ins><ins><span class="dp">·</span>D</ins>evice<ins>Typ</ins><ins>e.</ins>PYU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent">def<span class="dp">·</span>spu_to_pyu(self:<span class="dp">·</span>SPUObject,<span class="dp">·</span>pyu:<span class="dp">·</span>Device,<span class="dp">·</span>config:<span class="dp">·</span>HEUMoveConfig<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(pyu,<span class="dp">·</span>PYU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>a<span class="dp">·</span>PYU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(pyu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config<span class="dp">·</span>=<span class="dp">·</span>HEUMoveConfig()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>def<span class="dp">·</span>reveal(conf,<span class="dp">·</span>world_size,<span class="dp">·</span>refs,<span class="dp">·</span>meta):</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>reveal(conf,<span class="dp">·</span>world_size,<span class="dp">·</span>refs,<span class="dp">·</span>meta):</td></tr>
<tr class="diffchanged"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>io<span class="dp">·</span>=<span class="dp">·</span>SPUIO(conf,<span class="dp">·</span>world_size)</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>io<span class="dp">·</span>=<span class="dp">·</span>SPUIO(conf,<span class="dp">·</span>world_size)</td></tr>
<tr class="diffchanged"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>return<span class="dp">·</span>io.reconstruct(refs,<span class="dp">·</span>meta)</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>io.reconstruct(refs,<span class="dp">·</span>meta)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>return<span class="dp">·</span><del>dev</del><del>ice</del>(reveal)(</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span><ins>pyu</ins>(reveal)(</td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>self.device.conf,</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.conf,</td></tr>
<tr class="diffchanged"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>self.device.world_size,</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.world_size,</td></tr>
<tr class="diffchanged"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>self.device.outfeed_shares(self.shares_name),</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device.outfeed_shares(self.shares_name),</td></tr>
<tr class="diffchanged"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>self.meta,</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.meta,</td></tr>
<tr class="diffchanged"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>)</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>same<span class="dp">·</span>spu</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.device<span class="dp">·</span>==<span class="dp">·</span>device:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">46 </td><td class="diffpresent">@register_to(DeviceType.SPU,<span class="dp">·</span>DeviceType.SPU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent">def<span class="dp">·</span>spu_to_spu(self:<span class="dp">·</span>SPUObject,<span class="dp">·</span>spu:<span class="dp">·</span>SPU):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(spu,<span class="dp">·</span>SPU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>SPU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(spu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>same<span class="dp">·</span>spu</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.device<span class="dp">·</span>==<span class="dp">·</span>spu:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self</td></tr>
<tr class="diffdeleted"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>send<span class="dp">·</span>to<span class="dp">·</span>another<span class="dp">·</span>spu.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device.conf.protocol<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.protocol</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>device.conf.field<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.field</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>device.conf.fxp_fraction_bits<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.fxp_fraction_bits</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>device.world_size<span class="dp">·</span>==<span class="dp">·</span>self.device.world_size</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares<span class="dp">·</span>=<span class="dp">·</span>self.device.outfeed_shares(self.shares_name)</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span></del><del><span class="dp">·</span></del><span class="dp">·</span>s<del>har</del>e<del>s_</del>n<del>ame<span class="dp">·</span>=<span class="dp">·</span></del>d<del>ev</del><del>ice.i</del>n<del>feed</del><del>_s</del>h<del>ar</del>e<del>s(</del>s<del>har</del><del>es)</del></td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>#</ins><span class="dp">·</span>send<ins><span class="dp">·</span>to<span class="dp">·</span>a</ins>n<ins>ot</ins>he<ins>r<span class="dp">·</span></ins>s<ins>pu.</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu.conf.protocol<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.protocol</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>spu.conf.field<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.field</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>spu.conf.fxp_fraction_bits<span class="dp">·</span>==<span class="dp">·</span>self.device.conf.fxp_fraction_bits</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>spu.world_size<span class="dp">·</span>==<span class="dp">·</span>self.device.world_size</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>TODO:<span class="dp">·</span>do<span class="dp">·</span>we<span class="dp">·</span>need<span class="dp">·</span>reshare<span class="dp">·</span>shares.</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span></del><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>re<del>t</del><del>urn</del><span class="dp">·</span><del>SPUObj</del>ec<del>t(devic</del>e<del>,<span class="dp">·</span></del>s<del>elf.meta,<span class="dp">·</span></del>shares_name)</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>sha</ins>re<ins>s<span class="dp">·</span>=</ins><span class="dp">·</span><ins>self.d</ins>e<ins>vi</ins>c<ins>e.outfe</ins>e<ins>d_</ins>s<ins>h</ins><ins>ares(self.</ins>shares_name)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shares_name<span class="dp">·</span>=<span class="dp">·</span>spu.infeed_shares(shares)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(device,<span class="dp">·</span>HEU):</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span></del><del><span class="dp">·</span></del><span class="dp">·</span><del>r</del><del>eturn</del><span class="dp">·</span><del>spu_</del><del>t</del>o<del>_h</del>e<del>u</del><del>(s</del>e<del>l</del><del>f,</del><span class="dp">·</span><del>d</del>e<del>vice,</del><span class="dp">·</span><del>config)</del></td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>#</ins><span class="dp">·</span><ins>TODO:</ins><span class="dp">·</span><ins>d</ins>o<ins><span class="dp">·</span>w</ins>e<ins><span class="dp">·</span>n</ins>e<ins>ed</ins><span class="dp">·</span><ins>r</ins>e<ins>share</ins><span class="dp">·</span><ins>shares.</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>SPUObject(spu,<span class="dp">·</span>self.meta,<span class="dp">·</span>shares_name)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>ValueError(f&#x27;Unexpected<span class="dp">·</span>device<span class="dp">·</span>type:<span class="dp">·</span>{type(device)}&#x27;)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent">@register_to(DeviceType.SPU,<span class="dp">·</span>DeviceType.HEU)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent">def<span class="dp">·</span>spu_to_heu(self:<span class="dp">·</span>SPUObject,<span class="dp">·</span>heu:<span class="dp">·</span>Device,<span class="dp">·</span>config:<span class="dp">·</span>HEUMoveConfig<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(heu,<span class="dp">·</span>HEU),<span class="dp">·</span>f&#x27;Expect<span class="dp">·</span>an<span class="dp">·</span>HEU<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(heu)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config<span class="dp">·</span>=<span class="dp">·</span>HEUMoveConfig()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">60 </td><td class="diffpresent">def<span class="dp">·</span>spu_to_heu(self:<span class="dp">·</span>SPUObject,<span class="dp">·</span>heu:<span class="dp">·</span>HEU,<span class="dp">·</span>config):</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>==<span class="dp">·</span>&quot;auto&quot;:</td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>==<span class="dp">·</span>&quot;auto&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>=<span class="dp">·</span>list(heu.evaluator_names())[0]</td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>=<span class="dp">·</span>list(heu.evaluator_names())[0]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>==<span class="dp">·</span>heu.sk_keeper_name():</td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>config.heu_dest_party<span class="dp">·</span>==<span class="dp">·</span>heu.sk_keeper_name():</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>RuntimeError(</td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>RuntimeError(</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;move<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>heu<span class="dp">·</span>sk_keeper({config.heu_dest_party})<span class="dp">·</span>is<span class="dp">·</span>dangerous.<span class="dp">·</span>If<span class="dp">·</span>you<span class="dp">·</span>are<span class="dp">·</span>&quot;</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;move<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>heu<span class="dp">·</span>sk_keeper({config.heu_dest_party})<span class="dp">·</span>is<span class="dp">·</span>dangerous.<span class="dp">·</span>If<span class="dp">·</span>you<span class="dp">·</span>are<span class="dp">·</span>&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;sure<span class="dp">·</span>you<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>do<span class="dp">·</span>this,<span class="dp">·</span>please<span class="dp">·</span>reveal<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>PYU<span class="dp">·</span>first,<span class="dp">·</span>&quot;</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;sure<span class="dp">·</span>you<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>do<span class="dp">·</span>this,<span class="dp">·</span>please<span class="dp">·</span>reveal<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>to<span class="dp">·</span>PYU<span class="dp">·</span>first,<span class="dp">·</span>&quot;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 113, 14 lines modified</td><td colspan="2">Offset 120, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input=True,</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort=True,</td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result=True,</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size=1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>20,</td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size=1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>20,</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type=&quot;CURVE_25519&quot;,</td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type=&quot;CURVE_25519&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path=None,</td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path=None,</td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path=None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dppsi_bob_sub_sampling=0.9,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dppsi_epsilon=3,</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>List[PYUObject]:</td><td class="diffline">129 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>List[PYUObject]:</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU),<span class="dp">·</span>f&#x27;device<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>SPU<span class="dp">·</span>device&#x27;</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(device,<span class="dp">·</span>SPU),<span class="dp">·</span>f&#x27;device<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>SPU<span class="dp">·</span>device&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key,<span class="dp">·</span>(str,<span class="dp">·</span>List,<span class="dp">·</span>Dict)</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key,<span class="dp">·</span>(str,<span class="dp">·</span>List,<span class="dp">·</span>Dict)</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;invalid<span class="dp">·</span>key,<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>str<span class="dp">·</span>of<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>str<span class="dp">·</span>or<span class="dp">·</span>dict<span class="dp">·</span>of<span class="dp">·</span>str<span class="dp">·</span>list&#x27;</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;invalid<span class="dp">·</span>key,<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>str<span class="dp">·</span>of<span class="dp">·</span>list<span class="dp">·</span>of<span class="dp">·</span>str<span class="dp">·</span>or<span class="dp">·</span>dict<span class="dp">·</span>of<span class="dp">·</span>str<span class="dp">·</span>list&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(set([df.device<span class="dp">·</span>for<span class="dp">·</span>df<span class="dp">·</span>in<span class="dp">·</span>dfs]))<span class="dp">·</span>==<span class="dp">·</span>len(</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(set([df.device<span class="dp">·</span>for<span class="dp">·</span>df<span class="dp">·</span>in<span class="dp">·</span>dfs]))<span class="dp">·</span>==<span class="dp">·</span>len(</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dfs</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dfs</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 150, 14 lines modified</td><td colspan="2">Offset 159, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input,</td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input,</td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort,</td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort,</td></tr>
<tr class="diffunmodified"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result,</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result,</td></tr>
<tr class="diffunmodified"><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size,</td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size,</td></tr>
<tr class="diffunmodified"><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type,</td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type,</td></tr>
<tr class="diffunmodified"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path,</td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path,</td></tr>
<tr class="diffunmodified"><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path,</td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dppsi_bob_sub_sampling,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dppsi_epsilon,</td></tr>
<tr class="diffunmodified"><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>res</td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>res</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 170, 16 lines modified</td><td colspan="2">Offset 181, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>receiver:<span class="dp">·</span>str,</td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>receiver:<span class="dp">·</span>str,</td></tr>
<tr class="diffunmodified"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>protocol=&#x27;KKRT_PSI_2PC&#x27;,</td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>protocol=&#x27;KKRT_PSI_2PC&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input=True,</td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>precheck_input=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort=True,</td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sort=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result=True,</td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>broadcast_result=True,</td></tr>
<tr class="diffunmodified"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size=1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>20,</td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bucket_size=1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>20,</td></tr>
<tr class="diffunmodified"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type=&quot;CURVE_25519&quot;,</td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>curve_type=&quot;CURVE_25519&quot;,</td></tr>
<tr class="diffchanged"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path=None,</td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>preprocess_path<ins>:<span class="dp">·</span>Union[str,<span class="dp">·</span>Dict[Device,<span class="dp">·</span>str]]<span class="dp">·</span></ins>=<ins><span class="dp">·</span></ins>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path=None,</td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ecdh_secret_key_path=None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dppsi_bob_sub_sampling=0.9,</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 3122/7920 bytes (39.42%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">986 B</span></div>
    <div id="secretflow-distributed-__init__.py"><span class="source">secretflow/distributed/__init__.py</span>
      <a class="anchor" href="#secretflow-distributed-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 9 lines modified</td><td colspan="2">Offset 1, 23 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">1 </td><td class="diffpresent">from<span class="dp">·</span>.primitive<span class="dp">·</span>import<span class="dp">·</span><del>(</del>get,<span class="dp">·</span>kill,<span class="dp">·</span>production_mode,<span class="dp">·</span>remote,<span class="dp">·</span>set_production,</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.primitive<span class="dp">·</span>import<span class="dp">·</span>get,<span class="dp">·</span>kill,<span class="dp">·</span>production_mode,<span class="dp">·</span>remote,<span class="dp">·</span>set_production,<ins><span class="dp">·</span>shutdown</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">2 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shutdown)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;get&#x27;,</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;get&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;kill&#x27;,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;kill&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;production_mode&#x27;,</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;production_mode&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;remote&#x27;,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;remote&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;set_production&#x27;,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;set_production&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">4.46 KB</span></div>
    <div id="secretflow-distributed-primitive.py"><span class="source">secretflow/distributed/primitive.py</span>
      <a class="anchor" href="#secretflow-distributed-primitive.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 39 lines modified</td><td colspan="2">Offset 1, 65 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>inspect</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>inspect</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>partial</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>partial</td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Union</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">import<span class="dp">·</span>fed</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>fed</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">import<span class="dp">·</span>jax</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>jax</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">import<span class="dp">·</span>ray</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>ray</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">from<span class="dp">·</span>ray<span class="dp">·</span>import<span class="dp">·</span>Language</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>ray<span class="dp">·</span>import<span class="dp">·</span>Language</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">from<span class="dp">·</span>ray._private<span class="dp">·</span>import<span class="dp">·</span>ray_option_utils</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>ray._private<span class="dp">·</span>import<span class="dp">·</span>ray_option_utils</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>ray.actor<span class="dp">·</span>import<span class="dp">·</span>ActorClass,<span class="dp">·</span>_inject_tracing_into_class,<span class="dp">·</span>ray_constants</td></tr>
<tr class="diffdeleted"><td class="diffline">9 </td><td class="diffpresent">from<span class="dp">·</span>ray._private.inspect_util<span class="dp">·</span>import<span class="dp">·</span>is_cython</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">10 </td><td class="diffpresent">from<span class="dp">·</span>ray.actor<span class="dp">·</span>import<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ActorClass,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ActorClassID,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_inject_tracing_into_class,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_modify_class,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ray_constants,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>ray.remote_function<span class="dp">·</span>import<span class="dp">·</span>RemoteFunction</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>ray.remote_function<span class="dp">·</span>import<span class="dp">·</span>RemoteFunction</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.ray_compatibility<span class="dp">·</span>import<span class="dp">·</span>ray_version_less_than_2_0_0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">_production_mode<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">25 </td><td class="diffpresent">_production_mode<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">def<span class="dp">·</span>set_production(mode:<span class="dp">·</span>bool):</td><td class="diffline">26 </td><td class="diffpresent">def<span class="dp">·</span>set_production(mode:<span class="dp">·</span>bool):</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>global<span class="dp">·</span>_production_mode</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>global<span class="dp">·</span>_production_mode</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_production_mode<span class="dp">·</span>=<span class="dp">·</span>mode</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_production_mode<span class="dp">·</span>=<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">def<span class="dp">·</span>production_mode():</td><td class="diffline">29 </td><td class="diffpresent">def<span class="dp">·</span>production_mode():</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>global<span class="dp">·</span>_production_mode</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>global<span class="dp">·</span>_production_mode</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>_production_mode</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>_production_mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent">def<span class="dp">·</span>_is_cython(obj):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Check<span class="dp">·</span>if<span class="dp">·</span>an<span class="dp">·</span>object<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>Cython<span class="dp">·</span>function<span class="dp">·</span>or<span class="dp">·</span>method&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>TODO(suo):<span class="dp">·</span>We<span class="dp">·</span>could<span class="dp">·</span>split<span class="dp">·</span>these<span class="dp">·</span>into<span class="dp">·</span>two<span class="dp">·</span>functions,<span class="dp">·</span>one<span class="dp">·</span>for<span class="dp">·</span>Cython</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>functions<span class="dp">·</span>and<span class="dp">·</span>another<span class="dp">·</span>for<span class="dp">·</span>Cython<span class="dp">·</span>methods.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>TODO(suo):<span class="dp">·</span>There<span class="dp">·</span>doesn&#x27;t<span class="dp">·</span>appear<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>Cython<span class="dp">·</span>function<span class="dp">·</span>&#x27;type&#x27;<span class="dp">·</span>we<span class="dp">·</span>can</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>check<span class="dp">·</span>against<span class="dp">·</span>via<span class="dp">·</span>isinstance.<span class="dp">·</span>Please<span class="dp">·</span>correct<span class="dp">·</span>me<span class="dp">·</span>if<span class="dp">·</span>I&#x27;m<span class="dp">·</span>wrong.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>check_cython(x):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>type(x).__name__<span class="dp">·</span>==<span class="dp">·</span>&quot;cython_function_or_method&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Check<span class="dp">·</span>if<span class="dp">·</span>function<span class="dp">·</span>or<span class="dp">·</span>method,<span class="dp">·</span>respectively</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>check_cython(obj)<span class="dp">·</span>or<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hasattr(obj,<span class="dp">·</span>&quot;__func__&quot;)<span class="dp">·</span>and<span class="dp">·</span>check_cython(obj.__func__)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">def<span class="dp">·</span>remote(*args,<span class="dp">·</span>**kwargs):</td><td class="diffline">44 </td><td class="diffpresent">def<span class="dp">·</span>remote(*args,<span class="dp">·</span>**kwargs):</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>production_mode():</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>production_mode():</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>fed.remote(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>fed.remote(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>ray_remote(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>ray_remote(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 79, 19 lines modified</td><td colspan="2">Offset 105, 19 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent">class<span class="dp">·</span>RemoteFunctionWrapper(RemoteFunction):</td><td class="diffline">105 </td><td class="diffpresent">class<span class="dp">·</span>RemoteFunctionWrapper(RemoteFunction):</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_remote(self,<span class="dp">·</span>*args,<span class="dp">·</span>**kwargs):</td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_remote(self,<span class="dp">·</span>*args,<span class="dp">·</span>**kwargs):</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args,<span class="dp">·</span>kwargs<span class="dp">·</span>=<span class="dp">·</span>_resolve_args(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args,<span class="dp">·</span>kwargs<span class="dp">·</span>=<span class="dp">·</span>_resolve_args(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>super()._remote(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>super()._remote(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>party(self,<span class="dp">·</span>party:<span class="dp">·</span>str):</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>party(self,<span class="dp">·</span>party:<span class="dp">·</span>str):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&#x27;resources&#x27;<span class="dp">·</span>in<span class="dp">·</span>self._default_options:</td><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&#x27;resources&#x27;<span class="dp">·</span>in<span class="dp">·</span>self._default_options:</td></tr>
<tr class="diffunmodified"><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._default_options[&#x27;resources&#x27;].update({self.party:<span class="dp">·</span>1})</td><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._default_options[&#x27;resources&#x27;].update({self.party:<span class="dp">·</span>1})</td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._default_options.update({&#x27;resources&#x27;:<span class="dp">·</span>{self.party:<span class="dp">·</span>1}})</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._default_options.update({&#x27;resources&#x27;:<span class="dp">·</span>{self.party:<span class="dp">·</span>1}})</td></tr>
<tr class="diffdeleted"><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.party<span class="dp">·</span>=<span class="dp">·</span>party</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self</td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>options(self,<span class="dp">·</span>**task_options):</td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>options(self,<span class="dp">·</span>**task_options):</td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(self,<span class="dp">·</span>&#x27;party&#x27;)<span class="dp">·</span>and<span class="dp">·</span>self.party:</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(self,<span class="dp">·</span>&#x27;party&#x27;)<span class="dp">·</span>and<span class="dp">·</span>self.party:</td></tr>
<tr class="diffunmodified"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&#x27;resources&#x27;<span class="dp">·</span>in<span class="dp">·</span>task_options:</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&#x27;resources&#x27;<span class="dp">·</span>in<span class="dp">·</span>task_options:</td></tr>
<tr class="diffunmodified"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>task_options[&#x27;resources&#x27;].update({self.party:<span class="dp">·</span>1})</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>task_options[&#x27;resources&#x27;].update({self.party:<span class="dp">·</span>1})</td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 118, 14 lines modified</td><td colspan="2">Offset 144, 20 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>remote(self,<span class="dp">·</span>*args,<span class="dp">·</span>**kwargs):</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>remote(self,<span class="dp">·</span>*args,<span class="dp">·</span>**kwargs):</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args,<span class="dp">·</span>kwargs<span class="dp">·</span>=<span class="dp">·</span>_resolve_args(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>args,<span class="dp">·</span>kwargs<span class="dp">·</span>=<span class="dp">·</span>_resolve_args(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>super().remote(*args,<span class="dp">·</span>**kwargs)</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>super().remote(*args,<span class="dp">·</span>**kwargs)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent">def<span class="dp">·</span>_make_actor(cls,<span class="dp">·</span>actor_options):</td><td class="diffline">147 </td><td class="diffpresent">def<span class="dp">·</span>_make_actor(cls,<span class="dp">·</span>actor_options):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>ray_version_less_than_2_0_0():</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from<span class="dp">·</span>ray<span class="dp">·</span>import<span class="dp">·</span>ActorClassID</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from<span class="dp">·</span>ray.actor<span class="dp">·</span>import<span class="dp">·</span>modify_class<span class="dp">·</span>as<span class="dp">·</span>_modify_class</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from<span class="dp">·</span>ray.actor<span class="dp">·</span>import<span class="dp">·</span>ActorClassID,<span class="dp">·</span>_modify_class</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Class<span class="dp">·</span>=<span class="dp">·</span>_modify_class(cls)</td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Class<span class="dp">·</span>=<span class="dp">·</span>_modify_class(cls)</td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_inject_tracing_into_class(Class)</td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_inject_tracing_into_class(Class)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&quot;max_restarts&quot;<span class="dp">·</span>in<span class="dp">·</span>actor_options:</td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>&quot;max_restarts&quot;<span class="dp">·</span>in<span class="dp">·</span>actor_options:</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>actor_options[&quot;max_restarts&quot;]<span class="dp">·</span>!=<span class="dp">·</span>-1:<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>-1<span class="dp">·</span>represents<span class="dp">·</span>infinite<span class="dp">·</span>restart</td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>actor_options[&quot;max_restarts&quot;]<span class="dp">·</span>!=<span class="dp">·</span>-1:<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>-1<span class="dp">·</span>represents<span class="dp">·</span>infinite<span class="dp">·</span>restart</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Make<span class="dp">·</span>sure<span class="dp">·</span>we<span class="dp">·</span>don&#x27;t<span class="dp">·</span>pass<span class="dp">·</span>too<span class="dp">·</span>big<span class="dp">·</span>of<span class="dp">·</span>an<span class="dp">·</span>int<span class="dp">·</span>to<span class="dp">·</span>C++,<span class="dp">·</span>causing</td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Make<span class="dp">·</span>sure<span class="dp">·</span>we<span class="dp">·</span>don&#x27;t<span class="dp">·</span>pass<span class="dp">·</span>too<span class="dp">·</span>big<span class="dp">·</span>of<span class="dp">·</span>an<span class="dp">·</span>int<span class="dp">·</span>to<span class="dp">·</span>C++,<span class="dp">·</span>causing</td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>an<span class="dp">·</span>overflow.</td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>an<span class="dp">·</span>overflow.</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 137, 23 lines modified</td><td colspan="2">Offset 169, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Class,</td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Class,</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ActorClassID.from_random(),</td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ActorClassID.from_random(),</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>actor_options,</td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>actor_options,</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent">def<span class="dp">·</span>_make_remote(function_or_class,<span class="dp">·</span>options):</td><td class="diffline">173 </td><td class="diffpresent">def<span class="dp">·</span>_make_remote(function_or_class,<span class="dp">·</span>options):</td></tr>
<tr class="diffchanged"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>inspect.isfunction(function_or_class)<span class="dp">·</span>or<span class="dp">·</span>is_cython(function_or_class):</td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>inspect.isfunction(function_or_class)<span class="dp">·</span>or<span class="dp">·</span><ins>_</ins>is_cython(function_or_class):</td></tr>
<tr class="diffunmodified"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ray_option_utils.validate_task_options(options,<span class="dp">·</span>in_options=False)</td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ray_option_utils.validate_task_options(options,<span class="dp">·</span>in_options=False)</td></tr>
<tr class="diffunmodified"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>RemoteFunctionWrapper(</td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>RemoteFunctionWrapper(</td></tr>
<tr class="diffunmodified"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Language.PYTHON,</td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Language.PYTHON,</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 347/4492 bytes (7.72%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">565 B</span></div>
    <div id="secretflow-ml-boost-homo_boost-homo_decision_tree.py"><span class="source">secretflow/ml/boost/homo_boost/homo_decision_tree.py</span>
      <a class="anchor" href="#secretflow-ml-boost-homo_boost-homo_decision_tree.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 18, 14 lines modified</td><td colspan="2">Offset 18, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">&quot;&quot;&quot;<span class="dp">·</span>Homo<span class="dp">·</span>Decision<span class="dp">·</span>Tree<span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">18 </td><td class="diffpresent">&quot;&quot;&quot;<span class="dp">·</span>Homo<span class="dp">·</span>Decision<span class="dp">·</span>Tree<span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>concurrent.futures<span class="dp">·</span>import<span class="dp">·</span>ThreadPoolExecutor</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>concurrent.futures<span class="dp">·</span>import<span class="dp">·</span>ThreadPoolExecutor</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>reduce</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>reduce</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.device.link<span class="dp">·</span>as<span class="dp">·</span>link</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.device.link<span class="dp">·</span>as<span class="dp">·</span>link</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.decision_tree<span class="dp">·</span>import<span class="dp">·</span>DecisionTree</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.decision_tree<span class="dp">·</span>import<span class="dp">·</span>DecisionTree</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_histogram<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_histogram<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FeatureHistogram,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FeatureHistogram,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HistogramBag,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HistogramBag,</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">)</td><td class="diffline">29 </td><td class="diffpresent">)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">949 B</span></div>
    <div id="secretflow-ml-boost-homo_boost-boost_core-training.py"><span class="source">secretflow/ml/boost/homo_boost/boost_core/training.py</span>
      <a class="anchor" href="#secretflow-ml-boost-homo_boost-boost_core-training.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 138, 15 lines modified</td><td colspan="2">Offset 138, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>role<span class="dp">·</span>==<span class="dp">·</span>link.SERVER:</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>role<span class="dp">·</span>==<span class="dp">·</span>link.SERVER:</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pre_round_list<span class="dp">·</span>=<span class="dp">·</span>link.recv_from_clients(</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pre_round_list<span class="dp">·</span>=<span class="dp">·</span>link.recv_from_clients(</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>name=&quot;pre_round&quot;,</td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>name=&quot;pre_round&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>version=0,</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>version=0,</td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(set(pre_round_list))<span class="dp">·</span>!=<span class="dp">·</span>1:</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(set(pre_round_list))<span class="dp">·</span>!=<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>ValueError(</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>ValueError(</td></tr>
<tr class="diffchanged"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;num<span class="dp">·</span>round<span class="dp">·</span>before<span class="dp">·</span>train<del>n</del>ing<span class="dp">·</span>for<span class="dp">·</span>clients<span class="dp">·</span>must<span class="dp">·</span>aligned,<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{pre_round_list}&quot;</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;num<span class="dp">·</span>round<span class="dp">·</span>before<span class="dp">·</span>training<span class="dp">·</span>for<span class="dp">·</span>clients<span class="dp">·</span>must<span class="dp">·</span>aligned,<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{pre_round_list}&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pre_round<span class="dp">·</span>=<span class="dp">·</span>pre_round_list[0]</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pre_round<span class="dp">·</span>=<span class="dp">·</span>pre_round_list[0]</td></tr>
<tr class="diffunmodified"><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>start_iteration<span class="dp">·</span>+=<span class="dp">·</span>pre_round</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>start_iteration<span class="dp">·</span>+=<span class="dp">·</span>pre_round</td></tr>
<tr class="diffunmodified"><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(start_iteration,<span class="dp">·</span>start_iteration<span class="dp">·</span>+<span class="dp">·</span>num_boost_round):</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(start_iteration,<span class="dp">·</span>start_iteration<span class="dp">·</span>+<span class="dp">·</span>num_boost_round):</td></tr>
<tr class="diffunmodified"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>callbacks.before_iteration(bst,<span class="dp">·</span>i,<span class="dp">·</span>dtrain,<span class="dp">·</span>evals):</td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>callbacks.before_iteration(bst,<span class="dp">·</span>i,<span class="dp">·</span>dtrain,<span class="dp">·</span>evals):</td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>break</td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>break</td></tr>
<tr class="diffunmodified"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>bst<span class="dp">·</span>calls<span class="dp">·</span>federate_update<span class="dp">·</span>to<span class="dp">·</span>build<span class="dp">·</span>the<span class="dp">·</span>tree<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>iteration<span class="dp">·</span>in<span class="dp">·</span>federated<span class="dp">·</span>mode,<span class="dp">·</span>and<span class="dp">·</span>merges<span class="dp">·</span>it<span class="dp">·</span>into<span class="dp">·</span>the<span class="dp">·</span>xgboost<span class="dp">·</span>model<span class="dp">·</span>after<span class="dp">·</span>the<span class="dp">·</span>construction<span class="dp">·</span>is<span class="dp">·</span>complete</td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>bst<span class="dp">·</span>calls<span class="dp">·</span>federate_update<span class="dp">·</span>to<span class="dp">·</span>build<span class="dp">·</span>the<span class="dp">·</span>tree<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>iteration<span class="dp">·</span>in<span class="dp">·</span>federated<span class="dp">·</span>mode,<span class="dp">·</span>and<span class="dp">·</span>merges<span class="dp">·</span>it<span class="dp">·</span>into<span class="dp">·</span>the<span class="dp">·</span>xgboost<span class="dp">·</span>model<span class="dp">·</span>after<span class="dp">·</span>the<span class="dp">·</span>construction<span class="dp">·</span>is<span class="dp">·</span>complete</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">653 B</span></div>
    <div id="secretflow-ml-boost-homo_boost-tree_core-decision_tree.py"><span class="source">secretflow/ml/boost/homo_boost/tree_core/decision_tree.py</span>
      <a class="anchor" href="#secretflow-ml-boost-homo_boost-tree_core-decision_tree.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 19, 14 lines modified</td><td colspan="2">Offset 19, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>json</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>json</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>pandas</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>pandas</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>xgboost<span class="dp">·</span>as<span class="dp">·</span>xgb</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>xgboost<span class="dp">·</span>as<span class="dp">·</span>xgb</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_histogram<span class="dp">·</span>import<span class="dp">·</span>FeatureHistogram</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_histogram<span class="dp">·</span>import<span class="dp">·</span>FeatureHistogram</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_importance<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.feature_importance<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FeatureImportance,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FeatureImportance,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">)</td><td class="diffline">28 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.node<span class="dp">·</span>import<span class="dp">·</span>Node</td><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.node<span class="dp">·</span>import<span class="dp">·</span>Node</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.splitter<span class="dp">·</span>import<span class="dp">·</span>SplitInfo,<span class="dp">·</span>Splitter</td><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_core.splitter<span class="dp">·</span>import<span class="dp">·</span>SplitInfo,<span class="dp">·</span>Splitter</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_param<span class="dp">·</span>import<span class="dp">·</span>TreeParam</td><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.boost.homo_boost.tree_param<span class="dp">·</span>import<span class="dp">·</span>TreeParam</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">951 B</span></div>
    <div id="secretflow-ml-boost-homo_boost-tree_core-feature_histogram.py"><span class="source">secretflow/ml/boost/homo_boost/tree_core/feature_histogram.py</span>
      <a class="anchor" href="#secretflow-ml-boost-homo_boost-tree_core-feature_histogram.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 23 lines modified</td><td colspan="2">Offset 12, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>operator<span class="dp">·</span>import<span class="dp">·</span>add,<span class="dp">·</span>sub</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>concurrent.futures<span class="dp">·</span>import<span class="dp">·</span>ThreadPoolExecutor</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>concurrent.futures<span class="dp">·</span>import<span class="dp">·</span>ThreadPoolExecutor</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>operator<span class="dp">·</span>import<span class="dp">·</span>add,<span class="dp">·</span>sub</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>numpy</td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>pandas</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>pandas</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">@dataclass()</td><td class="diffline">26 </td><td class="diffpresent">@dataclass()</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">class<span class="dp">·</span>HistogramBag(object):</td><td class="diffline">27 </td><td class="diffpresent">class<span class="dp">·</span>HistogramBag(object):</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Histogram<span class="dp">·</span>container</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Histogram<span class="dp">·</span>container</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">542 B</span></div>
    <div id="secretflow-ml-boost-ss_xgb_v-__init__.py"><span class="source">secretflow/ml/boost/ss_xgb_v/__init__.py</span>
      <a class="anchor" href="#secretflow-ml-boost-ss_xgb_v-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 13 lines modified</td><td colspan="2">Offset 8, 13 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.model<span class="dp">·</span>import<span class="dp">·</span>Xgb<del>Model,<span class="dp">·</span>Xgb</del></td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.model<span class="dp">·</span>import<span class="dp">·</span>Xgb<ins>,<span class="dp">·</span>XgbModel</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;XgbModel&#x27;,</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;XgbModel&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;Xgb&#x27;,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;Xgb&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">]</td><td class="diffline">18 </td><td class="diffpresent">]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.8 KB</span></div>
    <div id="secretflow-ml-boost-ss_xgb_v-model.py"><span class="source">secretflow/ml/boost/ss_xgb_v/model.py</span>
      <a class="anchor" href="#secretflow-ml-boost-ss_xgb_v-model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 27, 15 lines modified</td><td colspan="2">Offset 27, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUCompilerNumReturnsPolicy,</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUCompilerNumReturnsPolicy,</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">)</td><td class="diffline">33 </td><td class="diffpresent">)</td></tr>
<tr class="diffdeleted"><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.base<span class="dp">·</span>import<span class="dp">·</span>MoveConfig</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">from<span class="dp">·</span>.core<span class="dp">·</span>import<span class="dp">·</span>node_split<span class="dp">·</span>as<span class="dp">·</span>split_fn</td><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>.core<span class="dp">·</span>import<span class="dp">·</span>node_split<span class="dp">·</span>as<span class="dp">·</span>split_fn</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>.core.node_split<span class="dp">·</span>import<span class="dp">·</span>RegType</td><td class="diffline">35 </td><td class="diffpresent">from<span class="dp">·</span>.core.node_split<span class="dp">·</span>import<span class="dp">·</span>RegType</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>.core.tree_worker<span class="dp">·</span>import<span class="dp">·</span>XgbTreeWorker<span class="dp">·</span>as<span class="dp">·</span>Worker</td><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>.core.tree_worker<span class="dp">·</span>import<span class="dp">·</span>XgbTreeWorker<span class="dp">·</span>as<span class="dp">·</span>Worker</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>prepare_dataset</td><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>prepare_dataset</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 323, 17 lines modified</td><td colspan="2">Offset 322, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(self.y)<span class="dp">·</span>==<span class="dp">·</span>len(self.pred)</td><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(self.y)<span class="dp">·</span>==<span class="dp">·</span>len(self.pred)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.colsample<span class="dp">·</span>&lt;<span class="dp">·</span>1:</td><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.colsample<span class="dp">·</span>&lt;<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>spu<span class="dp">·</span>in<span class="dp">·</span>self.spu:</td><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>spu<span class="dp">·</span>in<span class="dp">·</span>self.spu:</td></tr>
<tr class="diffdeleted"><td class="diffline">328 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>choices<span class="dp">·</span>=<span class="dp">·</span>[</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">329 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span></del><span class="dp">·</span><del><span class="dp">·</span></del>c.to(spu,<span class="dp">·</span><del>MoveConfig(</del>spu_vis=&#x27;public&#x27;<del>)</del>)<span class="dp">·</span>for<span class="dp">·</span>c<span class="dp">·</span>in<span class="dp">·</span>col_buckets_choices</td><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>choices</ins><span class="dp">·</span><ins>=</ins><span class="dp">·</span><ins>[</ins>c.to(spu,<span class="dp">·</span>spu_vis=&#x27;public&#x27;)<span class="dp">·</span>for<span class="dp">·</span>c<span class="dp">·</span>in<span class="dp">·</span>col_buckets_choices<ins>]</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">330 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">331 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_choices<span class="dp">·</span>=<span class="dp">·</span>spu(lambda<span class="dp">·</span>c:<span class="dp">·</span>jnp.concatenate(c,<span class="dp">·</span>axis=None))(choices)</td><td class="diffline">328 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_choices<span class="dp">·</span>=<span class="dp">·</span>spu(lambda<span class="dp">·</span>c:<span class="dp">·</span>jnp.concatenate(c,<span class="dp">·</span>axis=None))(choices)</td></tr>
<tr class="diffunmodified"><td class="diffline">332 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices.append(spu_choices)</td><td class="diffline">329 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices.append(spu_choices)</td></tr>
<tr class="diffunmodified"><td class="diffline">333 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">330 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">334 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices<span class="dp">·</span>=<span class="dp">·</span>[None]<span class="dp">·</span>*<span class="dp">·</span>self.spus</td><td class="diffline">331 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.col_choices<span class="dp">·</span>=<span class="dp">·</span>[None]<span class="dp">·</span>*<span class="dp">·</span>self.spus</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">335 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.sub_choices<span class="dp">·</span>=<span class="dp">·</span>list()</td><td class="diffline">332 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.sub_choices<span class="dp">·</span>=<span class="dp">·</span>list()</td></tr>
<tr class="diffunmodified"><td class="diffline">336 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.ghs<span class="dp">·</span>=<span class="dp">·</span>list()</td><td class="diffline">333 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.ghs<span class="dp">·</span>=<span class="dp">·</span>list()</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 348, 15 lines modified</td><td colspan="2">Offset 345, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">348 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>choices<span class="dp">·</span>&gt;<span class="dp">·</span>0,<span class="dp">·</span>f&quot;subsample<span class="dp">·</span>{self.subsample}<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>small&quot;</td><td class="diffline">345 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>choices<span class="dp">·</span>&gt;<span class="dp">·</span>0,<span class="dp">·</span>f&quot;subsample<span class="dp">·</span>{self.subsample}<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>small&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">349 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>choices<span class="dp">·</span>&lt;<span class="dp">·</span>samples:</td><td class="diffline">346 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>choices<span class="dp">·</span>&lt;<span class="dp">·</span>samples:</td></tr>
<tr class="diffunmodified"><td class="diffline">350 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>self.workers[0].device(</td><td class="diffline">347 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>self.workers[0].device(</td></tr>
<tr class="diffunmodified"><td class="diffline">351 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>s,<span class="dp">·</span>c:<span class="dp">·</span>np.sort(np.random.choice(s,<span class="dp">·</span>c,<span class="dp">·</span>replace=False))</td><td class="diffline">348 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda<span class="dp">·</span>s,<span class="dp">·</span>c:<span class="dp">·</span>np.sort(np.random.choice(s,<span class="dp">·</span>c,<span class="dp">·</span>replace=False))</td></tr>
<tr class="diffunmodified"><td class="diffline">352 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)(samples,<span class="dp">·</span>choices)</td><td class="diffline">349 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)(samples,<span class="dp">·</span>choices)</td></tr>
<tr class="diffunmodified"><td class="diffline">353 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>same<span class="dp">·</span>as<span class="dp">·</span>colsample<span class="dp">·</span>above,<span class="dp">·</span>keep<span class="dp">·</span>choices<span class="dp">·</span>in<span class="dp">·</span>public.</td><td class="diffline">350 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>same<span class="dp">·</span>as<span class="dp">·</span>colsample<span class="dp">·</span>above,<span class="dp">·</span>keep<span class="dp">·</span>choices<span class="dp">·</span>in<span class="dp">·</span>public.</td></tr>
<tr class="diffchanged"><td class="diffline">354 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>sub_choices.to(spu,<span class="dp">·</span><del>MoveConfig(</del>spu_vis=&#x27;public&#x27;<del>)</del>)</td><td class="diffline">351 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>sub_choices.to(spu,<span class="dp">·</span>spu_vis=&#x27;public&#x27;)</td></tr>
<tr class="diffunmodified"><td class="diffline">355 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">352 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">356 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">353 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">357 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gh<span class="dp">·</span>=<span class="dp">·</span>spu(split_fn.tree_setup,<span class="dp">·</span>static_argnames=(&quot;objective&quot;),)(</td><td class="diffline">354 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gh<span class="dp">·</span>=<span class="dp">·</span>spu(split_fn.tree_setup,<span class="dp">·</span>static_argnames=(&quot;objective&quot;),)(</td></tr>
<tr class="diffunmodified"><td class="diffline">358 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pred,</td><td class="diffline">355 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pred,</td></tr>
<tr class="diffunmodified"><td class="diffline">359 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y,</td><td class="diffline">356 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y,</td></tr>
<tr class="diffunmodified"><td class="diffline">360 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices,</td><td class="diffline">357 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sub_choices,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">676 B</span></div>
    <div id="secretflow-ml-boost-ss_xgb_v-core-node_split.py"><span class="source">secretflow/ml/boost/ss_xgb_v/core/node_split.py</span>
      <a class="anchor" href="#secretflow-ml-boost-ss_xgb_v-core-node_split.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 17 lines modified</td><td colspan="2">Offset 9, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils<span class="dp">·</span>import<span class="dp">·</span>sigmoid<span class="dp">·</span>as<span class="dp">·</span>appr_sig</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils<span class="dp">·</span>import<span class="dp">·</span>sigmoid<span class="dp">·</span>as<span class="dp">·</span>appr_sig</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">@unique</td><td class="diffline">19 </td><td class="diffpresent">@unique</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>RegType(Enum):</td><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>RegType(Enum):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.55 KB</span></div>
    <div id="secretflow-ml-boost-ss_xgb_v-core-tree_worker.py"><span class="source">secretflow/ml/boost/ss_xgb_v/core/tree_worker.py</span>
      <a class="anchor" href="#secretflow-ml-boost-ss_xgb_v-core-tree_worker.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 19 lines modified</td><td colspan="2">Offset 9, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffchanged"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>T</del><del>uple</del>,<span class="dp">·</span><del>List</del></td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>List</ins>,<span class="dp">·</span><ins>T</ins><ins>uple</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span><del>.xgb_t</del><del>r</del>e<del>e</del><span class="dp">·</span>import<span class="dp">·</span><del>XgbTree</del></td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span><ins>h</ins>e<ins>u</ins><span class="dp">·</span>import<span class="dp">·</span><ins>numpy</ins><ins><span class="dp">·</span>as<span class="dp">·</span>hnp</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.xgb_tree<span class="dp">·</span>import<span class="dp">·</span>XgbTree</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">@proxy(PYUObject)</td><td class="diffline">20 </td><td class="diffpresent">@proxy(PYUObject)</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>XgbTreeWorker:</td><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>XgbTreeWorker:</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>XGB<span class="dp">·</span>model.</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>XGB<span class="dp">·</span>model.</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>do<span class="dp">·</span>some<span class="dp">·</span>compute<span class="dp">·</span>works<span class="dp">·</span>that<span class="dp">·</span>only<span class="dp">·</span>use<span class="dp">·</span>one<span class="dp">·</span>partition&#x27;<span class="dp">·</span>dataset.</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>do<span class="dp">·</span>some<span class="dp">·</span>compute<span class="dp">·</span>works<span class="dp">·</span>that<span class="dp">·</span>only<span class="dp">·</span>use<span class="dp">·</span>one<span class="dp">·</span>partition&#x27;<span class="dp">·</span>dataset.</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 37, 44 lines modified</td><td colspan="2">Offset 41, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>dataset<span class="dp">·</span>from<span class="dp">·</span>this<span class="dp">·</span>partition.</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>dataset<span class="dp">·</span>from<span class="dp">·</span>this<span class="dp">·</span>partition.</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tree:<span class="dp">·</span>tree<span class="dp">·</span>model<span class="dp">·</span>store<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>partition.</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tree:<span class="dp">·</span>tree<span class="dp">·</span>model<span class="dp">·</span>store<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>partition.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>leaf<span class="dp">·</span>nodes&#x27;<span class="dp">·</span>selects</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>leaf<span class="dp">·</span>nodes&#x27;<span class="dp">·</span>selects</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>x<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.ndarray)<span class="dp">·</span>else<span class="dp">·</span>np.array(x)</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>x<span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>np.ndarray)<span class="dp">·</span>else<span class="dp">·</span>np.array(x)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>hnp.tree_predict(x,<span class="dp">·</span>tree.split_features,<span class="dp">·</span>tree.split_values)</td></tr>
<tr class="diffdeleted"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>split_nodes<span class="dp">·</span>=<span class="dp">·</span>len(tree.split_features)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>select<span class="dp">·</span>=<span class="dp">·</span>np.zeros((x.shape[0],<span class="dp">·</span>split_nodes<span class="dp">·</span>+<span class="dp">·</span>1),<span class="dp">·</span>dtype=np.int8)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>should<span class="dp">·</span>parallel<span class="dp">·</span>in<span class="dp">·</span>c++</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>r<span class="dp">·</span>in<span class="dp">·</span>range(x.shape[0]):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>row<span class="dp">·</span>=<span class="dp">·</span>x[r,<span class="dp">·</span>:]</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs<span class="dp">·</span>=<span class="dp">·</span>list()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs.append(0)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>len(idxs):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx<span class="dp">·</span>=<span class="dp">·</span>idxs.pop(0)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>idx<span class="dp">·</span>&lt;<span class="dp">·</span>split_nodes:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f<span class="dp">·</span>=<span class="dp">·</span>tree.split_features[idx]</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>v<span class="dp">·</span>=<span class="dp">·</span>tree.split_values[idx]</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>f<span class="dp">·</span>==<span class="dp">·</span>-1:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>if<span class="dp">·</span>node<span class="dp">·</span>split<span class="dp">·</span>by<span class="dp">·</span>others<span class="dp">·</span>partition&#x27;s<span class="dp">·</span>feature</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>mark<span class="dp">·</span>all<span class="dp">·</span>split<span class="dp">·</span>paths<span class="dp">·</span>in<span class="dp">·</span>tree.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs.append(idx<span class="dp">·</span>*<span class="dp">·</span>2<span class="dp">·</span>+<span class="dp">·</span>1)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs.append(idx<span class="dp">·</span>*<span class="dp">·</span>2<span class="dp">·</span>+<span class="dp">·</span>2)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>if<span class="dp">·</span>node<span class="dp">·</span>split<span class="dp">·</span>by<span class="dp">·</span>this<span class="dp">·</span>partition&#x27;s<span class="dp">·</span>feature</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>mark<span class="dp">·</span>the<span class="dp">·</span>clearly<span class="dp">·</span>split<span class="dp">·</span>path<span class="dp">·</span>in<span class="dp">·</span>tree.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>row[f]<span class="dp">·</span>&lt;<span class="dp">·</span>v:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs.append(idx<span class="dp">·</span>*<span class="dp">·</span>2<span class="dp">·</span>+<span class="dp">·</span>1)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idxs.append(idx<span class="dp">·</span>*<span class="dp">·</span>2<span class="dp">·</span>+<span class="dp">·</span>2)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>leaf_idx<span class="dp">·</span>=<span class="dp">·</span>idx<span class="dp">·</span>-<span class="dp">·</span>split_nodes</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>select[r,<span class="dp">·</span>leaf_idx]<span class="dp">·</span>=<span class="dp">·</span>1</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>select</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_qcut(self,<span class="dp">·</span>x:<span class="dp">·</span>np.ndarray)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[np.ndarray,<span class="dp">·</span>List]:</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_qcut(self,<span class="dp">·</span>x:<span class="dp">·</span>np.ndarray)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[np.ndarray,<span class="dp">·</span>List]:</td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sorted_x<span class="dp">·</span>=<span class="dp">·</span>np.sort(x,<span class="dp">·</span>axis=0)</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sorted_x<span class="dp">·</span>=<span class="dp">·</span>np.sort(x,<span class="dp">·</span>axis=0)</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>samples<span class="dp">·</span>=<span class="dp">·</span>len(sorted_x)</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>samples<span class="dp">·</span>=<span class="dp">·</span>len(sorted_x)</td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remained_count<span class="dp">·</span>=<span class="dp">·</span>samples</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remained_count<span class="dp">·</span>=<span class="dp">·</span>samples</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>remained_count<span class="dp">·</span>&gt;<span class="dp">·</span>0,<span class="dp">·</span>&#x27;can<span class="dp">·</span>not<span class="dp">·</span>qcut<span class="dp">·</span>empty<span class="dp">·</span>x&#x27;</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>remained_count<span class="dp">·</span>&gt;<span class="dp">·</span>0,<span class="dp">·</span>&#x27;can<span class="dp">·</span>not<span class="dp">·</span>qcut<span class="dp">·</span>empty<span class="dp">·</span>x&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.33 KB</span></div>
    <div id="secretflow-ml-boost-ss_xgb_v-core-utils.py"><span class="source">secretflow/ml/boost/ss_xgb_v/core/utils.py</span>
      <a class="anchor" href="#secretflow-ml-boost-ss_xgb_v-core-utils.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 21 lines modified</td><td colspan="2">Offset 8, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union,<span class="dp">·</span>Tuple</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">def<span class="dp">·</span>prepare_dataset(</td><td class="diffline">18 </td><td class="diffpresent">def<span class="dp">·</span>prepare_dataset(</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds:<span class="dp">·</span>Union[FedNdarray,<span class="dp">·</span>VDataFrame]</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds:<span class="dp">·</span>Union[FedNdarray,<span class="dp">·</span>VDataFrame]</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[FedNdarray,<span class="dp">·</span>Tuple[int,<span class="dp">·</span>int]]:</td><td class="diffline">20 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[FedNdarray,<span class="dp">·</span>Tuple[int,<span class="dp">·</span>int]]:</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>check<span class="dp">·</span>data<span class="dp">·</span>setting<span class="dp">·</span>and<span class="dp">·</span>get<span class="dp">·</span>total<span class="dp">·</span>shape.</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>check<span class="dp">·</span>data<span class="dp">·</span>setting<span class="dp">·</span>and<span class="dp">·</span>get<span class="dp">·</span>total<span class="dp">·</span>shape.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 37, 14 lines modified</td><td colspan="2">Offset 36, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds,<span class="dp">·</span>(FedNdarray,<span class="dp">·</span>VDataFrame)</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds,<span class="dp">·</span>(FedNdarray,<span class="dp">·</span>VDataFrame)</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;ds<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>FedNdarray<span class="dp">·</span>or<span class="dp">·</span>VDataFrame,<span class="dp">·</span>got<span class="dp">·</span>{type(ds)}&quot;</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;ds<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>FedNdarray<span class="dp">·</span>or<span class="dp">·</span>VDataFrame,<span class="dp">·</span>got<span class="dp">·</span>{type(ds)}&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds<span class="dp">·</span>=<span class="dp">·</span>ds<span class="dp">·</span>if<span class="dp">·</span>isinstance(ds,<span class="dp">·</span>FedNdarray)<span class="dp">·</span>else<span class="dp">·</span>ds.values</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ds<span class="dp">·</span>=<span class="dp">·</span>ds<span class="dp">·</span>if<span class="dp">·</span>isinstance(ds,<span class="dp">·</span>FedNdarray)<span class="dp">·</span>else<span class="dp">·</span>ds.values</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>ds.partition_way<span class="dp">·</span>==<span class="dp">·</span>PartitionWay.VERTICAL,<span class="dp">·</span>(</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>ds.partition_way<span class="dp">·</span>==<span class="dp">·</span>PartitionWay.VERTICAL,<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;SS<span class="dp">·</span>XGB<span class="dp">·</span>Only<span class="dp">·</span>support<span class="dp">·</span>vertical<span class="dp">·</span>dataset,<span class="dp">·</span>&quot;</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;SS<span class="dp">·</span>XGB<span class="dp">·</span>Only<span class="dp">·</span>support<span class="dp">·</span>vertical<span class="dp">·</span>dataset,<span class="dp">·</span>&quot;</td></tr>
<tr class="diffchanged"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;for<span class="dp">·</span>horizontal<span class="dp">·</span>dataset<span class="dp">·</span>please<span class="dp">·</span>use<span class="dp">·</span>secreflow.ml.boost.homo_boost&quot;</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;for<span class="dp">·</span>horizontal<span class="dp">·</span>dataset<span class="dp">·</span>please<span class="dp">·</span>use<span class="dp">·</span>secre<ins>t</ins>flow.ml.boost.homo_boost&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shape<span class="dp">·</span>=<span class="dp">·</span>ds.shape</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shape<span class="dp">·</span>=<span class="dp">·</span>ds.shape</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>math.prod(shape),<span class="dp">·</span>f&quot;not<span class="dp">·</span>support<span class="dp">·</span>empty<span class="dp">·</span>dataset,<span class="dp">·</span>shape<span class="dp">·</span>{shape}&quot;</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>math.prod(shape),<span class="dp">·</span>f&quot;not<span class="dp">·</span>support<span class="dp">·</span>empty<span class="dp">·</span>dataset,<span class="dp">·</span>shape<span class="dp">·</span>{shape}&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>ds,<span class="dp">·</span>shape</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>ds,<span class="dp">·</span>shape</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">736 B</span></div>
    <div id="secretflow-ml-linear-__init__.py"><span class="source">secretflow/ml/linear/__init__.py</span>
      <a class="anchor" href="#secretflow-ml-linear-__init__.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 11, 17 lines modified</td><td colspan="2">Offset 11, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fl_lr_mix<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionMix</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fl_lr_mix<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionMix</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fl_lr_v<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionVertical</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fl_lr_v<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionVertical</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.hess_sgd<span class="dp">·</span>import<span class="dp">·</span>HESSLogisticRegression</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.hess_sgd<span class="dp">·</span>import<span class="dp">·</span>HESSLogisticRegression</td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.ss_sgd<span class="dp">·</span>import<span class="dp">·</span>SSRegression</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.linear_model<span class="dp">·</span>import<span class="dp">·</span>LinearModel,<span class="dp">·</span>RegType</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.linear_model<span class="dp">·</span>import<span class="dp">·</span>LinearModel,<span class="dp">·</span>RegType</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.ss_glm<span class="dp">·</span>import<span class="dp">·</span>SSGLM</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.ss_glm<span class="dp">·</span>import<span class="dp">·</span>SSGLM</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.ss_sgd<span class="dp">·</span>import<span class="dp">·</span>SSRegression</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;FlLogisticRegressionMix&#x27;,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;FlLogisticRegressionMix&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;FlLogisticRegressionVertical&#x27;,</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;FlLogisticRegressionVertical&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;HESSLogisticRegression&#x27;,</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;HESSLogisticRegression&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSRegression&#x27;,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSRegression&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;LinearModel&#x27;,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;LinearModel&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.02 KB</span></div>
    <div id="secretflow-ml-linear-fl_lr_mix.py"><span class="source">secretflow/ml/linear/fl_lr_mix.py</span>
      <a class="anchor" href="#secretflow-ml-linear-fl_lr_mix.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 11, 28 lines modified</td><td colspan="2">Offset 11, 28 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Optional</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Optional</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>spu</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>spu</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow<span class="dp">·</span>import<span class="dp">·</span>reveal</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow<span class="dp">·</span>import<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix.dataframe<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix.dataframe<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device<span class="dp">·</span>import<span class="dp">·</span>PYU</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.heu<span class="dp">·</span>import<span class="dp">·</span>HEU</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.heu<span class="dp">·</span>import<span class="dp">·</span>HEU</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.fl_lr_v<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionVertical</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.fl_lr_v<span class="dp">·</span>import<span class="dp">·</span>FlLogisticRegressionVertical</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator,<span class="dp">·</span>SecureAggregator</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator,<span class="dp">·</span>SecureAggregator</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device<span class="dp">·</span>import<span class="dp">·</span>PYU</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">class<span class="dp">·</span>_CustomSecureAggregator(SecureAggregator):</td><td class="diffline">28 </td><td class="diffpresent">class<span class="dp">·</span>_CustomSecureAggregator(SecureAggregator):</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;This<span class="dp">·</span>aggregator<span class="dp">·</span>is<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>secure<span class="dp">·</span>aggregator</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;This<span class="dp">·</span>aggregator<span class="dp">·</span>is<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>secure<span class="dp">·</span>aggregator</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>this<span class="dp">·</span>aggregator<span class="dp">·</span>supports<span class="dp">·</span>multi<span class="dp">·</span>inputs<span class="dp">·</span>from<span class="dp">·</span>one<span class="dp">·</span>device.</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>this<span class="dp">·</span>aggregator<span class="dp">·</span>supports<span class="dp">·</span>multi<span class="dp">·</span>inputs<span class="dp">·</span>from<span class="dp">·</span>one<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>multi<span class="dp">·</span>inputs<span class="dp">·</span>from<span class="dp">·</span>same<span class="dp">·</span>device<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>aggregated<span class="dp">·</span>first<span class="dp">·</span>and<span class="dp">·</span>secure</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>multi<span class="dp">·</span>inputs<span class="dp">·</span>from<span class="dp">·</span>same<span class="dp">·</span>device<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>aggregated<span class="dp">·</span>first<span class="dp">·</span>and<span class="dp">·</span>secure</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aggregation<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>executed<span class="dp">·</span>then.</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aggregation<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>executed<span class="dp">·</span>then.</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 167, 15 lines modified</td><td colspan="2">Offset 167, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>0.1,</td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>0.1,</td></tr>
<tr class="diffunmodified"><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>agg_epochs:<span class="dp">·</span>Optional[int]<span class="dp">·</span>=<span class="dp">·</span>1,</td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>agg_epochs:<span class="dp">·</span>Optional[int]<span class="dp">·</span>=<span class="dp">·</span>1,</td></tr>
<tr class="diffunmodified"><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>audit_log_dir:<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>str]<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>audit_log_dir:<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>str]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffunmodified"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Fit<span class="dp">·</span>the<span class="dp">·</span>model.</td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Fit<span class="dp">·</span>the<span class="dp">·</span>model.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffchanged"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>train<del>n</del>ing<span class="dp">·</span>vector.<span class="dp">·</span>X<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>horizontal<span class="dp">·</span>partitioned</td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>training<span class="dp">·</span>vector.<span class="dp">·</span>X<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>horizontal<span class="dp">·</span>partitioned</td></tr>
<tr class="diffunmodified"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:py:class:`~secretflow.data.mix.MixDataFrame`,<span class="dp">·</span>which<span class="dp">·</span>consists</td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:py:class:`~secretflow.data.mix.MixDataFrame`,<span class="dp">·</span>which<span class="dp">·</span>consists</td></tr>
<tr class="diffunmodified"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>of<span class="dp">·</span>:py:class:`~secretflow.data.vertical.VDataFrame`s.</td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>of<span class="dp">·</span>:py:class:`~secretflow.data.vertical.VDataFrame`s.</td></tr>
<tr class="diffunmodified"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>target<span class="dp">·</span>vector<span class="dp">·</span>relative<span class="dp">·</span>to<span class="dp">·</span>x.<span class="dp">·</span>Y<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>horizontal<span class="dp">·</span>partitioned</td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>target<span class="dp">·</span>vector<span class="dp">·</span>relative<span class="dp">·</span>to<span class="dp">·</span>x.<span class="dp">·</span>Y<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>horizontal<span class="dp">·</span>partitioned</td></tr>
<tr class="diffunmodified"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:py:class:`~secretflow.data.mix.MixDataFrame`<span class="dp">·</span>alos.<span class="dp">·</span>X<span class="dp">·</span>and<span class="dp">·</span>y</td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:py:class:`~secretflow.data.mix.MixDataFrame`<span class="dp">·</span>alos.<span class="dp">·</span>X<span class="dp">·</span>and<span class="dp">·</span>y</td></tr>
<tr class="diffunmodified"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>should<span class="dp">·</span>have<span class="dp">·</span>the<span class="dp">·</span>same<span class="dp">·</span>amount<span class="dp">·</span>of<span class="dp">·</span>`VDataFrame`s.</td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>should<span class="dp">·</span>have<span class="dp">·</span>the<span class="dp">·</span>same<span class="dp">·</span>amount<span class="dp">·</span>of<span class="dp">·</span>`VDataFrame`s.</td></tr>
<tr class="diffunmodified"><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>samples<span class="dp">·</span>per<span class="dp">·</span>gradient<span class="dp">·</span>update.</td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>samples<span class="dp">·</span>per<span class="dp">·</span>gradient<span class="dp">·</span>update.</td></tr>
<tr class="diffunmodified"><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>epochs<span class="dp">·</span>to<span class="dp">·</span>train<span class="dp">·</span>the<span class="dp">·</span>model.</td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>epochs<span class="dp">·</span>to<span class="dp">·</span>train<span class="dp">·</span>the<span class="dp">·</span>model.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.96 KB</span></div>
    <div id="secretflow-ml-linear-fl_lr_v.py"><span class="source">secretflow/ml/linear/fl_lr_v.py</span>
      <a class="anchor" href="#secretflow-ml-linear-fl_lr_v.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 22, 16 lines modified</td><td colspan="2">Offset 22, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>numpy.random<span class="dp">·</span>import<span class="dp">·</span>RandomState</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>numpy.random<span class="dp">·</span>import<span class="dp">·</span>RandomState</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow<span class="dp">·</span>import<span class="dp">·</span>reveal</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow<span class="dp">·</span>import<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical.dataframe<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical.dataframe<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>proxy</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>proxy</td></tr>
<tr class="diffchanged"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<del>b</del><del>ase</del><span class="dp">·</span>import<span class="dp">·</span>MoveConfig</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<ins>heu</ins><span class="dp">·</span>import<ins><span class="dp">·</span>HEU,</ins><span class="dp">·</span><ins>HEU</ins>MoveConfig</td></tr>
<tr class="diffdeleted"><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.heu<span class="dp">·</span>import<span class="dp">·</span>HEU</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject</td><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation.aggregator<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation.aggregator<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">class<span class="dp">·</span>FlLrVWorker(object):</td><td class="diffline">32 </td><td class="diffpresent">class<span class="dp">·</span>FlLrVWorker(object):</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_data_generator(</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_data_generator(</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 362, 15 lines modified</td><td colspan="2">Offset 361, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">362 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>int,</td><td class="diffline">361 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>int,</td></tr>
<tr class="diffunmodified"><td class="diffline">363 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tol:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>1e-4,</td><td class="diffline">362 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tol:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>1e-4,</td></tr>
<tr class="diffunmodified"><td class="diffline">364 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>0.1,</td><td class="diffline">363 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>Optional[float]<span class="dp">·</span>=<span class="dp">·</span>0.1,</td></tr>
<tr class="diffunmodified"><td class="diffline">365 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td class="diffline">364 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffunmodified"><td class="diffline">366 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Fit<span class="dp">·</span>the<span class="dp">·</span>model.</td><td class="diffline">365 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Fit<span class="dp">·</span>the<span class="dp">·</span>model.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">367 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">366 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffchanged"><td class="diffline">368 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>train<del>n</del>ing<span class="dp">·</span>vector.</td><td class="diffline">367 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>training<span class="dp">·</span>vector.</td></tr>
<tr class="diffunmodified"><td class="diffline">369 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>target<span class="dp">·</span>vector<span class="dp">·</span>relative<span class="dp">·</span>to<span class="dp">·</span>x.</td><td class="diffline">368 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>target<span class="dp">·</span>vector<span class="dp">·</span>relative<span class="dp">·</span>to<span class="dp">·</span>x.</td></tr>
<tr class="diffunmodified"><td class="diffline">370 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>samples<span class="dp">·</span>per<span class="dp">·</span>gradient<span class="dp">·</span>update.</td><td class="diffline">369 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>samples<span class="dp">·</span>per<span class="dp">·</span>gradient<span class="dp">·</span>update.</td></tr>
<tr class="diffunmodified"><td class="diffline">371 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>epochs<span class="dp">·</span>to<span class="dp">·</span>train<span class="dp">·</span>the<span class="dp">·</span>model.</td><td class="diffline">370 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs:<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>epochs<span class="dp">·</span>to<span class="dp">·</span>train<span class="dp">·</span>the<span class="dp">·</span>model.</td></tr>
<tr class="diffunmodified"><td class="diffline">372 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tol:<span class="dp">·</span>optional,<span class="dp">·</span>tolerance<span class="dp">·</span>for<span class="dp">·</span>stopping<span class="dp">·</span>criteria.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>1e-4.</td><td class="diffline">371 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tol:<span class="dp">·</span>optional,<span class="dp">·</span>tolerance<span class="dp">·</span>for<span class="dp">·</span>stopping<span class="dp">·</span>criteria.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>1e-4.</td></tr>
<tr class="diffunmodified"><td class="diffline">373 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>optional,<span class="dp">·</span>learning<span class="dp">·</span>rate.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>0.1.</td><td class="diffline">372 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>optional,<span class="dp">·</span>learning<span class="dp">·</span>rate.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>0.1.</td></tr>
<tr class="diffunmodified"><td class="diffline">374 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">373 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">375 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td class="diffline">374 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 465, 34 lines modified</td><td colspan="2">Offset 464, 34 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">465 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>(device,<span class="dp">·</span>worker)<span class="dp">·</span>in<span class="dp">·</span>enumerate(self.workers.items()):</td><td class="diffline">464 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>(device,<span class="dp">·</span>worker)<span class="dp">·</span>in<span class="dp">·</span>enumerate(self.workers.items()):</td></tr>
<tr class="diffunmodified"><td class="diffline">466 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>==<span class="dp">·</span>self.y_device:</td><td class="diffline">465 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>==<span class="dp">·</span>self.y_device:</td></tr>
<tr class="diffunmodified"><td class="diffline">467 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>continue</td><td class="diffline">466 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>continue</td></tr>
<tr class="diffunmodified"><td class="diffline">468 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>step<span class="dp">·</span>2:<span class="dp">·</span>current<span class="dp">·</span>device<span class="dp">·</span>compute<span class="dp">·</span>the<span class="dp">·</span>gradients<span class="dp">·</span>locally,</td><td class="diffline">467 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>step<span class="dp">·</span>2:<span class="dp">·</span>current<span class="dp">·</span>device<span class="dp">·</span>compute<span class="dp">·</span>the<span class="dp">·</span>gradients<span class="dp">·</span>locally,</td></tr>
<tr class="diffunmodified"><td class="diffline">469 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>and<span class="dp">·</span>add<span class="dp">·</span>mask<span class="dp">·</span>and<span class="dp">·</span>send<span class="dp">·</span>to<span class="dp">·</span>y<span class="dp">·</span>device.</td><td class="diffline">468 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>and<span class="dp">·</span>add<span class="dp">·</span>mask<span class="dp">·</span>and<span class="dp">·</span>send<span class="dp">·</span>to<span class="dp">·</span>y<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td class="diffline">470 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_heu<span class="dp">·</span>=<span class="dp">·</span>worker.encode(x_batchs[i],<span class="dp">·</span>self.fxp_bits).to(</td><td class="diffline">469 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_heu<span class="dp">·</span>=<span class="dp">·</span>worker.encode(x_batchs[i],<span class="dp">·</span>self.fxp_bits).to(</td></tr>
<tr class="diffunmodified"><td class="diffline">471 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td><td class="diffline">470 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td></tr>
<tr class="diffchanged"><td class="diffline">472 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>MoveConfig(</td><td class="diffline">471 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>HEU</ins>MoveConfig(</td></tr>
<tr class="diffunmodified"><td class="diffline">473 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td><td class="diffline">472 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td></tr>
<tr class="diffunmodified"><td class="diffline">474 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_encoder=phe.FloatEncoder(self.heu.schema,<span class="dp">·</span>1),</td><td class="diffline">473 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_encoder=phe.FloatEncoder(self.heu.schema,<span class="dp">·</span>1),</td></tr>
<tr class="diffunmodified"><td class="diffline">475 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td><td class="diffline">474 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td></tr>
<tr class="diffunmodified"><td class="diffline">476 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;masked_g&#x27;</td><td class="diffline">475 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;masked_g&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">477 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">476 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">478 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">477 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">479 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">478 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">480 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r_heu<span class="dp">·</span>=<span class="dp">·</span>r.to(</td><td class="diffline">479 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r_heu<span class="dp">·</span>=<span class="dp">·</span>r.to(</td></tr>
<tr class="diffunmodified"><td class="diffline">481 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td><td class="diffline">480 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td></tr>
<tr class="diffchanged"><td class="diffline">482 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>MoveConfig(</td><td class="diffline">481 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>HEU</ins>MoveConfig(</td></tr>
<tr class="diffunmodified"><td class="diffline">483 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td><td class="diffline">482 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td></tr>
<tr class="diffunmodified"><td class="diffline">484 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td><td class="diffline">483 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td></tr>
<tr class="diffunmodified"><td class="diffline">485 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;residual&#x27;</td><td class="diffline">484 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;residual&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">486 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">485 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">487 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">486 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">488 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">487 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">489 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>m_heu<span class="dp">·</span>=<span class="dp">·</span>worker.generate_rand_mask(self.fxp_bits).to(</td><td class="diffline">488 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>m_heu<span class="dp">·</span>=<span class="dp">·</span>worker.generate_rand_mask(self.fxp_bits).to(</td></tr>
<tr class="diffunmodified"><td class="diffline">490 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td><td class="diffline">489 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.heu,</td></tr>
<tr class="diffchanged"><td class="diffline">491 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>MoveConfig(</td><td class="diffline">490 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>HEU</ins>MoveConfig(</td></tr>
<tr class="diffunmodified"><td class="diffline">492 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td><td class="diffline">491 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_dest_party=device.party,</td></tr>
<tr class="diffunmodified"><td class="diffline">493 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td><td class="diffline">492 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>heu_audit_log=_gen_auth_file_path(</td></tr>
<tr class="diffunmodified"><td class="diffline">494 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;rand_mask&#x27;</td><td class="diffline">493 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.audit_log_dir,<span class="dp">·</span>device,<span class="dp">·</span>epoch,<span class="dp">·</span>step,<span class="dp">·</span>&#x27;rand_mask&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">495 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">494 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">496 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">495 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">497 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">496 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">498 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>maskg_heu<span class="dp">·</span>=<span class="dp">·</span>r_heu<span class="dp">·</span>@<span class="dp">·</span>x_heu<span class="dp">·</span>+<span class="dp">·</span>m_heu</td><td class="diffline">497 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>maskg_heu<span class="dp">·</span>=<span class="dp">·</span>r_heu<span class="dp">·</span>@<span class="dp">·</span>x_heu<span class="dp">·</span>+<span class="dp">·</span>m_heu</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.95 KB</span></div>
    <div id="secretflow-ml-linear-linear_model.py"><span class="source">secretflow/ml/linear/linear_model.py</span>
      <a class="anchor" href="#secretflow-ml-linear-linear_model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 28 lines modified</td><td colspan="2">Offset 9, 44 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>dataclasses</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>U</del><del>n</del>i<del>on</del>,<span class="dp">·</span>List</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>D</ins>i<ins>ct</ins>,<span class="dp">·</span>List<ins>,<span class="dp">·</span>Union</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>SPU,<span class="dp">·</span>PYUObject,<span class="dp">·</span>SPUObject</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPUObject,<span class="dp">·</span>PYUObject</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">@unique</td><td class="diffline">20 </td><td class="diffpresent">@unique</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>RegType(Enum):</td><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>RegType(Enum):</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Linear<span class="dp">·</span>=<span class="dp">·</span>&#x27;linear&#x27;</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Linear<span class="dp">·</span>=<span class="dp">·</span>&#x27;linear&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Logistic<span class="dp">·</span>=<span class="dp">·</span>&#x27;logistic&#x27;</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Logistic<span class="dp">·</span>=<span class="dp">·</span>&#x27;logistic&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent">@dataclass</td><td class="diffline">24 </td><td class="diffpresent">@dataclass<ins>es.dataclass</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>PartyPath:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>party:<span class="dp">·</span>str</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>path:<span class="dp">·</span>str</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent">@dataclasses.dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent">class<span class="dp">·</span>LinearModelRecord:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>RegType</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>SigType</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_spu:<span class="dp">·</span>List[PartyPath]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_pyu:<span class="dp">·</span>List[PartyPath]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent">@dataclasses.dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>LinearModel:</td><td class="diffline">35 </td><td class="diffpresent">class<span class="dp">·</span>LinearModel:</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Unified<span class="dp">·</span>linear<span class="dp">·</span>regression<span class="dp">·</span>model.</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Unified<span class="dp">·</span>linear<span class="dp">·</span>regression<span class="dp">·</span>model.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>:<span class="dp">·</span>{SPUObject,<span class="dp">·</span>List[PYUObject]}</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>:<span class="dp">·</span>{SPUObject,<span class="dp">·</span>List[PYUObject]}</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 40, 7 lines modified</td><td colspan="2">Offset 56, 51 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type<span class="dp">·</span>:<span class="dp">·</span>SigType</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type<span class="dp">·</span>:<span class="dp">·</span>SigType</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>which<span class="dp">·</span>sigmoid<span class="dp">·</span>approximation<span class="dp">·</span>should<span class="dp">·</span>use,<span class="dp">·</span>only<span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>mpc<span class="dp">·</span>lr.</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>which<span class="dp">·</span>sigmoid<span class="dp">·</span>approximation<span class="dp">·</span>should<span class="dp">·</span>use,<span class="dp">·</span>only<span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>mpc<span class="dp">·</span>lr.</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights:<span class="dp">·</span>Union[SPUObject,<span class="dp">·</span>List[PYUObject]]</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights:<span class="dp">·</span>Union[SPUObject,<span class="dp">·</span>List[PYUObject]]</td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>RegType</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>RegType</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>SigType</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>SigType</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>dump(self,<span class="dp">·</span>dir_path:<span class="dp">·</span>Dict[str,<span class="dp">·</span>str])<span class="dp">·</span>-&gt;<span class="dp">·</span>LinearModelRecord:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(self.weights,<span class="dp">·</span>SPUObject):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu_paths<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.path.join(dir_path[name],<span class="dp">·</span>&#x27;weights&#x27;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name<span class="dp">·</span>in<span class="dp">·</span>self.weights.device.actors.keys()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.weights.device.dump(self.weights,<span class="dp">·</span>spu_paths)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_pyu<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_spu<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PartyPath(party,<span class="dp">·</span>path)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>party,<span class="dp">·</span>path<span class="dp">·</span>in<span class="dp">·</span>zip(self.weights.device.actors.keys(),<span class="dp">·</span>spu_paths)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>NotImplementedError(&quot;pyu<span class="dp">·</span>weights<span class="dp">·</span>are<span class="dp">·</span>not<span class="dp">·</span>supported&quot;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>LinearModelRecord(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type=self.reg_type,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type=self.sig_type,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_pyu=weights_pyu,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_spu=weights_spu,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@classmethod</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>load(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cls,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>record:<span class="dp">·</span>LinearModelRecord,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>spu:<span class="dp">·</span>SPU<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pyus:<span class="dp">·</span>List[PYU]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)<span class="dp">·</span>-&gt;<span class="dp">·</span>&#x27;LinearModel&#x27;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(record.weights_spu)<span class="dp">·</span>or<span class="dp">·</span>len(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>record.weights_pyu</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;weights<span class="dp">·</span>are<span class="dp">·</span>not<span class="dp">·</span>provided.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>record.weights_spu:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>spu,<span class="dp">·</span>&#x27;spu<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>provided&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>path_dict<span class="dp">·</span>=<span class="dp">·</span>{t.party:<span class="dp">·</span>t.path<span class="dp">·</span>for<span class="dp">·</span>t<span class="dp">·</span>in<span class="dp">·</span>record.weights_spu}</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>paths<span class="dp">·</span>=<span class="dp">·</span>[path_dict[party]<span class="dp">·</span>for<span class="dp">·</span>party<span class="dp">·</span>in<span class="dp">·</span>spu.actors.keys()]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>=<span class="dp">·</span>spu.load(paths)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>NotImplementedError(&quot;pyu<span class="dp">·</span>weights<span class="dp">·</span>are<span class="dp">·</span>not<span class="dp">·</span>supported&quot;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>cls(weights,<span class="dp">·</span>record.reg_type,<span class="dp">·</span>record.sig_type)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.32 KB</span></div>
    <div id="secretflow-ml-linear-hess_sgd-model.py"><span class="source">secretflow/ml/linear/hess_sgd/model.py</span>
      <a class="anchor" href="#secretflow-ml-linear-hess_sgd-model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 25 lines modified</td><td colspan="2">Offset 9, 25 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffchanged"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple,<span class="dp">·</span>Union<del>,<span class="dp">·</span>List</del></td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>List,<span class="dp">·</span></ins>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffchanged"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>HEU,<span class="dp">·</span>SPU,<span class="dp">·</span>PYUObject,<span class="dp">·</span><del>wait,<span class="dp">·</span></del>SPUObject</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>HEU,<span class="dp">·</span>SPU,<span class="dp">·</span>PYUObject,<span class="dp">·</span>SPUObjec<ins>t,<span class="dp">·</span>wai</ins>t</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.type_traits<span class="dp">·</span>import<span class="dp">·</span>spu_fxp_precision</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.linear_model<span class="dp">·</span>import<span class="dp">·</span>LinearModel,<span class="dp">·</span>RegType</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType,<span class="dp">·</span>sigmoid</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType,<span class="dp">·</span>sigmoid</td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.linear_model<span class="dp">·</span>import<span class="dp">·</span>RegType,<span class="dp">·</span>LinearModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>hess-lr</td><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>hess-lr</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>HESSLogisticRegression:</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>HESSLogisticRegression:</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;This<span class="dp">·</span>method<span class="dp">·</span>provides<span class="dp">·</span>logistic<span class="dp">·</span>regression<span class="dp">·</span>linear<span class="dp">·</span>models<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>split<span class="dp">·</span>dataset</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;This<span class="dp">·</span>method<span class="dp">·</span>provides<span class="dp">·</span>logistic<span class="dp">·</span>regression<span class="dp">·</span>linear<span class="dp">·</span>models<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>split<span class="dp">·</span>dataset</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setting<span class="dp">·</span>by<span class="dp">·</span>using<span class="dp">·</span>secret<span class="dp">·</span>sharing<span class="dp">·</span>and<span class="dp">·</span>homomorphic<span class="dp">·</span>encryption<span class="dp">·</span>with<span class="dp">·</span>mini<span class="dp">·</span>batch<span class="dp">·</span>SGD</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setting<span class="dp">·</span>by<span class="dp">·</span>using<span class="dp">·</span>secret<span class="dp">·</span>sharing<span class="dp">·</span>and<span class="dp">·</span>homomorphic<span class="dp">·</span>encryption<span class="dp">·</span>with<span class="dp">·</span>mini<span class="dp">·</span>batch<span class="dp">·</span>SGD</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>training<span class="dp">·</span>solver.<span class="dp">·</span>HESS-SGD<span class="dp">·</span>is<span class="dp">·</span>short<span class="dp">·</span>for<span class="dp">·</span>HE<span class="dp">·</span>&amp;<span class="dp">·</span>secret<span class="dp">·</span>sharing<span class="dp">·</span>SGD<span class="dp">·</span>training.</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>training<span class="dp">·</span>solver.<span class="dp">·</span>HESS-SGD<span class="dp">·</span>is<span class="dp">·</span>short<span class="dp">·</span>for<span class="dp">·</span>HE<span class="dp">·</span>&amp;<span class="dp">·</span>secret<span class="dp">·</span>sharing<span class="dp">·</span>SGD<span class="dp">·</span>training.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">15.9 KB</span></div>
    <div id="secretflow-ml-linear-ss_sgd-model.py"><span class="source">secretflow/ml/linear/ss_sgd/model.py</span>
      <a class="anchor" href="#secretflow-ml-linear-ss_sgd-model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 36 lines modified</td><td colspan="2">Offset 8, 51 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>time</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span><del>nu</del>m<del>py<span class="dp">·</span></del>a<del>s<span class="dp">·</span></del><del>np</del></td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>ma<ins>th</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>time</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>jax.lax</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffchanged"><td class="diffline">20 </td><td class="diffpresent"><del>from<span class="dp">·</span>typing<span class="dp">·</span></del>import<span class="dp">·</span><del>U</del>n<del>ion,</del><span class="dp">·</span><del>L</del><del>i</del>s<del>t,</del><span class="dp">·</span><del>T</del><del>u</del>p<del>le</del></td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>n<ins>umpy</ins><span class="dp">·</span><ins>a</ins>s<span class="dp">·</span><ins>n</ins>p</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>sigmoid,<span class="dp">·</span>SigType</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffchanged"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span><del>SPU,<span class="dp">·</span>SPUObject,<span class="dp">·</span>wait,<span class="dp">·</span>PYUObject,<span class="dp">·</span>PY</del><del>U</del></td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span><ins>(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPU,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUCompilerNumReturnsPolicy,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUObject,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>wait,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.driver<span class="dp">·</span>import<span class="dp">·</span>reveal</td></tr>
<tr class="diffchanged"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.linear_model<span class="dp">·</span>import<span class="dp">·</span><del>R</del>e<del>gTyp</del>e,<span class="dp">·</span><del>Li</del><del>n</del>e<del>a</del><del>rMod</del>e<del>l</del></td><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear.linear_model<span class="dp">·</span>import<span class="dp">·</span><ins>Li</ins><ins>n</ins>e<ins>a</ins><ins>rMod</ins>e<ins>l</ins>,<span class="dp">·</span><ins>R</ins>e<ins>gTyp</ins>e</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType,<span class="dp">·</span>sigmoid</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">@unique</td><td class="diffline">35 </td><td class="diffpresent">@unique</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">class<span class="dp">·</span>Penalty(Enum):</td><td class="diffline">36 </td><td class="diffpresent">class<span class="dp">·</span>Penalty(Enum):</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NONE<span class="dp">·</span>=<span class="dp">·</span>&#x27;None&#x27;</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NONE<span class="dp">·</span>=<span class="dp">·</span>&#x27;None&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>L1<span class="dp">·</span>=<span class="dp">·</span>&#x27;l1&#x27;<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>not<span class="dp">·</span>supported</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>L1<span class="dp">·</span>=<span class="dp">·</span>&#x27;l1&#x27;<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>not<span class="dp">·</span>supported</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>L2<span class="dp">·</span>=<span class="dp">·</span>&#x27;l2&#x27;</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>L2<span class="dp">·</span>=<span class="dp">·</span>&#x27;l2&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">class<span class="dp">·</span>Strategy(Enum):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>NAIVE_SGD<span class="dp">·</span>=<span class="dp">·</span>&#x27;naive_sgd&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>POLICY_SGD<span class="dp">·</span>=<span class="dp">·</span>&#x27;policy_sgd&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">&#x27;&#x27;&#x27;</td><td class="diffline">43 </td><td class="diffpresent">&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">stateless<span class="dp">·</span>functions<span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>LR<span class="dp">·</span>training.</td><td class="diffline">44 </td><td class="diffpresent">stateless<span class="dp">·</span>functions<span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>LR<span class="dp">·</span>training.</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">please<span class="dp">·</span>keep<span class="dp">·</span>functions<span class="dp">·</span>stateless<span class="dp">·</span>to<span class="dp">·</span>make<span class="dp">·</span>jax<span class="dp">·</span>happy</td><td class="diffline">45 </td><td class="diffpresent">please<span class="dp">·</span>keep<span class="dp">·</span>functions<span class="dp">·</span>stateless<span class="dp">·</span>to<span class="dp">·</span>make<span class="dp">·</span>jax<span class="dp">·</span>happy</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">see<span class="dp">·</span>https://jax.readthedocs.io/en/latest/jax-101/07-state.html</td><td class="diffline">46 </td><td class="diffpresent">see<span class="dp">·</span>https://jax.readthedocs.io/en/latest/jax-101/07-state.html</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">&#x27;&#x27;&#x27;</td><td class="diffline">47 </td><td class="diffpresent">&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 102, 82 lines modified</td><td colspan="2">Offset 117, 120 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">102 </td><td class="diffpresent">def<span class="dp">·</span>_init_w(base:<span class="dp">·</span>float,<span class="dp">·</span>num_feat:<span class="dp">·</span>int)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td><td class="diffline">117 </td><td class="diffpresent">def<span class="dp">·</span>_init_w(base:<span class="dp">·</span>float,<span class="dp">·</span>num_feat:<span class="dp">·</span>int)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td></tr>
<tr class="diffunmodified"><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>last<span class="dp">·</span>one<span class="dp">·</span>is<span class="dp">·</span>bias</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>last<span class="dp">·</span>one<span class="dp">·</span>is<span class="dp">·</span>bias</td></tr>
<tr class="diffunmodified"><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.full((num_feat<span class="dp">·</span>+<span class="dp">·</span>1,<span class="dp">·</span>1),<span class="dp">·</span>base,<span class="dp">·</span>dtype=jnp.float32)</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.full((num_feat<span class="dp">·</span>+<span class="dp">·</span>1,<span class="dp">·</span>1),<span class="dp">·</span>base,<span class="dp">·</span>dtype=jnp.float32)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">120 </td><td class="diffpresent">def<span class="dp">·</span>_convergence(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>old_w:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>current_w:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>norm_eps:<span class="dp">·</span>float,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>eps_scale:<span class="dp">·</span>float,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">125 </td><td class="diffpresent">):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_delta<span class="dp">·</span>=<span class="dp">·</span>jnp.max(jnp.abs(current_w<span class="dp">·</span>-<span class="dp">·</span>old_w))<span class="dp">·</span>*<span class="dp">·</span>eps_scale</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_w<span class="dp">·</span>=<span class="dp">·</span>jnp.max(jnp.abs(current_w))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>(max_delta<span class="dp">·</span>/<span class="dp">·</span>max_w)<span class="dp">·</span>&lt;<span class="dp">·</span>norm_eps</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">129 </td><td class="diffpresent">def<span class="dp">·</span>_compute_2norm(grad,<span class="dp">·</span>eps=1e-4):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jax.lax.rsqrt(jnp.sum(jnp.square(grad))<span class="dp">·</span>+<span class="dp">·</span>eps)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">105 </td><td class="diffpresent">def<span class="dp">·</span>_batch_update_w(</td><td class="diffline">131 </td><td class="diffpresent">def<span class="dp">·</span>_batch_update_w(</td></tr>
<tr class="diffunmodified"><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>np.ndarray,</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffunmodified"><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>np.ndarray,</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffunmodified"><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w:<span class="dp">·</span>np.ndarray,</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>float,</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>float,</td></tr>
<tr class="diffunmodified"><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>l2_norm:<span class="dp">·</span>float,</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>l2_norm:<span class="dp">·</span>float,</td></tr>
<tr class="diffunmodified"><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>SigType,</td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>SigType,</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>RegType,</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>RegType,</td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>penalty:<span class="dp">·</span>Penalty,</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>penalty:<span class="dp">·</span>Penalty,</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>total_batch:<span class="dp">·</span>int,</td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>total_batch:<span class="dp">·</span>int,</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>int,</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>int,</td></tr>
<tr class="diffchanged"><td class="diffline">116 </td><td class="diffpresent"><del>)</del><span class="dp">·</span><del>-&gt;<span class="dp">·</span>np.ndar</del>ray<del>:</del></td><td class="diffline">142 </td><td class="diffpresent"><ins><span class="dp">·</span><span class="dp">·</span></ins><ins><span class="dp">·</span></ins><span class="dp">·</span><ins>st</ins><ins>rategy:<span class="dp">·</span>St</ins>ra<ins>teg</ins>y<ins>,</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dk_arr:<span class="dp">·</span>np.ndarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">144 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[np.ndarray,<span class="dp">·</span>np.ndarray]:</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>update<span class="dp">·</span>weights<span class="dp">·</span>on<span class="dp">·</span>dataset<span class="dp">·</span>in<span class="dp">·</span>one<span class="dp">·</span>iteration.</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>update<span class="dp">·</span>weights<span class="dp">·</span>on<span class="dp">·</span>dataset<span class="dp">·</span>in<span class="dp">·</span>one<span class="dp">·</span>iteration.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffchanged"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>data</del><del>set</del>:<span class="dp">·</span>input<span class="dp">·</span><del>d</del>ata<del>sets</del>.</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>x,y</ins>:<span class="dp">·</span>input<span class="dp">·</span><ins>f</ins><ins>e</ins>at<ins>ures<span class="dp">·</span></ins>a<ins>nd<span class="dp">·</span>l</ins><ins>abel</ins>.</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w:<span class="dp">·</span>base<span class="dp">·</span>model<span class="dp">·</span>weights.</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w:<span class="dp">·</span>base<span class="dp">·</span>model<span class="dp">·</span>weights.</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>controls<span class="dp">·</span>how<span class="dp">·</span>much<span class="dp">·</span>to<span class="dp">·</span>change<span class="dp">·</span>the<span class="dp">·</span>model<span class="dp">·</span>in<span class="dp">·</span>one<span class="dp">·</span>epoch.</td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>learning_rate:<span class="dp">·</span>controls<span class="dp">·</span>how<span class="dp">·</span>much<span class="dp">·</span>to<span class="dp">·</span>change<span class="dp">·</span>the<span class="dp">·</span>model<span class="dp">·</span>in<span class="dp">·</span>one<span class="dp">·</span>epoch.</td></tr>
<tr class="diffchanged"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>bat</del><del>ch</del>_<del>size</del>:<del><span class="dp">·</span>how</del><span class="dp">·</span><del>ma</del><del>ny</del><span class="dp">·</span><del>samp</del>l<del>e</del><del>s<span class="dp">·</span>use<span class="dp">·</span></del>i<del>n<span class="dp">·</span></del>on<del>e</del><span class="dp">·</span><del>calcula</del>t<del>ion</del>.</td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>l2</ins>_<ins>norm</ins>:<span class="dp">·</span><ins>L2</ins><span class="dp">·</span><ins>regu</ins>l<ins>arizat</ins>ion<span class="dp">·</span>t<ins>erm</ins>.</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>sigmoid<span class="dp">·</span>approximation<span class="dp">·</span>type.</td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig_type:<span class="dp">·</span>sigmoid<span class="dp">·</span>approximation<span class="dp">·</span>type.</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>Linear<span class="dp">·</span>or<span class="dp">·</span>Logistic<span class="dp">·</span>regression.</td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>reg_type:<span class="dp">·</span>Linear<span class="dp">·</span>or<span class="dp">·</span>Logistic<span class="dp">·</span>regression.</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>penalty:<span class="dp">·</span>The<span class="dp">·</span>penalty<span class="dp">·</span>(aka<span class="dp">·</span>regularization<span class="dp">·</span>term)<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>used.</td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>penalty:<span class="dp">·</span>The<span class="dp">·</span>penalty<span class="dp">·</span>(aka<span class="dp">·</span>regularization<span class="dp">·</span>term)<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>used.</td></tr>
<tr class="diffchanged"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>l<del>2_norm</del>:<span class="dp">·</span><del>L2</del><span class="dp">·</span><del>reg</del>ul<del>a</del><del>riz</del>at<del>i</del><del>on</del><span class="dp">·</span><del>term</del>.</td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>tota</ins>l<ins>_batch</ins>:<span class="dp">·</span><ins>h</ins><ins>ow</ins><span class="dp">·</span><ins>man</ins><ins>y<span class="dp">·</span>f</ins>ul<ins>l<span class="dp">·</span>b</ins>at<ins>ch</ins><span class="dp">·</span><ins>in<span class="dp">·</span>x</ins>.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>how<span class="dp">·</span>many<span class="dp">·</span>samples<span class="dp">·</span>use<span class="dp">·</span>in<span class="dp">·</span>one<span class="dp">·</span>calculation.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>strategy:<span class="dp">·</span>learning<span class="dp">·</span>strategy<span class="dp">·</span>for<span class="dp">·</span>updating<span class="dp">·</span>weights.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dk_arr:<span class="dp">·</span>only<span class="dp">·</span>useful<span class="dp">·</span>for<span class="dp">·</span>policy-sgd,<span class="dp">·</span>store<span class="dp">·</span>the<span class="dp">·</span>recently<span class="dp">·</span>1/norm(g_k)<span class="dp">·</span>in<span class="dp">·</span>this<span class="dp">·</span>infeed.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td></tr>
<tr class="diffchanged"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>W<span class="dp">·</span>after<span class="dp">·</span>update.</td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>W<span class="dp">·</span>after<span class="dp">·</span>update<ins><span class="dp">·</span>and<span class="dp">·</span>array<span class="dp">·</span>of<span class="dp">·</span>norm<span class="dp">·</span>of<span class="dp">·</span>gradient</ins>.</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x.shape[0]<span class="dp">·</span>&gt;=<span class="dp">·</span>total_batch<span class="dp">·</span>*<span class="dp">·</span>batch_size,<span class="dp">·</span>&quot;total<span class="dp">·</span>batch<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>large&quot;</td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x.shape[0]<span class="dp">·</span>&gt;=<span class="dp">·</span>total_batch<span class="dp">·</span>*<span class="dp">·</span>batch_size,<span class="dp">·</span>&quot;total<span class="dp">·</span>batch<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>large&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_feat<span class="dp">·</span>=<span class="dp">·</span>x.shape[1]</td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>num_feat<span class="dp">·</span>=<span class="dp">·</span>x.shape[1]</td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>w.shape[0]<span class="dp">·</span>==<span class="dp">·</span>num_feat<span class="dp">·</span>+<span class="dp">·</span>1,<span class="dp">·</span>&quot;w<span class="dp">·</span>shape<span class="dp">·</span>is<span class="dp">·</span>mismatch<span class="dp">·</span>to<span class="dp">·</span>x&quot;</td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>w.shape[0]<span class="dp">·</span>==<span class="dp">·</span>num_feat<span class="dp">·</span>+<span class="dp">·</span>1,<span class="dp">·</span>&quot;w<span class="dp">·</span>shape<span class="dp">·</span>is<span class="dp">·</span>mismatch<span class="dp">·</span>to<span class="dp">·</span>x&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(w.shape)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>or<span class="dp">·</span>(</td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(w.shape)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>or<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>len(w.shape)<span class="dp">·</span>==<span class="dp">·</span>2<span class="dp">·</span>and<span class="dp">·</span>w.shape[1]<span class="dp">·</span>==<span class="dp">·</span>1</td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>len(w.shape)<span class="dp">·</span>==<span class="dp">·</span>2<span class="dp">·</span>and<span class="dp">·</span>w.shape[1]<span class="dp">·</span>==<span class="dp">·</span>1</td></tr>
<tr class="diffunmodified"><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&quot;w<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>list<span class="dp">·</span>or<span class="dp">·</span>1D<span class="dp">·</span>array&quot;</td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&quot;w<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>list<span class="dp">·</span>or<span class="dp">·</span>1D<span class="dp">·</span>array&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w<span class="dp">·</span>=<span class="dp">·</span>w.reshape((w.shape[0],<span class="dp">·</span>1))</td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>w<span class="dp">·</span>=<span class="dp">·</span>w.reshape((w.shape[0],<span class="dp">·</span>1))</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>y.shape[0]<span class="dp">·</span>==<span class="dp">·</span>x.shape[0],<span class="dp">·</span>&quot;x<span class="dp">·</span>&amp;<span class="dp">·</span>y<span class="dp">·</span>not<span class="dp">·</span>aligned&quot;</td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>y.shape[0]<span class="dp">·</span>==<span class="dp">·</span>x.shape[0],<span class="dp">·</span>&quot;x<span class="dp">·</span>&amp;<span class="dp">·</span>y<span class="dp">·</span>not<span class="dp">·</span>aligned&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(y.shape)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>or<span class="dp">·</span>(</td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(y.shape)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>or<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>len(y.shape)<span class="dp">·</span>==<span class="dp">·</span>2<span class="dp">·</span>and<span class="dp">·</span>y.shape[1]<span class="dp">·</span>==<span class="dp">·</span>1</td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>len(y.shape)<span class="dp">·</span>==<span class="dp">·</span>2<span class="dp">·</span>and<span class="dp">·</span>y.shape[1]<span class="dp">·</span>==<span class="dp">·</span>1</td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&quot;Y<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>be<span class="dp">·</span>list<span class="dp">·</span>or<span class="dp">·</span>1D<span class="dp">·</span>array&quot;</td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&quot;Y<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>be<span class="dp">·</span>list<span class="dp">·</span>or<span class="dp">·</span>1D<span class="dp">·</span>array&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y<span class="dp">·</span>=<span class="dp">·</span>y.reshape((y.shape[0],<span class="dp">·</span>1))</td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y<span class="dp">·</span>=<span class="dp">·</span>y.reshape((y.shape[0],<span class="dp">·</span>1))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compute_dk<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>dk_arr<span class="dp">·</span>is<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>strategy<span class="dp">·</span>==<span class="dp">·</span>Strategy.POLICY_SGD:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compute_dk<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 12136/16250 bytes (74.68%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">598 B</span></div>
    <div id="secretflow-ml-nn-metrics.py"><span class="source">secretflow/ml/nn/metrics.py</span>
      <a class="anchor" href="#secretflow-ml-nn-metrics.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 19 lines modified</td><td colspan="2">Offset 12, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">&quot;&quot;&quot;keras<span class="dp">·</span>global<span class="dp">·</span>evaluation<span class="dp">·</span>metrics</td><td class="diffline">14 </td><td class="diffpresent">&quot;&quot;&quot;keras<span class="dp">·</span>global<span class="dp">·</span>evaluation<span class="dp">·</span>metrics</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">&quot;&quot;&quot;</td><td class="diffline">15 </td><td class="diffpresent">&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">#<span class="dp">·</span>The<span class="dp">·</span>reason<span class="dp">·</span>we<span class="dp">·</span>just<span class="dp">·</span>do<span class="dp">·</span>not<span class="dp">·</span>inherit<span class="dp">·</span>or<span class="dp">·</span>combine<span class="dp">·</span>tensorflow<span class="dp">·</span>metrics</td><td class="diffline">20 </td><td class="diffpresent">#<span class="dp">·</span>The<span class="dp">·</span>reason<span class="dp">·</span>we<span class="dp">·</span>just<span class="dp">·</span>do<span class="dp">·</span>not<span class="dp">·</span>inherit<span class="dp">·</span>or<span class="dp">·</span>combine<span class="dp">·</span>tensorflow<span class="dp">·</span>metrics</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">#<span class="dp">·</span>is<span class="dp">·</span>tensorflow<span class="dp">·</span>metrics<span class="dp">·</span>are<span class="dp">·</span>un-serializable<span class="dp">·</span>but<span class="dp">·</span>we<span class="dp">·</span>need<span class="dp">·</span>send<span class="dp">·</span>they<span class="dp">·</span>from<span class="dp">·</span>worker<span class="dp">·</span>to<span class="dp">·</span>server.</td><td class="diffline">21 </td><td class="diffpresent">#<span class="dp">·</span>is<span class="dp">·</span>tensorflow<span class="dp">·</span>metrics<span class="dp">·</span>are<span class="dp">·</span>un-serializable<span class="dp">·</span>but<span class="dp">·</span>we<span class="dp">·</span>need<span class="dp">·</span>send<span class="dp">·</span>they<span class="dp">·</span>from<span class="dp">·</span>worker<span class="dp">·</span>to<span class="dp">·</span>server.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>Metric(ABC):</td><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>Metric(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">693 B</span></div>
    <div id="secretflow-ml-nn-fl-compress.py"><span class="source">secretflow/ml/nn/fl/compress.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-compress.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 16 lines modified</td><td colspan="2">Offset 12, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>STCSparse</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>STCSparse</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">COMPRESS_STRATEGY<span class="dp">·</span>=<span class="dp">·</span>(&quot;fed_stc&quot;,<span class="dp">·</span>&quot;fed_scr&quot;)</td><td class="diffline">20 </td><td class="diffpresent">COMPRESS_STRATEGY<span class="dp">·</span>=<span class="dp">·</span>(&quot;fed_stc&quot;,<span class="dp">·</span>&quot;fed_scr&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">def<span class="dp">·</span>stc_compress(compressor,<span class="dp">·</span>server_weights,<span class="dp">·</span>agg_updates,<span class="dp">·</span>res):</td><td class="diffline">21 </td><td class="diffpresent">def<span class="dp">·</span>stc_compress(compressor,<span class="dp">·</span>server_weights,<span class="dp">·</span>agg_updates,<span class="dp">·</span>res):</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_add(matrices_a:<span class="dp">·</span>List,<span class="dp">·</span>matrices_b:<span class="dp">·</span>List):</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_add(matrices_a:<span class="dp">·</span>List,<span class="dp">·</span>matrices_b:<span class="dp">·</span>List):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">17.8 KB</span></div>
    <div id="secretflow-ml-nn-fl-fl_model.py"><span class="source">secretflow/ml/nn/fl/fl_model.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-fl_model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 113, 87 lines modified</td><td colspan="2">Offset 113, 114 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>clients_weights.append(weights)</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>clients_weights.append(weights)</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>initial_weight<span class="dp">·</span>=<span class="dp">·</span>self._aggregator.average(clients_weights,<span class="dp">·</span>axis=0)</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>initial_weight<span class="dp">·</span>=<span class="dp">·</span>self._aggregator.average(clients_weights,<span class="dp">·</span>axis=0)</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>=<span class="dp">·</span>initial_weight.to(device)<span class="dp">·</span>if<span class="dp">·</span>initial_weight<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>=<span class="dp">·</span>initial_weight.to(device)<span class="dp">·</span>if<span class="dp">·</span>initial_weight<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker.set_weights(weights)</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker.set_weights(weights)</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>initial_weight</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>initial_weight</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>handle_file(</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span><ins>_</ins>handle_file(</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_dict:<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>str],</td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_dict:<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>str],</td></tr>
<tr class="diffchanged"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label:<span class="dp">·</span>str,</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label:<span class="dp">·</span>str<ins><span class="dp">·</span>=<span class="dp">·</span>None</ins>,</td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>Union[int,<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>int]]<span class="dp">·</span>=<span class="dp">·</span>32,</td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size:<span class="dp">·</span>Union[int,<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>int]]<span class="dp">·</span>=<span class="dp">·</span>32,</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate=None,</td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=False,</td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=False,</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=1234,</td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=1234,</td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs=1,</td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>epochs=1,</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=&quot;train&quot;,</td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=&quot;train&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label_decoder=None,</td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label_decoder=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_batch_size=20000,</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_batch_size=20000,</td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>prefetch_buffer_size=None,</td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>prefetch_buffer_size=None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder=None,</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>dataset_builder:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>steps_per_epochs<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffdeleted"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>get<span class="dp">·</span>party<span class="dp">·</span>length</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parties_length<span class="dp">·</span>=<span class="dp">·</span>reveal(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device:<span class="dp">·</span>worker.get_rows_count(train_dict[device])</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items()</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items()<ins>:</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>sampling_rate<span class="dp">·</span>is<span class="dp">·</span>None:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(batch_size,<span class="dp">·</span>int):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>=<span class="dp">·</span>max(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>[batch_size<span class="dp">·</span>/<span class="dp">·</span>length<span class="dp">·</span>for<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.values()]</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>)</del></td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>assert<span class="dp">·</span></ins><ins>(</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>sampl</del>in<del>g_r</del>at<del>e<span class="dp">·</span>=<span class="dp">·</span>max(</del></td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>de</ins><ins>vice<span class="dp">·</span></ins>in<ins><span class="dp">·</span></ins><ins>dat</ins>a<ins>se</ins>t<ins>_builder</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;party={device}<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>provide<span class="dp">·</span>dataset_builder,<span class="dp">·</span>please<span class="dp">·</span>check&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>worker.build_dataset_from_builder(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder[device],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_dict[device],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,</td></tr>
<tr class="diffchanged"><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>[</del></td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>None</ins><ins>,</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size[device]<span class="dp">·</span>/<span class="dp">·</span>length</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.items()</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>]</del></td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>stage=stage</ins><ins>,</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count=epochs,</td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>steps_per_epochs.append(steps_per_epoch)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>set_steps_per_epochs<span class="dp">·</span>=<span class="dp">·</span>set(reveal(steps_per_epochs))</td></tr>
<tr class="diffdeleted"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>sampling_rate<span class="dp">·</span>&gt;<span class="dp">·</span>1.0:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>=<span class="dp">·</span>1.0</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.warn(&quot;Batchsize<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>large<span class="dp">·</span>it<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>size&quot;)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>check<span class="dp">·</span>batchsize</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.values():</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>=<span class="dp">·</span>math.floor(length<span class="dp">·</span>*<span class="dp">·</span>sampling_rate)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>len(set_steps_per_epochs)<span class="dp">·</span>==<span class="dp">·</span>1</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&quot;steps_per_epochs<span class="dp">·</span>of<span class="dp">·</span>all<span class="dp">·</span>parties<span class="dp">·</span>must<span class="dp">·</span>be<span class="dp">·</span>same&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>set_steps_per_epochs.pop()</td></tr>
<tr class="diffdeleted"><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>&lt;<span class="dp">·</span>max_batch_size</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;Automatic<span class="dp">·</span>batchsize<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>big(batch_size={batch_size}),<span class="dp">·</span>variable<span class="dp">·</span>batchsize<span class="dp">·</span>in<span class="dp">·</span>dict<span class="dp">·</span>is<span class="dp">·</span>recommended&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>&lt;=<span class="dp">·</span>1.0<span class="dp">·</span>and<span class="dp">·</span>sampling_rate<span class="dp">·</span>&gt;<span class="dp">·</span>0.0</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;invalid<span class="dp">·</span>sampling<span class="dp">·</span>rate<span class="dp">·</span>{sampling_rate}&#x27;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>math.ceil(1.0<span class="dp">·</span>/<span class="dp">·</span>sampling_rate)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>get<span class="dp">·</span>party<span class="dp">·</span>length</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parties_length<span class="dp">·</span>=<span class="dp">·</span>reveal(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device:<span class="dp">·</span>worker.get_rows_count(train_dict[device])</td></tr>
<tr class="diffchanged"><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items()<del>:</del></td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items()</td></tr>
<tr class="diffdeleted"><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count<span class="dp">·</span>=<span class="dp">·</span>epochs</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker.build_dataset_from_csv(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_dict[device],</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>label</del><del>,</del></td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>}</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate=sampling_rate,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=shuffle,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=random_seed,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count=repeat_count,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sample_length=parties_length[device],</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>prefetch_buffer_size=prefetch_buffer_size,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=stage,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label_decoder=label_decoder,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>sampling_rate<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(batch_size,<span class="dp">·</span>int):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>=<span class="dp">·</span>max(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>[batch_size<span class="dp">·</span>/<span class="dp">·</span>length<span class="dp">·</span>for<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.values()]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>=<span class="dp">·</span>max(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size[device]<span class="dp">·</span>/<span class="dp">·</span>length</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.items()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>sampling_rate<span class="dp">·</span>&gt;<span class="dp">·</span>1.0:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>=<span class="dp">·</span>1.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.warn(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;Batchsize<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>large<span class="dp">·</span>it<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>data<span class="dp">·</span>size&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>check<span class="dp">·</span>batchsize</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>length<span class="dp">·</span>in<span class="dp">·</span>parties_length.values():</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>=<span class="dp">·</span>math.floor(length<span class="dp">·</span>*<span class="dp">·</span>sampling_rate)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>&lt;<span class="dp">·</span>max_batch_size</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;Automatic<span class="dp">·</span>batchsize<span class="dp">·</span>is<span class="dp">·</span>too<span class="dp">·</span>big(batch_size={batch_size}),<span class="dp">·</span>variable<span class="dp">·</span>batchsize<span class="dp">·</span>in<span class="dp">·</span>dict<span class="dp">·</span>is<span class="dp">·</span>recommended&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate<span class="dp">·</span>&lt;=<span class="dp">·</span>1.0<span class="dp">·</span>and<span class="dp">·</span>sampling_rate<span class="dp">·</span>&gt;<span class="dp">·</span>0.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;invalid<span class="dp">·</span>sampling<span class="dp">·</span>rate<span class="dp">·</span>{sampling_rate}&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>math.ceil(1.0<span class="dp">·</span>/<span class="dp">·</span>sampling_rate)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count<span class="dp">·</span>=<span class="dp">·</span>epochs</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker.build_dataset_from_csv(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_dict[device],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sampling_rate=sampling_rate,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle=shuffle,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=random_seed,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count=repeat_count,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sample_length=parties_length[device],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>prefetch_buffer_size=prefetch_buffer_size,</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 12376/18206 bytes (67.98%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.79 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-fl_base.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/fl_base.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-fl_base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 13, 17 lines modified</td><td colspan="2">Offset 13, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>collections</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>collections</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>abstractmethod</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Optional</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Optional<ins>,<span class="dp">·</span>Union</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.sampler<span class="dp">·</span>import<span class="dp">·</span>sampler_data</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.sampler<span class="dp">·</span>import<span class="dp">·</span>sampler_data</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>AUC,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>AUC,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.io<span class="dp">·</span>import<span class="dp">·</span>rows_count</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.io<span class="dp">·</span>import<span class="dp">·</span>rows_count</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 155, 14 lines modified</td><td colspan="2">Offset 156, 55 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td></tr>
<tr class="diffunmodified"><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td></tr>
<tr class="diffunmodified"><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>build_dataset_from_builder(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>Callable,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>str],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count=1,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=&quot;train&quot;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;build<span class="dp">·</span>tf.data.Dataset</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>Function<span class="dp">·</span>of<span class="dp">·</span>how<span class="dp">·</span>to<span class="dp">·</span>build<span class="dp">·</span>dataset,<span class="dp">·</span>must<span class="dp">·</span>return<span class="dp">·</span>dataset<span class="dp">·</span>and<span class="dp">·</span>step_per_epoch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>A<span class="dp">·</span>string<span class="dp">·</span>representing<span class="dp">·</span>the<span class="dp">·</span>path<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>CSV<span class="dp">·</span>file<span class="dp">·</span>or<span class="dp">·</span>data<span class="dp">·</span>folder<span class="dp">·</span>containing<span class="dp">·</span>the<span class="dp">·</span>input<span class="dp">·</span>data.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>label,<span class="dp">·</span>FedNdArray<span class="dp">·</span>or<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>Default<span class="dp">·</span>None,<span class="dp">·</span>all<span class="dp">·</span>samples<span class="dp">·</span>are<span class="dp">·</span>assumed<span class="dp">·</span>to<span class="dp">·</span>have<span class="dp">·</span>equal<span class="dp">·</span>weight.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count:<span class="dp">·</span>An<span class="dp">·</span>integer<span class="dp">·</span>specifying<span class="dp">·</span>the<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>times<span class="dp">·</span>to<span class="dp">·</span>repeat<span class="dp">·</span>the<span class="dp">·</span>dataset.<span class="dp">·</span>This<span class="dp">·</span>is<span class="dp">·</span>useful<span class="dp">·</span>for<span class="dp">·</span>increasing<span class="dp">·</span>the<span class="dp">·</span>effective<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>dataset.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>A<span class="dp">·</span>string<span class="dp">·</span>specifying<span class="dp">·</span>the<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>dataset<span class="dp">·</span>to<span class="dp">·</span>build.<span class="dp">·</span>This<span class="dp">·</span>is<span class="dp">·</span>useful<span class="dp">·</span>for<span class="dp">·</span>separating<span class="dp">·</span>training,<span class="dp">·</span>validation,<span class="dp">·</span>and<span class="dp">·</span>test<span class="dp">·</span>datasets.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>A<span class="dp">·</span>tensorflow<span class="dp">·</span>dataset</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>dataset_builder<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;Dataset<span class="dp">·</span>builder<span class="dp">·</span>cannot<span class="dp">·</span>be<span class="dp">·</span>none&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>str):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set,<span class="dp">·</span>step_per_epoch<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x,<span class="dp">·</span>stage=stage)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set,<span class="dp">·</span>step_per_epoch<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x,<span class="dp">·</span>stage=stage)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>data_set.repeat(repeat_count)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>iter(data_set)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>step_per_epoch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_rows_count(self,<span class="dp">·</span>filename):</td><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_rows_count(self,<span class="dp">·</span>filename):</td></tr>
<tr class="diffunmodified"><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>int(rows_count(filename=filename))<span class="dp">·</span>-<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>except<span class="dp">·</span>header<span class="dp">·</span>line</td><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>int(rows_count(filename=filename))<span class="dp">·</span>-<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>except<span class="dp">·</span>header<span class="dp">·</span>line</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_weights(self):</td><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_weights(self):</td></tr>
<tr class="diffunmodified"><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.model.get_weights()</td><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.model.get_weights()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td><td class="diffline">204 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">844 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-strategy-__init__.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/strategy/__init__.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-strategy-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 21 lines modified</td><td colspan="2">Offset 8, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_w<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgW</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_g<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgG</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_g<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgG</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_u<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgU</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_u<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgU</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_w<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgW</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.fed_prox<span class="dp">·</span>import<span class="dp">·</span>PYUFedProx</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.fed_scr<span class="dp">·</span>import<span class="dp">·</span>PYUFedSCR</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.fed_scr<span class="dp">·</span>import<span class="dp">·</span>PYUFedSCR</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.fed_stc<span class="dp">·</span>import<span class="dp">·</span>PYUFedSTC</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.fed_stc<span class="dp">·</span>import<span class="dp">·</span>PYUFedSTC</td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.fed_prox<span class="dp">·</span>import<span class="dp">·</span>PYUFedProx</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgG&#x27;,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgG&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgW&#x27;,</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgW&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgU&#x27;,</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgU&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedSCR&#x27;,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedSCR&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedSTC&#x27;,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedSTC&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.06 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_g.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_g.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_g.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 22 lines modified</td><td colspan="2">Offset 12, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>collections</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>collections</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgG(BaseTFModel):</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgG(BaseTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgG:<span class="dp">·</span>An<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>accumulated</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgG:<span class="dp">·</span>An<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>accumulated</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>during<span class="dp">·</span>the<span class="dp">·</span>federated<span class="dp">·</span>round<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>during<span class="dp">·</span>the<span class="dp">·</span>federated<span class="dp">·</span>round<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.06 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_u.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_u.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_u.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 22 lines modified</td><td colspan="2">Offset 12, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>collections</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>collections</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgU(BaseTFModel):</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgU(BaseTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgU:<span class="dp">·</span>An<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>model<span class="dp">·</span>updates</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgU:<span class="dp">·</span>An<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>model<span class="dp">·</span>updates</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their<span class="dp">·</span>local<span class="dp">·</span>models<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>aggregated</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their<span class="dp">·</span>local<span class="dp">·</span>models<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>aggregated</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.08 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_w.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_avg_w.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_avg_w.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 22 lines modified</td><td colspan="2">Offset 12, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>collections</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>collections</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgW(BaseTFModel):</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgW(BaseTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgW:<span class="dp">·</span>A<span class="dp">·</span>naive<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>trained<span class="dp">·</span>model</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedAvgW:<span class="dp">·</span>A<span class="dp">·</span>naive<span class="dp">·</span>implementation<span class="dp">·</span>of<span class="dp">·</span>FedAvg,<span class="dp">·</span>where<span class="dp">·</span>the<span class="dp">·</span>clients<span class="dp">·</span>upload<span class="dp">·</span>their<span class="dp">·</span>trained<span class="dp">·</span>model</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their<span class="dp">·</span>local<span class="dp">·</span>models<span class="dp">·</span>via<span class="dp">·</span>the<span class="dp">·</span>aggregated<span class="dp">·</span>weights</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>server<span class="dp">·</span>for<span class="dp">·</span>averaging<span class="dp">·</span>and<span class="dp">·</span>update<span class="dp">·</span>their<span class="dp">·</span>local<span class="dp">·</span>models<span class="dp">·</span>via<span class="dp">·</span>the<span class="dp">·</span>aggregated<span class="dp">·</span>weights</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.08 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_prox.py"><span class="source">secretflow/ml/nn/fl/backend/tensorflow/strategy/fed_prox.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-tensorflow-strategy-fed_prox.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 22 lines modified</td><td colspan="2">Offset 12, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>collections</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>collections</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.tensorflow.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTFModel</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedProx(BaseTFModel):</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>FedProx(BaseTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedfProx:<span class="dp">·</span>An<span class="dp">·</span>FL<span class="dp">·</span>optimization<span class="dp">·</span>strategy<span class="dp">·</span>that<span class="dp">·</span>addresses<span class="dp">·</span>the<span class="dp">·</span>challenge<span class="dp">·</span>of<span class="dp">·</span>heterogeneity<span class="dp">·</span>on<span class="dp">·</span>data</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedfProx:<span class="dp">·</span>An<span class="dp">·</span>FL<span class="dp">·</span>optimization<span class="dp">·</span>strategy<span class="dp">·</span>that<span class="dp">·</span>addresses<span class="dp">·</span>the<span class="dp">·</span>challenge<span class="dp">·</span>of<span class="dp">·</span>heterogeneity<span class="dp">·</span>on<span class="dp">·</span>data</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(non-IID)<span class="dp">·</span>and<span class="dp">·</span>devices,<span class="dp">·</span>which<span class="dp">·</span>adds<span class="dp">·</span>a<span class="dp">·</span>proximal<span class="dp">·</span>term<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>local<span class="dp">·</span>objective<span class="dp">·</span>function<span class="dp">·</span>of<span class="dp">·</span>each</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(non-IID)<span class="dp">·</span>and<span class="dp">·</span>devices,<span class="dp">·</span>which<span class="dp">·</span>adds<span class="dp">·</span>a<span class="dp">·</span>proximal<span class="dp">·</span>term<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>local<span class="dp">·</span>objective<span class="dp">·</span>function<span class="dp">·</span>of<span class="dp">·</span>each</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">3.67 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-fl_base.py"><span class="source">secretflow/ml/nn/fl/backend/torch/fl_base.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-fl_base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 21 lines modified</td><td colspan="2">Offset 9, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Optional</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Optional<ins>,<span class="dp">·</span>Union</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>torch</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>torch</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>torchmetrics</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>torchmetrics</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.sampler<span class="dp">·</span>import<span class="dp">·</span>sampler_data</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.sampler<span class="dp">·</span>import<span class="dp">·</span>sampler_data</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.utils<span class="dp">·</span>import<span class="dp">·</span>TorchModel</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.utils<span class="dp">·</span>import<span class="dp">·</span>TorchModel</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>Default,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>Default,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.io<span class="dp">·</span>import<span class="dp">·</span>rows_count</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.io<span class="dp">·</span>import<span class="dp">·</span>rows_count</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>Torch<span class="dp">·</span>model<span class="dp">·</span>on<span class="dp">·</span>worker<span class="dp">·</span>side</td><td class="diffline">25 </td><td class="diffpresent">#<span class="dp">·</span>Torch<span class="dp">·</span>model<span class="dp">·</span>on<span class="dp">·</span>worker<span class="dp">·</span>side</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 146, 14 lines modified</td><td colspan="2">Offset 147, 55 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td></tr>
<tr class="diffunmodified"><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td></tr>
<tr class="diffunmodified"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>build_dataset_from_builder(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>Callable,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>str],</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">157 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">158 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">159 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count=1,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">160 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=&quot;train&quot;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">161 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">162 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;build<span class="dp">·</span>tf.data.Dataset</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">163 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">164 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>Function<span class="dp">·</span>of<span class="dp">·</span>how<span class="dp">·</span>to<span class="dp">·</span>build<span class="dp">·</span>dataset,<span class="dp">·</span>must<span class="dp">·</span>return<span class="dp">·</span>dataset<span class="dp">·</span>and<span class="dp">·</span>step_per_epoch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>A<span class="dp">·</span>pandas<span class="dp">·</span>Dataframe<span class="dp">·</span>or<span class="dp">·</span>A<span class="dp">·</span>string<span class="dp">·</span>representing<span class="dp">·</span>the<span class="dp">·</span>path<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>CSV<span class="dp">·</span>file<span class="dp">·</span>or<span class="dp">·</span>data<span class="dp">·</span>folder<span class="dp">·</span>containing<span class="dp">·</span>the<span class="dp">·</span>input<span class="dp">·</span>data.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>label,<span class="dp">·</span>An<span class="dp">·</span>optional<span class="dp">·</span>NumPy<span class="dp">·</span>array<span class="dp">·</span>containing<span class="dp">·</span>the<span class="dp">·</span>labels<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>dataset.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>None.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>An<span class="dp">·</span>optional<span class="dp">·</span>NumPy<span class="dp">·</span>array<span class="dp">·</span>containing<span class="dp">·</span>the<span class="dp">·</span>sample<span class="dp">·</span>weights<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>dataset.<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>None.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count:<span class="dp">·</span>An<span class="dp">·</span>integer<span class="dp">·</span>specifying<span class="dp">·</span>the<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>times<span class="dp">·</span>to<span class="dp">·</span>repeat<span class="dp">·</span>the<span class="dp">·</span>dataset.<span class="dp">·</span>This<span class="dp">·</span>is<span class="dp">·</span>useful<span class="dp">·</span>for<span class="dp">·</span>increasing<span class="dp">·</span>the<span class="dp">·</span>effective<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>dataset.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">169 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>A<span class="dp">·</span>string<span class="dp">·</span>indicating<span class="dp">·</span>the<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>dataset<span class="dp">·</span>(either<span class="dp">·</span>&quot;train&quot;,<span class="dp">·</span>&quot;eval&quot;).<span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>&quot;train&quot;.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">170 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>A<span class="dp">·</span>tensorflow<span class="dp">·</span>dataset</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>dataset_builder<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;Dataset<span class="dp">·</span>builder<span class="dp">·</span>cannot<span class="dp">·</span>be<span class="dp">·</span>none&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(x,<span class="dp">·</span>str):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set,<span class="dp">·</span>step_per_epoch<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x,<span class="dp">·</span>stage=stage)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set,<span class="dp">·</span>step_per_epoch<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x,<span class="dp">·</span>stage=stage)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;train&quot;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>stage<span class="dp">·</span>==<span class="dp">·</span>&quot;eval&quot;:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>data_set</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(f&quot;Illegal<span class="dp">·</span>argument<span class="dp">·</span>stage={stage}&quot;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>step_per_epoch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_rows_count(self,<span class="dp">·</span>filename):</td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_rows_count(self,<span class="dp">·</span>filename):</td></tr>
<tr class="diffunmodified"><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>int(rows_count(filename=filename))<span class="dp">·</span>-<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>except<span class="dp">·</span>header<span class="dp">·</span>line</td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>int(rows_count(filename=filename))<span class="dp">·</span>-<span class="dp">·</span>1<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>except<span class="dp">·</span>header<span class="dp">·</span>line</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_weights(self):</td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_weights(self):</td></tr>
<tr class="diffunmodified"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.model.get_weights(return_numpy=True)</td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.model.get_weights(return_numpy=True)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">156 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 283, 15 lines modified</td><td colspan="2">Offset 325, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">283 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.train_set<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.train_set<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">284 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_iter<span class="dp">·</span>=<span class="dp">·</span>iter(self.train_set)</td><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_iter<span class="dp">·</span>=<span class="dp">·</span>iter(self.train_set)</td></tr>
<tr class="diffunmodified"><td class="diffline">285 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.eval_set<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.eval_set<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">286 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_iter<span class="dp">·</span>=<span class="dp">·</span>iter(self.eval_set)</td><td class="diffline">328 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_iter<span class="dp">·</span>=<span class="dp">·</span>iter(self.eval_set)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">287 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>on_epoch_end(self,<span class="dp">·</span>epoch):</td><td class="diffline">329 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>on_epoch_end(self,<span class="dp">·</span>epoch):</td></tr>
<tr class="diffunmodified"><td class="diffline">288 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.epoch.append(epoch)</td><td class="diffline">330 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.epoch.append(epoch)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">289 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>k,<span class="dp">·</span>v<span class="dp">·</span>in<span class="dp">·</span>self.epoch_logs.items():</td><td class="diffline">331 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>k,<span class="dp">·</span>v<span class="dp">·</span>in<span class="dp">·</span>self.epoch_logs.items():</td></tr>
<tr class="diffunmodified"><td class="diffline">290 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.history.setdefault(k,<span class="dp">·</span>[]).append(v)</td><td class="diffline">332 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.history.setdefault(k,<span class="dp">·</span>[]).append(v)</td></tr>
<tr class="diffunmodified"><td class="diffline">291 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.training_logs<span class="dp">·</span>=<span class="dp">·</span>self.epoch_logs</td><td class="diffline">333 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.training_logs<span class="dp">·</span>=<span class="dp">·</span>self.epoch_logs</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">292 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.epoch_logs</td><td class="diffline">334 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self.epoch_logs</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">293 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>transform_metrics(self,<span class="dp">·</span>logs,<span class="dp">·</span>stage=&quot;train&quot;):</td><td class="diffline">335 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>transform_metrics(self,<span class="dp">·</span>logs,<span class="dp">·</span>stage=&quot;train&quot;):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">357 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-sampler.py"><span class="source">secretflow/ml/nn/fl/backend/torch/sampler.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-sampler.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 17, 15 lines modified</td><td colspan="2">Offset 17, 14 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>random</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>random</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>torch</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>torch</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>torch.utils.data<span class="dp">·</span>import<span class="dp">·</span>DataLoader,<span class="dp">·</span>TensorDataset</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>torch.utils.data<span class="dp">·</span>import<span class="dp">·</span>DataLoader,<span class="dp">·</span>TensorDataset</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>batch_sampler(</td><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>batch_sampler(</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x,<span class="dp">·</span>y,<span class="dp">·</span>s_w,<span class="dp">·</span>sampling_rate,<span class="dp">·</span>buffer_size,<span class="dp">·</span>shuffle,<span class="dp">·</span>repeat_count,<span class="dp">·</span>random_seed</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x,<span class="dp">·</span>y,<span class="dp">·</span>s_w,<span class="dp">·</span>sampling_rate,<span class="dp">·</span>buffer_size,<span class="dp">·</span>shuffle,<span class="dp">·</span>repeat_count,<span class="dp">·</span>random_seed</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">):</td><td class="diffline">25 </td><td class="diffpresent">):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.06 KB</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-utils.py"><span class="source">secretflow/ml/nn/fl/backend/torch/utils.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-utils.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 16, 19 lines modified</td><td colspan="2">Offset 16, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Optional,<span class="dp">·</span>Union</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Optional,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>torchmetrics<span class="dp">·</span>import<span class="dp">·</span>Metric</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>torch</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>torch</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>torch<span class="dp">·</span>import<span class="dp">·</span>nn,<span class="dp">·</span>optim</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>torch<span class="dp">·</span>import<span class="dp">·</span>nn,<span class="dp">·</span>optim</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>torch.nn.modules.loss<span class="dp">·</span>import<span class="dp">·</span>_Loss<span class="dp">·</span>as<span class="dp">·</span>BaseTorchLoss</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>torch.nn.modules.loss<span class="dp">·</span>import<span class="dp">·</span>_Loss<span class="dp">·</span>as<span class="dp">·</span>BaseTorchLoss</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>torchmetrics<span class="dp">·</span>import<span class="dp">·</span>Metric</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>BaseModule(ABC,<span class="dp">·</span>nn.Module):</td><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>BaseModule(ABC,<span class="dp">·</span>nn.Module):</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>forward(self,<span class="dp">·</span>x):</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>forward(self,<span class="dp">·</span>x):</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 44, 15 lines modified</td><td colspan="2">Offset 43, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>set_weights(self,<span class="dp">·</span>weights):</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.load_state_dict(weights)</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.load_state_dict(weights)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>update_weights(self,<span class="dp">·</span>weights):</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>update_weights(self,<span class="dp">·</span>weights):</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>keys<span class="dp">·</span>=<span class="dp">·</span>self.state_dict().keys()</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>keys<span class="dp">·</span>=<span class="dp">·</span>self.state_dict().keys()</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_dict<span class="dp">·</span>=<span class="dp">·</span>{}</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_dict<span class="dp">·</span>=<span class="dp">·</span>{}</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>k,<span class="dp">·</span>v<span class="dp">·</span>in<span class="dp">·</span>zip(keys,<span class="dp">·</span>weights):</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>k,<span class="dp">·</span>v<span class="dp">·</span>in<span class="dp">·</span>zip(keys,<span class="dp">·</span>weights):</td></tr>
<tr class="diffchanged"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_dict[k]<span class="dp">·</span>=<span class="dp">·</span>torch.Tensor(v)</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>weights_dict[k]<span class="dp">·</span>=<span class="dp">·</span>torch.Tensor(<ins>np.copy(</ins>v<ins>)</ins>)</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.load_state_dict(weights_dict)</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.load_state_dict(weights_dict)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_gradients(self,<span class="dp">·</span>parameters=None):</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>get_gradients(self,<span class="dp">·</span>parameters=None):</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>parameters<span class="dp">·</span>is<span class="dp">·</span>None:</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>parameters<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parameters<span class="dp">·</span>=<span class="dp">·</span>self.parameters()</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parameters<span class="dp">·</span>=<span class="dp">·</span>self.parameters()</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>grads<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>grads<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>p<span class="dp">·</span>in<span class="dp">·</span>parameters:</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>p<span class="dp">·</span>in<span class="dp">·</span>parameters:</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">768 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-strategy-__init__.py"><span class="source">secretflow/ml/nn/fl/backend/torch/strategy/__init__.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-strategy-__init__.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 17 lines modified</td><td colspan="2">Offset 8, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_w<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgW</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_g<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgG</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_g<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgG</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_u<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgU</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_u<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgU</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.fed_avg_w<span class="dp">·</span>import<span class="dp">·</span>PYUFedAvgW</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.fed_prox<span class="dp">·</span>import<span class="dp">·</span>PYUFedProx</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.fed_prox<span class="dp">·</span>import<span class="dp">·</span>PYUFedProx</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.fed_scr<span class="dp">·</span>import<span class="dp">·</span>PYUFedSCR</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.fed_scr<span class="dp">·</span>import<span class="dp">·</span>PYUFedSCR</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.fed_stc<span class="dp">·</span>import<span class="dp">·</span>PYUFedSTC</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.fed_stc<span class="dp">·</span>import<span class="dp">·</span>PYUFedSTC</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">20 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgW&#x27;,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgW&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgG&#x27;,</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PYUFedAvgG&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">465 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_g.py"><span class="source">secretflow/ml/nn/fl/backend/torch/strategy/fed_avg_g.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_g.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 16, 14 lines modified</td><td colspan="2">Offset 16, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgG(BaseTorchModel):</td><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgG(BaseTorchModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">465 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_u.py"><span class="source">secretflow/ml/nn/fl/backend/torch/strategy/fed_avg_u.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_u.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 16, 14 lines modified</td><td colspan="2">Offset 16, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgU(BaseTorchModel):</td><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgU(BaseTorchModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">445 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_w.py"><span class="source">secretflow/ml/nn/fl/backend/torch/strategy/fed_avg_w.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-strategy-fed_avg_w.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 17, 14 lines modified</td><td colspan="2">Offset 17, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Tuple</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>torch</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>torch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgW(BaseTorchModel):</td><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>FedAvgW(BaseTorchModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">449 B</span></div>
    <div id="secretflow-ml-nn-fl-backend-torch-strategy-fed_prox.py"><span class="source">secretflow/ml/nn/fl/backend/torch/strategy/fed_prox.py</span>
      <a class="anchor" href="#secretflow-ml-nn-fl-backend-torch-strategy-fed_prox.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 17, 14 lines modified</td><td colspan="2">Offset 17, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>torch</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>torch</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.backend.torch.fl_base<span class="dp">·</span>import<span class="dp">·</span>BaseTorchModel</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.fl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>FedProx(BaseTorchModel):</td><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>FedProx(BaseTorchModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">6.97 KB</span></div>
    <div id="secretflow-ml-nn-sl-sl_model.py"><span class="source">secretflow/ml/nn/sl/sl_model.py</span>
      <a class="anchor" href="#secretflow-ml-nn-sl-sl_model.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 21, 28 lines modified</td><td colspan="2">Offset 21, 27 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">&quot;&quot;&quot;</td><td class="diffline">21 </td><td class="diffpresent">&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>Iterable,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>Iterable,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>multiprocess<span class="dp">·</span>import<span class="dp">·</span>cpu_count</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>tqdm<span class="dp">·</span>import<span class="dp">·</span>tqdm</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>tqdm<span class="dp">·</span>import<span class="dp">·</span>tqdm</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>Device,<span class="dp">·</span>reveal,<span class="dp">·</span>wait</td><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>Device,<span class="dp">·</span>reveal,<span class="dp">·</span>wait</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>dispatch_strategy</td></tr>
<tr class="diffdeleted"><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.sl_base<span class="dp">·</span>import<span class="dp">·</span>PYUSLTFModel</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.strategy<span class="dp">·</span>import<span class="dp">·</span>PYUSLAsyncTFModel</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td><td class="diffline">35 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor</td><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.random<span class="dp">·</span>import<span class="dp">·</span>global_random</td><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.random<span class="dp">·</span>import<span class="dp">·</span>global_random</td></tr>
<tr class="diffdeleted"><td class="diffline">38 </td><td class="diffpresent">from<span class="dp">·</span>multiprocess<span class="dp">·</span>import<span class="dp">·</span>cpu_count</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent">class<span class="dp">·</span>SLModel:</td><td class="diffline">38 </td><td class="diffpresent">class<span class="dp">·</span>SLModel:</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>base_model_dict:<span class="dp">·</span>Dict[Device,<span class="dp">·</span>Callable[[],<span class="dp">·</span>&#x27;tensorflow.keras.Model&#x27;]]<span class="dp">·</span>=<span class="dp">·</span>{},</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>base_model_dict:<span class="dp">·</span>Dict[Device,<span class="dp">·</span>Callable[[],<span class="dp">·</span>&#x27;tensorflow.keras.Model&#x27;]]<span class="dp">·</span>=<span class="dp">·</span>{},</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device_y:<span class="dp">·</span>PYU<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device_y:<span class="dp">·</span>PYU<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 66, 47 lines modified</td><td colspan="2">Offset 65, 37 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device_y<span class="dp">·</span>=<span class="dp">·</span>device_y</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device_y<span class="dp">·</span>=<span class="dp">·</span>device_y</td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.has_compressor<span class="dp">·</span>=<span class="dp">·</span>compressor<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None</td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.has_compressor<span class="dp">·</span>=<span class="dp">·</span>compressor<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.dp_strategy_dict<span class="dp">·</span>=<span class="dp">·</span>dp_strategy_dict</td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.dp_strategy_dict<span class="dp">·</span>=<span class="dp">·</span>dp_strategy_dict</td></tr>
<tr class="diffunmodified"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.simulation<span class="dp">·</span>=<span class="dp">·</span>kwargs.get(&#x27;simulation&#x27;,<span class="dp">·</span>False)</td><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.simulation<span class="dp">·</span>=<span class="dp">·</span>kwargs.get(&#x27;simulation&#x27;,<span class="dp">·</span>False)</td></tr>
<tr class="diffunmodified"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.num_parties<span class="dp">·</span>=<span class="dp">·</span>len(base_model_dict)</td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.num_parties<span class="dp">·</span>=<span class="dp">·</span>len(base_model_dict)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>if<span class="dp">·</span>str</del>a<del>tegy<span class="dp">·</span>==<span class="dp">·</span>&#x27;split_n</del>n<del>&#x27;:</del></td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>#<span class="dp">·</span></ins><ins>TODO:<span class="dp">·</span></ins>a<ins>dd</ins><ins><span class="dp">·</span>argument<span class="dp">·</span>`backe</ins>n<ins>d`</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.strategy<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>noqa</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>self._workers<span class="dp">·</span>=<span class="dp">·</span>{</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers<span class="dp">·</span>=<span class="dp">·</span>{<ins>}</ins></td></tr>
<tr class="diffchanged"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>d</del>e<del>vic</del>e<del>:</del><span class="dp">·</span><del>PYUSLTFM</del>odel(</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>for</ins><span class="dp">·</span><ins>devic</ins>e<ins>,<span class="dp">·</span></ins><ins>mod</ins>e<ins>l</ins><span class="dp">·</span><ins>i</ins><ins>n<span class="dp">·</span>base_m</ins>odel<ins>_dict.items</ins>(<ins>):</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[device],<span class="dp">·</span>self.check_skip_grad<span class="dp">·</span>=<span class="dp">·</span>dispatch_strategy(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>strategy,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>backend=kwargs.get(&#x27;backend&#x27;,<span class="dp">·</span>&#x27;tensorflow&#x27;),</td></tr>
<tr class="diffchanged"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>device=device,</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device=device,</td></tr>
<tr class="diffchanged"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>builder_base=model,</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>builder_base=model,</td></tr>
<tr class="diffchanged"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>builder_fuse=None<span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>!=<span class="dp">·</span>device_y<span class="dp">·</span>else<span class="dp">·</span>model_fuse,</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>builder_fuse=None<span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>!=<span class="dp">·</span>device_y<span class="dp">·</span>else<span class="dp">·</span>model_fuse,</td></tr>
<tr class="diffchanged"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>compressor=compressor,</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compressor=compressor,</td></tr>
<tr class="diffchanged"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>random_seed=random_seed,</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=random_seed,</td></tr>
<tr class="diffchanged"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>dp_strategy=dp_strategy_dict.get(device,<span class="dp">·</span>None)</td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dp_strategy=dp_strategy_dict.get(device,<span class="dp">·</span>None)</td></tr>
<tr class="diffchanged"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>if<span class="dp">·</span>dp_strategy_dict</td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>dp_strategy_dict</td></tr>
<tr class="diffchanged"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>else<span class="dp">·</span>None,</td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else<span class="dp">·</span>None,</td></tr>
<tr class="diffdeleted"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>model<span class="dp">·</span>in<span class="dp">·</span>base_model_dict.items()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>strategy<span class="dp">·</span>==<span class="dp">·</span>&#x27;split_async&#x27;:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers<span class="dp">·</span>=<span class="dp">·</span>{</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device:<span class="dp">·</span>PYUSLAsyncTFModel(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device=device,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>builder_base=model,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>builder_fuse=None<span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>!=<span class="dp">·</span>device_y<span class="dp">·</span>else<span class="dp">·</span>model_fuse,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compressor=compressor,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed=random_seed,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dp_strategy=dp_strategy_dict.get(device,<span class="dp">·</span>None)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>dp_strategy_dict</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else<span class="dp">·</span>None,</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>base_local_steps=kwargs.get(&#x27;base_local_steps&#x27;,<span class="dp">·</span>1),</td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>base_local_steps=kwargs.get(&#x27;base_local_steps&#x27;,<span class="dp">·</span>1),</td></tr>
<tr class="diffchanged"><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>fuse_local_steps=kwargs.get(&#x27;fuse_local_steps&#x27;,<span class="dp">·</span>1),</td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>fuse_local_steps=kwargs.get(&#x27;fuse_local_steps&#x27;,<span class="dp">·</span>1),</td></tr>
<tr class="diffchanged"><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del>bound_param=kwargs.get(&#x27;bound_param&#x27;,<span class="dp">·</span>0.0),</td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bound_param=kwargs.get(&#x27;bound_param&#x27;,<span class="dp">·</span>0.0),</td></tr>
<tr class="diffdeleted"><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>f</del>o<del>r<span class="dp">·</span>device,<span class="dp">·</span>model<span class="dp">·</span>in<span class="dp">·</span>ba</del>s<del>e</del>_<del>mod</del>e<del>l</del><del>_dict</del>.<del>ite</del><del>ms()</del></td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>l</ins>o<ins>ss</ins><ins>_thres=kwargs.get(&#x27;lo</ins>s<ins>s</ins>_<ins>thr</ins>e<ins>s&#x27;,<span class="dp">·</span>0</ins>.<ins>01),</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>split_steps=kwargs.get(&#x27;split_steps&#x27;,<span class="dp">·</span>1),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_fuse_local_steps=kwargs.get(&#x27;max_fuse_local_steps&#x27;,<span class="dp">·</span>1),</td></tr>
<tr class="diffchanged"><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>}</del></td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>)</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>logging.error(&quot;unvalid<span class="dp">·</span>split<span class="dp">·</span>learning<span class="dp">·</span>strategy:<span class="dp">·</span>&quot;,<span class="dp">·</span>strategy)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>handle_data(</td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>handle_data(</td></tr>
<tr class="diffunmodified"><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>Union[</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x:<span class="dp">·</span>Union[</td></tr>
<tr class="diffunmodified"><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>VDataFrame,</td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>VDataFrame,</td></tr>
<tr class="diffunmodified"><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>List[Union[HDataFrame,<span class="dp">·</span>VDataFrame,<span class="dp">·</span>FedNdarray]],</td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>List[Union[HDataFrame,<span class="dp">·</span>VDataFrame,<span class="dp">·</span>FedNdarray]],</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 298, 14 lines modified</td><td colspan="2">Offset 287, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">298 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">287 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>res<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">299 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>report_list<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">288 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>report_list<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">300 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>report_list.append(f&quot;epoch:<span class="dp">·</span>{epoch+1}/{epochs}<span class="dp">·</span>-<span class="dp">·</span>&quot;)</td><td class="diffline">289 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>report_list.append(f&quot;epoch:<span class="dp">·</span>{epoch+1}/{epochs}<span class="dp">·</span>-<span class="dp">·</span>&quot;)</td></tr>
<tr class="diffunmodified"><td class="diffline">301 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>verbose<span class="dp">·</span>==<span class="dp">·</span>1:</td><td class="diffline">290 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>verbose<span class="dp">·</span>==<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">302 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pbar<span class="dp">·</span>=<span class="dp">·</span>tqdm(total=steps_per_epoch)</td><td class="diffline">291 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pbar<span class="dp">·</span>=<span class="dp">·</span>tqdm(total=steps_per_epoch)</td></tr>
<tr class="diffunmodified"><td class="diffline">303 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].reset_metrics()</td><td class="diffline">292 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].reset_metrics()</td></tr>
<tr class="diffunmodified"><td class="diffline">304 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].on_epoch_begin(epoch)</td><td class="diffline">293 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].on_epoch_begin(epoch)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">294 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>fuse_net_num_returns<span class="dp">·</span>=<span class="dp">·</span>sum(self.basenet_output_num.values())</td></tr>
<tr class="diffunmodified"><td class="diffline">305 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>step<span class="dp">·</span>in<span class="dp">·</span>range(0,<span class="dp">·</span>steps_per_epoch):</td><td class="diffline">295 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>step<span class="dp">·</span>in<span class="dp">·</span>range(0,<span class="dp">·</span>steps_per_epoch):</td></tr>
<tr class="diffunmodified"><td class="diffline">306 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>verbose<span class="dp">·</span>==<span class="dp">·</span>1:</td><td class="diffline">296 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>verbose<span class="dp">·</span>==<span class="dp">·</span>1:</td></tr>
<tr class="diffunmodified"><td class="diffline">307 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pbar.update(1)</td><td class="diffline">297 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pbar.update(1)</td></tr>
<tr class="diffunmodified"><td class="diffline">308 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">298 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">309 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].on_train_batch_begin(step=step)</td><td class="diffline">299 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].on_train_batch_begin(step=step)</td></tr>
<tr class="diffunmodified"><td class="diffline">310 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td><td class="diffline">300 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td></tr>
<tr class="diffunmodified"><td class="diffline">311 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>enable<span class="dp">·</span>compression<span class="dp">·</span>in<span class="dp">·</span>fit<span class="dp">·</span>when<span class="dp">·</span>model<span class="dp">·</span>has<span class="dp">·</span>compressor</td><td class="diffline">301 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>enable<span class="dp">·</span>compression<span class="dp">·</span>in<span class="dp">·</span>fit<span class="dp">·</span>when<span class="dp">·</span>model<span class="dp">·</span>has<span class="dp">·</span>compressor</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 315, 24 lines modified</td><td colspan="2">Offset 305, 33 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">315 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens.append(hidden.to(self.device_y))</td><td class="diffline">305 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens.append(hidden.to(self.device_y))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">316 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>self._workers[self.device_y].fuse_net(</td><td class="diffline">306 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>self._workers[self.device_y].fuse_net(</td></tr>
<tr class="diffunmodified"><td class="diffline">317 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*hiddens,</td><td class="diffline">307 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*hiddens,</td></tr>
<tr class="diffunmodified"><td class="diffline">318 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_num_returns=fuse_net_num_returns,</td><td class="diffline">308 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_num_returns=fuse_net_num_returns,</td></tr>
<tr class="diffunmodified"><td class="diffline">319 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compress=self.has_compressor,</td><td class="diffline">309 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>compress=self.has_compressor,</td></tr>
<tr class="diffunmodified"><td class="diffline">320 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">310 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">311 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>In<span class="dp">·</span>some<span class="dp">·</span>strategies,<span class="dp">·</span>we<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>bypass<span class="dp">·</span>the<span class="dp">·</span>backpropagation<span class="dp">·</span>step.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">312 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>skip_gradient<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">313 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>self.check_skip_grad:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">314 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>skip_gradient<span class="dp">·</span>=<span class="dp">·</span>reveal(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">315 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._workers[self.device_y].get_skip_gradient()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">316 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">317 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>skip_gradient:</td></tr>
<tr class="diffchanged"><td class="diffline">321 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx<span class="dp">·</span>=<span class="dp">·</span>0</td><td class="diffline">318 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>idx<span class="dp">·</span>=<span class="dp">·</span>0</td></tr>
<tr class="diffchanged"><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td><td class="diffline">319 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>for<span class="dp">·</span>device,<span class="dp">·</span>worker<span class="dp">·</span>in<span class="dp">·</span>self._workers.items():</td></tr>
<tr class="diffchanged"><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradient_list<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">320 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>gradient_list<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffchanged"><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(self.basenet_output_num[device]):</td><td class="diffline">321 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(self.basenet_output_num[device]):</td></tr>
<tr class="diffchanged"><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradient<span class="dp">·</span>=<span class="dp">·</span>gradients[idx<span class="dp">·</span>+<span class="dp">·</span>i].to(device)</td><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>gradient<span class="dp">·</span>=<span class="dp">·</span>gradients[idx<span class="dp">·</span>+<span class="dp">·</span>i].to(device)</td></tr>
<tr class="diffchanged"><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradient_list.append(gradient)</td><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>gradient_list.append(gradient)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker.base_backward(</td></tr>
<tr class="diffchanged"><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>worker.base_b</del><del>ackward(</del>gradient_list,<span class="dp">·</span>compress=self.has_compressor<del>)</del></td><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>gradient_list,<span class="dp">·</span>compress=self.has_compressor</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 386/7072 bytes (5.46%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">22.5 KB</span></div>
    <div id="secretflow-ml-nn-sl-backend-tensorflow-sl_base.py"><span class="source">secretflow/ml/nn/sl/backend/tensorflow/sl_base.py</span>
      <a class="anchor" href="#secretflow-ml-nn-sl-backend-tensorflow-sl_base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 31, 19 lines modified</td><td colspan="2">Offset 31, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>torch<span class="dp">·</span>import<span class="dp">·</span>nn</td><td class="diffline">31 </td><td class="diffpresent">from<span class="dp">·</span>torch<span class="dp">·</span>import<span class="dp">·</span>nn</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>torch.nn.modules.loss<span class="dp">·</span>import<span class="dp">·</span>_Loss<span class="dp">·</span>as<span class="dp">·</span>BaseTorchLoss</td><td class="diffline">32 </td><td class="diffpresent">from<span class="dp">·</span>torch.nn.modules.loss<span class="dp">·</span>import<span class="dp">·</span>_Loss<span class="dp">·</span>as<span class="dp">·</span>BaseTorchLoss</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>torch.optim<span class="dp">·</span>import<span class="dp">·</span>Optimizer</td><td class="diffline">33 </td><td class="diffpresent">from<span class="dp">·</span>torch.optim<span class="dp">·</span>import<span class="dp">·</span>Optimizer</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>torch.utils.data<span class="dp">·</span>import<span class="dp">·</span>DataLoader</td><td class="diffline">34 </td><td class="diffpresent">from<span class="dp">·</span>torch.utils.data<span class="dp">·</span>import<span class="dp">·</span>DataLoader</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.device<span class="dp">·</span>as<span class="dp">·</span>ft</td><td class="diffline">35 </td><td class="diffpresent">import<span class="dp">·</span>secretflow.device<span class="dp">·</span>as<span class="dp">·</span>ft</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">36 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>AUC,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.utils<span class="dp">·</span>import<span class="dp">·</span>ForwardData</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td><td class="diffline">40 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor,<span class="dp">·</span>SparseCompressor</td><td class="diffline">41 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor,<span class="dp">·</span>SparseCompressor</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">39 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.metrics<span class="dp">·</span>import<span class="dp">·</span>AUC,<span class="dp">·</span>Mean,<span class="dp">·</span>Precision,<span class="dp">·</span>Recall</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent">class<span class="dp">·</span>SLBaseModel(ABC):</td><td class="diffline">42 </td><td class="diffpresent">class<span class="dp">·</span>SLBaseModel(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>builder_base:<span class="dp">·</span>Callable,<span class="dp">·</span>builder_fuse:<span class="dp">·</span>Callable<span class="dp">·</span>=<span class="dp">·</span>None):</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>builder_base:<span class="dp">·</span>Callable,<span class="dp">·</span>builder_fuse:<span class="dp">·</span>Callable<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_base<span class="dp">·</span>=<span class="dp">·</span>builder_base()<span class="dp">·</span>if<span class="dp">·</span>builder_base<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_base<span class="dp">·</span>=<span class="dp">·</span>builder_base()<span class="dp">·</span>if<span class="dp">·</span>builder_base<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_fuse<span class="dp">·</span>=<span class="dp">·</span>builder_fuse()<span class="dp">·</span>if<span class="dp">·</span>builder_fuse<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_fuse<span class="dp">·</span>=<span class="dp">·</span>builder_fuse()<span class="dp">·</span>if<span class="dp">·</span>builder_fuse<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>else<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 112, 23 lines modified</td><td colspan="2">Offset 113, 26 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_set<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.valid_set<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.valid_set<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.tape<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.tape<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.h<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.h<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_x,<span class="dp">·</span>self.train_y<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>None</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_x,<span class="dp">·</span>self.train_y<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_x,<span class="dp">·</span>self.eval_y<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>None</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_x,<span class="dp">·</span>self.eval_y<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.kwargs<span class="dp">·</span>=<span class="dp">·</span>{}</td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.kwargs<span class="dp">·</span>=<span class="dp">·</span>{}</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_has_y<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffchanged"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.has_y<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.<ins>eval_</ins>has_y<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffchanged"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.<ins>eval_</ins>has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_sample_weight<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_sample_weight<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_sample_weight<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.eval_sample_weight<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.fuse_callbacks<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.fuse_callbacks<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.logs<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.logs<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.epoch_logs<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.epoch_logs<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.training_logs<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.training_logs<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.steps_per_epoch<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.skip_gradient<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>random_seed<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>random_seed<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.keras.utils.set_random_seed(random_seed)</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.keras.utils.set_random_seed(random_seed)</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(builder_base,<span class="dp">·</span>builder_fuse)</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__(builder_base,<span class="dp">·</span>builder_fuse)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@staticmethod</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@staticmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@tf.custom_gradient</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@tf.custom_gradient</td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>fuse_op(x,<span class="dp">·</span>y):</td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>fuse_op(x,<span class="dp">·</span>y):</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 181, 35 lines modified</td><td colspan="2">Offset 185, 37 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle:<span class="dp">·</span>whether<span class="dp">·</span>shuffle<span class="dp">·</span>the<span class="dp">·</span>dataset<span class="dp">·</span>or<span class="dp">·</span>not</td><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>shuffle:<span class="dp">·</span>whether<span class="dp">·</span>shuffle<span class="dp">·</span>the<span class="dp">·</span>dataset<span class="dp">·</span>or<span class="dp">·</span>not</td></tr>
<tr class="diffunmodified"><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count:<span class="dp">·</span>num<span class="dp">·</span>of<span class="dp">·</span>repeats</td><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>repeat_count:<span class="dp">·</span>num<span class="dp">·</span>of<span class="dp">·</span>repeats</td></tr>
<tr class="diffunmodified"><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>datset</td><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>datset</td></tr>
<tr class="diffunmodified"><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed:<span class="dp">·</span>Prg<span class="dp">·</span>seed<span class="dp">·</span>for<span class="dp">·</span>shuffling</td><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>random_seed:<span class="dp">·</span>Prg<span class="dp">·</span>seed<span class="dp">·</span>for<span class="dp">·</span>shuffling</td></tr>
<tr class="diffunmodified"><td class="diffline">185 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">186 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x<span class="dp">·</span>and<span class="dp">·</span>x[0]<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;X<span class="dp">·</span>can<span class="dp">·</span>not<span class="dp">·</span>be<span class="dp">·</span>None,<span class="dp">·</span>please<span class="dp">·</span>check&quot;</td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x<span class="dp">·</span>and<span class="dp">·</span>x[0]<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;X<span class="dp">·</span>can<span class="dp">·</span>not<span class="dp">·</span>be<span class="dp">·</span>None,<span class="dp">·</span>please<span class="dp">·</span>check&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">187 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[xi<span class="dp">·</span>for<span class="dp">·</span>xi<span class="dp">·</span>in<span class="dp">·</span>x]</td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[xi<span class="dp">·</span>for<span class="dp">·</span>xi<span class="dp">·</span>in<span class="dp">·</span>x]</td></tr>
<tr class="diffchanged"><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_y<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_y<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffchanged"><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(y.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(y.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffchanged"><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_y<span class="dp">·</span>=<span class="dp">·</span>True</td><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_y<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffunmodified"><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td></tr>
<tr class="diffunmodified"><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffchanged"><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_s_w<span class="dp">·</span>=<span class="dp">·</span>True</td><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_s_w<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffunmodified"><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>convert<span class="dp">·</span>pandas.DataFrame<span class="dp">·</span>to<span class="dp">·</span>numpy.ndarray</td><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>convert<span class="dp">·</span>pandas.DataFrame<span class="dp">·</span>to<span class="dp">·</span>numpy.ndarray</td></tr>
<tr class="diffunmodified"><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[t.values<span class="dp">·</span>if<span class="dp">·</span>isinstance(t,<span class="dp">·</span>pd.DataFrame)<span class="dp">·</span>else<span class="dp">·</span>t<span class="dp">·</span>for<span class="dp">·</span>t<span class="dp">·</span>in<span class="dp">·</span>x]</td><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[t.values<span class="dp">·</span>if<span class="dp">·</span>isinstance(t,<span class="dp">·</span>pd.DataFrame)<span class="dp">·</span>else<span class="dp">·</span>t<span class="dp">·</span>for<span class="dp">·</span>t<span class="dp">·</span>in<span class="dp">·</span>x]</td></tr>
<tr class="diffunmodified"><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>https://github.com/tensorflow/tensorflow/issues/20481</td><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>https://github.com/tensorflow/tensorflow/issues/20481</td></tr>
<tr class="diffunmodified"><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>x[0]<span class="dp">·</span>if<span class="dp">·</span>len(x)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>else<span class="dp">·</span>tuple(x)</td><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>x[0]<span class="dp">·</span>if<span class="dp">·</span>len(x)<span class="dp">·</span>==<span class="dp">·</span>1<span class="dp">·</span>else<span class="dp">·</span>tuple(x)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>(</td><td class="diffline">204 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.data.Dataset.from_tensor_slices(x).batch(batch_size).repeat(repeat_count)</td><td class="diffline">205 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.data.Dataset.from_tensor_slices(x).batch(batch_size).repeat(repeat_count)</td></tr>
<tr class="diffunmodified"><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">206 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>shuffle:</td><td class="diffline">207 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>shuffle:</td></tr>
<tr class="diffunmodified"><td class="diffline">204 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>data_set.shuffle(buffer_size,<span class="dp">·</span>seed=random_seed)</td><td class="diffline">208 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>data_set.shuffle(buffer_size,<span class="dp">·</span>seed=random_seed)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">205 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.set_dataset_stage(<del>data_set=data_set,<span class="dp">·</span>stage=stage)</del></td><td class="diffline">209 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.set_dataset_stage(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">210 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set=data_set,<span class="dp">·</span>stage=stage,<span class="dp">·</span>has_y=has_y,<span class="dp">·</span>has_s_w=has_s_w</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">211 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">206 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>build_dataset_from_builder(</td><td class="diffline">212 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>build_dataset_from_builder(</td></tr>
<tr class="diffunmodified"><td class="diffline">207 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">213 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffunmodified"><td class="diffline">208 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*x:<span class="dp">·</span>List[np.ndarray],</td><td class="diffline">214 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>*x:<span class="dp">·</span>List[np.ndarray],</td></tr>
<tr class="diffunmodified"><td class="diffline">209 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">215 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">210 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">216 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>Optional[np.ndarray]<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">211 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size=-1,</td><td class="diffline">217 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size=-1,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 226, 21 lines modified</td><td colspan="2">Offset 232, 21 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">226 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>label,<span class="dp">·</span>FedNdArray<span class="dp">·</span>or<span class="dp">·</span>HDataFrame</td><td class="diffline">232 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y:<span class="dp">·</span>label,<span class="dp">·</span>FedNdArray<span class="dp">·</span>or<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">227 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>sample<span class="dp">·</span>weight,<span class="dp">·</span>FedNdArray<span class="dp">·</span>or<span class="dp">·</span>HDataFrame</td><td class="diffline">233 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>s_w:<span class="dp">·</span>sample<span class="dp">·</span>weight,<span class="dp">·</span>FedNdArray<span class="dp">·</span>or<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">228 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>datset</td><td class="diffline">234 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage:<span class="dp">·</span>stage<span class="dp">·</span>of<span class="dp">·</span>this<span class="dp">·</span>datset</td></tr>
<tr class="diffunmodified"><td class="diffline">229 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>dataset<span class="dp">·</span>build<span class="dp">·</span>callable<span class="dp">·</span>function<span class="dp">·</span>of<span class="dp">·</span>worker</td><td class="diffline">235 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dataset_builder:<span class="dp">·</span>dataset<span class="dp">·</span>build<span class="dp">·</span>callable<span class="dp">·</span>function<span class="dp">·</span>of<span class="dp">·</span>worker</td></tr>
<tr class="diffunmodified"><td class="diffline">230 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">236 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">231 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x<span class="dp">·</span>and<span class="dp">·</span>x[0]<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;X<span class="dp">·</span>can<span class="dp">·</span>not<span class="dp">·</span>be<span class="dp">·</span>None,<span class="dp">·</span>please<span class="dp">·</span>check&quot;</td><td class="diffline">237 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>x<span class="dp">·</span>and<span class="dp">·</span>x[0]<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None,<span class="dp">·</span>&quot;X<span class="dp">·</span>can<span class="dp">·</span>not<span class="dp">·</span>be<span class="dp">·</span>None,<span class="dp">·</span>please<span class="dp">·</span>check&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">232 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[xi<span class="dp">·</span>for<span class="dp">·</span>xi<span class="dp">·</span>in<span class="dp">·</span>x]</td><td class="diffline">238 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>=<span class="dp">·</span>[xi<span class="dp">·</span>for<span class="dp">·</span>xi<span class="dp">·</span>in<span class="dp">·</span>x]</td></tr>
<tr class="diffchanged"><td class="diffline">233 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_y<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">239 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_y<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffchanged"><td class="diffline">234 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td><td class="diffline">240 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_s_w<span class="dp">·</span>=<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td class="diffline">235 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(y.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td><td class="diffline">241 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>y<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(y.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffchanged"><td class="diffline">236 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_y<span class="dp">·</span>=<span class="dp">·</span>True</td><td class="diffline">242 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_y<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffunmodified"><td class="diffline">237 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td><td class="diffline">243 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(y)</td></tr>
<tr class="diffunmodified"><td class="diffline">238 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td><td class="diffline">244 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>s_w<span class="dp">·</span>is<span class="dp">·</span>not<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>len(s_w.shape)<span class="dp">·</span>&gt;<span class="dp">·</span>0:</td></tr>
<tr class="diffchanged"><td class="diffline">239 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.</del>has_s_w<span class="dp">·</span>=<span class="dp">·</span>True</td><td class="diffline">245 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_s_w<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffunmodified"><td class="diffline">240 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td><td class="diffline">246 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x.append(s_w)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">241 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x)</td><td class="diffline">247 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set<span class="dp">·</span>=<span class="dp">·</span>dataset_builder(x)</td></tr>
<tr class="diffunmodified"><td class="diffline">242 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Compatible<span class="dp">·</span>with<span class="dp">·</span>existing<span class="dp">·</span>gnn<span class="dp">·</span>databuilder</td><td class="diffline">248 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Compatible<span class="dp">·</span>with<span class="dp">·</span>existing<span class="dp">·</span>gnn<span class="dp">·</span>databuilder</td></tr>
<tr class="diffunmodified"><td class="diffline">243 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(data_set,<span class="dp">·</span>&#x27;steps_per_epoch&#x27;):</td><td class="diffline">249 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>hasattr(data_set,<span class="dp">·</span>&#x27;steps_per_epoch&#x27;):</td></tr>
<tr class="diffunmodified"><td class="diffline">244 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>data_set.steps_per_epoch</td><td class="diffline">250 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>data_set.steps_per_epoch</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 262, 28 lines modified</td><td colspan="2">Offset 268, 43 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">262 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">268 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">263 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>=<span class="dp">·</span>batch_size_inf</td><td class="diffline">269 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>batch_size<span class="dp">·</span>=<span class="dp">·</span>batch_size_inf</td></tr>
<tr class="diffunmodified"><td class="diffline">264 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">270 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">265 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(</td><td class="diffline">271 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>Exception(</td></tr>
<tr class="diffunmodified"><td class="diffline">266 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;Unable<span class="dp">·</span>to<span class="dp">·</span>get<span class="dp">·</span>batchsize<span class="dp">·</span>from<span class="dp">·</span>dataset,<span class="dp">·</span>please<span class="dp">·</span>spcify<span class="dp">·</span>batchsize<span class="dp">·</span>in<span class="dp">·</span>&#x27;fit&#x27;&quot;</td><td class="diffline">272 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&quot;Unable<span class="dp">·</span>to<span class="dp">·</span>get<span class="dp">·</span>batchsize<span class="dp">·</span>from<span class="dp">·</span>dataset,<span class="dp">·</span>please<span class="dp">·</span>spcify<span class="dp">·</span>batchsize<span class="dp">·</span>in<span class="dp">·</span>&#x27;fit&#x27;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">267 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">273 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">268 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.set_dataset_stage(<del>data_set=data_set,<span class="dp">·</span>stage=stage)</del></td><td class="diffline">274 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.set_dataset_stage(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">275 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_set=data_set,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">276 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stage=stage,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">277 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_y=has_y,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">278 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>has_s_w=has_s_w,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">279 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">269 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data_set,<span class="dp">·</span>tf.data.Dataset):</td><td class="diffline">280 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data_set,<span class="dp">·</span>tf.data.Dataset):</td></tr>
<tr class="diffunmodified"><td class="diffline">270 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>math</td><td class="diffline">281 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">271 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>math.ceil(len(x[0])<span class="dp">·</span>/<span class="dp">·</span>batch_size)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>use<span class="dp">·</span>ceil<span class="dp">·</span>to<span class="dp">·</span>avoid<span class="dp">·</span>drop_last</td><td class="diffline">282 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>math.ceil(len(x[0])<span class="dp">·</span>/<span class="dp">·</span>batch_size)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>use<span class="dp">·</span>ceil<span class="dp">·</span>to<span class="dp">·</span>avoid<span class="dp">·</span>drop_last</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 17945/22979 bytes (78.09%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.25 KB</span></div>
    <div id="secretflow-ml-nn-sl-backend-tensorflow-utils.py"><span class="source">secretflow/ml/nn/sl/backend/tensorflow/utils.py</span>
      <a class="anchor" href="#secretflow-ml-nn-sl-backend-tensorflow-utils.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 13, 15 lines modified</td><td colspan="2">Offset 13, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">14 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">15 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">16 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>L</del><del>ist</del>,<span class="dp">·</span>Callable</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>Any</ins>,<span class="dp">·</span>Callable<ins>,<span class="dp">·</span>List,<span class="dp">·</span>Union</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>custom_loss:</td><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>custom_loss:</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Decorator<span class="dp">·</span>to<span class="dp">·</span>define<span class="dp">·</span>a<span class="dp">·</span>function<span class="dp">·</span>with<span class="dp">·</span>a<span class="dp">·</span>custom<span class="dp">·</span>loss.</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Decorator<span class="dp">·</span>to<span class="dp">·</span>define<span class="dp">·</span>a<span class="dp">·</span>function<span class="dp">·</span>with<span class="dp">·</span>a<span class="dp">·</span>custom<span class="dp">·</span>loss.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 128, 7 lines modified</td><td colspan="2">Offset 128, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.tensor_name<span class="dp">·</span>=<span class="dp">·</span>info_pb.name</td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.tensor_name<span class="dp">·</span>=<span class="dp">·</span>info_pb.name</td></tr>
<tr class="diffunmodified"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.dtype<span class="dp">·</span>=<span class="dp">·</span>(</td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.dtype<span class="dp">·</span>=<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>supported_dtypes[info_pb.dtype]<span class="dp">·</span>if<span class="dp">·</span>info_pb.dtype<span class="dp">·</span>in<span class="dp">·</span>supported_dtypes<span class="dp">·</span>else<span class="dp">·</span>&quot;&quot;</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>supported_dtypes[info_pb.dtype]<span class="dp">·</span>if<span class="dp">·</span>info_pb.dtype<span class="dp">·</span>in<span class="dp">·</span>supported_dtypes<span class="dp">·</span>else<span class="dp">·</span>&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.shape.extend([dim.size<span class="dp">·</span>for<span class="dp">·</span>dim<span class="dp">·</span>in<span class="dp">·</span>info_pb.tensor_shape.dim])</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tensor_info.shape.extend([dim.size<span class="dp">·</span>for<span class="dp">·</span>dim<span class="dp">·</span>in<span class="dp">·</span>info_pb.tensor_shape.dim])</td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>results.append(tensor_info)</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>results.append(tensor_info)</td></tr>
<tr class="diffunmodified"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>results</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>results</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">135 </td><td class="diffpresent">@dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">136 </td><td class="diffpresent">class<span class="dp">·</span>ForwardData:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>ForwardData<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>dataclass<span class="dp">·</span>for<span class="dp">·</span>data<span class="dp">·</span>uploaded<span class="dp">·</span>by<span class="dp">·</span>each<span class="dp">·</span>party<span class="dp">·</span>to<span class="dp">·</span>label<span class="dp">·</span>party<span class="dp">·</span>for<span class="dp">·</span>computation.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hidden:<span class="dp">·</span>base<span class="dp">·</span>model<span class="dp">·</span>hidden<span class="dp">·</span>layers<span class="dp">·</span>outputs</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>losses:<span class="dp">·</span>the<span class="dp">·</span>sum<span class="dp">·</span>of<span class="dp">·</span>base<span class="dp">·</span>model<span class="dp">·</span>losses<span class="dp">·</span>should<span class="dp">·</span>added<span class="dp">·</span>up<span class="dp">·</span>to<span class="dp">·</span>fuse<span class="dp">·</span>model<span class="dp">·</span>loss</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hidden:<span class="dp">·</span>Union[Any,<span class="dp">·</span>List[Any]]<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>losses:<span class="dp">·</span>Any<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">691 B</span></div>
    <div id="secretflow-ml-nn-sl-backend-tensorflow-strategy-__init__.py"><span class="source">secretflow/ml/nn/sl/backend/tensorflow/strategy/__init__.py</span>
      <a class="anchor" href="#secretflow-ml-nn-sl-backend-tensorflow-strategy-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 7, 11 lines modified</td><td colspan="2">Offset 7, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.split_async<span class="dp">·</span>import<span class="dp">·</span>PYUSLAsyncTFModel</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.split_async<span class="dp">·</span>import<span class="dp">·</span>PYUSLAsyncTFModel</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.split_state_async<span class="dp">·</span>import<span class="dp">·</span>PYUSLStateAsyncTFModel</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">16 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;PYUSLAsyncTFModel&quot;,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;PYUSLAsyncTFModel&quot;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;PYUSLStateAsyncTFModel&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">]</td><td class="diffline">19 </td><td class="diffpresent">]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">3.54 KB</span></div>
    <div id="secretflow-ml-nn-sl-backend-tensorflow-strategy-split_async.py"><span class="source">secretflow/ml/nn/sl/backend/tensorflow/strategy/split_async.py</span>
      <a class="anchor" href="#secretflow-ml-nn-sl-backend-tensorflow-strategy-split_async.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 14 lines modified</td><td colspan="2">Offset 23, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>List</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Callable,<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td class="diffline">25 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.sl_base<span class="dp">·</span>import<span class="dp">·</span>SLBaseTFModel</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.backend.tensorflow.sl_base<span class="dp">·</span>import<span class="dp">·</span>SLBaseTFModel</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.nn.sl.strategy_dispatcher<span class="dp">·</span>import<span class="dp">·</span>register_strategy</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor</td><td class="diffline">30 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>Compressor</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">class<span class="dp">·</span>SLAsyncTFModel(SLBaseTFModel):</td><td class="diffline">31 </td><td class="diffpresent">class<span class="dp">·</span>SLAsyncTFModel(SLBaseTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 89, 52 lines modified</td><td colspan="2">Offset 90, 61 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>self._base_forward_internal(self.data_x,<span class="dp">·</span>use_dp=False)</td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>self._base_forward_internal(self.data_x,<span class="dp">·</span>use_dp=False)</td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(gradient)<span class="dp">·</span>==<span class="dp">·</span>len(h):</td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(gradient)<span class="dp">·</span>==<span class="dp">·</span>len(h):</td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(len(gradient)):</td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i<span class="dp">·</span>in<span class="dp">·</span>range(len(gradient)):</td></tr>
<tr class="diffunmodified"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return_hiddens.append(self.fuse_op(h[i],<span class="dp">·</span>gradient[i]))</td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return_hiddens.append(self.fuse_op(h[i],<span class="dp">·</span>gradient[i]))</td></tr>
<tr class="diffunmodified"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradient<span class="dp">·</span>=<span class="dp">·</span>gradient[0]</td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradient<span class="dp">·</span>=<span class="dp">·</span>gradient[0]</td></tr>
<tr class="diffunmodified"><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return_hiddens.append(self.fuse_op(h,<span class="dp">·</span>gradient))</td><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return_hiddens.append(self.fuse_op(h,<span class="dp">·</span>gradient))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>add<span class="dp">·</span>model.losses<span class="dp">·</span>into<span class="dp">·</span>graph</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return_hiddens.append(self.model_base.losses)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>trainable_vars<span class="dp">·</span>=<span class="dp">·</span>self.model_base.trainable_variables</td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>trainable_vars<span class="dp">·</span>=<span class="dp">·</span>self.model_base.trainable_variables</td></tr>
<tr class="diffunmodified"><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>self.tape.gradient(return_hiddens,<span class="dp">·</span>trainable_vars)</td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>self.tape.gradient(return_hiddens,<span class="dp">·</span>trainable_vars)</td></tr>
<tr class="diffunmodified"><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._base_backward_internal(gradients,<span class="dp">·</span>trainable_vars)</td><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._base_backward_internal(gradients,<span class="dp">·</span>trainable_vars)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>clear<span class="dp">·</span>intermediate<span class="dp">·</span>results</td><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>clear<span class="dp">·</span>intermediate<span class="dp">·</span>results</td></tr>
<tr class="diffunmodified"><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.tape<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.tape<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.h<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.h<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data_x<span class="dp">·</span>=<span class="dp">·</span>None</td><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.data_x<span class="dp">·</span>=<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.kwargs<span class="dp">·</span>=<span class="dp">·</span>{}</td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.kwargs<span class="dp">·</span>=<span class="dp">·</span>{}</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_fuse_net_train(self,<span class="dp">·</span>hiddens):</td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_fuse_net_train(self,<span class="dp">·</span>hiddens<ins>,<span class="dp">·</span>losses=[]</ins>):</td></tr>
<tr class="diffunmodified"><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.hiddens<span class="dp">·</span>=<span class="dp">·</span>copy.deepcopy(hiddens)</td><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.hiddens<span class="dp">·</span>=<span class="dp">·</span>copy.deepcopy(hiddens)</td></tr>
<tr class="diffunmodified"><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self._fuse_net_async_internal(</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>self._fuse_net_async_internal(</td></tr>
<tr class="diffunmodified"><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens,</td><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>losses,</td></tr>
<tr class="diffunmodified"><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_y,</td><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_y,</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_sample_weight,</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.train_sample_weight,</td></tr>
<tr class="diffunmodified"><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.fuse_local_steps,</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.fuse_local_steps,</td></tr>
<tr class="diffunmodified"><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.bound_param,</td><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.bound_param,</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@tf.function</td><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@tf.function</td></tr>
<tr class="diffunmodified"><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_fuse_net_async_internal(</td><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_fuse_net_async_internal(</td></tr>
<tr class="diffchanged"><td class="diffline">115 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,<del><span class="dp">·</span>hiddens,<span class="dp">·</span>train_y,<span class="dp">·</span>train_sample_weight,<span class="dp">·</span>fuse_local_steps,<span class="dp">·</span>bound_param</del></td><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hiddens,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>losses,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_y,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_sample_weight,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>fuse_local_steps,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bound_param,</td></tr>
<tr class="diffunmodified"><td class="diffline">116 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>):</td></tr>
<tr class="diffunmodified"><td class="diffline">117 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>accumulated_gradients<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>accumulated_gradients<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">118 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>local_step<span class="dp">·</span>in<span class="dp">·</span>range(fuse_local_steps):</td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>local_step<span class="dp">·</span>in<span class="dp">·</span>range(fuse_local_steps):</td></tr>
<tr class="diffunmodified"><td class="diffline">119 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>tf.GradientTape(persistent=True)<span class="dp">·</span>as<span class="dp">·</span>tape:</td><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>tf.GradientTape(persistent=True)<span class="dp">·</span>as<span class="dp">·</span>tape:</td></tr>
<tr class="diffunmodified"><td class="diffline">120 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>h<span class="dp">·</span>in<span class="dp">·</span>hiddens:</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>h<span class="dp">·</span>in<span class="dp">·</span>hiddens:</td></tr>
<tr class="diffunmodified"><td class="diffline">121 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tape.watch(h)</td><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tape.watch(h)</td></tr>
<tr class="diffunmodified"><td class="diffline">122 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step<span class="dp">·</span>1:<span class="dp">·</span>forward<span class="dp">·</span>pass</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step<span class="dp">·</span>1:<span class="dp">·</span>forward<span class="dp">·</span>pass</td></tr>
<tr class="diffunmodified"><td class="diffline">123 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse(hiddens,<span class="dp">·</span>training=True,<span class="dp">·</span>**self.kwargs)</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse(hiddens,<span class="dp">·</span>training=True,<span class="dp">·</span>**self.kwargs)</td></tr>
<tr class="diffunmodified"><td class="diffline">124 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step<span class="dp">·</span>2:<span class="dp">·</span>loss<span class="dp">·</span>calculation,<span class="dp">·</span>the<span class="dp">·</span>loss<span class="dp">·</span>function<span class="dp">·</span>is<span class="dp">·</span>configured<span class="dp">·</span>in<span class="dp">·</span>`compile()`.</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step<span class="dp">·</span>2:<span class="dp">·</span>loss<span class="dp">·</span>calculation,<span class="dp">·</span>the<span class="dp">·</span>loss<span class="dp">·</span>function<span class="dp">·</span>is<span class="dp">·</span>configured<span class="dp">·</span>in<span class="dp">·</span>`compile()`.</td></tr>
<tr class="diffunmodified"><td class="diffline">125 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>loss<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse.compiled_loss(</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>loss<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse.compiled_loss(</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_y,</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>train_y,</td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred,</td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred,</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sample_weight=train_sample_weight,</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sample_weight=train_sample_weight,</td></tr>
<tr class="diffchanged"><td class="diffline">129 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>regularization_losses=self.model_fuse.losses,</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>regularization_losses=self.model_fuse.losses<ins><span class="dp">·</span>+<span class="dp">·</span>losses</ins>,</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step3:<span class="dp">·</span>compute<span class="dp">·</span>gradients</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>Step3:<span class="dp">·</span>compute<span class="dp">·</span>gradients</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>trainable_vars<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse.trainable_variables</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>trainable_vars<span class="dp">·</span>=<span class="dp">·</span>self.model_fuse.trainable_variables</td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>tape.gradient(loss,<span class="dp">·</span>trainable_vars)</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>gradients<span class="dp">·</span>=<span class="dp">·</span>tape.gradient(loss,<span class="dp">·</span>trainable_vars)</td></tr>
<tr class="diffunmodified"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_fuse.optimizer.apply_gradients(zip(gradients,<span class="dp">·</span>trainable_vars))</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.model_fuse.optimizer.apply_gradients(zip(gradients,<span class="dp">·</span>trainable_vars))</td></tr>
<tr class="diffunmodified"><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hidden_layer_gradients<span class="dp">·</span>=<span class="dp">·</span>tape.gradient(loss,<span class="dp">·</span>hiddens)</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>hidden_layer_gradients<span class="dp">·</span>=<span class="dp">·</span>tape.gradient(loss,<span class="dp">·</span>hiddens)</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 165, 10 lines modified</td><td colspan="2">Offset 175, 11 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">165 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.math.subtract(layer_var,<span class="dp">·</span>tf.math.multiply(lr,<span class="dp">·</span>h_grad))</td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>tf.math.subtract(layer_var,<span class="dp">·</span>tf.math.multiply(lr,<span class="dp">·</span>h_grad))</td></tr>
<tr class="diffunmodified"><td class="diffline">166 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>layer_var,<span class="dp">·</span>h_grad<span class="dp">·</span>in<span class="dp">·</span>zip(hiddens,<span class="dp">·</span>hidden_layer_gradients)</td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>layer_var,<span class="dp">·</span>h_grad<span class="dp">·</span>in<span class="dp">·</span>zip(hiddens,<span class="dp">·</span>hidden_layer_gradients)</td></tr>
<tr class="diffunmodified"><td class="diffline">167 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">168 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>accumulated_gradients</td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>accumulated_gradients</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent">@register_strategy(strategy_name=&#x27;split_async&#x27;,<span class="dp">·</span>backend=&#x27;tensorflow&#x27;)</td></tr>
<tr class="diffunmodified"><td class="diffline">169 </td><td class="diffpresent">@proxy(PYUObject)</td><td class="diffline">180 </td><td class="diffpresent">@proxy(PYUObject)</td></tr>
<tr class="diffunmodified"><td class="diffline">170 </td><td class="diffpresent">class<span class="dp">·</span>PYUSLAsyncTFModel(SLAsyncTFModel):</td><td class="diffline">181 </td><td class="diffpresent">class<span class="dp">·</span>PYUSLAsyncTFModel(SLAsyncTFModel):</td></tr>
<tr class="diffunmodified"><td class="diffline">171 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>pass</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">894 B</span></div>
    <div id="secretflow-preprocessing-discretization.py"><span class="source">secretflow/preprocessing/discretization.py</span>
      <a class="anchor" href="#secretflow-preprocessing-discretization.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 19, 18 lines modified</td><td colspan="2">Offset 19, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>KBinsDiscretizer<span class="dp">·</span>as<span class="dp">·</span>SkKBinsDiscretizer</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>KBinsDiscretizer<span class="dp">·</span>as<span class="dp">·</span>SkKBinsDiscretizer</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix.dataframe<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix.dataframe<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.driver<span class="dp">·</span>import<span class="dp">·</span>reveal</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.driver<span class="dp">·</span>import<span class="dp">·</span>reveal</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.base<span class="dp">·</span>import<span class="dp">·</span>_PreprocessBase</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.homo_binning<span class="dp">·</span>import<span class="dp">·</span>HomoBinning</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.homo_binning<span class="dp">·</span>import<span class="dp">·</span>HomoBinning</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.compare<span class="dp">·</span>import<span class="dp">·</span>Comparator</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.compare<span class="dp">·</span>import<span class="dp">·</span>Comparator</td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.base<span class="dp">·</span>import<span class="dp">·</span>_PreprocessBase</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">_STRATEGIES<span class="dp">·</span>=<span class="dp">·</span>[&#x27;uniform&#x27;,<span class="dp">·</span>&#x27;quantile&#x27;]</td><td class="diffline">29 </td><td class="diffpresent">_STRATEGIES<span class="dp">·</span>=<span class="dp">·</span>[&#x27;uniform&#x27;,<span class="dp">·</span>&#x27;quantile&#x27;]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">class<span class="dp">·</span>KBinsDiscretizer(_PreprocessBase):</td><td class="diffline">30 </td><td class="diffpresent">class<span class="dp">·</span>KBinsDiscretizer(_PreprocessBase):</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Bin<span class="dp">·</span>continuous<span class="dp">·</span>data<span class="dp">·</span>into<span class="dp">·</span>intervals.</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Bin<span class="dp">·</span>continuous<span class="dp">·</span>data<span class="dp">·</span>into<span class="dp">·</span>intervals.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">849 B</span></div>
    <div id="secretflow-preprocessing-scaler.py"><span class="source">secretflow/preprocessing/scaler.py</span>
      <a class="anchor" href="#secretflow-preprocessing-scaler.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 20, 17 lines modified</td><td colspan="2">Offset 20, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>StandardScaler<span class="dp">·</span>as<span class="dp">·</span>SkStandardScaler</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>StandardScaler<span class="dp">·</span>as<span class="dp">·</span>SkStandardScaler</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.mix<span class="dp">·</span>import<span class="dp">·</span>MixDataFrame,<span class="dp">·</span>PartitionWay</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.driver<span class="dp">·</span>import<span class="dp">·</span>reveal</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.driver<span class="dp">·</span>import<span class="dp">·</span>reveal</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.base<span class="dp">·</span>import<span class="dp">·</span>_PreprocessBase</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.base<span class="dp">·</span>import<span class="dp">·</span>_PreprocessBase</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">class<span class="dp">·</span>MinMaxScaler(_PreprocessBase):</td><td class="diffline">29 </td><td class="diffpresent">class<span class="dp">·</span>MinMaxScaler(_PreprocessBase):</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Transform<span class="dp">·</span>features<span class="dp">·</span>by<span class="dp">·</span>scaling<span class="dp">·</span>each<span class="dp">·</span>feature<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>given<span class="dp">·</span>range.</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Transform<span class="dp">·</span>features<span class="dp">·</span>by<span class="dp">·</span>scaling<span class="dp">·</span>each<span class="dp">·</span>feature<span class="dp">·</span>to<span class="dp">·</span>a<span class="dp">·</span>given<span class="dp">·</span>range.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_scaler:<span class="dp">·</span>the<span class="dp">·</span>sklearn<span class="dp">·</span>MinMaxScaler<span class="dp">·</span>instance.</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_scaler:<span class="dp">·</span>the<span class="dp">·</span>sklearn<span class="dp">·</span>MinMaxScaler<span class="dp">·</span>instance.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">767 B</span></div>
    <div id="secretflow-preprocessing-transformer.py"><span class="source">secretflow/preprocessing/transformer.py</span>
      <a class="anchor" href="#secretflow-preprocessing-transformer.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 16 lines modified</td><td colspan="2">Offset 8, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Union,<span class="dp">·</span>Callable,<span class="dp">·</span>Dict</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>partial</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>functools<span class="dp">·</span>import<span class="dp">·</span>partial</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>Callable,<span class="dp">·</span>Dict,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>FunctionTransformer<span class="dp">·</span>as<span class="dp">·</span>SkFunctionTransformer</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>sklearn.preprocessing<span class="dp">·</span>import<span class="dp">·</span>FunctionTransformer<span class="dp">·</span>as<span class="dp">·</span>SkFunctionTransformer</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">582 B</span></div>
    <div id="secretflow-preprocessing-binning-homo_binning_base.py"><span class="source">secretflow/preprocessing/binning/homo_binning_base.py</span>
      <a class="anchor" href="#secretflow-preprocessing-binning-homo_binning_base.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 19, 14 lines modified</td><td colspan="2">Offset 19, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>copy</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>copy</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>functools</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>functools</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>operator</td><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>operator</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.base_binning<span class="dp">·</span>import<span class="dp">·</span>BaseBinning</td><td class="diffline">26 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.base_binning<span class="dp">·</span>import<span class="dp">·</span>BaseBinning</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_binning<span class="dp">·</span>import<span class="dp">·</span>QuantileBinning</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_binning<span class="dp">·</span>import<span class="dp">·</span>QuantileBinning</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_summaries<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">28 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_summaries<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>QuantileSummaries,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>QuantileSummaries,</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">)</td><td class="diffline">30 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">4.1 KB</span></div>
    <div id="secretflow-preprocessing-binning-vert_woe_binning.py"><span class="source">secretflow/preprocessing/binning/vert_woe_binning.py</span>
      <a class="anchor" href="#secretflow-preprocessing-binning-vert_woe_binning.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 25 lines modified</td><td colspan="2">Offset 8, 26 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>L</del>i<del>s</del>t,<span class="dp">·</span><del>D</del>i<del>c</del>t,<span class="dp">·</span>Union</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>D</ins>i<ins>c</ins>t,<span class="dp">·</span><ins>L</ins>i<ins>s</ins>t,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>HEU,<span class="dp">·</span>PYU,<span class="dp">·</span>SPU,<span class="dp">·</span>PYUObject</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<del>b</del><del>ase</del><span class="dp">·</span>import<span class="dp">·</span>MoveConfig</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.<ins>heu</ins><span class="dp">·</span>import<span class="dp">·</span><ins>HEU</ins>MoveConfig</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.vert_woe_binning_pyu<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.vert_woe_binning_pyu<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>VertWoeBinningPyuWorker,</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>VertWoeBinningPyuWorker,</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">)</td><td class="diffline">23 </td><td class="diffpresent">)</td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU,<span class="dp">·</span>HEU,<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>phe</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>VertWoeBinning:</td><td class="diffline">24 </td><td class="diffpresent">class<span class="dp">·</span>VertWoeBinning:</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe<span class="dp">·</span>binning<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>datasets.</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe<span class="dp">·</span>binning<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>datasets.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Split<span class="dp">·</span>all<span class="dp">·</span>features<span class="dp">·</span>into<span class="dp">·</span>bins<span class="dp">·</span>by<span class="dp">·</span>equal<span class="dp">·</span>frequency<span class="dp">·</span>or<span class="dp">·</span>ChiMerge.</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Split<span class="dp">·</span>all<span class="dp">·</span>features<span class="dp">·</span>into<span class="dp">·</span>bins<span class="dp">·</span>by<span class="dp">·</span>equal<span class="dp">·</span>frequency<span class="dp">·</span>or<span class="dp">·</span>ChiMerge.</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 196, 46 lines modified</td><td colspan="2">Offset 197, 58 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>coordinator<span class="dp">·</span>build<span class="dp">·</span>woe<span class="dp">·</span>rules</td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>coordinator<span class="dp">·</span>build<span class="dp">·</span>woe<span class="dp">·</span>rules</td></tr>
<tr class="diffunmodified"><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>coordinator_worker<span class="dp">·</span>=<span class="dp">·</span>workers[coordinator_device]</td><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>coordinator_worker<span class="dp">·</span>=<span class="dp">·</span>workers[coordinator_device]</td></tr>
<tr class="diffunmodified"><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,<span class="dp">·</span>coordinator_report<span class="dp">·</span>=<span class="dp">·</span>coordinator_worker.coordinator_work(</td><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,<span class="dp">·</span>coordinator_report<span class="dp">·</span>=<span class="dp">·</span>coordinator_worker.coordinator_work(</td></tr>
<tr class="diffunmodified"><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata.partitions[coordinator_device].data</td><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata.partitions[coordinator_device].data</td></tr>
<tr class="diffunmodified"><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe_rules[coordinator_device]<span class="dp">·</span>=<span class="dp">·</span>coordinator_report</td><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe_rules[coordinator_device]<span class="dp">·</span>=<span class="dp">·</span>coordinator_report</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(self.secure_device,<span class="dp">·</span>SPU):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">204 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label<span class="dp">·</span>=<span class="dp">·</span>label.to(self.secure_device)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">205 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(self.secure_device,<span class="dp">·</span>HEU):</td></tr>
<tr class="diffchanged"><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label<span class="dp">·</span>=<span class="dp">·</span>label.to(</td><td class="diffline">206 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>secure_label<span class="dp">·</span>=<span class="dp">·</span>label.to(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">207 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.secure_device,</td></tr>
<tr class="diffchanged"><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>self.secure_d</del><del>evice,<span class="dp">·</span></del>MoveConfig(heu_audit_log=coordinator_audit_log_path)</td><td class="diffline">208 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>HEU</ins>MoveConfig(heu_audit_log=coordinator_audit_log_path)<ins>,</ins></td></tr>
<tr class="diffchanged"><td class="diffline">204 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">209 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">210 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">211 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>NotImplementedError(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">212 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&#x27;Secure<span class="dp">·</span>device<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>SPU<span class="dp">·</span>or<span class="dp">·</span>HEU,<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(self.secure_device)}.&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">213 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">205 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>all<span class="dp">·</span>participants</td><td class="diffline">214 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>all<span class="dp">·</span>participants</td></tr>
<tr class="diffunmodified"><td class="diffline">206 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device<span class="dp">·</span>in<span class="dp">·</span>workers:</td><td class="diffline">215 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>device<span class="dp">·</span>in<span class="dp">·</span>workers:</td></tr>
<tr class="diffunmodified"><td class="diffline">207 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>==<span class="dp">·</span>coordinator_device:</td><td class="diffline">216 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>device<span class="dp">·</span>==<span class="dp">·</span>coordinator_device:</td></tr>
<tr class="diffunmodified"><td class="diffline">208 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>continue</td><td class="diffline">217 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>continue</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">209 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker<span class="dp">·</span>=<span class="dp">·</span>workers[device]</td><td class="diffline">218 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker<span class="dp">·</span>=<span class="dp">·</span>workers[device]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">210 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_select<span class="dp">·</span>=<span class="dp">·</span>worker.participant_build_sum_select(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">211 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata.partitions[device].data</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">212 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">213 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(self.secure_device,<span class="dp">·</span>HEU):</td><td class="diffline">219 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(self.secure_device,<span class="dp">·</span>HEU):</td></tr>
<tr class="diffunmodified"><td class="diffline">214 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>audit_log_path:</td><td class="diffline">220 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>audit_log_path:</td></tr>
<tr class="diffunmodified"><td class="diffline">215 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">221 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">216 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device.party<span class="dp">·</span>in<span class="dp">·</span>audit_log_path</td><td class="diffline">222 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>device.party<span class="dp">·</span>in<span class="dp">·</span>audit_log_path</td></tr>
<tr class="diffunmodified"><td class="diffline">217 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;can<span class="dp">·</span>not<span class="dp">·</span>find<span class="dp">·</span>{device.party}<span class="dp">·</span>device&#x27;s<span class="dp">·</span>audit<span class="dp">·</span>log<span class="dp">·</span>path&quot;</td><td class="diffline">223 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&quot;can<span class="dp">·</span>not<span class="dp">·</span>find<span class="dp">·</span>{device.party}<span class="dp">·</span>device&#x27;s<span class="dp">·</span>audit<span class="dp">·</span>log<span class="dp">·</span>path&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">218 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker_audit_path<span class="dp">·</span>=<span class="dp">·</span>audit_log_path[device.party]</td><td class="diffline">224 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>worker_audit_path<span class="dp">·</span>=<span class="dp">·</span>audit_log_path[device.party]</td></tr>
<tr class="diffunmodified"><td class="diffline">219 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label.dump(worker_audit_path)</td><td class="diffline">225 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label.dump(worker_audit_path)</td></tr>
<tr class="diffunmodified"><td class="diffline">220 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.secure_device.get_participant(device.party).dump_pk.remote(</td><td class="diffline">226 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.secure_device.get_participant(device.party).dump_pk.remote(</td></tr>
<tr class="diffunmodified"><td class="diffline">221 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&#x27;{worker_audit_path}.pk.pickle&#x27;</td><td class="diffline">227 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f&#x27;{worker_audit_path}.pk.pickle&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">222 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">228 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffchanged"><td class="diffline">223 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>move_config<span class="dp">·</span>=<span class="dp">·</span>MoveConfig()</td><td class="diffline">229 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>move_config<span class="dp">·</span>=<span class="dp">·</span><ins>HEU</ins>MoveConfig()</td></tr>
<tr class="diffunmodified"><td class="diffline">224 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>move_config.heu_encoder<span class="dp">·</span>=<span class="dp">·</span>phe.BigintEncoderParams()</td><td class="diffline">230 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>move_config.heu_encoder<span class="dp">·</span>=<span class="dp">·</span>phe.BigintEncoderParams()</td></tr>
<tr class="diffchanged"><td class="diffline">225 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_<del>sele</del>c<del>t_h</del>e<del>u</del><span class="dp">·</span>=<span class="dp">·</span><del>b</del><del>in_s</del>e<del>lect.</del>t<del>o</del><del>(self.sec</del>u<del>r</del><del>e_</del>d<del>evic</del><del>e,<span class="dp">·</span></del>m<del>ove</del>_<del>c</del><del>o</del>n<del>f</del>i<del>g)</del></td><td class="diffline">231 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_<ins>indi</ins>ce<ins>s</ins><span class="dp">·</span>=<span class="dp">·</span><ins>work</ins>e<ins>r.par</ins>t<ins>icipant_b</ins>u<ins>il</ins>d<ins>_su</ins>m_<ins>i</ins>n<ins>d</ins>i<ins>ce</ins><ins>s(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">232 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata.partitions[device].data</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">233 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">226 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_positive<span class="dp">·</span>=<span class="dp">·</span>(</td><td class="diffline">234 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_positive<span class="dp">·</span>=<span class="dp">·</span>(</td></tr>
<tr class="diffchanged"><td class="diffline">227 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>(</del>secure_label<del><span class="dp">·</span>@<span class="dp">·</span>bin</del>_select_<del>h</del><del>e</del>u<del>).t</del><del>o</del>(<del>coor</del><del>d</del>in<del>ator</del>_<del>dev</del>i<del>ce).to</del><del>(</del>d<del>ev</del>ice)</td><td class="diffline">235 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label<ins>.batch</ins>_select_<ins>s</ins>u<ins>m</ins>(<ins>b</ins>in_i<ins>n</ins>dice<ins>s</ins>)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">236 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.to(coordinator_device)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">237 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>.to(device)</td></tr>
<tr class="diffunmodified"><td class="diffline">228 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">238 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffdeleted"><td class="diffline">229 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_positive<span class="dp">·</span>=<span class="dp">·</span>device(lambda<span class="dp">·</span>x:<span class="dp">·</span>x)(bins_positive)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">230 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_stats<span class="dp">·</span>=<span class="dp">·</span>worker.participant_sum_bin(bins_positive)</td><td class="diffline">239 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_stats<span class="dp">·</span>=<span class="dp">·</span>worker.participant_sum_bin(bins_positive)</td></tr>
<tr class="diffunmodified"><td class="diffline">231 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">240 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">241 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin_select<span class="dp">·</span>=<span class="dp">·</span>worker.participant_build_sum_select(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">242 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata.partitions[device].data</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">243 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">232 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_work(label,<span class="dp">·</span>select):</td><td class="diffline">244 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_work(label,<span class="dp">·</span>select):</td></tr>
<tr class="diffunmodified"><td class="diffline">233 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.matmul(label,<span class="dp">·</span>select)</td><td class="diffline">245 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.matmul(label,<span class="dp">·</span>select)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">234 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_positive<span class="dp">·</span>=<span class="dp">·</span>self.secure_device(spu_work)(</td><td class="diffline">246 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_positive<span class="dp">·</span>=<span class="dp">·</span>self.secure_device(spu_work)(</td></tr>
<tr class="diffunmodified"><td class="diffline">235 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label,<span class="dp">·</span>bin_select.to(self.secure_device)</td><td class="diffline">247 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>secure_label,<span class="dp">·</span>bin_select.to(self.secure_device)</td></tr>
<tr class="diffunmodified"><td class="diffline">236 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>).to(device)</td><td class="diffline">248 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>).to(device)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.81 KB</span></div>
    <div id="secretflow-preprocessing-binning-vert_woe_binning_pyu.py"><span class="source">secretflow/preprocessing/binning/vert_woe_binning_pyu.py</span>
      <a class="anchor" href="#secretflow-preprocessing-binning-vert_woe_binning_pyu.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 19 lines modified</td><td colspan="2">Offset 8, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Dict,<span class="dp">·</span>Union,<span class="dp">·</span>Tuple</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>scipy.stats<span class="dp">·</span>import<span class="dp">·</span>chi2</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>scipy.stats<span class="dp">·</span>import<span class="dp">·</span>chi2</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">@proxy(PYUObject)</td><td class="diffline">20 </td><td class="diffpresent">@proxy(PYUObject)</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>VertWoeBinningPyuWorker:</td><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>VertWoeBinningPyuWorker:</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 470, 14 lines modified</td><td colspan="2">Offset 471, 28 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">470 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>(</td><td class="diffline">471 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">471 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,</td><td class="diffline">472 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>label,</td></tr>
<tr class="diffunmodified"><td class="diffline">472 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._build_report(</td><td class="diffline">473 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self._build_report(</td></tr>
<tr class="diffunmodified"><td class="diffline">473 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe_ivs,<span class="dp">·</span>split_points,<span class="dp">·</span>else_woe_ivs,<span class="dp">·</span>total_counts,<span class="dp">·</span>else_counts</td><td class="diffline">474 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>woe_ivs,<span class="dp">·</span>split_points,<span class="dp">·</span>else_woe_ivs,<span class="dp">·</span>total_counts,<span class="dp">·</span>else_counts</td></tr>
<tr class="diffunmodified"><td class="diffline">474 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">475 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">475 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">476 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">477 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>participant_build_sum_indices(self,<span class="dp">·</span>data:<span class="dp">·</span>pd.DataFrame)<span class="dp">·</span>-&gt;<span class="dp">·</span>List[List[int]]:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">478 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">479 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>build<span class="dp">·</span>sum<span class="dp">·</span>indices<span class="dp">·</span>for<span class="dp">·</span>driver<span class="dp">·</span>to<span class="dp">·</span>calculate<span class="dp">·</span>positive<span class="dp">·</span>samples<span class="dp">·</span>by<span class="dp">·</span>HE.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">480 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">481 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>full<span class="dp">·</span>dataset<span class="dp">·</span>for<span class="dp">·</span>this<span class="dp">·</span>party.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">482 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">483 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bin<span class="dp">·</span>indices.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">484 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">485 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>bins_idx,<span class="dp">·</span>self.split_points,<span class="dp">·</span>else_bins_idx<span class="dp">·</span>=<span class="dp">·</span>self._build_feature_bins(data)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">486 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.total_counts<span class="dp">·</span>=<span class="dp">·</span>[b.size<span class="dp">·</span>for<span class="dp">·</span>b<span class="dp">·</span>in<span class="dp">·</span>bins_idx]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">487 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.else_counts<span class="dp">·</span>=<span class="dp">·</span>[b.size<span class="dp">·</span>for<span class="dp">·</span>b<span class="dp">·</span>in<span class="dp">·</span>else_bins_idx]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">488 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>[*bins_idx,<span class="dp">·</span>*[e<span class="dp">·</span>for<span class="dp">·</span>e<span class="dp">·</span>in<span class="dp">·</span>else_bins_idx<span class="dp">·</span>if<span class="dp">·</span>e.size]]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">476 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>participant_build_sum_select(self,<span class="dp">·</span>data:<span class="dp">·</span>pd.DataFrame)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td><td class="diffline">489 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>participant_build_sum_select(self,<span class="dp">·</span>data:<span class="dp">·</span>pd.DataFrame)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td></tr>
<tr class="diffunmodified"><td class="diffline">477 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td><td class="diffline">490 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">478 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>build<span class="dp">·</span>select<span class="dp">·</span>matrix<span class="dp">·</span>for<span class="dp">·</span>driver<span class="dp">·</span>to<span class="dp">·</span>calculate<span class="dp">·</span>positive<span class="dp">·</span>samples<span class="dp">·</span>by<span class="dp">·</span>Secret<span class="dp">·</span>Sharing.</td><td class="diffline">491 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>build<span class="dp">·</span>select<span class="dp">·</span>matrix<span class="dp">·</span>for<span class="dp">·</span>driver<span class="dp">·</span>to<span class="dp">·</span>calculate<span class="dp">·</span>positive<span class="dp">·</span>samples<span class="dp">·</span>by<span class="dp">·</span>Secret<span class="dp">·</span>Sharing.</td></tr>
<tr class="diffunmodified"><td class="diffline">479 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">492 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td class="diffline">480 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>full<span class="dp">·</span>dataset<span class="dp">·</span>for<span class="dp">·</span>this<span class="dp">·</span>party.</td><td class="diffline">493 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>full<span class="dp">·</span>dataset<span class="dp">·</span>for<span class="dp">·</span>this<span class="dp">·</span>party.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">481 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td><td class="diffline">494 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">977 B</span></div>
    <div id="secretflow-preprocessing-binning-vert_woe_substitution.py"><span class="source">secretflow/preprocessing/binning/vert_woe_substitution.py</span>
      <a class="anchor" href="#secretflow-preprocessing-binning-vert_woe_substitution.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 20 lines modified</td><td colspan="2">Offset 9, 21 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict</td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>proxy,<span class="dp">·</span>PYUObject,<span class="dp">·</span>PYU</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.base<span class="dp">·</span>import<span class="dp">·</span>Partition</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>PYUObject,<span class="dp">·</span>proxy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">@proxy(PYUObject)</td><td class="diffline">20 </td><td class="diffpresent">@proxy(PYUObject)</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>VertWOESubstitutionPyuWorker:</td><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>VertWOESubstitutionPyuWorker:</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>sub(self,<span class="dp">·</span>data:<span class="dp">·</span>pd.DataFrame,<span class="dp">·</span>r:<span class="dp">·</span>Dict)<span class="dp">·</span>-&gt;<span class="dp">·</span>pd.DataFrame:</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>sub(self,<span class="dp">·</span>data:<span class="dp">·</span>pd.DataFrame,<span class="dp">·</span>r:<span class="dp">·</span>Dict)<span class="dp">·</span>-&gt;<span class="dp">·</span>pd.DataFrame:</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span>functions<span class="dp">·</span>for<span class="dp">·</span>woe<span class="dp">·</span>substitution.</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PYU<span class="dp">·</span>functions<span class="dp">·</span>for<span class="dp">·</span>woe<span class="dp">·</span>substitution.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">458 B</span></div>
    <div id="secretflow-preprocessing-binning-kernels-quantile_binning.py"><span class="source">secretflow/preprocessing/binning/kernels/quantile_binning.py</span>
      <a class="anchor" href="#secretflow-preprocessing-binning-kernels-quantile_binning.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 17, 14 lines modified</td><td colspan="2">Offset 17, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">20 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.base_binning<span class="dp">·</span>import<span class="dp">·</span>BaseBinning</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.base_binning<span class="dp">·</span>import<span class="dp">·</span>BaseBinning</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_summaries<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.binning.kernels.quantile_summaries<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>QuantileSummaries,</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>QuantileSummaries,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">)</td><td class="diffline">24 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>QuantileBinning(BaseBinning):</td><td class="diffline">25 </td><td class="diffpresent">class<span class="dp">·</span>QuantileBinning(BaseBinning):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">796 B</span></div>
    <div id="secretflow-security-__init__.py"><span class="source">secretflow/security/__init__.py</span>
      <a class="anchor" href="#secretflow-security-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 21 lines modified</td><td colspan="2">Offset 8, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.aggregation<span class="dp">·</span>import<span class="dp">·</span>Aggregator,<span class="dp">·</span>PlainAggregator,<span class="dp">·</span>SecureAggregator,<span class="dp">·</span>SPUAggregator</td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.aggregation<span class="dp">·</span>import<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Aggregator,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SecureAggregator,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PlainAggregator,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>SPUAggregator,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>.compare<span class="dp">·</span>import<span class="dp">·</span>Comparator,<span class="dp">·</span>DeviceComparator,<span class="dp">·</span>PlainComparator,<span class="dp">·</span>SPUComparator</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.compare<span class="dp">·</span>import<span class="dp">·</span>Comparator,<span class="dp">·</span>DeviceComparator,<span class="dp">·</span>PlainComparator,<span class="dp">·</span>SPUComparator</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">16 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;Aggregator&#x27;,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;Aggregator&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SecureAggregator&#x27;,</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SecureAggregator&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PlainAggregator&#x27;,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;PlainAggregator&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SPUAggregator&#x27;,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SPUAggregator&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.36 KB</span></div>
    <div id="secretflow-security-aggregation-secure_aggregator.py"><span class="source">secretflow/security/aggregation/secure_aggregator.py</span>
      <a class="anchor" href="#secretflow-security-aggregation-secure_aggregator.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 138, 21 lines modified</td><td colspan="2">Offset 138, 21 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>..<span class="dp">·</span>math::</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>..<span class="dp">·</span>math::</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_1<span class="dp">·</span>+<span class="dp">·</span>y_2<span class="dp">·</span>+<span class="dp">·</span>y_3<span class="dp">·</span>=<span class="dp">·</span>x_1<span class="dp">·</span>+<span class="dp">·</span>s_{a,b}<span class="dp">·</span>+<span class="dp">·</span>s_{a,c}<span class="dp">·</span>+<span class="dp">·</span>x_2<span class="dp">·</span>-<span class="dp">·</span>s_{a,b}<span class="dp">·</span>+<span class="dp">·</span>s_{b,c}<span class="dp">·</span>+<span class="dp">·</span>x_3<span class="dp">·</span>-<span class="dp">·</span>s_{a,c}<span class="dp">·</span>-<span class="dp">·</span>s_{b,c}</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_1<span class="dp">·</span>+<span class="dp">·</span>y_2<span class="dp">·</span>+<span class="dp">·</span>y_3<span class="dp">·</span>=<span class="dp">·</span>x_1<span class="dp">·</span>+<span class="dp">·</span>s_{a,b}<span class="dp">·</span>+<span class="dp">·</span>s_{a,c}<span class="dp">·</span>+<span class="dp">·</span>x_2<span class="dp">·</span>-<span class="dp">·</span>s_{a,b}<span class="dp">·</span>+<span class="dp">·</span>s_{b,c}<span class="dp">·</span>+<span class="dp">·</span>x_3<span class="dp">·</span>-<span class="dp">·</span>s_{a,c}<span class="dp">·</span>-<span class="dp">·</span>s_{b,c}</td></tr>
<tr class="diffunmodified"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>=<span class="dp">·</span>x_1<span class="dp">·</span>+<span class="dp">·</span>x_2<span class="dp">·</span>+<span class="dp">·</span>x_3</td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>=<span class="dp">·</span>x_1<span class="dp">·</span>+<span class="dp">·</span>x_2<span class="dp">·</span>+<span class="dp">·</span>x_3</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Notes:</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Notes:</td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`Masking<span class="dp">·</span>with<span class="dp">·</span>One-Time<span class="dp">·</span>Pads`<span class="dp">·</span>is<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>semi-honest<span class="dp">·</span>assumptions</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`Masking<span class="dp">·</span>with<span class="dp">·</span>One-Time<span class="dp">·</span>Pads`<span class="dp">·</span>is<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>semi-honest<span class="dp">·</span>assumptions</td></tr>
<tr class="diffunmodified"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>support<span class="dp">·</span>client<span class="dp">·</span>dropping.<span class="dp">·</span>For<span class="dp">·</span>more<span class="dp">·</span>information,<span class="dp">·</span>please<span class="dp">·</span>refer<span class="dp">·</span>to</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>support<span class="dp">·</span>client<span class="dp">·</span>dropping.<span class="dp">·</span>For<span class="dp">·</span>more<span class="dp">·</span>information,<span class="dp">·</span>please<span class="dp">·</span>refer<span class="dp">·</span>to</td></tr>
<tr class="diffchanged"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`Practical<span class="dp">·</span>Secure<span class="dp">·</span>Aggregationfor<span class="dp">·</span>Privacy-Preserving<span class="dp">·</span>Machine<span class="dp">·</span>Learning<span class="dp">·</span>&lt;https://eprint.iacr.org/2017/281.pdf&gt;`_</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`Practical<span class="dp">·</span>Secure<span class="dp">·</span>Aggregation<ins><span class="dp">·</span></ins>for<span class="dp">·</span>Privacy-Preserving<span class="dp">·</span>Machine<span class="dp">·</span>Learning<span class="dp">·</span>&lt;https://eprint.iacr.org/2017/281.pdf&gt;`_</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Warnings:</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Warnings:</td></tr>
<tr class="diffunmodified"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>SecureAggregator<span class="dp">·</span>uses<span class="dp">·</span>:py:meth:`numpy.random.PCG64`.<span class="dp">·</span>There<span class="dp">·</span>are<span class="dp">·</span>many</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>SecureAggregator<span class="dp">·</span>uses<span class="dp">·</span>:py:meth:`numpy.random.PCG64`.<span class="dp">·</span>There<span class="dp">·</span>are<span class="dp">·</span>many</td></tr>
<tr class="diffunmodified"><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>discussions<span class="dp">·</span>of<span class="dp">·</span>whether<span class="dp">·</span>PCG<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>CSPRNG</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>discussions<span class="dp">·</span>of<span class="dp">·</span>whether<span class="dp">·</span>PCG<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>CSPRNG</td></tr>
<tr class="diffunmodified"><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(e.g.<span class="dp">·</span>https://crypto.stackexchange.com/questions/77101/is-the-pcg-prng-a-csprng-or-why-not),</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(e.g.<span class="dp">·</span>https://crypto.stackexchange.com/questions/77101/is-the-pcg-prng-a-csprng-or-why-not),</td></tr>
<tr class="diffchanged"><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>we<span class="dp">·</span>p<del>er</del>fer<span class="dp">·</span>a<span class="dp">·</span>conservative<span class="dp">·</span>strategy<span class="dp">·</span>unless<span class="dp">·</span>a<span class="dp">·</span>further<span class="dp">·</span>security<span class="dp">·</span>analysis<span class="dp">·</span>came</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>we<span class="dp">·</span>p<ins>re</ins>fer<span class="dp">·</span>a<span class="dp">·</span>conservative<span class="dp">·</span>strategy<span class="dp">·</span>unless<span class="dp">·</span>a<span class="dp">·</span>further<span class="dp">·</span>security<span class="dp">·</span>analysis<span class="dp">·</span>came</td></tr>
<tr class="diffunmodified"><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>up.<span class="dp">·</span>Therefore<span class="dp">·</span>we<span class="dp">·</span>recommend<span class="dp">·</span>users<span class="dp">·</span>to<span class="dp">·</span>use<span class="dp">·</span>a<span class="dp">·</span>standardized<span class="dp">·</span>CSPRNG<span class="dp">·</span>in<span class="dp">·</span>industrial</td><td class="diffline">150 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>up.<span class="dp">·</span>Therefore<span class="dp">·</span>we<span class="dp">·</span>recommend<span class="dp">·</span>users<span class="dp">·</span>to<span class="dp">·</span>use<span class="dp">·</span>a<span class="dp">·</span>standardized<span class="dp">·</span>CSPRNG<span class="dp">·</span>in<span class="dp">·</span>industrial</td></tr>
<tr class="diffunmodified"><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scenarios.</td><td class="diffline">151 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scenarios.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td><td class="diffline">152 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td></tr>
<tr class="diffunmodified"><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Alice<span class="dp">·</span>and<span class="dp">·</span>bob<span class="dp">·</span>are<span class="dp">·</span>both<span class="dp">·</span>pyu<span class="dp">·</span>instances.</td><td class="diffline">153 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Alice<span class="dp">·</span>and<span class="dp">·</span>bob<span class="dp">·</span>are<span class="dp">·</span>both<span class="dp">·</span>pyu<span class="dp">·</span>instances.</td></tr>
<tr class="diffunmodified"><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>aggregator<span class="dp">·</span>=<span class="dp">·</span>SecureAggregator(alice,<span class="dp">·</span>[alice,<span class="dp">·</span>bob])</td><td class="diffline">154 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>aggregator<span class="dp">·</span>=<span class="dp">·</span>SecureAggregator(alice,<span class="dp">·</span>[alice,<span class="dp">·</span>bob])</td></tr>
<tr class="diffunmodified"><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>a<span class="dp">·</span>=<span class="dp">·</span>alice(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td><td class="diffline">155 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>a<span class="dp">·</span>=<span class="dp">·</span>alice(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.56 KB</span></div>
    <div id="secretflow-security-aggregation-sparse_plain_aggregator.py"><span class="source">secretflow/security/aggregation/sparse_plain_aggregator.py</span>
      <a class="anchor" href="#secretflow-security-aggregation-sparse_plain_aggregator.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 15 lines modified</td><td colspan="2">Offset 12, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>DeviceObject</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>DeviceObject</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation.plain_aggregator<span class="dp">·</span>import<span class="dp">·</span>PlainAggregator</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.aggregation.plain_aggregator<span class="dp">·</span>import<span class="dp">·</span>PlainAggregator</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>sparse_decode</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.compressor<span class="dp">·</span>import<span class="dp">·</span>sparse_decode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>SparsePlainAggregator(PlainAggregator):</td><td class="diffline">19 </td><td class="diffpresent">class<span class="dp">·</span>SparsePlainAggregator(PlainAggregator):</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 44, 25 lines modified</td><td colspan="2">Offset 43, 29 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__post_init__(self):</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__post_init__(self):</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,<span class="dp">·</span>PYU</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.device,<span class="dp">·</span>PYU</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;Accepts<span class="dp">·</span>PYU<span class="dp">·</span>only<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(self.device)}.&#x27;</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>f&#x27;Accepts<span class="dp">·</span>PYU<span class="dp">·</span>only<span class="dp">·</span>but<span class="dp">·</span>got<span class="dp">·</span>{type(self.device)}.&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_zip_decode_data(self,<span class="dp">·</span>data:<span class="dp">·</span>List)<span class="dp">·</span>-&gt;<span class="dp">·</span>List:</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_zip_decode_data(self,<span class="dp">·</span>data:<span class="dp">·</span>List)<span class="dp">·</span>-&gt;<span class="dp">·</span>List:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)):</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)):</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>[sparse_decode(data=element)<span class="dp">·</span>for<span class="dp">·</span>element<span class="dp">·</span>in<span class="dp">·</span>zip(*data)]</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>[sparse_decode(data=element)<span class="dp">·</span>for<span class="dp">·</span>element<span class="dp">·</span>in<span class="dp">·</span>zip(*data)]</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>np.ndarray):</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>np.ndarray):</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>zip(*data)</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>zip(*data)</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>False</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;Sparse<span class="dp">·</span>encoding<span class="dp">·</span>method<span class="dp">·</span>not<span class="dp">·</span>supporterd<span class="dp">·</span>in<span class="dp">·</span>SecurePlainAggregator&#x27;</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;Sparse<span class="dp">·</span>encoding<span class="dp">·</span>method<span class="dp">·</span>not<span class="dp">·</span>supporterd<span class="dp">·</span>in<span class="dp">·</span>SecurePlainAggregator&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>decoded_data</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>decoded_data</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_decode_data(self,<span class="dp">·</span>data:<span class="dp">·</span>List)<span class="dp">·</span>-&gt;<span class="dp">·</span>List:</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>_decode_data(self,<span class="dp">·</span>data:<span class="dp">·</span>List)<span class="dp">·</span>-&gt;<span class="dp">·</span>List:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)):</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>isinstance(data[0][0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)):</td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>sparse_decode(data=data)</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>sparse_decode(data=data)</td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(data[0],<span class="dp">·</span>np.ndarray):</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>elif<span class="dp">·</span>isinstance(data[0],<span class="dp">·</span>np.ndarray):</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>data</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_data<span class="dp">·</span>=<span class="dp">·</span>data</td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>False</td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>False</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">680 B</span></div>
    <div id="secretflow-security-aggregation-spu_aggregator.py"><span class="source">secretflow/security/aggregation/spu_aggregator.py</span>
      <a class="anchor" href="#secretflow-security-aggregation-spu_aggregator.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 15 lines modified</td><td colspan="2">Offset 23, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>SPUAggregator(Aggregator):</td><td class="diffline">23 </td><td class="diffpresent">class<span class="dp">·</span>SPUAggregator(Aggregator):</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Aggregator<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>SPU.</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Aggregator<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>SPU.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>computation<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>performed<span class="dp">·</span>on<span class="dp">·</span>the<span class="dp">·</span>given<span class="dp">·</span>SPU<span class="dp">·</span>device.</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>computation<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>performed<span class="dp">·</span>on<span class="dp">·</span>the<span class="dp">·</span>given<span class="dp">·</span>SPU<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Examples:</td></tr>
<tr class="diffchanged"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>spu<span class="dp">·</span>shall<span class="dp">·</span>be<span class="dp">·</span>a<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>instance.</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>spu<span class="dp">·</span>shall<span class="dp">·</span>be<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>instance.</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>aggregator<span class="dp">·</span>=<span class="dp">·</span>SPUAggregator(spu)</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>aggregator<span class="dp">·</span>=<span class="dp">·</span>SPUAggregator(spu)</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Alice<span class="dp">·</span>and<span class="dp">·</span>bob<span class="dp">·</span>are<span class="dp">·</span>both<span class="dp">·</span>pyu<span class="dp">·</span>instances.</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Alice<span class="dp">·</span>and<span class="dp">·</span>bob<span class="dp">·</span>are<span class="dp">·</span>both<span class="dp">·</span>pyu<span class="dp">·</span>instances.</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>a<span class="dp">·</span>=<span class="dp">·</span>alice(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>a<span class="dp">·</span>=<span class="dp">·</span>alice(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>bob(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>bob(lambda<span class="dp">·</span>:<span class="dp">·</span>np.random.rand(2,<span class="dp">·</span>5))()</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sum_a_b<span class="dp">·</span>=<span class="dp">·</span>aggregator.sum([a,<span class="dp">·</span>b],<span class="dp">·</span>axis=0)</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sum_a_b<span class="dp">·</span>=<span class="dp">·</span>aggregator.sum([a,<span class="dp">·</span>b],<span class="dp">·</span>axis=0)</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Get<span class="dp">·</span>the<span class="dp">·</span>result.</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>#<span class="dp">·</span>Get<span class="dp">·</span>the<span class="dp">·</span>result.</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sf.reveal(sum_a_b)</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&gt;&gt;&gt;<span class="dp">·</span>sf.reveal(sum_a_b)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">529 B</span></div>
    <div id="secretflow-security-compare-device_comparator.py"><span class="source">secretflow/security/compare/device_comparator.py</span>
      <a class="anchor" href="#secretflow-security-compare-device_comparator.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 13, 15 lines modified</td><td colspan="2">Offset 13, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Union</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span><del>SP</del>U,<span class="dp">·</span><del>PY</del>U,<span class="dp">·</span>DeviceObject</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span><ins>PY</ins>U,<span class="dp">·</span><ins>SP</ins>U,<span class="dp">·</span>DeviceObject</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.compare.comparator<span class="dp">·</span>import<span class="dp">·</span>Comparator</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.compare.comparator<span class="dp">·</span>import<span class="dp">·</span>Comparator</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">@dataclass</td><td class="diffline">19 </td><td class="diffpresent">@dataclass</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>DeviceComparator(Comparator):</td><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>DeviceComparator(Comparator):</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Comparator<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>a<span class="dp">·</span>device<span class="dp">·</span>(PYU<span class="dp">·</span>or<span class="dp">·</span>SPU).</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Comparator<span class="dp">·</span>based<span class="dp">·</span>on<span class="dp">·</span>a<span class="dp">·</span>device<span class="dp">·</span>(PYU<span class="dp">·</span>or<span class="dp">·</span>SPU).</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">879 B</span></div>
    <div id="secretflow-security-privacy-__init__.py"><span class="source">secretflow/security/privacy/__init__.py</span>
      <a class="anchor" href="#secretflow-security-privacy-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 23 lines modified</td><td colspan="2">Offset 8, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.mechanism.tensorflow.layers<span class="dp">·</span>import<span class="dp">·</span>GaussianEmbeddingDP,<span class="dp">·</span>LabelDP</td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.mechanism.tensorflow.layers<span class="dp">·</span>import<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>GaussianEmbeddingDP,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>LabelDP,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.mechanism.tensorflow.mechanism_fl<span class="dp">·</span>import<span class="dp">·</span><del>(</del></td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.mechanism.tensorflow.mechanism_fl<span class="dp">·</span>import<span class="dp">·</span><ins>GaussianModelD</ins><ins>P</ins></td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>GaussianModelDP,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.strategy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.strategy<span class="dp">·</span>import<span class="dp">·</span>DPStrategy</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>.strategy_fl<span class="dp">·</span>import<span class="dp">·</span>DPStrategyFL</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.strategy_fl<span class="dp">·</span>import<span class="dp">·</span>DPStrategyFL</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">18 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;GaussianEmbeddingDP&#x27;,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;GaussianEmbeddingDP&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;GaussianModelDP&#x27;,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;GaussianModelDP&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;LabelDP&#x27;,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;LabelDP&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">665 B</span></div>
    <div id="secretflow-security-privacy-accounting-rdp_accountant.py"><span class="source">secretflow/security/privacy/accounting/rdp_accountant.py</span>
      <a class="anchor" href="#secretflow-security-privacy-accounting-rdp_accountant.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 15 lines modified</td><td colspan="2">Offset 9, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.log_utils<span class="dp">·</span>import<span class="dp">·</span>log_alpha</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.log_utils<span class="dp">·</span>import<span class="dp">·</span>log_alpha</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">&quot;&quot;&quot;Implements<span class="dp">·</span>privacy<span class="dp">·</span>accounting<span class="dp">·</span>for<span class="dp">·</span>Rényi<span class="dp">·</span>Differential<span class="dp">·</span>Privacy.</td><td class="diffline">17 </td><td class="diffpresent">&quot;&quot;&quot;Implements<span class="dp">·</span>privacy<span class="dp">·</span>accounting<span class="dp">·</span>for<span class="dp">·</span>Rényi<span class="dp">·</span>Differential<span class="dp">·</span>Privacy.</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">&quot;&quot;&quot;</td><td class="diffline">18 </td><td class="diffpresent">&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">def<span class="dp">·</span>rdp_core(q:<span class="dp">·</span>float,<span class="dp">·</span>noise_multiplier:<span class="dp">·</span>float,<span class="dp">·</span>alpha:<span class="dp">·</span>float):</td><td class="diffline">19 </td><td class="diffpresent">def<span class="dp">·</span>rdp_core(q:<span class="dp">·</span>float,<span class="dp">·</span>noise_multiplier:<span class="dp">·</span>float,<span class="dp">·</span>alpha:<span class="dp">·</span>float):</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.11 KB</span></div>
    <div id="secretflow-security-privacy-mechanism-tensorflow-layers.py"><span class="source">secretflow/security/privacy/mechanism/tensorflow/layers.py</span>
      <a class="anchor" href="#secretflow-security-privacy-mechanism-tensorflow-layers.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 29 lines modified</td><td colspan="2">Offset 8, 29 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.rdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_rdp,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_privacy_spent_rdp,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.gdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.gdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cal_mu_poisson,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cal_mu_poisson,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cal_mu_uniform,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cal_mu_uniform,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_eps_from_mu,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_eps_from_mu,</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">)</td><td class="diffline">22 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.rdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_privacy_spent_rdp,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_rdp,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">class<span class="dp">·</span>EmbeddingDP(tf.keras.layers.Layer,<span class="dp">·</span>ABC):</td><td class="diffline">27 </td><td class="diffpresent">class<span class="dp">·</span>EmbeddingDP(tf.keras.layers.Layer,<span class="dp">·</span>ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>None:</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self)<span class="dp">·</span>-&gt;<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__()</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>super().__init__()</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">827 B</span></div>
    <div id="secretflow-security-privacy-mechanism-tensorflow-mechanism_fl.py"><span class="source">secretflow/security/privacy/mechanism/tensorflow/mechanism_fl.py</span>
      <a class="anchor" href="#secretflow-security-privacy-mechanism-tensorflow-mechanism_fl.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 21 lines modified</td><td colspan="2">Offset 8, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>tensorflow<span class="dp">·</span>as<span class="dp">·</span>tf</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.rdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.security.privacy.accounting.rdp_accountant<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_rdp,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_privacy_spent_rdp,</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_privacy_spent_rdp,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>get_rdp,</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">)</td><td class="diffline">20 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>GaussianModelDP:</td><td class="diffline">21 </td><td class="diffpresent">class<span class="dp">·</span>GaussianModelDP:</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;global<span class="dp">·</span>model<span class="dp">·</span>differential<span class="dp">·</span>privacy<span class="dp">·</span>perturbation<span class="dp">·</span>using<span class="dp">·</span>gaussian<span class="dp">·</span>noise&quot;&quot;&quot;</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;global<span class="dp">·</span>model<span class="dp">·</span>differential<span class="dp">·</span>privacy<span class="dp">·</span>perturbation<span class="dp">·</span>using<span class="dp">·</span>gaussian<span class="dp">·</span>noise&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.15 KB</span></div>
    <div id="secretflow-stats-__init__.py"><span class="source">secretflow/stats/__init__.py</span>
      <a class="anchor" href="#secretflow-stats-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 24 lines modified</td><td colspan="2">Offset 8, 23 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.ss_pearsonr_v<span class="dp">·</span>import<span class="dp">·</span>PearsonR<span class="dp">·</span>as<span class="dp">·</span>SSVertPearsonR</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.ss_vif_v<span class="dp">·</span>import<span class="dp">·</span>VIF<span class="dp">·</span>as<span class="dp">·</span>SSVertVIF</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.ss_pvalue_v<span class="dp">·</span>import<span class="dp">·</span>PVlaue<span class="dp">·</span>as<span class="dp">·</span>SSPValue</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.regression_eval<span class="dp">·</span>import<span class="dp">·</span>RegressionEval</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.biclassification_eval<span class="dp">·</span>import<span class="dp">·</span>BiClassificationEval</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.biclassification_eval<span class="dp">·</span>import<span class="dp">·</span>BiClassificationEval</td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.pva_eval<span class="dp">·</span>import<span class="dp">·</span>pva_eval</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>.psi_eval<span class="dp">·</span>import<span class="dp">·</span>psi_eval</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.psi_eval<span class="dp">·</span>import<span class="dp">·</span>psi_eval</td></tr>
<tr class="diffchanged"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.<del>ta</del><del>ble</del>_<del>st</del>a<del>tistic</del><del>s</del><span class="dp">·</span>import<span class="dp">·</span><del>ta</del><del>ble</del>_<del>st</del>a<del>tistic</del><del>s</del></td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.<ins>pva</ins>_<ins>ev</ins>a<ins>l</ins><span class="dp">·</span>import<span class="dp">·</span><ins>pva</ins>_<ins>ev</ins>a<ins>l</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>.regression_eval<span class="dp">·</span>import<span class="dp">·</span>RegressionEval</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>.score_card<span class="dp">·</span>import<span class="dp">·</span>ScoreCard</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>.score_card<span class="dp">·</span>import<span class="dp">·</span>ScoreCard</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>.ss_pearsonr_v<span class="dp">·</span>import<span class="dp">·</span>PearsonR<span class="dp">·</span>as<span class="dp">·</span>SSVertPearsonR</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>.ss_pvalue_v<span class="dp">·</span>import<span class="dp">·</span>PVlaue<span class="dp">·</span>as<span class="dp">·</span>SSPValue</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.ss_vif_v<span class="dp">·</span>import<span class="dp">·</span>VIF<span class="dp">·</span>as<span class="dp">·</span>SSVertVIF</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>.table_statistics<span class="dp">·</span>import<span class="dp">·</span>table_statistics</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">23 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSVertPearsonR&#x27;,</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSVertPearsonR&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSVertVIF&#x27;,</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSVertVIF&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSPValue&#x27;,</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;SSPValue&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;RegressionEval&#x27;,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;RegressionEval&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;BiClassificationEval&#x27;,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;BiClassificationEval&#x27;,</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.5 KB</span></div>
    <div id="secretflow-stats-regression_eval.py"><span class="source">secretflow/stats/regression_eval.py</span>
      <a class="anchor" href="#secretflow-stats-regression_eval.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 37 lines modified</td><td colspan="2">Offset 9, 37 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>(</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.ndarray<span class="dp">·</span>import<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean,</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean,</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r2_score,</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rss,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_err,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_err,</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_percent_err,</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_percent_err,</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_squared_error,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_squared_error,</td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r<del>oot_mea</del><del>n</del>_s<del>q</del><del>ua</del>r<del>ed_</del>e<del>rror</del>,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r<ins>2</ins>_s<ins>co</ins>re,</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>residual_histogram,</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>residual_histogram,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>root_mean_squared_error,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rss,</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">)</td><td class="diffline">24 </td><td class="diffpresent">)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">class<span class="dp">·</span>RegressionEval:</td><td class="diffline">26 </td><td class="diffpresent">class<span class="dp">·</span>RegressionEval:</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Statistics<span class="dp">·</span>Evaluation<span class="dp">·</span>for<span class="dp">·</span>a<span class="dp">·</span>regression<span class="dp">·</span>model<span class="dp">·</span>on<span class="dp">·</span>a<span class="dp">·</span>dataset.</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Statistics<span class="dp">·</span>Evaluation<span class="dp">·</span>for<span class="dp">·</span>a<span class="dp">·</span>regression<span class="dp">·</span>model<span class="dp">·</span>on<span class="dp">·</span>a<span class="dp">·</span>dataset.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Attributes:</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_true:<span class="dp">·</span>FedNdarray</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_true:<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y_true<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>party,<span class="dp">·</span>then<span class="dp">·</span>each<span class="dp">·</span>statistics<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>PYUObject.</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y_true<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>a<span class="dp">·</span>single<span class="dp">·</span>party,<span class="dp">·</span>then<span class="dp">·</span>each<span class="dp">·</span>statistics<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>PYUObject.</td></tr>
<tr class="diffchanged"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y_true<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>multiple<span class="dp">·</span>parties,<span class="dp">·</span>then<span class="dp">·</span>a<span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>If<span class="dp">·</span>y_true<span class="dp">·</span>is<span class="dp">·</span>from<span class="dp">·</span>multiple<span class="dp">·</span>parties,<span class="dp">·</span>then<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>device<span class="dp">·</span>is<span class="dp">·</span>required</td></tr>
<tr class="diffchanged"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>each<span class="dp">·</span>statistics<span class="dp">·</span>is<span class="dp">·</span>a<span class="dp">·</span>SPUObject.</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>each<span class="dp">·</span>statistics<span class="dp">·</span>is<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPUObject.</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred:<span class="dp">·</span>FedNdarray</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_pred:<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_true<span class="dp">·</span>and<span class="dp">·</span>y_pred<span class="dp">·</span>must<span class="dp">·</span>have<span class="dp">·</span>the<span class="dp">·</span>same<span class="dp">·</span>device<span class="dp">·</span>and<span class="dp">·</span>partition<span class="dp">·</span>shapes</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y_true<span class="dp">·</span>and<span class="dp">·</span>y_pred<span class="dp">·</span>must<span class="dp">·</span>have<span class="dp">·</span>the<span class="dp">·</span>same<span class="dp">·</span>device<span class="dp">·</span>and<span class="dp">·</span>partition<span class="dp">·</span>shapes</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r2_score:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>r2_score:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_err:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_err:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_percent_err:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mean_abs_percent_err:<span class="dp">·</span>Union[PYUObject,<span class="dp">·</span>SPUObject]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">926 B</span></div>
    <div id="secretflow-stats-score_card.py"><span class="source">secretflow/stats/score_card.py</span>
      <a class="anchor" href="#secretflow-stats-score_card.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 23 lines modified</td><td colspan="2">Offset 8, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data<span class="dp">·</span>import<span class="dp">·</span>FedNdarray</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>ScoreCard:</td><td class="diffline">20 </td><td class="diffpresent">class<span class="dp">·</span>ScoreCard:</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>component<span class="dp">·</span>provides<span class="dp">·</span>a<span class="dp">·</span>mapping<span class="dp">·</span>procedure<span class="dp">·</span>from<span class="dp">·</span>binary<span class="dp">·</span>regression&#x27;s<span class="dp">·</span>probability<span class="dp">·</span>value<span class="dp">·</span>to<span class="dp">·</span>an<span class="dp">·</span>integer<span class="dp">·</span>range<span class="dp">·</span>score.</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>component<span class="dp">·</span>provides<span class="dp">·</span>a<span class="dp">·</span>mapping<span class="dp">·</span>procedure<span class="dp">·</span>from<span class="dp">·</span>binary<span class="dp">·</span>regression&#x27;s<span class="dp">·</span>probability<span class="dp">·</span>value<span class="dp">·</span>to<span class="dp">·</span>an<span class="dp">·</span>integer<span class="dp">·</span>range<span class="dp">·</span>score.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>mapping<span class="dp">·</span>process<span class="dp">·</span>is<span class="dp">·</span>as<span class="dp">·</span>follows:</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>The<span class="dp">·</span>mapping<span class="dp">·</span>process<span class="dp">·</span>is<span class="dp">·</span>as<span class="dp">·</span>follows:</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.32 KB</span></div>
    <div id="secretflow-stats-ss_pearsonr_v.py"><span class="source">secretflow/stats/ss_pearsonr_v.py</span>
      <a class="anchor" href="#secretflow-stats-ss_pearsonr_v.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 16 lines modified</td><td colspan="2">Offset 10, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.scaler<span class="dp">·</span>import<span class="dp">·</span>StandardScaler</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.scaler<span class="dp">·</span>import<span class="dp">·</span>StandardScaler</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffhunk"><td colspan="2">Offset 54, 15 lines modified</td><td colspan="2">Offset 54, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>standardize<span class="dp">·</span>purpose:</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>standardize<span class="dp">·</span>purpose:</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>reduce<span class="dp">·</span>the<span class="dp">·</span>result<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>matrix<span class="dp">·</span>xtx,<span class="dp">·</span>avoid<span class="dp">·</span>overflow<span class="dp">·</span>in<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>reduce<span class="dp">·</span>the<span class="dp">·</span>result<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>matrix<span class="dp">·</span>xtx,<span class="dp">·</span>avoid<span class="dp">·</span>overflow<span class="dp">·</span>in<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>after<span class="dp">·</span>standardize,<span class="dp">·</span>the<span class="dp">·</span>variance<span class="dp">·</span>is<span class="dp">·</span>1<span class="dp">·</span>and<span class="dp">·</span>the<span class="dp">·</span>mean<span class="dp">·</span>is<span class="dp">·</span>0,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>simplify<span class="dp">·</span>the<span class="dp">·</span>calculation.</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>after<span class="dp">·</span>standardize,<span class="dp">·</span>the<span class="dp">·</span>variance<span class="dp">·</span>is<span class="dp">·</span>1<span class="dp">·</span>and<span class="dp">·</span>the<span class="dp">·</span>mean<span class="dp">·</span>is<span class="dp">·</span>0,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>simplify<span class="dp">·</span>the<span class="dp">·</span>calculation.</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>standardize:</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>standardize:</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scaler<span class="dp">·</span>=<span class="dp">·</span>StandardScaler()</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scaler<span class="dp">·</span>=<span class="dp">·</span>StandardScaler()</td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata<span class="dp">·</span>=<span class="dp">·</span>scaler.fit_transform(vdata)</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata<span class="dp">·</span>=<span class="dp">·</span>scaler.fit_transform(vdata)</td></tr>
<tr class="diffchanged"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[<del>sf</del>.to(self.spu_device<del>,<span class="dp">·</span>d.data</del>)<span class="dp">·</span>for<span class="dp">·</span>d<span class="dp">·</span>in<span class="dp">·</span>vdata.partitions.values()]</td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[<ins>d.da</ins><ins>ta</ins>.to(self.spu_device)<span class="dp">·</span>for<span class="dp">·</span>d<span class="dp">·</span>in<span class="dp">·</span>vdata.partitions.values()]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rows<span class="dp">·</span>=<span class="dp">·</span>vdata.shape[0]</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rows<span class="dp">·</span>=<span class="dp">·</span>vdata.shape[0]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_xtx(objs:<span class="dp">·</span>List[np.ndarray]):</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_xtx(objs:<span class="dp">·</span>List[np.ndarray]):</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>jnp.concatenate(objs,<span class="dp">·</span>axis=1)</td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>jnp.concatenate(objs,<span class="dp">·</span>axis=1)</td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.matmul(data.transpose(),<span class="dp">·</span>data)</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>jnp.matmul(data.transpose(),<span class="dp">·</span>data)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">2.27 KB</span></div>
    <div id="secretflow-stats-ss_pvalue_v.py"><span class="source">secretflow/stats/ss_pvalue_v.py</span>
      <a class="anchor" href="#secretflow-stats-ss_pvalue_v.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 24 lines modified</td><td colspan="2">Offset 10, 24 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>logging</td></tr>
<tr class="diffchanged"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List,<span class="dp">·</span>Tuple</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>Any,<span class="dp">·</span></ins>List,<span class="dp">·</span>Tuple</td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>scipy<span class="dp">·</span>import<span class="dp">·</span>stats</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>scipy<span class="dp">·</span>import<span class="dp">·</span>stats</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td><td class="diffline">19 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPUObject,<span class="dp">·</span>SPU</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.ml.linear<span class="dp">·</span>import<span class="dp">·</span>LinearModel,<span class="dp">·</span>RegType,<span class="dp">·</span>SSRegression</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU,<span class="dp">·</span>SPUObject</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.sigmoid<span class="dp">·</span>import<span class="dp">·</span>SigType</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>newton_matrix_inverse</td><td class="diffline">23 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>newton_matrix_inverse</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">#<span class="dp">·</span>spu<span class="dp">·</span>functions<span class="dp">·</span>for<span class="dp">·</span>Logistic<span class="dp">·</span>PValue</td><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>spu<span class="dp">·</span>functions<span class="dp">·</span>for<span class="dp">·</span>Logistic<span class="dp">·</span>PValue</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">def<span class="dp">·</span>_hessian_matrix(x:<span class="dp">·</span>np.ndarray,<span class="dp">·</span>yhat:<span class="dp">·</span>np.ndarray):</td><td class="diffline">25 </td><td class="diffpresent">def<span class="dp">·</span>_hessian_matrix(x:<span class="dp">·</span>np.ndarray,<span class="dp">·</span>yhat:<span class="dp">·</span>np.ndarray):</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 172, 15 lines modified</td><td colspan="2">Offset 172, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n2.<span class="dp">·</span>if<span class="dp">·</span>input<span class="dp">·</span>model<span class="dp">·</span>is<span class="dp">·</span>converged.&quot;</td><td class="diffline">172 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n2.<span class="dp">·</span>if<span class="dp">·</span>input<span class="dp">·</span>model<span class="dp">·</span>is<span class="dp">·</span>converged.&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n3.<span class="dp">·</span>if<span class="dp">·</span>dataset<span class="dp">·</span>is<span class="dp">·</span>same<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>one<span class="dp">·</span>used<span class="dp">·</span>during<span class="dp">·</span>training.&quot;</td><td class="diffline">173 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n3.<span class="dp">·</span>if<span class="dp">·</span>dataset<span class="dp">·</span>is<span class="dp">·</span>same<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>one<span class="dp">·</span>used<span class="dp">·</span>during<span class="dp">·</span>training.&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n4.<span class="dp">·</span>if<span class="dp">·</span>dataset<span class="dp">·</span>is<span class="dp">·</span>normalized<span class="dp">·</span>or<span class="dp">·</span>standardized.&quot;</td><td class="diffline">174 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;\n4.<span class="dp">·</span>if<span class="dp">·</span>dataset<span class="dp">·</span>is<span class="dp">·</span>normalized<span class="dp">·</span>or<span class="dp">·</span>standardized.&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">175 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>square[idx]<span class="dp">·</span>=<span class="dp">·</span>0</td><td class="diffline">176 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>square[idx]<span class="dp">·</span>=<span class="dp">·</span>0</td></tr>
<tr class="diffunmodified"><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>square</td><td class="diffline">177 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>square</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>pvalues(self,<span class="dp">·</span>x:<span class="dp">·</span>VDataFrame,<span class="dp">·</span>y:<span class="dp">·</span>VDataFrame,<span class="dp">·</span>model:<span class="dp">·</span><del>L</del><del>i</del>n<del>earMode</del><del>l</del>)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td><td class="diffline">178 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>pvalues(self,<span class="dp">·</span>x:<span class="dp">·</span>VDataFrame,<span class="dp">·</span>y:<span class="dp">·</span>VDataFrame,<span class="dp">·</span>model:<span class="dp">·</span><ins>A</ins>n<ins>y</ins>)<span class="dp">·</span>-&gt;<span class="dp">·</span>np.ndarray:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>from<span class="dp">·</span>secretflow.ml.linear<span class="dp">·</span>import<span class="dp">·</span>LinearModel,<span class="dp">·</span>RegType,<span class="dp">·</span>SSRegression</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">179 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">180 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>computer<span class="dp">·</span>pvalue<span class="dp">·</span>for<span class="dp">·</span>lr<span class="dp">·</span>model</td><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>computer<span class="dp">·</span>pvalue<span class="dp">·</span>for<span class="dp">·</span>lr<span class="dp">·</span>model</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">181 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">182 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>:<span class="dp">·</span>VDataFrame</td><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x<span class="dp">·</span>:<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">183 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>input<span class="dp">·</span>dataset</td><td class="diffline">184 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>input<span class="dp">·</span>dataset</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 188, 14 lines modified</td><td colspan="2">Offset 190, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">188 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>true<span class="dp">·</span>label</td><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>true<span class="dp">·</span>label</td></tr>
<tr class="diffunmodified"><td class="diffline">189 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>model<span class="dp">·</span>:<span class="dp">·</span>LinearModel</td><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>model<span class="dp">·</span>:<span class="dp">·</span>LinearModel</td></tr>
<tr class="diffunmodified"><td class="diffline">190 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lr<span class="dp">·</span>model</td><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lr<span class="dp">·</span>model</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">191 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Return:</td></tr>
<tr class="diffunmodified"><td class="diffline">192 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PValue</td><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>PValue</td></tr>
<tr class="diffunmodified"><td class="diffline">193 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(model,<span class="dp">·</span>LinearModel),<span class="dp">·</span>&quot;Only<span class="dp">·</span>support<span class="dp">·</span>Linear<span class="dp">·</span>model.&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">194 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(model.weights,<span class="dp">·</span>SPUObject),<span class="dp">·</span>(</td><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(model.weights,<span class="dp">·</span>SPUObject),<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">195 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;Only<span class="dp">·</span>support<span class="dp">·</span>model<span class="dp">·</span>fit<span class="dp">·</span>by<span class="dp">·</span>sslr/hesslr<span class="dp">·</span>that<span class="dp">·</span>&quot;</td><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;Only<span class="dp">·</span>support<span class="dp">·</span>model<span class="dp">·</span>fit<span class="dp">·</span>by<span class="dp">·</span>sslr/hesslr<span class="dp">·</span>that<span class="dp">·</span>&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">196 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;training<span class="dp">·</span>on<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>dataset.&quot;</td><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;training<span class="dp">·</span>on<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>dataset.&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">197 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">198 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>model.weights.device<span class="dp">·</span>==<span class="dp">·</span>self.spu,<span class="dp">·</span>&quot;weights<span class="dp">·</span>should<span class="dp">·</span>saved<span class="dp">·</span>in<span class="dp">·</span>same<span class="dp">·</span>spu&quot;</td><td class="diffline">201 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>model.weights.device<span class="dp">·</span>==<span class="dp">·</span>self.spu,<span class="dp">·</span>&quot;weights<span class="dp">·</span>should<span class="dp">·</span>saved<span class="dp">·</span>in<span class="dp">·</span>same<span class="dp">·</span>spu&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">199 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lr<span class="dp">·</span>=<span class="dp">·</span>SSRegression(self.spu)</td><td class="diffline">202 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lr<span class="dp">·</span>=<span class="dp">·</span>SSRegression(self.spu)</td></tr>
<tr class="diffunmodified"><td class="diffline">200 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>hessian_matrix<span class="dp">·</span>is<span class="dp">·</span>very<span class="dp">·</span>sensitive<span class="dp">·</span>on<span class="dp">·</span>yhat,<span class="dp">·</span>use<span class="dp">·</span>a<span class="dp">·</span>expensive<span class="dp">·</span>but<span class="dp">·</span>more<span class="dp">·</span>precision<span class="dp">·</span>sig<span class="dp">·</span>approximation.</td><td class="diffline">203 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>hessian_matrix<span class="dp">·</span>is<span class="dp">·</span>very<span class="dp">·</span>sensitive<span class="dp">·</span>on<span class="dp">·</span>yhat,<span class="dp">·</span>use<span class="dp">·</span>a<span class="dp">·</span>expensive<span class="dp">·</span>but<span class="dp">·</span>more<span class="dp">·</span>precision<span class="dp">·</span>sig<span class="dp">·</span>approximation.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.48 KB</span></div>
    <div id="secretflow-stats-ss_vif_v.py"><span class="source">secretflow/stats/ss_vif_v.py</span>
      <a class="anchor" href="#secretflow-stats-ss_vif_v.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 21 lines modified</td><td colspan="2">Offset 10, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>List</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>secretflow<span class="dp">·</span>as<span class="dp">·</span>sf</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>SPU</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.scaler<span class="dp">·</span>import<span class="dp">·</span>StandardScaler</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.preprocessing.scaler<span class="dp">·</span>import<span class="dp">·</span>StandardScaler</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>newton_matrix_inverse</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>.core.utils<span class="dp">·</span>import<span class="dp">·</span>newton_matrix_inverse</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>VIF:</td><td class="diffline">22 </td><td class="diffpresent">class<span class="dp">·</span>VIF:</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Calculate<span class="dp">·</span>variance<span class="dp">·</span>inflation<span class="dp">·</span>factor<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>dataset</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Calculate<span class="dp">·</span>variance<span class="dp">·</span>inflation<span class="dp">·</span>factor<span class="dp">·</span>for<span class="dp">·</span>vertical<span class="dp">·</span>slice<span class="dp">·</span>dataset</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>by<span class="dp">·</span>using<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>by<span class="dp">·</span>using<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 73, 15 lines modified</td><td colspan="2">Offset 74, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>reduce<span class="dp">·</span>the<span class="dp">·</span>result<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>matrix<span class="dp">·</span>xtx,<span class="dp">·</span>avoid<span class="dp">·</span>overflow<span class="dp">·</span>in<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>reduce<span class="dp">·</span>the<span class="dp">·</span>result<span class="dp">·</span>number<span class="dp">·</span>of<span class="dp">·</span>matrix<span class="dp">·</span>xtx,<span class="dp">·</span>avoid<span class="dp">·</span>overflow<span class="dp">·</span>in<span class="dp">·</span>secret<span class="dp">·</span>sharing.</td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>after<span class="dp">·</span>standardize,<span class="dp">·</span>the<span class="dp">·</span>variance<span class="dp">·</span>is<span class="dp">·</span>1<span class="dp">·</span>and<span class="dp">·</span>the<span class="dp">·</span>mean<span class="dp">·</span>is<span class="dp">·</span>0,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>simplify<span class="dp">·</span>the<span class="dp">·</span>calculation.</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>after<span class="dp">·</span>standardize,<span class="dp">·</span>the<span class="dp">·</span>variance<span class="dp">·</span>is<span class="dp">·</span>1<span class="dp">·</span>and<span class="dp">·</span>the<span class="dp">·</span>mean<span class="dp">·</span>is<span class="dp">·</span>0,<span class="dp">·</span>which<span class="dp">·</span>can<span class="dp">·</span>simplify<span class="dp">·</span>the<span class="dp">·</span>calculation.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>standardize:</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>standardize:</td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scaler<span class="dp">·</span>=<span class="dp">·</span>StandardScaler()</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>scaler<span class="dp">·</span>=<span class="dp">·</span>StandardScaler()</td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata<span class="dp">·</span>=<span class="dp">·</span>scaler.fit_transform(vdata)</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>vdata<span class="dp">·</span>=<span class="dp">·</span>scaler.fit_transform(vdata)</td></tr>
<tr class="diffchanged"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[<del>sf</del>.to(self.spu_device<del>,<span class="dp">·</span>d.data</del>)<span class="dp">·</span>for<span class="dp">·</span>d<span class="dp">·</span>in<span class="dp">·</span>vdata.partitions.values()]</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>obj_list<span class="dp">·</span>=<span class="dp">·</span>[<ins>d.da</ins><ins>ta</ins>.to(self.spu_device)<span class="dp">·</span>for<span class="dp">·</span>d<span class="dp">·</span>in<span class="dp">·</span>vdata.partitions.values()]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rows<span class="dp">·</span>=<span class="dp">·</span>vdata.shape[0]</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>rows<span class="dp">·</span>=<span class="dp">·</span>vdata.shape[0]</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_vif(objs:<span class="dp">·</span>List[np.ndarray]):</td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>spu_vif(objs:<span class="dp">·</span>List[np.ndarray]):</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>jnp.concatenate(objs,<span class="dp">·</span>axis=1)</td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>jnp.concatenate(objs,<span class="dp">·</span>axis=1)</td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>xtx<span class="dp">·</span>=<span class="dp">·</span>jnp.matmul(data.transpose(),<span class="dp">·</span>data)</td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>xtx<span class="dp">·</span>=<span class="dp">·</span>jnp.matmul(data.transpose(),<span class="dp">·</span>data)</td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_inv<span class="dp">·</span>=<span class="dp">·</span>newton_matrix_inverse(xtx)</td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_inv<span class="dp">·</span>=<span class="dp">·</span>newton_matrix_inverse(xtx)</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">749 B</span></div>
    <div id="secretflow-stats-table_statistics.py"><span class="source">secretflow/stats/table_statistics.py</span>
      <a class="anchor" href="#secretflow-stats-table_statistics.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 17 lines modified</td><td colspan="2">Offset 8, 19 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.vertical<span class="dp">·</span>import<span class="dp">·</span>VDataFrame</td></tr>
<tr class="diffdeleted"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Union</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">def<span class="dp">·</span>table_statistics(table:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>VDataFrame])<span class="dp">·</span>-&gt;<span class="dp">·</span>pd.DataFrame:</td><td class="diffline">17 </td><td class="diffpresent">def<span class="dp">·</span>table_statistics(table:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>VDataFrame])<span class="dp">·</span>-&gt;<span class="dp">·</span>pd.DataFrame:</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Get<span class="dp">·</span>table<span class="dp">·</span>statistics<span class="dp">·</span>for<span class="dp">·</span>a<span class="dp">·</span>pd.DataFrame<span class="dp">·</span>or<span class="dp">·</span>VDataFrame.</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Get<span class="dp">·</span>table<span class="dp">·</span>statistics<span class="dp">·</span>for<span class="dp">·</span>a<span class="dp">·</span>pd.DataFrame<span class="dp">·</span>or<span class="dp">·</span>VDataFrame.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>table:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>VDataFrame]</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>table:<span class="dp">·</span>Union[pd.DataFrame,<span class="dp">·</span>VDataFrame]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">600 B</span></div>
    <div id="secretflow-stats-core-__init__.py"><span class="source">secretflow/stats/core/__init__.py</span>
      <a class="anchor" href="#secretflow-stats-core-__init__.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 9 lines modified</td><td colspan="2">Offset 9, 9 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.biclassification_eval_core<span class="dp">·</span>import<span class="dp">·</span>gen_all_reports<span class="dp">·</span>as<span class="dp">·</span>gen_biclassification_reports</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.biclassification_eval_core<span class="dp">·</span>import<span class="dp">·</span>gen_all_reports<span class="dp">·</span>as<span class="dp">·</span>gen_biclassification_reports</td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.pva_core<span class="dp">·</span>import<span class="dp">·</span>pva</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.psi_core<span class="dp">·</span>import<span class="dp">·</span>psi</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>.psi_core<span class="dp">·</span>import<span class="dp">·</span>psi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>.pva_core<span class="dp">·</span>import<span class="dp">·</span>pva</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">701 B</span></div>
    <div id="secretflow-stats-core-utils.py"><span class="source">secretflow/stats/core/utils.py</span>
      <a class="anchor" href="#secretflow-stats-core-utils.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 9, 16 lines modified</td><td colspan="2">Offset 9, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">def<span class="dp">·</span>newton_matrix_inverse(x:<span class="dp">·</span>np.ndarray,<span class="dp">·</span>iter_round:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>20):</td><td class="diffline">16 </td><td class="diffpresent">def<span class="dp">·</span>newton_matrix_inverse(x:<span class="dp">·</span>np.ndarray,<span class="dp">·</span>iter_round:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>20):</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>computing<span class="dp">·</span>the<span class="dp">·</span>inverse<span class="dp">·</span>of<span class="dp">·</span>a<span class="dp">·</span>matrix<span class="dp">·</span>by<span class="dp">·</span>newton<span class="dp">·</span>iteration.</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>computing<span class="dp">·</span>the<span class="dp">·</span>inverse<span class="dp">·</span>of<span class="dp">·</span>a<span class="dp">·</span>matrix<span class="dp">·</span>by<span class="dp">·</span>newton<span class="dp">·</span>iteration.</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://aalexan3.math.ncsu.edu/articles/mat-inv-rep.pdf</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://aalexan3.math.ncsu.edu/articles/mat-inv-rep.pdf</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">514 B</span></div>
    <div id="secretflow-utils-__init__.py"><span class="source">secretflow/utils/__init__.py</span>
      <a class="anchor" href="#secretflow-utils-__init__.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 13 lines modified</td><td colspan="2">Offset 8, 13 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span><del>testing</del>,<span class="dp">·</span><del>sigmoid</del></td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>.<span class="dp">·</span>import<span class="dp">·</span><ins>sigmoid</ins>,<span class="dp">·</span><ins>testing</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td><td class="diffline">15 </td><td class="diffpresent">__all__<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;testing&#x27;,</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;testing&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;sigmoid&#x27;,</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;sigmoid&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">]</td><td class="diffline">18 </td><td class="diffpresent">]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.36 KB</span></div>
    <div id="secretflow-utils-compressor.py"><span class="source">secretflow/utils/compressor.py</span>
      <a class="anchor" href="#secretflow-utils-compressor.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 12, 15 lines modified</td><td colspan="2">Offset 12, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>abc<span class="dp">·</span>import<span class="dp">·</span>ABC,<span class="dp">·</span>abstractmethod</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>List,<span class="dp">·</span>Union</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Any,<span class="dp">·</span>List,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffdeleted"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>scipy<span class="dp">·</span>import<span class="dp">·</span>sparse</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>scipy<span class="dp">·</span>import<span class="dp">·</span>sparse</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">class<span class="dp">·</span>Compressor(ABC):</td><td class="diffline">18 </td><td class="diffpresent">class<span class="dp">·</span>Compressor(ABC):</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstract<span class="dp">·</span>base<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>cross<span class="dp">·</span>device<span class="dp">·</span>data<span class="dp">·</span>compressor&quot;&quot;&quot;</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Abstract<span class="dp">·</span>base<span class="dp">·</span>class<span class="dp">·</span>for<span class="dp">·</span>cross<span class="dp">·</span>device<span class="dp">·</span>data<span class="dp">·</span>compressor&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>@abstractmethod</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 298, 14 lines modified</td><td colspan="2">Offset 297, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">298 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>None:</td><td class="diffline">297 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">299 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>None</td><td class="diffline">298 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">300 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>encode_method<span class="dp">·</span>in<span class="dp">·</span>[</td><td class="diffline">299 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>encode_method<span class="dp">·</span>in<span class="dp">·</span>[</td></tr>
<tr class="diffunmodified"><td class="diffline">301 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;coo&#x27;,</td><td class="diffline">300 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;coo&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">302 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;gcxs&#x27;,</td><td class="diffline">301 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;gcxs&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">303 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>],<span class="dp">·</span>f&#x27;Get<span class="dp">·</span>unsupport<span class="dp">·</span>sparse<span class="dp">·</span>encoding<span class="dp">·</span>method:<span class="dp">·</span>{encode_method},<span class="dp">·</span>&#x27;</td><td class="diffline">302 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>],<span class="dp">·</span>f&#x27;Get<span class="dp">·</span>unsupport<span class="dp">·</span>sparse<span class="dp">·</span>encoding<span class="dp">·</span>method:<span class="dp">·</span>{encode_method},<span class="dp">·</span>&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">304 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_datas<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">303 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_datas<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">304 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">305 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data:</td><td class="diffline">305 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data:</td></tr>
<tr class="diffunmodified"><td class="diffline">306 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>encode_method<span class="dp">·</span>==<span class="dp">·</span>&#x27;coo&#x27;:</td><td class="diffline">306 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>encode_method<span class="dp">·</span>==<span class="dp">·</span>&#x27;coo&#x27;:</td></tr>
<tr class="diffunmodified"><td class="diffline">307 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_data<span class="dp">·</span>=<span class="dp">·</span>sp.COO(datum)</td><td class="diffline">307 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_data<span class="dp">·</span>=<span class="dp">·</span>sp.COO(datum)</td></tr>
<tr class="diffunmodified"><td class="diffline">308 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td><td class="diffline">308 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>else:</td></tr>
<tr class="diffunmodified"><td class="diffline">309 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_data<span class="dp">·</span>=<span class="dp">·</span>sp.GCXS(datum)</td><td class="diffline">309 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_data<span class="dp">·</span>=<span class="dp">·</span>sp.GCXS(datum)</td></tr>
<tr class="diffunmodified"><td class="diffline">310 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_datas.append(encoded_data)</td><td class="diffline">310 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encoded_datas.append(encoded_data)</td></tr>
<tr class="diffunmodified"><td class="diffline">311 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>encoded_datas</td><td class="diffline">311 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>encoded_datas</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 315, 14 lines modified</td><td colspan="2">Offset 316, 16 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">315 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Decode<span class="dp">·</span>the<span class="dp">·</span>compressed<span class="dp">·</span>sparse<span class="dp">·</span>matrix</td><td class="diffline">316 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Decode<span class="dp">·</span>the<span class="dp">·</span>compressed<span class="dp">·</span>sparse<span class="dp">·</span>matrix</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">316 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td><td class="diffline">317 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffunmodified"><td class="diffline">317 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>compressed<span class="dp">·</span>matrix<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>decoded</td><td class="diffline">318 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data:<span class="dp">·</span>compressed<span class="dp">·</span>matrix<span class="dp">·</span>to<span class="dp">·</span>be<span class="dp">·</span>decoded</td></tr>
<tr class="diffunmodified"><td class="diffline">318 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td class="diffline">319 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffunmodified"><td class="diffline">319 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_datas:<span class="dp">·</span>Decoded<span class="dp">·</span>matrix</td><td class="diffline">320 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decoded_datas:<span class="dp">·</span>Decoded<span class="dp">·</span>matrix</td></tr>
<tr class="diffunmodified"><td class="diffline">320 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">321 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>import<span class="dp">·</span>sparse<span class="dp">·</span>as<span class="dp">·</span>sp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">321 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>None:</td><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>data<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffunmodified"><td class="diffline">322 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>None</td><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>None</td></tr>
<tr class="diffunmodified"><td class="diffline">323 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>isinstance(</td></tr>
<tr class="diffunmodified"><td class="diffline">324 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data[0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)</td><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data[0],<span class="dp">·</span>(sp._coo.core.COO,<span class="dp">·</span>sp._compressed.compressed.GCXS)</td></tr>
<tr class="diffunmodified"><td class="diffline">325 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;Sparse<span class="dp">·</span>encoding<span class="dp">·</span>method<span class="dp">·</span>not<span class="dp">·</span>supporterd,<span class="dp">·</span>Only<span class="dp">·</span>COO<span class="dp">·</span>GCXS<span class="dp">·</span>supported&#x27;</td><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;Sparse<span class="dp">·</span>encoding<span class="dp">·</span>method<span class="dp">·</span>not<span class="dp">·</span>supporterd,<span class="dp">·</span>Only<span class="dp">·</span>COO<span class="dp">·</span>GCXS<span class="dp">·</span>supported&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">326 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decode_datas<span class="dp">·</span>=<span class="dp">·</span>[]</td><td class="diffline">328 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decode_datas<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffunmodified"><td class="diffline">327 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data:</td><td class="diffline">329 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>datum<span class="dp">·</span>in<span class="dp">·</span>data:</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">769 B</span></div>
    <div id="secretflow-utils-hash.py"><span class="source">secretflow/utils/hash.py</span>
      <a class="anchor" href="#secretflow-utils-hash.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 7 lines modified</td><td colspan="2">Offset 1, 22 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>hashlib</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>hashlib</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">_BUF_SIZE<span class="dp">·</span>=<span class="dp">·</span>64<span class="dp">·</span>*<span class="dp">·</span>1024</td><td class="diffline">15 </td><td class="diffpresent">_BUF_SIZE<span class="dp">·</span>=<span class="dp">·</span>64<span class="dp">·</span>*<span class="dp">·</span>1024</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">def<span class="dp">·</span>sha256sum(filename:<span class="dp">·</span>str):</td><td class="diffline">16 </td><td class="diffpresent">def<span class="dp">·</span>sha256sum(filename:<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>hashlib.sha256()</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>hashlib.sha256()</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">863 B</span></div>
    <div id="secretflow-utils-io.py"><span class="source">secretflow/utils/io.py</span>
      <a class="anchor" href="#secretflow-utils-io.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 7 lines modified</td><td colspan="2">Offset 1, 22 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>platform</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>platform</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">def<span class="dp">·</span>rows_count(filename):</td><td class="diffline">15 </td><td class="diffpresent">def<span class="dp">·</span>rows_count(filename):</td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;get<span class="dp">·</span>rows<span class="dp">·</span>count<span class="dp">·</span>from<span class="dp">·</span>file&quot;&quot;&quot;</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;get<span class="dp">·</span>rows<span class="dp">·</span>count<span class="dp">·</span>from<span class="dp">·</span>file&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>line_break<span class="dp">·</span>=<span class="dp">·</span>b&#x27;\r\n&#x27;<span class="dp">·</span>if<span class="dp">·</span>platform.system().lower()<span class="dp">·</span>==<span class="dp">·</span>&quot;windows&quot;<span class="dp">·</span>else<span class="dp">·</span>b&#x27;\n&#x27;</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>line_break<span class="dp">·</span>=<span class="dp">·</span>b&#x27;\r\n&#x27;<span class="dp">·</span>if<span class="dp">·</span>platform.system().lower()<span class="dp">·</span>==<span class="dp">·</span>&quot;windows&quot;<span class="dp">·</span>else<span class="dp">·</span>b&#x27;\n&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(filename,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(filename,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">840 B</span></div>
    <div id="secretflow-utils-logging.py"><span class="source">secretflow/utils/logging.py</span>
      <a class="anchor" href="#secretflow-utils-logging.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 7 lines modified</td><td colspan="2">Offset 1, 21 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">from<span class="dp">·</span>logging<span class="dp">·</span>import<span class="dp">·</span>_checkLevel</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>logging<span class="dp">·</span>import<span class="dp">·</span>_checkLevel</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">_LOGGING_LEVEL<span class="dp">·</span>=<span class="dp">·</span>&#x27;INFO&#x27;</td><td class="diffline">15 </td><td class="diffpresent">_LOGGING_LEVEL<span class="dp">·</span>=<span class="dp">·</span>&#x27;INFO&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">LOG_FORMAT<span class="dp">·</span>=<span class="dp">·</span>&#x27;%(asctime)s,%(msecs)d<span class="dp">·</span>%(levelname)s<span class="dp">·</span>[%(filename)s:%(funcName)s:%(lineno)d]<span class="dp">·</span>%(message)s&#x27;</td><td class="diffline">16 </td><td class="diffpresent">LOG_FORMAT<span class="dp">·</span>=<span class="dp">·</span>&#x27;%(asctime)s,%(msecs)d<span class="dp">·</span>%(levelname)s<span class="dp">·</span>[%(filename)s:%(funcName)s:%(lineno)d]<span class="dp">·</span>%(message)s&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">680 B</span></div>
    <div id="secretflow-utils-ndarray_bigint.py"><span class="source">secretflow/utils/ndarray_bigint.py</span>
      <a class="anchor" href="#secretflow-utils-ndarray_bigint.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 17 lines modified</td><td colspan="2">Offset 8, 17 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>math</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>random</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>random</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>math</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td><td class="diffline">17 </td><td class="diffpresent">from<span class="dp">·</span>heu<span class="dp">·</span>import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>hnp</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">def<span class="dp">·</span>randbits(shape:<span class="dp">·</span>tuple,<span class="dp">·</span>bits):</td><td class="diffline">18 </td><td class="diffpresent">def<span class="dp">·</span>randbits(shape:<span class="dp">·</span>tuple,<span class="dp">·</span>bits):</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>items<span class="dp">·</span>=<span class="dp">·</span>math.prod(shape)</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>items<span class="dp">·</span>=<span class="dp">·</span>math.prod(shape)</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>[random.getrandbits(bits)<span class="dp">·</span>-<span class="dp">·</span>(1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>(bits<span class="dp">·</span>-<span class="dp">·</span>1))<span class="dp">·</span>for<span class="dp">·</span>_<span class="dp">·</span>in<span class="dp">·</span>range(items)]</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data<span class="dp">·</span>=<span class="dp">·</span>[random.getrandbits(bits)<span class="dp">·</span>-<span class="dp">·</span>(1<span class="dp">·</span>&lt;&lt;<span class="dp">·</span>(bits<span class="dp">·</span>-<span class="dp">·</span>1))<span class="dp">·</span>for<span class="dp">·</span>_<span class="dp">·</span>in<span class="dp">·</span>range(items)]</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">894 B</span></div>
    <div id="secretflow-utils-random.py"><span class="source">secretflow/utils/random.py</span>
      <a class="anchor" href="#secretflow-utils-random.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 7 lines modified</td><td colspan="2">Offset 1, 22 lines modified</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">1 </td><td class="diffpresent">#<span class="dp">·</span>Copyright<span class="dp">·</span>2023<span class="dp">·</span>Ant<span class="dp">·</span>Group<span class="dp">·</span>Co.,<span class="dp">·</span>Ltd.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">#<span class="dp">·</span>Licensed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>Apache<span class="dp">·</span>License,<span class="dp">·</span>Version<span class="dp">·</span>2.0<span class="dp">·</span>(the<span class="dp">·</span>&quot;License&quot;);</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">4 </td><td class="diffpresent">#<span class="dp">·</span>you<span class="dp">·</span>may<span class="dp">·</span>not<span class="dp">·</span>use<span class="dp">·</span>this<span class="dp">·</span>file<span class="dp">·</span>except<span class="dp">·</span>in<span class="dp">·</span>compliance<span class="dp">·</span>with<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">#<span class="dp">·</span>You<span class="dp">·</span>may<span class="dp">·</span>obtain<span class="dp">·</span>a<span class="dp">·</span>copy<span class="dp">·</span>of<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>at</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">#<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://www.apache.org/licenses/LICENSE-2.0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>secrets</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>secrets</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>reveal</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device<span class="dp">·</span>import<span class="dp">·</span>PYU,<span class="dp">·</span>reveal</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">def<span class="dp">·</span>global_random(device:<span class="dp">·</span>PYU,<span class="dp">·</span>exclusive_upper_bound:<span class="dp">·</span>int)<span class="dp">·</span>-&gt;<span class="dp">·</span>int:</td><td class="diffline">16 </td><td class="diffpresent">def<span class="dp">·</span>global_random(device:<span class="dp">·</span>PYU,<span class="dp">·</span>exclusive_upper_bound:<span class="dp">·</span>int)<span class="dp">·</span>-&gt;<span class="dp">·</span>int:</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>reveal(device(lambda<span class="dp">·</span>bound:<span class="dp">·</span>secrets.randbelow(bound))(exclusive_upper_bound))</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>reveal(device(lambda<span class="dp">·</span>bound:<span class="dp">·</span>secrets.randbelow(bound))(exclusive_upper_bound))</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">703 B</span></div>
    <div id="secretflow-utils-sigmoid.py"><span class="source">secretflow/utils/sigmoid.py</span>
      <a class="anchor" href="#secretflow-utils-sigmoid.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 8, 16 lines modified</td><td colspan="2">Offset 8, 18 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">#</td><td class="diffline">8 </td><td class="diffpresent">#</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>Unless<span class="dp">·</span>required<span class="dp">·</span>by<span class="dp">·</span>applicable<span class="dp">·</span>law<span class="dp">·</span>or<span class="dp">·</span>agreed<span class="dp">·</span>to<span class="dp">·</span>in<span class="dp">·</span>writing,<span class="dp">·</span>software</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td><td class="diffline">14 </td><td class="diffpresent">from<span class="dp">·</span>enum<span class="dp">·</span>import<span class="dp">·</span>Enum,<span class="dp">·</span>unique</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>jax.numpy<span class="dp">·</span>as<span class="dp">·</span>jnp</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">def<span class="dp">·</span>t1_sig(x,<span class="dp">·</span>limit:<span class="dp">·</span>bool<span class="dp">·</span>=<span class="dp">·</span>True):</td><td class="diffline">17 </td><td class="diffpresent">def<span class="dp">·</span>t1_sig(x,<span class="dp">·</span>limit:<span class="dp">·</span>bool<span class="dp">·</span>=<span class="dp">·</span>True):</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;&#x27;&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>taylor<span class="dp">·</span>series<span class="dp">·</span>referenced<span class="dp">·</span>from:</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>taylor<span class="dp">·</span>series<span class="dp">·</span>referenced<span class="dp">·</span>from:</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://mortendahl.github.io/2017/04/17/private-deep-learning-with-mpc/</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>https://mortendahl.github.io/2017/04/17/private-deep-learning-with-mpc/</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">1.72 KB</span></div>
    <div id="secretflow-utils-testing.py"><span class="source">secretflow/utils/testing.py</span>
      <a class="anchor" href="#secretflow-utils-testing.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 10, 15 lines modified</td><td colspan="2">Offset 10, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>distributed<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>is<span class="dp">·</span>distributed<span class="dp">·</span>on<span class="dp">·</span>an<span class="dp">·</span>&quot;AS<span class="dp">·</span>IS&quot;<span class="dp">·</span>BASIS,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>socket</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>socket</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>contextlib<span class="dp">·</span>import<span class="dp">·</span>closing</td><td class="diffline">15 </td><td class="diffpresent">from<span class="dp">·</span>contextlib<span class="dp">·</span>import<span class="dp">·</span>closing</td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><del>L</del><del>ist</del>,<span class="dp">·</span><del>T</del><del>uple</del>,<span class="dp">·</span><del>ca</del>st,<span class="dp">·</span><del>Dict</del>,<span class="dp">·</span><del>Any</del></td><td class="diffline">16 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span><ins>Any</ins>,<span class="dp">·</span><ins>Dict</ins>,<span class="dp">·</span><ins>Li</ins>st,<span class="dp">·</span><ins>T</ins><ins>uple</ins>,<span class="dp">·</span><ins>c</ins><ins>ast</ins></td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>spu</td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>spu</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">DEFAULT_SEMI2K_RUNTIME_CONFIG<span class="dp">·</span>=<span class="dp">·</span>{</td><td class="diffline">18 </td><td class="diffpresent">DEFAULT_SEMI2K_RUNTIME_CONFIG<span class="dp">·</span>=<span class="dp">·</span>{</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;protocol&#x27;:<span class="dp">·</span>spu.spu_pb2.SEMI2K,</td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;protocol&#x27;:<span class="dp">·</span>spu.spu_pb2.SEMI2K,</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;field&#x27;:<span class="dp">·</span>spu.spu_pb2.FM128,</td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;field&#x27;:<span class="dp">·</span>spu.spu_pb2.FM128,</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent">}</td><td class="diffline">21 </td><td class="diffpresent">}</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 47, 15 lines modified</td><td colspan="2">Offset 47, 15 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`SPU<span class="dp">·</span>runtime<span class="dp">·</span>config<span class="dp">·</span>&lt;https://www.secretflow.org.cn/docs/spu/en/reference/runtime_config.html&gt;`_.</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>`SPU<span class="dp">·</span>runtime<span class="dp">·</span>config<span class="dp">·</span>&lt;https://www.secretflow.org.cn/docs/spu/en/reference/runtime_config.html&gt;`_.</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>use<span class="dp">·</span>default<span class="dp">·</span>runtime<span class="dp">·</span>config.</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Defaults<span class="dp">·</span>to<span class="dp">·</span>None<span class="dp">·</span>and<span class="dp">·</span>use<span class="dp">·</span>default<span class="dp">·</span>runtime<span class="dp">·</span>config.</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1.<span class="dp">·</span>If<span class="dp">·</span>3<span class="dp">·</span>parties<span class="dp">·</span>are<span class="dp">·</span>present,<span class="dp">·</span>protocol<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>ABY3<span class="dp">·</span>and<span class="dp">·</span>field<span class="dp">·</span>to<span class="dp">·</span>FM128.</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1.<span class="dp">·</span>If<span class="dp">·</span>3<span class="dp">·</span>parties<span class="dp">·</span>are<span class="dp">·</span>present,<span class="dp">·</span>protocol<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>ABY3<span class="dp">·</span>and<span class="dp">·</span>field<span class="dp">·</span>to<span class="dp">·</span>FM128.</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2.<span class="dp">·</span>Otherwise,<span class="dp">·</span>protocol<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>SEMI2k<span class="dp">·</span>and<span class="dp">·</span>field<span class="dp">·</span>to<span class="dp">·</span>FM128.</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2.<span class="dp">·</span>Otherwise,<span class="dp">·</span>protocol<span class="dp">·</span>would<span class="dp">·</span>be<span class="dp">·</span>set<span class="dp">·</span>to<span class="dp">·</span>SEMI2k<span class="dp">·</span>and<span class="dp">·</span>field<span class="dp">·</span>to<span class="dp">·</span>FM128.</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Other<span class="dp">·</span>options<span class="dp">·</span>are<span class="dp">·</span>using<span class="dp">·</span>default<span class="dp">·</span>values.</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Other<span class="dp">·</span>options<span class="dp">·</span>are<span class="dp">·</span>using<span class="dp">·</span>default<span class="dp">·</span>values.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffchanged"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Dict[str,<span class="dp">·</span>Any]:<span class="dp">·</span>A<span class="dp">·</span>SPU<span class="dp">·</span>cluster_def<span class="dp">·</span>to<span class="dp">·</span>initiate<span class="dp">·</span>a<span class="dp">·</span>SPU<span class="dp">·</span>device.</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Dict[str,<span class="dp">·</span>Any]:<span class="dp">·</span>A<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>cluster_def<span class="dp">·</span>to<span class="dp">·</span>initiate<span class="dp">·</span>a<ins>n</ins><span class="dp">·</span>SPU<span class="dp">·</span>device.</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>(</td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>isinstance(parties,<span class="dp">·</span>(Tuple,<span class="dp">·</span>List))<span class="dp">·</span>and<span class="dp">·</span>len(parties)<span class="dp">·</span>&gt;=<span class="dp">·</span>2</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>isinstance(parties,<span class="dp">·</span>(Tuple,<span class="dp">·</span>List))<span class="dp">·</span>and<span class="dp">·</span>len(parties)<span class="dp">·</span>&gt;=<span class="dp">·</span>2</td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;number<span class="dp">·</span>of<span class="dp">·</span>parties<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>&gt;=<span class="dp">·</span>2&#x27;</td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),<span class="dp">·</span>&#x27;number<span class="dp">·</span>of<span class="dp">·</span>parties<span class="dp">·</span>should<span class="dp">·</span>be<span class="dp">·</span>&gt;=<span class="dp">·</span>2&#x27;</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(set(parties))<span class="dp">·</span>==<span class="dp">·</span>len(parties),<span class="dp">·</span>f&#x27;duplicated<span class="dp">·</span>parties<span class="dp">·</span>{parties}&#x27;</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(set(parties))<span class="dp">·</span>==<span class="dp">·</span>len(parties),<span class="dp">·</span>f&#x27;duplicated<span class="dp">·</span>parties<span class="dp">·</span>{parties}&#x27;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>runtime_config:</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>runtime_config:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 72, 15 lines modified</td><td colspan="2">Offset 72, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;runtime_config&#x27;:<span class="dp">·</span>runtime_config,</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;runtime_config&#x27;:<span class="dp">·</span>runtime_config,</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>party<span class="dp">·</span>in<span class="dp">·</span>enumerate(parties):</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>party<span class="dp">·</span>in<span class="dp">·</span>enumerate(parties):</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cdef[&#x27;nodes&#x27;].append(</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>cdef[&#x27;nodes&#x27;].append(</td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>{</td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;party&#x27;:<span class="dp">·</span>party,</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;party&#x27;:<span class="dp">·</span>party,</td></tr>
<tr class="diffdeleted"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;id&#x27;:<span class="dp">·</span>f&#x27;local:{i}&#x27;,</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;address&#x27;:<span class="dp">·</span>f&#x27;127.0.0.1:{unused_tcp_port()}&#x27;,</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;address&#x27;:<span class="dp">·</span>f&#x27;127.0.0.1:{unused_tcp_port()}&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>}</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>cdef</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>cdef</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">12.5 KB</span></div>
    <div id="secretflow-utils-simulation-datasets.py"><span class="source">secretflow/utils/simulation/datasets.py</span>
      <a class="anchor" href="#secretflow-utils-simulation-datasets.py">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 11, 19 lines modified</td><td colspan="2">Offset 11, 20 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td><td class="diffline">11 </td><td class="diffpresent">#<span class="dp">·</span>WITHOUT<span class="dp">·</span>WARRANTIES<span class="dp">·</span>OR<span class="dp">·</span>CONDITIONS<span class="dp">·</span>OF<span class="dp">·</span>ANY<span class="dp">·</span>KIND,<span class="dp">·</span>either<span class="dp">·</span>express<span class="dp">·</span>or<span class="dp">·</span>implied.</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td><td class="diffline">12 </td><td class="diffpresent">#<span class="dp">·</span>See<span class="dp">·</span>the<span class="dp">·</span>License<span class="dp">·</span>for<span class="dp">·</span>the<span class="dp">·</span>specific<span class="dp">·</span>language<span class="dp">·</span>governing<span class="dp">·</span>permissions<span class="dp">·</span>and</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td><td class="diffline">13 </td><td class="diffpresent">#<span class="dp">·</span>limitations<span class="dp">·</span>under<span class="dp">·</span>the<span class="dp">·</span>License.</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>hashlib</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>hashlib</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">15 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pickle</td><td class="diffline">16 </td><td class="diffpresent">import<span class="dp">·</span>pickle</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>random</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">import<span class="dp">·</span>zipfile</td><td class="diffline">18 </td><td class="diffpresent">import<span class="dp">·</span>zipfile</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">from<span class="dp">·</span>collections<span class="dp">·</span>import<span class="dp">·</span>namedtuple</td><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>collections<span class="dp">·</span>import<span class="dp">·</span>namedtuple</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>pathlib<span class="dp">·</span>import<span class="dp">·</span>Path</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td><td class="diffline">21 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffdeleted"><td class="diffline">21 </td><td class="diffpresent">import<span class="dp">·</span>random</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>networkx<span class="dp">·</span>as<span class="dp">·</span>nx</td><td class="diffline">22 </td><td class="diffpresent">import<span class="dp">·</span>networkx<span class="dp">·</span>as<span class="dp">·</span>nx</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>pandas<span class="dp">·</span>as<span class="dp">·</span>pd</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">import<span class="dp">·</span>requests</td><td class="diffline">25 </td><td class="diffpresent">import<span class="dp">·</span>requests</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">import<span class="dp">·</span>scipy</td><td class="diffline">26 </td><td class="diffpresent">import<span class="dp">·</span>scipy</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td><td class="diffline">27 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.data.horizontal<span class="dp">·</span>import<span class="dp">·</span>HDataFrame</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 78, 14 lines modified</td><td colspan="2">Offset 79, 24 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;d1513ec63b385506f7cfce9f2c5caa9fe99e7ba4e8c3fa264b3aaf0f849ed32d&#x27;,</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;d1513ec63b385506f7cfce9f2c5caa9fe99e7ba4e8c3fa264b3aaf0f849ed32d&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml-1m&#x27;:<span class="dp">·</span>_Dataset(</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml-1m&#x27;:<span class="dp">·</span>_Dataset(</td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml-1m.zip&#x27;,</td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;ml-1m.zip&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;https://secretflow-data.oss-accelerate.aliyuncs.com/datasets/movielens/ml-1m.zip&#x27;,</td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;https://secretflow-data.oss-accelerate.aliyuncs.com/datasets/movielens/ml-1m.zip&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;a6898adb50b9ca05aa231689da44c217cb524e7ebd39d264c56e2832f2c54e20&#x27;,</td><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;a6898adb50b9ca05aa231689da44c217cb524e7ebd39d264c56e2832f2c54e20&#x27;,</td></tr>
<tr class="diffunmodified"><td class="diffline">84 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td><td class="diffline">85 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">86 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;pubmed&#x27;:<span class="dp">·</span>_Dataset(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;pubmed.zip&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;https://secretflow-data.oss-accelerate.aliyuncs.com/datasets/pubmed/pubmed.zip&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;04a5aa8b3b3432d617d35286e42011b64d58ac362a107d2c257d9da85bf0c021&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;citeseer&#x27;:<span class="dp">·</span>_Dataset(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;citeseer.zip&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;https://secretflow-data.oss-accelerate.aliyuncs.com/datasets/citeseer/citeseer.zip&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&#x27;8f0f1aba42c7be5818dc43d96913713a2ffc1c0d9dc09bef30d0432d2c102b49&#x27;,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>),</td></tr>
<tr class="diffunmodified"><td class="diffline">85 </td><td class="diffpresent">}</td><td class="diffline">96 </td><td class="diffpresent">}</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">86 </td><td class="diffpresent">def<span class="dp">·</span>_unzip(file,<span class="dp">·</span>extract_path=None):</td><td class="diffline">97 </td><td class="diffpresent">def<span class="dp">·</span>_unzip(file,<span class="dp">·</span>extract_path=None):</td></tr>
<tr class="diffunmodified"><td class="diffline">87 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>extract_path:</td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>extract_path:</td></tr>
<tr class="diffunmodified"><td class="diffline">88 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>extract_path<span class="dp">·</span>=<span class="dp">·</span>str(Path(file).parent)</td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>extract_path<span class="dp">·</span>=<span class="dp">·</span>str(Path(file).parent)</td></tr>
<tr class="diffunmodified"><td class="diffline">89 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>zipfile.ZipFile(file,<span class="dp">·</span>&#x27;r&#x27;)<span class="dp">·</span>as<span class="dp">·</span>zip_f:</td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>zipfile.ZipFile(file,<span class="dp">·</span>&#x27;r&#x27;)<span class="dp">·</span>as<span class="dp">·</span>zip_f:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 440, 15 lines modified</td><td colspan="2">Offset 451, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">440 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>feature_split_idxs<span class="dp">·</span>=<span class="dp">·</span>np.rint(np.linspace(0,<span class="dp">·</span>nodes.shape[1],<span class="dp">·</span>len(parts)<span class="dp">·</span>+<span class="dp">·</span>1)).astype(</td><td class="diffline">451 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>feature_split_idxs<span class="dp">·</span>=<span class="dp">·</span>np.rint(np.linspace(0,<span class="dp">·</span>nodes.shape[1],<span class="dp">·</span>len(parts)<span class="dp">·</span>+<span class="dp">·</span>1)).astype(</td></tr>
<tr class="diffunmodified"><td class="diffline">441 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>np.int32</td><td class="diffline">452 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>np.int32</td></tr>
<tr class="diffunmodified"><td class="diffline">442 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">453 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">443 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_arr<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(</td><td class="diffline">454 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>x_arr<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(</td></tr>
<tr class="diffunmodified"><td class="diffline">444 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={</td><td class="diffline">455 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={</td></tr>
<tr class="diffunmodified"><td class="diffline">445 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part:<span class="dp">·</span>part(</td><td class="diffline">456 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>part:<span class="dp">·</span>part(</td></tr>
<tr class="diffchanged"><td class="diffline">446 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda:<span class="dp">·</span>nodes[:,<span class="dp">·</span>feature_split_idxs[i]<del><span class="dp">·</span></del>:<span class="dp">·</span>feature_split_idxs[i<span class="dp">·</span>+<span class="dp">·</span>1]]</td><td class="diffline">457 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>lambda:<span class="dp">·</span>nodes[:,<span class="dp">·</span>feature_split_idxs[i]:<span class="dp">·</span>feature_split_idxs[i<span class="dp">·</span>+<span class="dp">·</span>1]]</td></tr>
<tr class="diffunmodified"><td class="diffline">447 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)()</td><td class="diffline">458 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)()</td></tr>
<tr class="diffunmodified"><td class="diffline">448 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>part<span class="dp">·</span>in<span class="dp">·</span>enumerate(parts)</td><td class="diffline">459 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>i,<span class="dp">·</span>part<span class="dp">·</span>in<span class="dp">·</span>enumerate(parts)</td></tr>
<tr class="diffunmodified"><td class="diffline">449 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>},</td><td class="diffline">460 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>},</td></tr>
<tr class="diffunmodified"><td class="diffline">450 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partition_way=PartitionWay.VERTICAL,</td><td class="diffline">461 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partition_way=PartitionWay.VERTICAL,</td></tr>
<tr class="diffunmodified"><td class="diffline">451 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">462 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td class="diffline">452 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Y_train_arr<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(</td><td class="diffline">463 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Y_train_arr<span class="dp">·</span>=<span class="dp">·</span>FedNdarray(</td></tr>
<tr class="diffunmodified"><td class="diffline">453 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={parts[0]:<span class="dp">·</span>parts[0](lambda:<span class="dp">·</span>y_train)()},</td><td class="diffline">464 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>partitions={parts[0]:<span class="dp">·</span>parts[0](lambda:<span class="dp">·</span>y_train)()},</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 483, 14 lines modified</td><td colspan="2">Offset 494, 305 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">483 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Y_test_arr,</td><td class="diffline">494 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Y_test_arr,</td></tr>
<tr class="diffunmodified"><td class="diffline">484 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_train_arr,</td><td class="diffline">495 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_train_arr,</td></tr>
<tr class="diffunmodified"><td class="diffline">485 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_val_arr,</td><td class="diffline">496 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_val_arr,</td></tr>
<tr class="diffunmodified"><td class="diffline">486 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_test_arr,</td><td class="diffline">497 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_test_arr,</td></tr>
<tr class="diffunmodified"><td class="diffline">487 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">498 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">499 </td><td class="diffpresent">def<span class="dp">·</span>load_pubmed(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">500 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts:<span class="dp">·</span>List[PYU],<span class="dp">·</span>data_dir:<span class="dp">·</span>str<span class="dp">·</span>=<span class="dp">·</span>None,<span class="dp">·</span>add_self_loop:<span class="dp">·</span>bool<span class="dp">·</span>=<span class="dp">·</span>True</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">501 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Tuple[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">502 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">503 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">504 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">505 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">506 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">507 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">508 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">509 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>FedNdarray,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">510 </td><td class="diffpresent">]:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">511 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Load<span class="dp">·</span>the<span class="dp">·</span>pubmed<span class="dp">·</span>dataset<span class="dp">·</span>for<span class="dp">·</span>split<span class="dp">·</span>learning<span class="dp">·</span>GNN.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">512 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Datasource:<span class="dp">·</span>https://github.com/kimiyoung/planetoid/tree/master/data</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">513 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Args:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">514 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts<span class="dp">·</span>(List[PYU]):<span class="dp">·</span>parties<span class="dp">·</span>that<span class="dp">·</span>the<span class="dp">·</span>paper<span class="dp">·</span>features<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>partitioned</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">515 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>evenly.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">516 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Returns:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">517 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>A<span class="dp">·</span>tuple<span class="dp">·</span>of<span class="dp">·</span>FedNdarray:<span class="dp">·</span>edge,<span class="dp">·</span>x,<span class="dp">·</span>Y_train,<span class="dp">·</span>Y_val,<span class="dp">·</span>Y_valid,<span class="dp">·</span>index_train,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">518 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>index_val,<span class="dp">·</span>index_test.<span class="dp">·</span>Note<span class="dp">·</span>that<span class="dp">·</span>Y<span class="dp">·</span>is<span class="dp">·</span>bound<span class="dp">·</span>to<span class="dp">·</span>the<span class="dp">·</span>first<span class="dp">·</span>participant.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">519 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">520 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>parts,<span class="dp">·</span>&#x27;Parts<span class="dp">·</span>shall<span class="dp">·</span>not<span class="dp">·</span>be<span class="dp">·</span>None<span class="dp">·</span>or<span class="dp">·</span>empty!&#x27;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">521 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>data_dir<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">522 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>data_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.join(_CACHE_DIR,<span class="dp">·</span>&#x27;pubmed&#x27;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">523 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>Path(data_dir).is_dir():</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">524 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>filepath<span class="dp">·</span>=<span class="dp">·</span>_get_dataset(_DATASETS[&#x27;pubmed&#x27;])</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">525 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>_unzip(filepath,<span class="dp">·</span>data_dir)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">526 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_names<span class="dp">·</span>=<span class="dp">·</span>[</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">527 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.path.join(data_dir,<span class="dp">·</span>f&#x27;ind.pubmed.{name}&#x27;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">528 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name<span class="dp">·</span>in<span class="dp">·</span>[&#x27;y&#x27;,<span class="dp">·</span>&#x27;tx&#x27;,<span class="dp">·</span>&#x27;ty&#x27;,<span class="dp">·</span>&#x27;allx&#x27;,<span class="dp">·</span>&#x27;ally&#x27;,<span class="dp">·</span>&#x27;graph&#x27;]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">529 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">530 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>objects<span class="dp">·</span>=<span class="dp">·</span>[]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">531 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>name<span class="dp">·</span>in<span class="dp">·</span>file_names:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">532 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(name,<span class="dp">·</span>&#x27;rb&#x27;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">533 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>objects.append(pickle.load(f,<span class="dp">·</span>encoding=&#x27;latin1&#x27;))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">534 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>y,<span class="dp">·</span>tx,<span class="dp">·</span>ty,<span class="dp">·</span>allx,<span class="dp">·</span>ally,<span class="dp">·</span>graph<span class="dp">·</span>=<span class="dp">·</span>tuple(objects)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">535 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(os.path.join(data_dir,<span class="dp">·</span>f&quot;ind.pubmed.test.index&quot;),<span class="dp">·</span>&#x27;r&#x27;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">536 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_idx_reorder<span class="dp">·</span>=<span class="dp">·</span>f.readlines()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">537 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_idx_reorder<span class="dp">·</span>=<span class="dp">·</span>list(map(lambda<span class="dp">·</span>s:<span class="dp">·</span>int(s.strip()),<span class="dp">·</span>test_idx_reorder))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">538 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>test_idx_range<span class="dp">·</span>=<span class="dp">·</span>np.sort(test_idx_reorder)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">539 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>nodes<span class="dp">·</span>=<span class="dp">·</span>scipy.sparse.vstack((allx,<span class="dp">·</span>tx)).tolil()</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">540 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>nodes[test_idx_reorder,<span class="dp">·</span>:]<span class="dp">·</span>=<span class="dp">·</span>nodes[test_idx_range,<span class="dp">·</span>:]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">541 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>edge_sparse<span class="dp">·</span>=<span class="dp">·</span>nx.adjacency_matrix(nx.from_dict_of_lists(graph))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">542 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>labels<span class="dp">·</span>=<span class="dp">·</span>np.vstack((ally,<span class="dp">·</span>ty))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">543 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>labels[test_idx_reorder,<span class="dp">·</span>:]<span class="dp">·</span>=<span class="dp">·</span>labels[test_idx_range,<span class="dp">·</span>:]</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">544 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>test<span class="dp">·</span>1000</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">545 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>train<span class="dp">·</span>#class<span class="dp">·</span>*<span class="dp">·</span>20<span class="dp">·</span>=<span class="dp">·</span>7<span class="dp">·</span>*<span class="dp">·</span>20<span class="dp">·</span>=<span class="dp">·</span>140</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">546 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>val<span class="dp">·</span>500</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">547 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>idx_test<span class="dp">·</span>=<span class="dp">·</span>test_idx_range.tolist()</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 822/12724 bytes (6.46%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">524 B</span></div>
    <div id="secretflow-utils-simulation-data-_utils.py"><span class="source">secretflow/utils/simulation/data/_utils.py</span>
      <a class="anchor" href="#secretflow-utils-simulation-data-_utils.py">¶</a>
    </div>
    </div>
    <div class="comment">Ordering differences only
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 12 lines modified</td><td colspan="2">Offset 1, 12 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td><td class="diffline">1 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>Dict,<span class="dp">·</span>List,<span class="dp">·</span>Tuple,<span class="dp">·</span>Union</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td><td class="diffline">2 </td><td class="diffpresent">import<span class="dp">·</span>numpy<span class="dp">·</span>as<span class="dp">·</span>np</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.device.device.pyu<span class="dp">·</span>import<span class="dp">·</span>PYU</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>secretflow.utils.errors<span class="dp">·</span>import<span class="dp">·</span>InvalidArgumentError</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">def<span class="dp">·</span>cal_indexes(</td><td class="diffline">5 </td><td class="diffpresent">def<span class="dp">·</span>cal_indexes(</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts:<span class="dp">·</span>Union[List[PYU],<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>Union[float,<span class="dp">·</span>Tuple]]],<span class="dp">·</span>total_num:<span class="dp">·</span>int</td><td class="diffline">6 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>parts:<span class="dp">·</span>Union[List[PYU],<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>Union[float,<span class="dp">·</span>Tuple]]],<span class="dp">·</span>total_num:<span class="dp">·</span>int</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>Tuple]:</td><td class="diffline">7 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>Dict[PYU,<span class="dp">·</span>Tuple]:</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Calculate<span class="dp">·</span>the<span class="dp">·</span>indexes<span class="dp">·</span>by<span class="dp">·</span>the<span class="dp">·</span>given<span class="dp">·</span>partitions.</td><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;Calculate<span class="dp">·</span>the<span class="dp">·</span>indexes<span class="dp">·</span>by<span class="dp">·</span>the<span class="dp">·</span>given<span class="dp">·</span>partitions.</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol diffcontrol-double">⊟</div>
    <div><span class="diffsize">111 B</span></div>
    <div><span class="source">secretflow-0.8.0b1.dist-info/LICENSE</span> vs.</div>
    <div id="secretflow--.-.-b-.dist-info-LICENSE"><span class="source">secretflow-0.8.1b0.dist-info/LICENSE</span>
      <a class="anchor" href="#secretflow--.-.-b-.dist-info-LICENSE">¶</a>
    </div>
    </div>
    <div class="comment">Files identical despite different names
    </div>
  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol diffcontrol-double">⊟</div>
    <div><span class="diffsize">28.9 KB</span></div>
    <div><span class="source">secretflow-0.8.0b1.dist-info/METADATA</span> vs.</div>
    <div id="secretflow--.-.-b-.dist-info-METADATA"><span class="source">secretflow-0.8.1b0.dist-info/METADATA</span>
      <a class="anchor" href="#secretflow--.-.-b-.dist-info-METADATA">¶</a>
    </div>
    </div>
    <div class="comment">Files 8% similar despite different names
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 11 lines modified</td><td colspan="2">Offset 1, 11 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000000:<span class="dp">·</span>4d65<span class="dp">·</span>7461<span class="dp">·</span>6461<span class="dp">·</span>7461<span class="dp">·</span>2d56<span class="dp">·</span>6572<span class="dp">·</span>7369<span class="dp">·</span>6f6e<span class="dp">·</span><span class="dp">·</span>Metadata-Version</td><td colspan="2" class="diffpresent">00000000:<span class="dp">·</span>4d65<span class="dp">·</span>7461<span class="dp">·</span>6461<span class="dp">·</span>7461<span class="dp">·</span>2d56<span class="dp">·</span>6572<span class="dp">·</span>7369<span class="dp">·</span>6f6e<span class="dp">·</span><span class="dp">·</span>Metadata-Version</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000010:<span class="dp">·</span>3a20<span class="dp">·</span>322e<span class="dp">·</span>310a<span class="dp">·</span>4e61<span class="dp">·</span>6d65<span class="dp">·</span>3a20<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span><span class="dp">·</span>:<span class="dp">·</span>2.1.Name:<span class="dp">·</span>secr</td><td colspan="2" class="diffpresent">00000010:<span class="dp">·</span>3a20<span class="dp">·</span>322e<span class="dp">·</span>310a<span class="dp">·</span>4e61<span class="dp">·</span>6d65<span class="dp">·</span>3a20<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span><span class="dp">·</span>:<span class="dp">·</span>2.1.Name:<span class="dp">·</span>secr</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000020:<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>0a56<span class="dp">·</span>6572<span class="dp">·</span>7369<span class="dp">·</span>6f6e<span class="dp">·</span>3a20<span class="dp">·</span><span class="dp">·</span>etflow.Version:<span class="dp">·</span></td><td colspan="2" class="diffpresent">00000020:<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>0a56<span class="dp">·</span>6572<span class="dp">·</span>7369<span class="dp">·</span>6f6e<span class="dp">·</span>3a20<span class="dp">·</span><span class="dp">·</span>etflow.Version:<span class="dp">·</span></td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000030:<span class="dp">·</span>302e<span class="dp">·</span>382e<span class="dp">·</span>3<del>0</del>62<span class="dp">·</span>3<del>1</del>0a<span class="dp">·</span>5375<span class="dp">·</span>6d6d<span class="dp">·</span>6172<span class="dp">·</span>793a<span class="dp">·</span><span class="dp">·</span>0.8.<del>0</del>b<del>1</del>.Summary:</td><td colspan="2" class="diffpresent">00000030:<span class="dp">·</span>302e<span class="dp">·</span>382e<span class="dp">·</span>3<ins>1</ins>62<span class="dp">·</span>3<ins>0</ins>0a<span class="dp">·</span>5375<span class="dp">·</span>6d6d<span class="dp">·</span>6172<span class="dp">·</span>793a<span class="dp">·</span><span class="dp">·</span>0.8.<ins>1</ins>b<ins>0</ins>.Summary:</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000040:<span class="dp">·</span>2053<span class="dp">·</span>6563<span class="dp">·</span>7265<span class="dp">·</span>7420<span class="dp">·</span>466c<span class="dp">·</span>6f77<span class="dp">·</span>0a48<span class="dp">·</span>6f6d<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Secret<span class="dp">·</span>Flow.Hom</td><td colspan="2" class="diffpresent">00000040:<span class="dp">·</span>2053<span class="dp">·</span>6563<span class="dp">·</span>7265<span class="dp">·</span>7420<span class="dp">·</span>466c<span class="dp">·</span>6f77<span class="dp">·</span>0a48<span class="dp">·</span>6f6d<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Secret<span class="dp">·</span>Flow.Hom</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000050:<span class="dp">·</span>652d<span class="dp">·</span>7061<span class="dp">·</span>6765<span class="dp">·</span>3a20<span class="dp">·</span>6874<span class="dp">·</span>7470<span class="dp">·</span>733a<span class="dp">·</span>2f2f<span class="dp">·</span><span class="dp">·</span>e-page:<span class="dp">·</span>https://</td><td colspan="2" class="diffpresent">00000050:<span class="dp">·</span>652d<span class="dp">·</span>7061<span class="dp">·</span>6765<span class="dp">·</span>3a20<span class="dp">·</span>6874<span class="dp">·</span>7470<span class="dp">·</span>733a<span class="dp">·</span>2f2f<span class="dp">·</span><span class="dp">·</span>e-page:<span class="dp">·</span>https://</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000060:<span class="dp">·</span>6769<span class="dp">·</span>7468<span class="dp">·</span>7562<span class="dp">·</span>2e63<span class="dp">·</span>6f6d<span class="dp">·</span>2f73<span class="dp">·</span>6563<span class="dp">·</span>7265<span class="dp">·</span><span class="dp">·</span>github.com/secre</td><td colspan="2" class="diffpresent">00000060:<span class="dp">·</span>6769<span class="dp">·</span>7468<span class="dp">·</span>7562<span class="dp">·</span>2e63<span class="dp">·</span>6f6d<span class="dp">·</span>2f73<span class="dp">·</span>6563<span class="dp">·</span>7265<span class="dp">·</span><span class="dp">·</span>github.com/secre</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000070:<span class="dp">·</span>7466<span class="dp">·</span>6c6f<span class="dp">·</span>772f<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span><span class="dp">·</span>tflow/secretflow</td><td colspan="2" class="diffpresent">00000070:<span class="dp">·</span>7466<span class="dp">·</span>6c6f<span class="dp">·</span>772f<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span><span class="dp">·</span>tflow/secretflow</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000080:<span class="dp">·</span>0a41<span class="dp">·</span>7574<span class="dp">·</span>686f<span class="dp">·</span>723a<span class="dp">·</span>2053<span class="dp">·</span>4349<span class="dp">·</span>2043<span class="dp">·</span>656e<span class="dp">·</span><span class="dp">·</span>.Author:<span class="dp">·</span>SCI<span class="dp">·</span>Cen</td><td colspan="2" class="diffpresent">00000080:<span class="dp">·</span>0a41<span class="dp">·</span>7574<span class="dp">·</span>686f<span class="dp">·</span>723a<span class="dp">·</span>2053<span class="dp">·</span>4349<span class="dp">·</span>2043<span class="dp">·</span>656e<span class="dp">·</span><span class="dp">·</span>.Author:<span class="dp">·</span>SCI<span class="dp">·</span>Cen</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000090:<span class="dp">·</span>7465<span class="dp">·</span>720a<span class="dp">·</span>4175<span class="dp">·</span>7468<span class="dp">·</span>6f72<span class="dp">·</span>2d65<span class="dp">·</span>6d61<span class="dp">·</span>696c<span class="dp">·</span><span class="dp">·</span>ter.Author-email</td><td colspan="2" class="diffpresent">00000090:<span class="dp">·</span>7465<span class="dp">·</span>720a<span class="dp">·</span>4175<span class="dp">·</span>7468<span class="dp">·</span>6f72<span class="dp">·</span>2d65<span class="dp">·</span>6d61<span class="dp">·</span>696c<span class="dp">·</span><span class="dp">·</span>ter.Author-email</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">000000a0:<span class="dp">·</span>3a20<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2d63<span class="dp">·</span>6f6e<span class="dp">·</span><span class="dp">·</span>:<span class="dp">·</span>secretflow-con</td><td colspan="2" class="diffpresent">000000a0:<span class="dp">·</span>3a20<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2d63<span class="dp">·</span>6f6e<span class="dp">·</span><span class="dp">·</span>:<span class="dp">·</span>secretflow-con</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 206 lines modified</td><td colspan="2">Offset 23, 215 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000160:<span class="dp">·</span>6c69<span class="dp">·</span>620a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>lib.Requires-Dis</td><td colspan="2" class="diffpresent">00000160:<span class="dp">·</span>6c69<span class="dp">·</span>620a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>lib.Requires-Dis</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000170:<span class="dp">·</span>743a<span class="dp">·</span>206d<span class="dp">·</span>756c<span class="dp">·</span>7469<span class="dp">·</span>7072<span class="dp">·</span>6f63<span class="dp">·</span>6573<span class="dp">·</span>730a<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>multiprocess.</td><td colspan="2" class="diffpresent">00000170:<span class="dp">·</span>743a<span class="dp">·</span>206d<span class="dp">·</span>756c<span class="dp">·</span>7469<span class="dp">·</span>7072<span class="dp">·</span>6f63<span class="dp">·</span>6573<span class="dp">·</span>730a<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>multiprocess.</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000180:<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>206e<span class="dp">·</span><span class="dp">·</span>Requires-Dist:<span class="dp">·</span>n</td><td colspan="2" class="diffpresent">00000180:<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>206e<span class="dp">·</span><span class="dp">·</span>Requires-Dist:<span class="dp">·</span>n</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">00000190:<span class="dp">·</span>6574<span class="dp">·</span>776f<span class="dp">·</span>726b<span class="dp">·</span>7820<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>2e38<span class="dp">·</span>2e38<span class="dp">·</span><span class="dp">·</span>etworkx<span class="dp">·</span>(==2.8.8</td><td colspan="2" class="diffpresent">00000190:<span class="dp">·</span>6574<span class="dp">·</span>776f<span class="dp">·</span>726b<span class="dp">·</span>7820<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>2e38<span class="dp">·</span>2e38<span class="dp">·</span><span class="dp">·</span>etworkx<span class="dp">·</span>(==2.8.8</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">000001a0:<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span><span class="dp">·</span>).Requires-Dist:</td><td colspan="2" class="diffpresent">000001a0:<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span><span class="dp">·</span>).Requires-Dist:</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">000001b0:<span class="dp">·</span>206e<span class="dp">·</span>756d<span class="dp">·</span>7079<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>312e<span class="dp">·</span>3233<span class="dp">·</span>2e35<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>numpy<span class="dp">·</span>(==1.23.5</td><td colspan="2" class="diffpresent">000001b0:<span class="dp">·</span>206e<span class="dp">·</span>756d<span class="dp">·</span>7079<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>312e<span class="dp">·</span>3233<span class="dp">·</span>2e35<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>numpy<span class="dp">·</span>(==1.23.5</td></tr>
<tr class="diffunmodified"><td colspan="2" class="diffpresent">000001c0:<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span><span class="dp">·</span>).Requires-Dist:</td><td colspan="2" class="diffpresent">000001c0:<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span><span class="dp">·</span>).Requires-Dist:</td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">000001d0:<span class="dp">·</span>206<del>f</del><span class="dp">·</span>6<del>e</del>6<del>e</del><span class="dp">·</span>7<del>8</del>20<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span>2e3<del>1</del><span class="dp">·</span><del>32</del>2e<del><span class="dp">·</span></del>3<del>0</del><del>29</del><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span>o</del>n<del>nx</del><span class="dp">·</span>(==1.<del>1</del><del>2</del>.<del>0</del><del>)</del></td><td colspan="2" class="diffpresent">000001d0:<span class="dp">·</span>20<ins>70<span class="dp">·</span>61</ins>6<ins>e</ins><span class="dp">·</span>6<ins>4</ins>6<ins>1</ins><span class="dp">·</span>7<ins>3</ins>20<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span>2e3<ins>5</ins><span class="dp">·</span>2e3<ins>3<span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><ins>pa</ins>n<ins>d</ins><ins>as</ins><span class="dp">·</span>(==1.<ins>5</ins>.<ins>3</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000001e0:<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span><span class="dp">·</span>).Requires-Dist:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000001f0:<span class="dp">·</span>2070<span class="dp">·</span>726f<span class="dp">·</span>746f<span class="dp">·</span>6275<span class="dp">·</span>6620<span class="dp">·</span>283d<span class="dp">·</span>3d33<span class="dp">·</span>2e31<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>protobuf<span class="dp">·</span>(==3.1</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000200:<span class="dp">·</span>392e<span class="dp">·</span>3629<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span><span class="dp">·</span>9.6).Requires-Di</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000210:<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7079<span class="dp">·</span>6172<span class="dp">·</span>726f<span class="dp">·</span>7720<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span><span class="dp">·</span>st:<span class="dp">·</span>pyarrow<span class="dp">·</span>(==1</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000220:<span class="dp">·</span>312e<span class="dp">·</span>302e<span class="dp">·</span>3029<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span><span class="dp">·</span>1.0.0).Requires-</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000230:<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7333<span class="dp">·</span>6673<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>3230<span class="dp">·</span><span class="dp">·</span>Dist:<span class="dp">·</span>s3fs<span class="dp">·</span>(==20</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000240:<span class="dp">·</span>3232<span class="dp">·</span>2e31<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span><span class="dp">·</span>22.1.0).Requires</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000250:<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>6369<span class="dp">·</span>6b69<span class="dp">·</span>742d<span class="dp">·</span>6c65<span class="dp">·</span><span class="dp">·</span>-Dist:<span class="dp">·</span>scikit-le</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000260:<span class="dp">·</span>6172<span class="dp">·</span>6e20<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span>2e31<span class="dp">·</span>2e33<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span><span class="dp">·</span>arn<span class="dp">·</span>(==1.1.3).Re</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000270:<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>6563<span class="dp">·</span><span class="dp">·</span>quires-Dist:<span class="dp">·</span>sec</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000280:<span class="dp">·</span>7265<span class="dp">·</span>7466<span class="dp">·</span>6c6f<span class="dp">·</span>772d<span class="dp">·</span>7261<span class="dp">·</span>7966<span class="dp">·</span>6564<span class="dp">·</span>2028<span class="dp">·</span><span class="dp">·</span>retflow-rayfed<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000290:<span class="dp">·</span>3d3d<span class="dp">·</span>302e<span class="dp">·</span>312e<span class="dp">·</span>3161<span class="dp">·</span>3329<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span>==0.1.1a3).Requi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002a0:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7370<span class="dp">·</span>6172<span class="dp">·</span>7365<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>sparse</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002b0:<span class="dp">·</span>2028<span class="dp">·</span>3e3d<span class="dp">·</span>302e<span class="dp">·</span>3134<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(&gt;=0.14.0).Requ</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002c0:<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>7075<span class="dp">·</span>2028<span class="dp">·</span><span class="dp">·</span>ires-Dist:<span class="dp">·</span>spu<span class="dp">·</span>(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002d0:<span class="dp">·</span>3d3d<span class="dp">·</span>302e<span class="dp">·</span>332e<span class="dp">·</span>3262<span class="dp">·</span>3132<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span><span class="dp">·</span>==0.3.2b12).Requ</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002e0:<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>662d<span class="dp">·</span>6865<span class="dp">·</span><span class="dp">·</span>ires-Dist:<span class="dp">·</span>sf-he</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000002f0:<span class="dp">·</span>7520<span class="dp">·</span>283d<span class="dp">·</span>3d30<span class="dp">·</span>2e34<span class="dp">·</span>2e32<span class="dp">·</span>6230<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span><span class="dp">·</span>u<span class="dp">·</span>(==0.4.2b0).Re</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000300:<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span>6632<span class="dp">·</span><span class="dp">·</span>quires-Dist:<span class="dp">·</span>tf2</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000310:<span class="dp">·</span>6f6e<span class="dp">·</span>6e78<span class="dp">·</span>2028<span class="dp">·</span>3e3d<span class="dp">·</span>312e<span class="dp">·</span>3133<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span><span class="dp">·</span>onnx<span class="dp">·</span>(&gt;=1.13.0).</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000320:<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span><span class="dp">·</span>Requires-Dist:<span class="dp">·</span>t</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000330:<span class="dp">·</span>7164<span class="dp">·</span>6d0a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>qdm.Requires-Dis</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000340:<span class="dp">·</span>743a<span class="dp">·</span>2076<span class="dp">·</span>616c<span class="dp">·</span>6964<span class="dp">·</span>6174<span class="dp">·</span>6f72<span class="dp">·</span>2e70<span class="dp">·</span>7920<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>validator.py<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000350:<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span>2e33<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span><span class="dp">·</span>(==1.3.0).Requir</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000360:<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2078<span class="dp">·</span>6762<span class="dp">·</span>6f6f<span class="dp">·</span>7374<span class="dp">·</span><span class="dp">·</span>es-Dist:<span class="dp">·</span>xgboost</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000370:<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>312e<span class="dp">·</span>352e<span class="dp">·</span>3229<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(==1.5.2).Requi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000380:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7768<span class="dp">·</span>6565<span class="dp">·</span>6c20<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>wheel<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000390:<span class="dp">·</span>283e<span class="dp">·</span>3d30<span class="dp">·</span>2e33<span class="dp">·</span>382e<span class="dp">·</span>3129<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span>(&gt;=0.38.1).Requi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000003a0:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>746f<span class="dp">·</span>7263<span class="dp">·</span>6820<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>torch<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000003b0:<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>2e30<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span><span class="dp">·</span>(==2.0.0).Requir</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000003c0:<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span>6f72<span class="dp">·</span>6368<span class="dp">·</span>6d65<span class="dp">·</span><span class="dp">·</span>es-Dist:<span class="dp">·</span>torchme</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000003d0:<span class="dp">·</span>7472<span class="dp">·</span>6963<span class="dp">·</span>7320<span class="dp">·</span>283d<span class="dp">·</span>3d30<span class="dp">·</span>2e31<span class="dp">·</span>312e<span class="dp">·</span>3429<span class="dp">·</span><span class="dp">·</span>trics<span class="dp">·</span>(==0.11.4)</td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>1</del>e0:<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span><span class="dp">·</span>.Requires-Dist:<span class="dp">·</span></td><td colspan="2" class="diffpresent">00000<ins>3</ins>e0:<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span><span class="dp">·</span>.Requires-Dist:<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000003f0:<span class="dp">·</span>746f<span class="dp">·</span>7263<span class="dp">·</span>6876<span class="dp">·</span>6973<span class="dp">·</span>696f<span class="dp">·</span>6e20<span class="dp">·</span>283d<span class="dp">·</span>3d30<span class="dp">·</span><span class="dp">·</span>torchvision<span class="dp">·</span>(==0</td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000001f0:<span class="dp">·</span>7061<span class="dp">·</span>6e64<span class="dp">·</span>6173<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>312e<span class="dp">·</span>352e<span class="dp">·</span>3329<span class="dp">·</span><span class="dp">·</span>pandas<span class="dp">·</span>(==1.5.3)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000200:<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span><span class="dp">·</span>.Requires-Dist:<span class="dp">·</span></td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000210:<span class="dp">·</span>7072<span class="dp">·</span>6f74<span class="dp">·</span>6f62<span class="dp">·</span>7566<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>332e<span class="dp">·</span>3139<span class="dp">·</span><span class="dp">·</span>protobuf<span class="dp">·</span>(==3.19</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000220:<span class="dp">·</span>2e36<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>.6).Requires-Dis</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000230:<span class="dp">·</span>743a<span class="dp">·</span>2070<span class="dp">·</span>7961<span class="dp">·</span>7272<span class="dp">·</span>6f77<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>3131<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>pyarrow<span class="dp">·</span>(==11</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000240:<span class="dp">·</span>2e30<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span><span class="dp">·</span>.0.0).Requires-D</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000250:<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>3366<span class="dp">·</span>7320<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>3032<span class="dp">·</span><span class="dp">·</span>ist:<span class="dp">·</span>s3fs<span class="dp">·</span>(==202</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>26</del>0:<span class="dp">·</span><del>322e</del><span class="dp">·</span>3<del>1</del>2e<span class="dp">·</span>3<del>0</del>29<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span><span class="dp">·</span><del>2</del>.1.<del>0</del>).Requires-</td><td colspan="2" class="diffpresent">00000<ins>40</ins>0:<span class="dp">·</span><ins>2e31</ins><span class="dp">·</span>3<ins>5</ins>2e<span class="dp">·</span>3<ins>1</ins>29<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span><span class="dp">·</span>.1<ins>5</ins>.<ins>1</ins>).Requires-</td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000270:<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7363<span class="dp">·</span>696b<span class="dp">·</span>6974<span class="dp">·</span>2d6c<span class="dp">·</span>6561<span class="dp">·</span><span class="dp">·</span>Dist:<span class="dp">·</span>scikit-lea</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>28</del>0:<span class="dp">·</span><del>72</del>6<del>e</del><span class="dp">·</span><del>2028</del><span class="dp">·</span>3<del>d3d</del><span class="dp">·</span><del>312e</del><span class="dp">·</span><del>312e</del><span class="dp">·</span><del>3329</del><span class="dp">·</span><del>0a52</del><span class="dp">·</span>6<del>571</del><span class="dp">·</span><span class="dp">·</span><del>rn<span class="dp">·</span>(==1.1.3).Req</del></td><td colspan="2" class="diffpresent">00000<ins>41</ins>0:<span class="dp">·</span><ins>44</ins>6<ins>9</ins><span class="dp">·</span><ins>7374</ins><span class="dp">·</span>3<ins>a20</ins><span class="dp">·</span><ins>746f</ins><span class="dp">·</span><ins>7263</ins><span class="dp">·</span><ins>6861</ins><span class="dp">·</span><ins>7564</ins><span class="dp">·</span>6<ins>96f</ins><span class="dp">·</span><span class="dp">·</span><ins>Dist:<span class="dp">·</span>torchaudio</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000420:<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>322e<span class="dp">·</span>302e<span class="dp">·</span>3129<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(==2.0.1).Requi</td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>29</del>0:<del><span class="dp">·</span>7569</del><span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7<del>3</del>65<span class="dp">·</span>6372<span class="dp">·</span><span class="dp">·</span><del>ui</del>res-Dist:<span class="dp">·</span><del>s</del>e<del>c</del>r</td><td colspan="2" class="diffpresent">00000<ins>43</ins>0:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7<ins>4</ins>65<span class="dp">·</span>6<ins>e7</ins>3<ins><span class="dp">·</span>6f</ins>72<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span><ins>t</ins>e<ins>ns</ins><ins>o</ins>r</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000440:<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>322e<span class="dp">·</span>3130<span class="dp">·</span>2e31<span class="dp">·</span>2920<span class="dp">·</span><span class="dp">·</span>flow<span class="dp">·</span>(==2.10.1)<span class="dp">·</span></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000450:<span class="dp">·</span>3b20<span class="dp">·</span>706c<span class="dp">·</span>6174<span class="dp">·</span>666f<span class="dp">·</span>726d<span class="dp">·</span>5f6d<span class="dp">·</span>6163<span class="dp">·</span>6869<span class="dp">·</span><span class="dp">·</span>;<span class="dp">·</span>platform_machi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000460:<span class="dp">·</span>6e65<span class="dp">·</span>2021<span class="dp">·</span>3d20<span class="dp">·</span>2261<span class="dp">·</span>726d<span class="dp">·</span>3634<span class="dp">·</span>220a<span class="dp">·</span>5265<span class="dp">·</span><span class="dp">·</span>ne<span class="dp">·</span>!=<span class="dp">·</span>&quot;arm64&quot;.Re</td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002a0:<span class="dp">·</span>6574<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2d72<span class="dp">·</span>6179<span class="dp">·</span>6665<span class="dp">·</span>6420<span class="dp">·</span>283d<span class="dp">·</span><span class="dp">·</span>etflow-rayfed<span class="dp">·</span>(=</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002b0:<span class="dp">·</span>3d30<span class="dp">·</span>2e31<span class="dp">·</span>2e31<span class="dp">·</span>6133<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span><span class="dp">·</span>=0.1.1a3).Requir</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002c0:<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2073<span class="dp">·</span>7061<span class="dp">·</span>7273<span class="dp">·</span>6520<span class="dp">·</span><span class="dp">·</span>es-Dist:<span class="dp">·</span>sparse<span class="dp">·</span></td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002d0:<span class="dp">·</span>283e<span class="dp">·</span>3d30<span class="dp">·</span>2e31<span class="dp">·</span>342e<span class="dp">·</span>3029<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span>(&gt;=0.14.0).Requi</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002e0:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7370<span class="dp">·</span>7520<span class="dp">·</span>283d<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>spu<span class="dp">·</span>(=</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000002f0:<span class="dp">·</span>3d30<span class="dp">·</span>2e33<span class="dp">·</span>2e32<span class="dp">·</span>6231<span class="dp">·</span>3129<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span>=0.3.2b11).Requi</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000300:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7366<span class="dp">·</span>2d68<span class="dp">·</span>6575<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>sf-heu</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000310:<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>302e<span class="dp">·</span>332e<span class="dp">·</span>3262<span class="dp">·</span>3129<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(==0.3.2b1).Req</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000320:<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7374<span class="dp">·</span>6174<span class="dp">·</span><span class="dp">·</span>uires-Dist:<span class="dp">·</span>stat</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000330:<span class="dp">·</span>736d<span class="dp">·</span>6f64<span class="dp">·</span>656c<span class="dp">·</span>7320<span class="dp">·</span>283d<span class="dp">·</span>3d30<span class="dp">·</span>2e31<span class="dp">·</span>332e<span class="dp">·</span><span class="dp">·</span>smodels<span class="dp">·</span>(==0.13.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000340:<span class="dp">·</span>3229<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span><span class="dp">·</span>2).Requires-Dist</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000350:<span class="dp">·</span>3a20<span class="dp">·</span>7466<span class="dp">·</span>326f<span class="dp">·</span>6e6e<span class="dp">·</span>7820<span class="dp">·</span>283e<span class="dp">·</span>3d31<span class="dp">·</span>2e31<span class="dp">·</span><span class="dp">·</span>:<span class="dp">·</span>tf2onnx<span class="dp">·</span>(&gt;=1.1</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000360:<span class="dp">·</span>332e<span class="dp">·</span>3029<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span><span class="dp">·</span>3.0).Requires-Di</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000370:<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>746f<span class="dp">·</span>7263<span class="dp">·</span>6820<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>2e30<span class="dp">·</span><span class="dp">·</span>st:<span class="dp">·</span>torch<span class="dp">·</span>(==2.0</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000380:<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>.0).Requires-Dis</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000390:<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span>6f72<span class="dp">·</span>6368<span class="dp">·</span>6d65<span class="dp">·</span>7472<span class="dp">·</span>6963<span class="dp">·</span>7320<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>torchmetrics<span class="dp">·</span></td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000003a0:<span class="dp">·</span>283d<span class="dp">·</span>3d30<span class="dp">·</span>2e39<span class="dp">·</span>2e32<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span><span class="dp">·</span>(==0.9.2).Requir</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000003b0:<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span>7164<span class="dp">·</span>6d0a<span class="dp">·</span>5265<span class="dp">·</span><span class="dp">·</span>es-Dist:<span class="dp">·</span>tqdm.Re</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>3c</del>0:<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>207<del>6</del><span class="dp">·</span>6<del>1</del>6<del>c</del><span class="dp">·</span><span class="dp">·</span>quires-Dist:<span class="dp">·</span><del>val</del></td><td colspan="2" class="diffpresent">00000<ins>47</ins>0:<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>207<ins>4</ins><span class="dp">·</span>6<ins>5</ins>6<ins>e</ins><span class="dp">·</span><span class="dp">·</span>quires-Dist:<span class="dp">·</span><ins>ten</ins></td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000003d0:<span class="dp">·</span>6964<span class="dp">·</span>6174<span class="dp">·</span>6f72<span class="dp">·</span>2e70<span class="dp">·</span>7920<span class="dp">·</span>283d<span class="dp">·</span>3d31<span class="dp">·</span>2e33<span class="dp">·</span><span class="dp">·</span>idator.py<span class="dp">·</span>(==1.3</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000003e0:<span class="dp">·</span>2e30<span class="dp">·</span>290a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span><span class="dp">·</span>.0).Requires-Dis</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000003f0:<span class="dp">·</span>743a<span class="dp">·</span>2078<span class="dp">·</span>6762<span class="dp">·</span>6f6f<span class="dp">·</span>7374<span class="dp">·</span>2028<span class="dp">·</span>3d3d<span class="dp">·</span>312e<span class="dp">·</span><span class="dp">·</span>t:<span class="dp">·</span>xgboost<span class="dp">·</span>(==1.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000400:<span class="dp">·</span>352e<span class="dp">·</span>3229<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span><span class="dp">·</span>5.2).Requires-Di</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000410:<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7768<span class="dp">·</span>6565<span class="dp">·</span>6c20<span class="dp">·</span>283e<span class="dp">·</span>3d30<span class="dp">·</span>2e33<span class="dp">·</span><span class="dp">·</span>st:<span class="dp">·</span>wheel<span class="dp">·</span>(&gt;=0.3</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000420:<span class="dp">·</span>382e<span class="dp">·</span>3129<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span><span class="dp">·</span>8.1).Requires-Di</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000430:<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7465<span class="dp">·</span>6e73<span class="dp">·</span>6f72<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2028<span class="dp">·</span><span class="dp">·</span>st:<span class="dp">·</span>tensorflow<span class="dp">·</span>(</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000440:<span class="dp">·</span>3d3d<span class="dp">·</span>322e<span class="dp">·</span>3130<span class="dp">·</span>2e31<span class="dp">·</span>2920<span class="dp">·</span>3b20<span class="dp">·</span>706c<span class="dp">·</span>6174<span class="dp">·</span><span class="dp">·</span>==2.10.1)<span class="dp">·</span>;<span class="dp">·</span>plat</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000450:<span class="dp">·</span>666f<span class="dp">·</span>726d<span class="dp">·</span>5f6d<span class="dp">·</span>6163<span class="dp">·</span>6869<span class="dp">·</span>6e65<span class="dp">·</span>2021<span class="dp">·</span>3d20<span class="dp">·</span><span class="dp">·</span>form_machine<span class="dp">·</span>!=<span class="dp">·</span></td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000460:<span class="dp">·</span>2261<span class="dp">·</span>726d<span class="dp">·</span>3634<span class="dp">·</span>220a<span class="dp">·</span>5265<span class="dp">·</span>7175<span class="dp">·</span>6972<span class="dp">·</span>6573<span class="dp">·</span><span class="dp">·</span>&quot;arm64&quot;.Requires</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000470:<span class="dp">·</span>2d44<span class="dp">·</span>6973<span class="dp">·</span>743a<span class="dp">·</span>2074<span class="dp">·</span>656e<span class="dp">·</span>736f<span class="dp">·</span>7266<span class="dp">·</span>6c6f<span class="dp">·</span><span class="dp">·</span>-Dist:<span class="dp">·</span>tensorflo</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000480:<span class="dp">·</span>772d<span class="dp">·</span>6d61<span class="dp">·</span>636f<span class="dp">·</span>7320<span class="dp">·</span>283d<span class="dp">·</span>3d32<span class="dp">·</span>2e31<span class="dp">·</span>312e<span class="dp">·</span><span class="dp">·</span>w-macos<span class="dp">·</span>(==2.11.</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">00000490:<span class="dp">·</span>3029<span class="dp">·</span>203b<span class="dp">·</span>2070<span class="dp">·</span>6c61<span class="dp">·</span>7466<span class="dp">·</span>6f72<span class="dp">·</span>6d5f<span class="dp">·</span>6d61<span class="dp">·</span><span class="dp">·</span>0)<span class="dp">·</span>;<span class="dp">·</span>platform_ma</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004a0:<span class="dp">·</span>6368<span class="dp">·</span>696e<span class="dp">·</span>6520<span class="dp">·</span>3d3d<span class="dp">·</span>2022<span class="dp">·</span>6172<span class="dp">·</span>6d36<span class="dp">·</span>3422<span class="dp">·</span><span class="dp">·</span>chine<span class="dp">·</span>==<span class="dp">·</span>&quot;arm64&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004b0:<span class="dp">·</span>2061<span class="dp">·</span>6e64<span class="dp">·</span>2070<span class="dp">·</span>6c61<span class="dp">·</span>7466<span class="dp">·</span>6f72<span class="dp">·</span>6d5f<span class="dp">·</span>7379<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>and<span class="dp">·</span>platform_sy</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004c0:<span class="dp">·</span>7374<span class="dp">·</span>656d<span class="dp">·</span>203d<span class="dp">·</span>3d20<span class="dp">·</span>2244<span class="dp">·</span>6172<span class="dp">·</span>7769<span class="dp">·</span>6e22<span class="dp">·</span><span class="dp">·</span>stem<span class="dp">·</span>==<span class="dp">·</span>&quot;Darwin&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004d0:<span class="dp">·</span>0a50<span class="dp">·</span>726f<span class="dp">·</span>7669<span class="dp">·</span>6465<span class="dp">·</span>732d<span class="dp">·</span>4578<span class="dp">·</span>7472<span class="dp">·</span>613a<span class="dp">·</span><span class="dp">·</span>.Provides-Extra:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004e0:<span class="dp">·</span>2064<span class="dp">·</span>6576<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dev.Requires-Di</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td colspan="2" class="diffpresent">000004f0:<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7079<span class="dp">·</span>6c69<span class="dp">·</span>6e74<span class="dp">·</span>203b<span class="dp">·</span>2065<span class="dp">·</span>7874<span class="dp">·</span><span class="dp">·</span>st:<span class="dp">·</span>pylint<span class="dp">·</span>;<span class="dp">·</span>ext</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td colspan="2" class="diffpresent">00000<del>50</del>0:<span class="dp">·</span>7<del>2</del>6<del>1</del><span class="dp">·</span><del>203d</del><span class="dp">·</span><del>3d20</del><span class="dp">·</span><del>2</del>7<del>64</del><span class="dp">·</span>6<del>576</del><span class="dp">·</span><del>270a</del><span class="dp">·</span><del>0a3c</del><span class="dp">·</span><del>6469</del><span class="dp">·</span><span class="dp">·</span><del>ra<span class="dp">·</span>==<span class="dp">·</span>&#x27;dev&#x27;..&lt;di</del></td><td colspan="2" class="diffpresent">00000<ins>48</ins>0:<span class="dp">·</span>7<ins>3</ins>6<ins>f</ins><span class="dp">·</span><ins>7266</ins><span class="dp">·</span><ins>6c6f</ins><span class="dp">·</span><ins>7</ins>7<ins>2d</ins><span class="dp">·</span>6<ins>d61</ins><span class="dp">·</span><ins>636f</ins><span class="dp">·</span><ins>7320</ins><span class="dp">·</span><ins>283d</ins><span class="dp">·</span><span class="dp">·</span><ins>sorflow-macos<span class="dp">·</span>(=</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000490:<span class="dp">·</span>3d32<span class="dp">·</span>2e31<span class="dp">·</span>312e<span class="dp">·</span>3029<span class="dp">·</span>203b<span class="dp">·</span>2070<span class="dp">·</span>6c61<span class="dp">·</span>7466<span class="dp">·</span><span class="dp">·</span>=2.11.0)<span class="dp">·</span>;<span class="dp">·</span>platf</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004a0:<span class="dp">·</span>6f72<span class="dp">·</span>6d5f<span class="dp">·</span>6d61<span class="dp">·</span>6368<span class="dp">·</span>696e<span class="dp">·</span>6520<span class="dp">·</span>3d3d<span class="dp">·</span>2022<span class="dp">·</span><span class="dp">·</span>orm_machine<span class="dp">·</span>==<span class="dp">·</span>&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004b0:<span class="dp">·</span>6172<span class="dp">·</span>6d36<span class="dp">·</span>3422<span class="dp">·</span>2061<span class="dp">·</span>6e64<span class="dp">·</span>2070<span class="dp">·</span>6c61<span class="dp">·</span>7466<span class="dp">·</span><span class="dp">·</span>arm64&quot;<span class="dp">·</span>and<span class="dp">·</span>platf</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004c0:<span class="dp">·</span>6f72<span class="dp">·</span>6d5f<span class="dp">·</span>7379<span class="dp">·</span>7374<span class="dp">·</span>656d<span class="dp">·</span>203d<span class="dp">·</span>3d20<span class="dp">·</span>2244<span class="dp">·</span><span class="dp">·</span>orm_system<span class="dp">·</span>==<span class="dp">·</span>&quot;D</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004d0:<span class="dp">·</span>6172<span class="dp">·</span>7769<span class="dp">·</span>6e22<span class="dp">·</span>0a50<span class="dp">·</span>726f<span class="dp">·</span>7669<span class="dp">·</span>6465<span class="dp">·</span>732d<span class="dp">·</span><span class="dp">·</span>arwin&quot;.Provides-</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004e0:<span class="dp">·</span>4578<span class="dp">·</span>7472<span class="dp">·</span>613a<span class="dp">·</span>2064<span class="dp">·</span>6576<span class="dp">·</span>0a52<span class="dp">·</span>6571<span class="dp">·</span>7569<span class="dp">·</span><span class="dp">·</span>Extra:<span class="dp">·</span>dev.Requi</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000004f0:<span class="dp">·</span>7265<span class="dp">·</span>732d<span class="dp">·</span>4469<span class="dp">·</span>7374<span class="dp">·</span>3a20<span class="dp">·</span>7079<span class="dp">·</span>6c69<span class="dp">·</span>6e74<span class="dp">·</span><span class="dp">·</span>res-Dist:<span class="dp">·</span>pylint</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000500:<span class="dp">·</span>203b<span class="dp">·</span>2065<span class="dp">·</span>7874<span class="dp">·</span>7261<span class="dp">·</span>203d<span class="dp">·</span>3d20<span class="dp">·</span>2764<span class="dp">·</span>6576<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>;<span class="dp">·</span>extra<span class="dp">·</span>==<span class="dp">·</span>&#x27;dev</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000510:<span class="dp">·</span>270a<span class="dp">·</span>0a3c<span class="dp">·</span>6469<span class="dp">·</span>7620<span class="dp">·</span>616c<span class="dp">·</span>6967<span class="dp">·</span>6e3d<span class="dp">·</span>2263<span class="dp">·</span><span class="dp">·</span>&#x27;..&lt;div<span class="dp">·</span>align=&quot;c</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000520:<span class="dp">·</span>656e<span class="dp">·</span>7465<span class="dp">·</span>7222<span class="dp">·</span>3e0a<span class="dp">·</span>2020<span class="dp">·</span>2020<span class="dp">·</span>3c69<span class="dp">·</span>6d67<span class="dp">·</span><span class="dp">·</span>enter&quot;&gt;.<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&lt;img</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000530:<span class="dp">·</span>2073<span class="dp">·</span>7263<span class="dp">·</span>3d22<span class="dp">·</span>646f<span class="dp">·</span>6373<span class="dp">·</span>2f5f<span class="dp">·</span>7374<span class="dp">·</span>6174<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>src=&quot;docs/_stat</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000540:<span class="dp">·</span>6963<span class="dp">·</span>2f6c<span class="dp">·</span>6f67<span class="dp">·</span>6f2d<span class="dp">·</span>6c69<span class="dp">·</span>6768<span class="dp">·</span>742e<span class="dp">·</span>706e<span class="dp">·</span><span class="dp">·</span>ic/logo-light.pn</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000550:<span class="dp">·</span>6722<span class="dp">·</span>3e0a<span class="dp">·</span>3c2f<span class="dp">·</span>6469<span class="dp">·</span>763e<span class="dp">·</span>0a0a<span class="dp">·</span>2d2d<span class="dp">·</span>2d0a<span class="dp">·</span><span class="dp">·</span>g&quot;&gt;.&lt;/div&gt;..---.</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000560:<span class="dp">·</span>0a5b<span class="dp">·</span>215b<span class="dp">·</span>4369<span class="dp">·</span>7263<span class="dp">·</span>6c65<span class="dp">·</span>4349<span class="dp">·</span>5d28<span class="dp">·</span>6874<span class="dp">·</span><span class="dp">·</span>.[![CircleCI](ht</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000570:<span class="dp">·</span>7470<span class="dp">·</span>733a<span class="dp">·</span>2f2f<span class="dp">·</span>646c<span class="dp">·</span>2e63<span class="dp">·</span>6972<span class="dp">·</span>636c<span class="dp">·</span>6563<span class="dp">·</span><span class="dp">·</span>tps://dl.circlec</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000580:<span class="dp">·</span>692e<span class="dp">·</span>636f<span class="dp">·</span>6d2f<span class="dp">·</span>7374<span class="dp">·</span>6174<span class="dp">·</span>7573<span class="dp">·</span>2d62<span class="dp">·</span>6164<span class="dp">·</span><span class="dp">·</span>i.com/status-bad</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">00000590:<span class="dp">·</span>6765<span class="dp">·</span>2f69<span class="dp">·</span>6d67<span class="dp">·</span>2f67<span class="dp">·</span>682f<span class="dp">·</span>7365<span class="dp">·</span>6372<span class="dp">·</span>6574<span class="dp">·</span><span class="dp">·</span>ge/img/gh/secret</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000005a0:<span class="dp">·</span>666c<span class="dp">·</span>6f77<span class="dp">·</span>2f73<span class="dp">·</span>6563<span class="dp">·</span>7265<span class="dp">·</span>7466<span class="dp">·</span>6c6f<span class="dp">·</span>772f<span class="dp">·</span><span class="dp">·</span>flow/secretflow/</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2" class="diffpresent">000005b0:<span class="dp">·</span>7472<span class="dp">·</span>6565<span class="dp">·</span>2f6d<span class="dp">·</span>6169<span class="dp">·</span>6e2e<span class="dp">·</span>7376<span class="dp">·</span>673f<span class="dp">·</span>7374<span class="dp">·</span><span class="dp">·</span>tree/main.svg?st</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; -1/29429 bytes (-0.00%) of diff not shown.
</td></tr></table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol diffcontrol-double">⊟</div>
    <div><span class="diffsize">32.0 KB</span></div>
    <div><span class="source">secretflow-0.8.0b1.dist-info/RECORD</span> vs.</div>
    <div id="secretflow--.-.-b-.dist-info-RECORD"><span class="source">secretflow-0.8.1b0.dist-info/RECORD</span>
      <a class="anchor" href="#secretflow--.-.-b-.dist-info-RECORD">¶</a>
    </div>
    </div>
    <div class="comment">Files 22% similar despite different names
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 193 lines modified</td><td colspan="2">Offset 1, 228 lines modified</td></tr>
<tr class="diffchanged"><td class="diffline">1 </td><td class="diffpresent">secretflow/__init__.py,sha256=<del>PqDTmqrGh</del>w<del>8NAV93A4e5bSSB8ko_btGH2RXuGNwIZ_0</del>,1<del>136</del></td><td class="diffline">1 </td><td class="diffpresent">secretflow/__init__.py,sha256=<ins>caiZVbXMR</ins>w<ins>qUKhDuy_Ca295Mw-YYMhrUOteWHx0RgLA</ins>,1<ins>261</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">2 </td><td class="diffpresent">secretflow/version.py,sha256=wboVrEO0tVexsLCxIhz7UiDnY8fePbece6gbPAMGQmk,607</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">secretflow/data/__init__.py,sha256=dfSoOj_BQ2QEMiFZXgitx2IHrpJ2qyN4hGfgpKbeKcI,754</td><td class="diffline">3 </td><td class="diffpresent">secretflow/data/__init__.py,sha256=dfSoOj_BQ2QEMiFZXgitx2IHrpJ2qyN4hGfgpKbeKcI,754</td></tr>
<tr class="diffchanged"><td class="diffline">3 </td><td class="diffpresent">secretflow/data/base.py,sha256=<del>T_oME</del>S<del>bpRn7nfVdSA4PbWhkBSV</del>x<del>ebWKN</del>i<del>Fo</del><del>YVuoYaG4</del>,14806</td><td class="diffline">4 </td><td class="diffpresent">secretflow/data/base.py,sha256=<ins>q</ins><ins>DwucR</ins>S<ins>3</ins><ins>FHJ0kYYMatUuS_1HL67U</ins>x<ins>J2IjK</ins>i<ins>6UvFBfSw</ins>,14806</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">secretflow/data/math_utils.py,sha256=wLVcz6eJC7LAYdTXfxERZmwtmxVfchpUkTNKVEW86HA,1108</td><td class="diffline">5 </td><td class="diffpresent">secretflow/data/math_utils.py,sha256=wLVcz6eJC7LAYdTXfxERZmwtmxVfchpUkTNKVEW86HA,1108</td></tr>
<tr class="diffdeleted"><td class="diffline">5 </td><td class="diffpresent">secretflow/data/ndarray.py,sha256=mcGhGs9FtEGOhHUVeNlUmZ_RdBDjBQaUgBmuP5S32_c,26347</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">6 </td><td class="diffpresent">secretflow/data/<del>split</del>.py,sha256=<del>WVobfLqgsP2</del>b<del>lK3LHUsoNWjSt_hDffS7iHzZoU8ZEss</del>,<del>55</del>8<del>6</del></td><td class="diffline">6 </td><td class="diffpresent">secretflow/data/<ins>nd</ins><ins>array</ins>.py,sha256=<ins>DN3GXtz2MAb</ins>b<ins>ohNPvnJvYvSs9Eyy6a2kBJekTNElgh4</ins>,<ins>24</ins>8<ins>7</ins><ins>8</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">secretflow/data/split.py,sha256=s8HV00DaVKulNvP2-BkH_Y8cWrrnqSc_ANPgKtOQBlY,5420</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">secretflow/data/horizontal/__init__.py,sha256=_2-VKz4GGygJrut0AqnLa4qvWQGztgzHkFIcoLMYhmk,716</td><td class="diffline">8 </td><td class="diffpresent">secretflow/data/horizontal/__init__.py,sha256=_2-VKz4GGygJrut0AqnLa4qvWQGztgzHkFIcoLMYhmk,716</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">secretflow/data/horizontal/dataframe.py,sha256=Vbc_GmHbDE6o54qEdYSQ12FVRPTc5TPzCdorO5nMZcQ,15042</td><td class="diffline">9 </td><td class="diffpresent">secretflow/data/horizontal/dataframe.py,sha256=Vbc_GmHbDE6o54qEdYSQ12FVRPTc5TPzCdorO5nMZcQ,15042</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">secretflow/data/horizontal/io.py,sha256=qIkzQLT8kMBq-PLU1M3OfS7-fXug61AbdzItvaNySsY,2557</td><td class="diffline">10 </td><td class="diffpresent">secretflow/data/horizontal/io.py,sha256=qIkzQLT8kMBq-PLU1M3OfS7-fXug61AbdzItvaNySsY,2557</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">secretflow/data/horizontal/sampler.py,sha256=wTkHd8A_C4bLSm380P2Lg0e6LBeLXplAQdHDrXDNz1M,1555</td><td class="diffline">11 </td><td class="diffpresent">secretflow/data/horizontal/sampler.py,sha256=wTkHd8A_C4bLSm380P2Lg0e6LBeLXplAQdHDrXDNz1M,1555</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">secretflow/data/io/__init__.py,sha256=GiNwroIs5A3LY5nKf5KR32Gay8e-zoVHo8_qKdVZEd4,627</td><td class="diffline">12 </td><td class="diffpresent">secretflow/data/io/__init__.py,sha256=GiNwroIs5A3LY5nKf5KR32Gay8e-zoVHo8_qKdVZEd4,627</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent">secretflow/data/io/oss.py,sha256=ma0WzVSQO37GBDI7AmHQByM1eUtXRMMBL1z3CxoM6ag,2112</td><td class="diffline">13 </td><td class="diffpresent">secretflow/data/io/oss.py,sha256=ma0WzVSQO37GBDI7AmHQByM1eUtXRMMBL1z3CxoM6ag,2112</td></tr>
<tr class="diffchanged"><td class="diffline">13 </td><td class="diffpresent">secretflow/data/io/util.py,sha256=<del>973b5DUSsfpZWQaGFlcaAtz2_zvGRODXi3OpnEppHXU</del>,20<del>75</del></td><td class="diffline">14 </td><td class="diffpresent">secretflow/data/io/util.py,sha256=<ins>wUL1gtqT72yuAwP31UTPI2wMgaVT_tKp92FlOR0KSlo</ins>,20<ins>83</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">secretflow/data/mix/__init__.py,sha256=h2bB-DvEkqUeUINstjjMvNzTEOxrwDpp3DML2oD2RoU,691</td><td class="diffline">15 </td><td class="diffpresent">secretflow/data/mix/__init__.py,sha256=h2bB-DvEkqUeUINstjjMvNzTEOxrwDpp3DML2oD2RoU,691</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">secretflow/data/mix/dataframe.py,sha256=vAuf-CVuCrG6U5qUtbcwdv-N2I6ORLzGdHgna7-oRuY,15054</td><td class="diffline">16 </td><td class="diffpresent">secretflow/data/mix/dataframe.py,sha256=vAuf-CVuCrG6U5qUtbcwdv-N2I6ORLzGdHgna7-oRuY,15054</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">secretflow/data/vertical/__init__.py,sha256=lvsakfHAkSdOtxQ88zhVftq5opqHQbKWs_3avYr5-xc,716</td><td class="diffline">17 </td><td class="diffpresent">secretflow/data/vertical/__init__.py,sha256=lvsakfHAkSdOtxQ88zhVftq5opqHQbKWs_3avYr5-xc,716</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">secretflow/data/vertical/dataframe.py,sha256=<del>0RXtRls2Qrr5l0u</del>t<del>PdEZToPoZ5FIngaht20Kx7-INZw</del>,2294<del>3</del></td><td class="diffline">18 </td><td class="diffpresent">secretflow/data/vertical/dataframe.py,sha256=<ins>EAzfauTNycPHfZH</ins>t<ins>eBf-FLVOqiBS0VuLkpzf7mtjF5Q</ins>,2294<ins>4</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">secretflow/data/vertical/io.py,sha256=M640m6S3Rh5pD4w4e1AvHRkyVu4S8R3UXLPvuf0jZBI,6821</td><td class="diffline">19 </td><td class="diffpresent">secretflow/data/vertical/io.py,sha256=M640m6S3Rh5pD4w4e1AvHRkyVu4S8R3UXLPvuf0jZBI,6821</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">secretflow/device/__init__.py,sha256=BEn43Wg3C8Pr9-f1ynF-L1HJ4IVKC8R2tU-SqnOOpp4,745</td><td class="diffline">20 </td><td class="diffpresent">secretflow/device/__init__.py,sha256=BEn43Wg3C8Pr9-f1ynF-L1HJ4IVKC8R2tU-SqnOOpp4,745</td></tr>
<tr class="diffdeleted"><td class="diffline">20 </td><td class="diffpresent">secretflow/device/driver.py,sha256=EryVwQvQFgVmBx9qJIUx0fnEzLG95lH2I4dudH2Kfuc,15193</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">21 </td><td class="diffpresent">secretflow/device/<del>l</del>i<del>nk</del>.py,sha256=<del>gIHF8_dmcyVo6aFCb0</del>q<del>y9nW7UKt</del>Z<del>F</del><del>JvJOkiatkhM5</del>Q<del>s</del>,<del>10796</del></td><td class="diffline">21 </td><td class="diffpresent">secretflow/device/<ins>d</ins><ins>r</ins>i<ins>v</ins><ins>er</ins>.py,sha256=<ins>M6</ins><ins>7_J2NG0VIvmfhEB9G7</ins>q<ins>pqgvv3OI</ins>Z<ins>2ZLUXzSpDPGY</ins>Q,<ins>22444</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">secretflow/device/global_state.py,sha256=5C6cysrgRG56oB93sBYHr2afkTMjlM3rL1VlD6sBuvw,2981</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent">secretflow/device/link.py,sha256=s8Dsx-UQ2XcbByFauiix2TXUWIosXhZCvB2T1dtPRJ0,10795</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent">secretflow/device/proxy.py,sha256=DZTukc-c3-PmdJwpTgoUY7HqaxNWkdGYIepts87akDI,8100</td><td class="diffline">24 </td><td class="diffpresent">secretflow/device/proxy.py,sha256=DZTukc-c3-PmdJwpTgoUY7HqaxNWkdGYIepts87akDI,8100</td></tr>
<tr class="diffdeleted"><td class="diffline">23 </td><td class="diffpresent">secretflow/device/device/__init__.py,sha256=GVMdpOYEwHB_BtPA19Rjof0aklq02-U8sq1b5gATlYo,894</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">24 </td><td class="diffpresent">secretflow/device/device/base.py,sha256=E6Lun94gcl2msOlny8hfz6F_N86l4aH6c1wXKdPShlM,2920</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">25 </td><td class="diffpresent">secretflow/device/device/heu.py,sha256=dowbUZLZWhY7upmxkbepMFoBlII-eFD_D1Bq5XnC8UY,17158</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">26 </td><td class="diffpresent">secretflow/device/device/heu_object.py,sha256=2hHVhIwZTzEbm6o8frVFFHSZkLPNjxmS7vY1MJ5_hF4,3545</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent">secretflow/device/device/pyu.py,sha256=0Sy6cJ65_yA8vX-zDC20rpTE5qqemW_UCaqdYEzhx04,5201</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent">secretflow/device/device/register.py,sha256=A_hVaNvIDQSycn_LQTgRFbFg1bmqfoooBmKRGLMJjLc,3572</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">29 </td><td class="diffpresent">secretflow/device/device/<del>spu</del>.py,sha256=<del>OYnya6VIEjy-Ha2f9</del>U<del>uwpwjyx</del>X<del>tt</del><del>if_p_4uoGyxyv7</del>g<del>,</del><del>47878</del></td><td class="diffline">25 </td><td class="diffpresent">secretflow/device/device/<ins>__ini</ins><ins>t__</ins>.py,sha256=<ins>W</ins><ins>I_jmQfWPY5VQu-b-c</ins>U<ins>bqK8Sqj</ins>X<ins>HYdRG-NF4iIFTE</ins>g<ins>c,939</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent">secretflow/device/device/_utils.py,sha256=H6q--hVRw7lQYzSbIenVM1vcGheQY8kNVK-KOEg-13w,889</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">27 </td><td class="diffpresent">secretflow/device/device/base.py,sha256=kvlkLFmZ0fmAsGQOTR5NC3X6YAnc9NecAPSS_UNoSGQ,2264</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">28 </td><td class="diffpresent">secretflow/device/device/heu.py,sha256=40aEkeQb4ncdmAleZFAGmQZJI9cjkiOF49qDoj1iVck,22903</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent">secretflow/device/device/heu_object.py,sha256=JuDaZYK8g55qzfFcqQkARmkZCX93BKV4nxsOu2Ei67E,6068</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">30 </td><td class="diffpresent">secretflow/device/device/pyu.py,sha256=T8SoyTiNIUQWj4OmBgqV7EFZxFkS-q-OxV54Zo0eRkU,4693</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">31 </td><td class="diffpresent">secretflow/device/device/register.py,sha256=-2PA4a01mX5Rlh-bbNEgto73P_3c4EtaFd1gbdUVICc,3589</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">32 </td><td class="diffpresent">secretflow/device/device/spu.py,sha256=psOU76PxI9rN7fD6R5S_-y0F1SHkAB0e9S2lEBsKWmU,56627</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">33 </td><td class="diffpresent">secretflow/device/device/teeu.py,sha256=PDW90WT01sI2Cv4tihbaiIGgSwE-FFh4_fZhX2Afu1w,7655</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">secretflow/device/device/type_traits.py,sha256=5jU1LTot9DrQl2meNc5c3mt-_NSnpKnLrHsTUZ-azUI,2410</td><td class="diffline">34 </td><td class="diffpresent">secretflow/device/device/type_traits.py,sha256=5jU1LTot9DrQl2meNc5c3mt-_NSnpKnLrHsTUZ-azUI,2410</td></tr>
<tr class="diffdeleted"><td class="diffline">31 </td><td class="diffpresent">secretflow/device/kernels/__init__.py,sha256=a1uhKy7tbA7WxfxqSWFPjElnJ-gz7pyFYquoVDXDCqs,638</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">32 </td><td class="diffpresent">secretflow/device/kernels/heu.py,sha256=suSmCv38m02GGpLZu4ryBO_giZ6p3TWG9REBFslAroQ,5528</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">33 </td><td class="diffpresent">secretflow/device/kernels/pyu.py,sha256=CnQ6qyBlO92zkTzNZV_XqDv3kCltYXakPxoVA1jKcvY,2205</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">34 </td><td class="diffpresent">secretflow/device/kernels/spu.py,sha256=yfi28HCzQsP5vedA0awRTxKvqE2N-_G1qOqPHsKKcr8,12954</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">35 </td><td class="diffpresent">secretflow/distributed/__init__.py,sha256=sTHao4gj8FwiXUBfFl0_-qWU-tMNYHnL-57-NOdms6g,223</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">36 </td><td class="diffpresent">secretflow/di<del>stribut</del>e<del>d</del>/<del>pr</del>i<del>m</del>it<del>i</del><del>ve</del>.py,sha256=<del>8ITnRB0aGn</del>_<del>AC14N</del>V<del>KJ3NlnOUs56Y_HGpNpf6jy0vzw</del>,<del>5</del><del>01</del>8</td><td class="diffline">35 </td><td class="diffpresent">secretflow/d<ins>ev</ins>i<ins>ce/kern</ins>e<ins>l</ins><ins>s</ins>/<ins>__</ins>i<ins>n</ins>it<ins>__</ins>.py,sha256=<ins>gWgvZx-2t6</ins>_<ins>XfGQo</ins>V<ins>dC9TQNyF-Jm9I9hnn-iVUcNKlE</ins>,<ins>63</ins>8</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">36 </td><td class="diffpresent">secretflow/device/kernels/heu.py,sha256=OEVnoebeKU6Jxua1yOCsEPQlhHUlYiQkvpwvvElGkrk,5716</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent">secretflow/device/kernels/pyu.py,sha256=8VBjgHxYYB14QZGI1XE60SySI4v1uQdbtIe8HJyIBoo,6837</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent">secretflow/device/kernels/spu.py,sha256=4l6v0c_RL-p4MlsFiH5OE84D23Km2-qfxjANRftlZR0,14374</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">secretflow/device/kernels/teeu.py,sha256=o6T8NLSpE9skxJ8eQAqcA4Dk00kC0mMjCzcmkcM1dQc,923</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">secretflow/distributed/__init__.py,sha256=lemgXRrzin237GO_Srg0VjaXv0PeJ0daxPVLJT78Qns,784</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">41 </td><td class="diffpresent">secretflow/distributed/primitive.py,sha256=3cSCX6kwIjnB38zzO7TRk9EACZamOhe-NeBg66Yy6p4,6373</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">secretflow/ml/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td><td class="diffline">42 </td><td class="diffpresent">secretflow/ml/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent">secretflow/ml/boost/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td><td class="diffline">43 </td><td class="diffpresent">secretflow/ml/boost/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/__init__.py,sha256=MWOYs8dgKs5CBSGS6V95PYd3_j5QGxRvota2xXDXjfk,654</td><td class="diffline">44 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/__init__.py,sha256=MWOYs8dgKs5CBSGS6V95PYd3_j5QGxRvota2xXDXjfk,654</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_booster.py,sha256=QSmPBfQy6zh0w7ImjApumrKsHMvED2mB8AILtFroQpk,9580</td><td class="diffline">45 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_booster.py,sha256=QSmPBfQy6zh0w7ImjApumrKsHMvED2mB8AILtFroQpk,9580</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_booster_worker.py,sha256=BRW8t729QXx3mhd-BhMlDAWDNsSDfVnBoMit1F5jGXg,7462</td><td class="diffline">46 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_booster_worker.py,sha256=BRW8t729QXx3mhd-BhMlDAWDNsSDfVnBoMit1F5jGXg,7462</td></tr>
<tr class="diffchanged"><td class="diffline">42 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_decision_tree.py,sha256=<del>-8Rxp8I</del>z<del>l4jLU-j3HPDk-xMuuUQLCG8nwVOu4gJgPSA</del>,1116<del>5</del></td><td class="diffline">47 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/homo_decision_tree.py,sha256=<ins>tL9ZNnC</ins>z<ins>EtItkBcm2IOzvyld1oso0z0FUHIa6XF-uZI</ins>,1116<ins>6</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_param.py,sha256=y7-5wrirBUU0qTiARbf3UMPTFHtVeawXVOblX9NTb7o,3043</td><td class="diffline">48 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_param.py,sha256=y7-5wrirBUU0qTiARbf3UMPTFHtVeawXVOblX9NTb7o,3043</td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td><td class="diffline">49 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/callback.py,sha256=VMFBtZA0Kxny-X_QwwMSX4QDSMkIqjtq6jn_tNQe_ik,4365</td><td class="diffline">50 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/callback.py,sha256=VMFBtZA0Kxny-X_QwwMSX4QDSMkIqjtq6jn_tNQe_ik,4365</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/core.py,sha256=1XIyKXDQt5-yxcKkZISL7qQJXthQvEa5LrBIFrrcM_c,7192</td><td class="diffline">51 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/core.py,sha256=1XIyKXDQt5-yxcKkZISL7qQJXthQvEa5LrBIFrrcM_c,7192</td></tr>
<tr class="diffchanged"><td class="diffline">47 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/training.py,sha256=<del>ubmJSU6lk-AG4fFkso-cOVWSUKHSgVlhw_zwVy01Ngo</del>,931<del>8</del></td><td class="diffline">52 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/boost_core/training.py,sha256=<ins>2MMvRppspwE8DBXDthkl6fcG1006EbP4TQ6R3pVb-lY</ins>,931<ins>7</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td><td class="diffline">53 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/criterion.py,sha256=4JERxTXcVG_Ad_bJP7OgqyOnCkh7H3RN-6gPVtX7rS4,4429</td><td class="diffline">54 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/criterion.py,sha256=4JERxTXcVG_Ad_bJP7OgqyOnCkh7H3RN-6gPVtX7rS4,4429</td></tr>
<tr class="diffdeleted"><td class="diffline">50 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/decision_tree.py,sha256=zJuhDlyYY0BjcIW-4t1rkrYTv4NdtCkQ0LvFzpBvyzg,18556</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">51 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/<del>f</del>e<del>atur</del><del>e_h</del>i<del>stog</del>r<del>am</del>.py,sha256=<del>jFBW4p2BH4z</del>s<del>Y</del>W<del>t66WKSq</del>y<del>CiZKJPrbHagiqqhiSbmzo,9371</del></td><td class="diffline">55 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/<ins>d</ins>e<ins>cis</ins>i<ins>on_t</ins>r<ins>ee</ins>.py,sha256=<ins>svtnTv-E7EZ</ins>s<ins>t</ins>W<ins>0</ins><ins>00PqRad</ins>y<ins>V7AxY-kxMNUkLdIRoy1Y,18557</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/feature_histogram.py,sha256=365Zuy8Y9PczRYMHYbR1QrmxDUBWZ68wca1aQJWBxi0,9371</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/feature_importance.py,sha256=RtYMeKZ4aA8FnihFaTGTfvaeOh0098kvwahY9aj3bY4,2535</td><td class="diffline">57 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/feature_importance.py,sha256=RtYMeKZ4aA8FnihFaTGTfvaeOh0098kvwahY9aj3bY4,2535</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/loss_function.py,sha256=DGW0AuQuZe64a-SQPfr8XKEknMeW3HW-cK4K-ivc_m4,4218</td><td class="diffline">58 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/loss_function.py,sha256=DGW0AuQuZe64a-SQPfr8XKEknMeW3HW-cK4K-ivc_m4,4218</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/node.py,sha256=oogyME57SuPl08PcXtUXtK37Wqsbb7LFSuQ0gp52n-M,2060</td><td class="diffline">59 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/node.py,sha256=oogyME57SuPl08PcXtUXtK37Wqsbb7LFSuQ0gp52n-M,2060</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/splitter.py,sha256=pK0qK3Ia5LMziazmdBHTRtum0VjcyohXbCq_nm-qDHA,9846</td><td class="diffline">60 </td><td class="diffpresent">secretflow/ml/boost/homo_boost/tree_core/splitter.py,sha256=pK0qK3Ia5LMziazmdBHTRtum0VjcyohXbCq_nm-qDHA,9846</td></tr>
<tr class="diffdeleted"><td class="diffline">56 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/__init__.py,sha256=nY9jiO3VpOccBN9COTyPmBbBAzoKySZh7vMW6Rc5RlE,660</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">57 </td><td class="diffpresent">secretflow/ml/boost/s<del>s_x</del>gb_v/<del>model</del>.py,sha256=<del>hRYR</del><del>fAvopE_oIX</del>L<del>d</del>K<del>oYAFm08ZJ0JH</del>3<del>JKrIBI1QtwrRY,20000</del></td><td class="diffline">61 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/<ins>__i</ins><ins>nit__</ins>.py,sha256=<ins>05aqw2SGTw</ins>L<ins>G</ins>K<ins>U</ins><ins>NNvdB1PLL_mh</ins>3<ins>K</ins><ins>eo6k2gDVgF579WU,677</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/model.py,sha256=CR_A-ESukei3H5xQGvQnkHWTOJuKq18SkLU_xQIREO8,3472</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/sgb.py,sha256=pqtAs30zec-sAmt-F_x_GBRwDj5PSuBJ81dNEPyYzVM,17539</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/label_holder.py,sha256=oJIeTqV2Qk9XzxHP5pAZpjbYKp-4iwb3yGKBM41ExWM,9768</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/level_cache.py,sha256=uUt-Ywq2359wFAmnxVgv8KeyApChB67CWtcwDhWL-w8,2043</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">67 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/params.py,sha256=GXnNKrQzlznCU99upWCydnCDKA-0VfVnBlTrGbkKPoo,1139</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">68 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/preprocessing.py,sha256=711Ipmof58GoGilrHyriXCsC_JovNn-jZAEf8ZGip-o,3212</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/distributed_tree/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">70 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/distributed_tree/distributed_tree.py,sha256=a4yDnl0Onr0Q0oEQ1BeK4ta86BO3ULmO6zVqDYaMfmU,2785</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">71 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/distributed_tree/split_tree.py,sha256=jrDeMm7aLqxoRa4cOqXApnUZlWA4TCE0N4vwNiAI1Uk,1582</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">73 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/boost.py,sha256=6zzT8bKJqPk7goWarPvOgAb4BaHlEZx-MT7e23vFPdY,2600</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">74 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/bucket_sum.py,sha256=oYgjkq2LEL4BPcIGFqYToA8kU8fgNVv-5IFi4kKwocU,1724</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/grad.py,sha256=tRL8nIprFDOr9RsGuqSIEglaLiP6NeuZ8-dK4c0HMCU,930</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/node_select.py,sha256=VtrHE_9U01ChoUj60-Nc2p-oLw9K6JKNxyhBFZ_tMtc,1994</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">77 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/pred.py,sha256=HzfGKu-GrWV512hSEnMmc3yccSkmvqESgfip390eUhc,1452</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">78 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/pure_numpy_ops/random.py,sha256=0LfG6qRSbj5jRFR8t7LHFmyEXrlMBoOtD1eY2SOOh7Q,776</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/split_tree_trainer/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">80 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/split_tree_trainer/order_map_context.py,sha256=UnVQaD1aoyR6LaPjQU2Ir8VFmvVjRViBO5yC6iv31c4,4712</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">81 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/split_tree_trainer/shuffler.py,sha256=Utmj_ETZPRDJzTkzsQ70orNrh6JBXb09TSWWIWat1pQ,2446</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">82 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/split_tree_trainer/split_tree_trainer.py,sha256=UWQPzJ8pocK2iG6GpddyyiO2_ImTn9aQ7uh3dA1l_3I,3828</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">83 </td><td class="diffpresent">secretflow/ml/boost/sgb_v/core/split_tree_trainer/splitter.py,sha256=be8BquAywE7IH4WUnALuWudtaX6OuTHq1oXRBK91cCQ,5057</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">84 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/__init__.py,sha256=mWFWnNM-indGXq7-H80y9KisAWayUQtH0MV0nVG0ymE,661</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/model.py,sha256=-ZKihB60XDRPbn2tqXRwQdZhKY_-RBboves8Dmpa6LY,19885</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td><td class="diffline">86 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0</td></tr>
<tr class="diffdeleted"><td class="diffline">59 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/node_split.py,sha256=1jJBpuevSj1ypfluMzOtNn2XlVFEv3kpge7M4_B-anU,8800</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">60 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/tree_worker.py,sha256=a9Dvru_WtzVl5nwBiM8syML401kyMh8IvTI41A1Hpe8,10969</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">61 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/<del>uti</del>l<del>s</del>.py,sha256=<del>0</del><del>gcvvaptykj8</del>K<del>2</del>J<del>QgCVSbf7z_eRwuV2u_cx4-3CAhmc</del>,<del>1513</del></td><td class="diffline">87 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/<ins>node</ins><ins>_sp</ins>l<ins>i</ins><ins>t</ins>.py,sha256=<ins>_DQ01D3dn-S</ins>K<ins>p</ins>J<ins>A</ins><ins>wS6NNDKJXNp1Cro41Fpip_AzKO1U</ins>,<ins>8801</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">88 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/tree_worker.py,sha256=CW9JWpwmCLdpNjxXOvChgLIM8MVoxVjW4PvdFwMqJdI,9885</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">89 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/utils.py,sha256=DQZ4xkE_6UhQIM0Wh8gfVDFG7wPlfsNV6mGtdyOu76s,1513</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/xgb_tree.py,sha256=JNeEdH_Boe7mJ8hNjCu0nnuNm2LIfIdiNHBWmDIPF_w,980</td><td class="diffline">90 </td><td class="diffpresent">secretflow/ml/boost/ss_xgb_v/core/xgb_tree.py,sha256=JNeEdH_Boe7mJ8hNjCu0nnuNm2LIfIdiNHBWmDIPF_w,980</td></tr>
<tr class="diffdeleted"><td class="diffline">63 </td><td class="diffpresent">secretflow/ml/linear/__init__.py,sha256=qg9VX_gG5brIbsi6iQoV5DtrG7234lyz9plKgSHhQ_8,1013</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">64 </td><td class="diffpresent">secretflow/ml/linear/fl_lr_mix.py,sha256=oVuiSAEF3LVj0h_UU2l2g8_chDALnYcClUUaCL3JXmY,11737</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">65 </td><td class="diffpresent">secretflow/ml/linear/fl_lr_v.py,sha256=eFqN4Yb71ibUMtAuLSrah9j4_aty1vdxzv764lkFIWY,19161</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">66 </td><td class="diffpresent">secretflow/ml/linear/<del>l</del>in<del>e</del><del>ar</del>_<del>mode</del><del>l</del>.py,sha256=<del>RV0m4JfVIvNiAhQPWwHkfV</del>x<del>RHmaCQRbD8eM</del>J<del>eL-dCTY</del>,1<del>375</del></td><td class="diffline">91 </td><td class="diffpresent">secretflow/ml/linear/<ins>_</ins><ins>_</ins>in<ins>it</ins>_<ins>_</ins>.py,sha256=<ins>S6Te5j_pKa2N860u3hrjDa</ins>x<ins>nN2hiW3c_On6</ins>J<ins>DidhxQM</ins>,1<ins>013</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">92 </td><td class="diffpresent">secretflow/ml/linear/fl_lr_mix.py,sha256=YRr1_B-GzdiyhkaAN8xaddjvoGDh1mn03VF3xOjtLXk,11736</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">93 </td><td class="diffpresent">secretflow/ml/linear/fl_lr_v.py,sha256=TePHL_2PAwvvvOFGvGzwKRnzM2r73ScJHEk_yhhE8_E,19131</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">94 </td><td class="diffpresent">secretflow/ml/linear/linear_model.py,sha256=UX7sn9dj60-YVkI7POpiaRbFphntrtje099rOFFZHFE,3129</td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent">secretflow/ml/linear/hess_sgd/__init__.py,sha256=tqLher8w0NHhOe5pb7Erfdg8Woa6793desVvSkKRJCU,673</td><td class="diffline">95 </td><td class="diffpresent">secretflow/ml/linear/hess_sgd/__init__.py,sha256=tqLher8w0NHhOe5pb7Erfdg8Woa6793desVvSkKRJCU,673</td></tr>
<tr class="diffchanged"><td class="diffline">68 </td><td class="diffpresent">secretflow/ml/linear/hess_sgd/model.py,sha256=<del>XBr1IG8-GjXS7vM</del>J<del>FcXmFTHaJ3iXvfjgPEYDlt5XqzM</del>,13250</td><td class="diffline">96 </td><td class="diffpresent">secretflow/ml/linear/hess_sgd/model.py,sha256=<ins>e1p-lv0Mpq8E5h9</ins>J<ins>3_S28vNVDs8t1LGXJvGHGNFM15k</ins>,13250</td></tr>
<tr class="diffunmodified"><td class="diffline">69 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/__init__.py,sha256=SXmD8shOQpUA5Dp89bX5yNSDThcsWbeVTKMhtLuxRJw,639</td><td class="diffline">97 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/__init__.py,sha256=SXmD8shOQpUA5Dp89bX5yNSDThcsWbeVTKMhtLuxRJw,639</td></tr>
<tr class="diffunmodified"><td class="diffline">70 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/model.py,sha256=znhxnxq5e0k3bLctH3WegAz6E418Z-vS-J1D3DSEKuw,23754</td><td class="diffline">98 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/model.py,sha256=znhxnxq5e0k3bLctH3WegAz6E418Z-vS-J1D3DSEKuw,23754</td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/__init__.py,sha256=Hz7_m2Fjd5Efyq_PWbvAAGFaM33blcDFMGURY1v0Fq4,233</td><td class="diffline">99 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/__init__.py,sha256=Hz7_m2Fjd5Efyq_PWbvAAGFaM33blcDFMGURY1v0Fq4,233</td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/distribution.py,sha256=fUizQ1UYW8OyF6Vs5X6Wu3Ue3_7NPaU4MDFRCfGWwQo,5287</td><td class="diffline">100 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/distribution.py,sha256=fUizQ1UYW8OyF6Vs5X6Wu3Ue3_7NPaU4MDFRCfGWwQo,5287</td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/link.py,sha256=DXNbYAyxUzheTplGMtqjOOYclhlol0wWqC5iDH_yQTM,2950</td><td class="diffline">101 </td><td class="diffpresent">secretflow/ml/linear/ss_glm/core/link.py,sha256=DXNbYAyxUzheTplGMtqjOOYclhlol0wWqC5iDH_yQTM,2950</td></tr>
<tr class="diffunmodified"><td class="diffline">74 </td><td class="diffpresent">secretflow/ml/linear/ss_sgd/__init__.py,sha256=hdNmisOmrvblwF4XbF2v8Ddv3ldHzbkYjW2f5rhkM5o,653</td><td class="diffline">102 </td><td class="diffpresent">secretflow/ml/linear/ss_sgd/__init__.py,sha256=hdNmisOmrvblwF4XbF2v8Ddv3ldHzbkYjW2f5rhkM5o,653</td></tr>
<tr class="diffchanged"><td class="diffline">75 </td><td class="diffpresent">secretflow/ml/linear/ss_sgd/model.py,sha256=<del>dLtYJz</del>L<del>ewyRH1aNxTWXh9g0wOdX7o4uP1uNhIAK</del>-<del>1A</del>4,<del>17121</del></td><td class="diffline">103 </td><td class="diffpresent">secretflow/ml/linear/ss_sgd/model.py,sha256=<ins>JSlUpH</ins>L<ins>BNeniq04TRIDuHRJ3WzFBB6kGSKzysej</ins>-<ins>pp</ins>4,<ins>21895</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent">secretflow/ml/nn/__init__.py,sha256=iOeB3Fi78uSNTBvlkmcpgkRLo1IPw7ipn1yj6rQrXu4,698</td><td class="diffline">104 </td><td class="diffpresent">secretflow/ml/nn/__init__.py,sha256=iOeB3Fi78uSNTBvlkmcpgkRLo1IPw7ipn1yj6rQrXu4,698</td></tr>
<tr class="diffchanged"><td class="diffline">77 </td><td class="diffpresent">secretflow/ml/nn/metrics.py,sha256=<del>rUWzjZfWqpRBhlJVHbJ7bLdMZPd</del>C<del>Z</del>Q<del>b</del><del>5tFnxPVFGGF0</del>,806<del>5</del></td><td class="diffline">105 </td><td class="diffpresent">secretflow/ml/nn/metrics.py,sha256=<ins>g</ins><ins>BobUmtRhk3ZKUAqG1ahKpSe68pO</ins>C<ins>T</ins>Q<ins>q7KdQiqOKN2g</ins>,806<ins>4</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">106 </td><td class="diffpresent">secretflow/ml/nn/applications/__init__.py,sha256=Wd00rjlQJKH-aY2LbPoVGjBo932U5pCSy9wAKN9ekjw,585</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">107 </td><td class="diffpresent">secretflow/ml/nn/applications/sl_deep_fm.py,sha256=w252NcasCrQwgiO1pPOjZ4kh9Yrld2HW3-Q9I14-7eE,5261</td></tr>
<tr class="error"><td colspan="4">
Max diff block lines reached; 18533/32682 bytes (56.71%) of diff not shown.
</td></tr></table>  </div>
</div>
<div class="footer">
Generated by
<a href="https://diffoscope.org" rel="noopener noreferrer" target="_blank">
diffoscope</a> 238
</div>
</body>
</html>

