--- tmp/fastkafka-0.4.0rc0.tar.gz
+++ tmp/fastkafka-0.4.0rc1.tar.gz
â”œâ”€â”€ filetype from file(1)
â”‚ @@ -1 +1 @@
â”‚ -gzip compressed data, was "fastkafka-0.4.0rc0.tar", last modified: Fri Apr  7 12:25:08 2023, max compression
â”‚ +gzip compressed data, was "fastkafka-0.4.0rc1.tar", last modified: Fri Apr  7 14:02:29 2023, max compression
â”‚   --- fastkafka-0.4.0rc0.tar
â”œâ”€â”€ +++ fastkafka-0.4.0rc1.tar
â”‚ â”œâ”€â”€ file list
â”‚ â”‚ @@ -1,49 +1,49 @@
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.735709 fastkafka-0.4.0rc0/
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    11357 2023-01-25 09:24:15.000000 fastkafka-0.4.0rc0/LICENSE
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)      111 2023-01-25 09:24:15.000000 fastkafka-0.4.0rc0/MANIFEST.in
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    31197 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/PKG-INFO
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    29790 2023-03-27 11:07:38.000000 fastkafka-0.4.0rc0/README.md
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/fastkafka/
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)      432 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/__init__.py
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/fastkafka/_application/
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_application/__init__.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    27864 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_application/app.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     7407 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_application/tester.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     1574 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_cli.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     3879 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_cli_docs.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)      852 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_cli_testing.py
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/fastkafka/_components/
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/__init__.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     3705 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_components/_subprocess.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     8769 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_components/aiokafka_consumer_loop.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     2848 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_components/aiokafka_producer_manager.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    16362 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_components/asyncapi.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     2940 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_components/benchmarking.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     4686 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/docs_dependencies.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     2639 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/helpers.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     3952 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/logger.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    12280 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/meta.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     3154 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_components/producer_decorator.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     5066 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_components/test_dependencies.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    11215 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_docusaurus_helper.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    50547 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_helpers.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    66827 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_modidx.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     6039 2023-04-07 12:24:03.000000 fastkafka-0.4.0rc0/fastkafka/_server.py
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/fastkafka/_testing/
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 12:24:04.000000 fastkafka-0.4.0rc0/fastkafka/_testing/__init__.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    19775 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_testing/apache_kafka_broker.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    18396 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_testing/in_memory_broker.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)    12366 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_testing/local_redpanda_broker.py
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     5031 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/_testing/test_utils.py
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)      849 2023-04-07 12:24:02.000000 fastkafka-0.4.0rc0/fastkafka/testing.py
â”‚ â”‚ -drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 12:25:08.731709 fastkafka-0.4.0rc0/fastkafka.egg-info/
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)    31197 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/PKG-INFO
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     1243 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/SOURCES.txt
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)        1 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/dependency_links.txt
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)      146 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/entry_points.txt
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)        1 2023-01-25 09:30:21.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/not-zip-safe
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)      578 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/requires.txt
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)       10 2023-04-07 12:25:08.000000 fastkafka-0.4.0rc0/fastkafka.egg-info/top_level.txt
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)     1231 2023-04-07 12:22:16.000000 fastkafka-0.4.0rc0/settings.ini
â”‚ â”‚ --rw-rw-r--   0 davor     (1000) davor     (1000)       38 2023-04-07 12:25:08.735709 fastkafka-0.4.0rc0/setup.cfg
â”‚ â”‚ --rw-r--r--   0 davor     (1000) davor     (1000)     3570 2023-04-07 10:22:05.000000 fastkafka-0.4.0rc0/setup.py
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)    11357 2023-01-25 09:24:15.000000 fastkafka-0.4.0rc1/LICENSE
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)      111 2023-01-25 09:24:15.000000 fastkafka-0.4.0rc1/MANIFEST.in
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    32291 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/PKG-INFO
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    30884 2023-04-07 14:01:48.000000 fastkafka-0.4.0rc1/README.md
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/fastkafka/
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)      432 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/__init__.py
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/fastkafka/_application/
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_application/__init__.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    27864 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_application/app.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     7407 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_application/tester.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     1574 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_cli.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     3879 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_cli_docs.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)      852 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_cli_testing.py
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/fastkafka/_components/
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_components/__init__.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     3705 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_components/_subprocess.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     8769 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_components/aiokafka_consumer_loop.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     2848 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_components/aiokafka_producer_manager.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)    16362 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_components/asyncapi.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     2940 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_components/benchmarking.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     4686 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_components/docs_dependencies.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     2639 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_components/helpers.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     3952 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_components/logger.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    12280 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_components/meta.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     3154 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_components/producer_decorator.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     5066 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_components/test_dependencies.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)    11215 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_docusaurus_helper.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)    50547 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_helpers.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    66827 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_modidx.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     6039 2023-04-07 14:00:34.000000 fastkafka-0.4.0rc1/fastkafka/_server.py
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/fastkafka/_testing/
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)        0 2023-04-07 14:00:35.000000 fastkafka-0.4.0rc1/fastkafka/_testing/__init__.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)    19775 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_testing/apache_kafka_broker.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    18396 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_testing/in_memory_broker.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    12382 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_testing/local_redpanda_broker.py
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     5031 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/_testing/test_utils.py
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)      849 2023-04-07 14:00:33.000000 fastkafka-0.4.0rc1/fastkafka/testing.py
â”‚ â”‚ +drwxrwxr-x   0 davor     (1000) davor     (1000)        0 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/fastkafka.egg-info/
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)    32291 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/PKG-INFO
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     1243 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/SOURCES.txt
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)        1 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/dependency_links.txt
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)      146 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/entry_points.txt
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)        1 2023-01-25 09:30:21.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/not-zip-safe
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)      578 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/requires.txt
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)       10 2023-04-07 14:02:29.000000 fastkafka-0.4.0rc1/fastkafka.egg-info/top_level.txt
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)     1231 2023-04-07 12:26:13.000000 fastkafka-0.4.0rc1/settings.ini
â”‚ â”‚ +-rw-rw-r--   0 davor     (1000) davor     (1000)       38 2023-04-07 14:02:29.331369 fastkafka-0.4.0rc1/setup.cfg
â”‚ â”‚ +-rw-r--r--   0 davor     (1000) davor     (1000)     3570 2023-04-07 10:22:05.000000 fastkafka-0.4.0rc1/setup.py
â”‚ â”‚   --- fastkafka-0.4.0rc0/LICENSE
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/LICENSE
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/PKG-INFO
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/PKG-INFO
â”‚ â”‚â”„ Files 8% similar despite different names
â”‚ â”‚ @@ -1,10 +1,10 @@
â”‚ â”‚  Metadata-Version: 2.1
â”‚ â”‚  Name: fastkafka
â”‚ â”‚ -Version: 0.4.0rc0
â”‚ â”‚ +Version: 0.4.0rc1
â”‚ â”‚  Summary: FastKafka is a powerful and easy-to-use Python library for building asynchronous web services that interact with Kafka topics. Built on top of FastAPI, Starlette, Pydantic, AIOKafka and AsyncAPI, FastKafka simplifies the process of writing producers and consumers for Kafka topics.
â”‚ â”‚  Home-page: https://github.com/airtai/fastkafka
â”‚ â”‚  Author: airt
â”‚ â”‚  Author-email: info@airt.ai
â”‚ â”‚  License: Apache Software License 2.0
â”‚ â”‚  Project-URL: Bug Tracker, https://github.com/airtai/fastkafka/issues
â”‚ â”‚  Project-URL: CI, https://github.com/airtai/fastkafka/actions
â”‚ â”‚ @@ -60,20 +60,30 @@
â”‚ â”‚  With FastKafka, you can quickly prototype and develop high-performance
â”‚ â”‚  Kafka-based services with minimal code, making it an ideal choice for
â”‚ â”‚  developers looking to streamline their workflow and accelerate their
â”‚ â”‚  projects.
â”‚ â”‚  
â”‚ â”‚  ------------------------------------------------------------------------
â”‚ â”‚  
â”‚ â”‚ -#### â­ Stay in touch
â”‚ â”‚ +#### â­â­â­ Stay in touch â­â­â­
â”‚ â”‚  
â”‚ â”‚ -Please show your support and stay in touch by giving our [GitHub
â”‚ â”‚ -repository](https://github.com/airtai/fastkafka/) a star! Your support
â”‚ â”‚ -helps us to stay in touch with you and encourages us to continue
â”‚ â”‚ -developing and improving the library. Thank you for your support!
â”‚ â”‚ +Please show your support and stay in touch by:
â”‚ â”‚ +
â”‚ â”‚ +- giving our [GitHub repository](https://github.com/airtai/fastkafka/) a
â”‚ â”‚ +  star, and
â”‚ â”‚ +
â”‚ â”‚ +- joining our [Discord server](https://discord.gg/CJWmYpyFbc).
â”‚ â”‚ +
â”‚ â”‚ +Your support helps us to stay in touch with you and encourages us to
â”‚ â”‚ +continue developing and improving the library. Thank you for your
â”‚ â”‚ +support!
â”‚ â”‚ +
â”‚ â”‚ +------------------------------------------------------------------------
â”‚ â”‚ +
â”‚ â”‚ +#### ğŸğŸğŸ We were busy lately ğŸğŸğŸ
â”‚ â”‚  
â”‚ â”‚  ![Activity](https://repobeats.axiom.co/api/embed/21f36049093d5eb8e5fdad18c3c5d8df5428ca30.svg "Repobeats analytics image")
â”‚ â”‚  
â”‚ â”‚  ## Install
â”‚ â”‚  
â”‚ â”‚  FastKafka works on macOS, Linux, and most Unix-style operating systems.
â”‚ â”‚  You can install base version of `fastkafka` with `pip` as usual:
â”‚ â”‚ @@ -102,44 +112,54 @@
â”‚ â”‚  
â”‚ â”‚  ## Tutorial
â”‚ â”‚  
â”‚ â”‚  You can start an interactive tutorial in Google Colab by clicking the
â”‚ â”‚  button below:
â”‚ â”‚  
â”‚ â”‚  <a href="https://colab.research.google.com/github/airtai/fastkafka/blob/main/nbs/guides/Guide_00_FastKafka_Demo.ipynb" target=â€_blankâ€>
â”‚ â”‚ -<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
â”‚ â”‚ +<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" />
â”‚ â”‚  </a>
â”‚ â”‚  
â”‚ â”‚  ## Writing server code
â”‚ â”‚  
â”‚ â”‚  Here is an example python script using FastKafka that takes data from a
â”‚ â”‚  Kafka topic, makes a prediction using a predictive model, and outputs
â”‚ â”‚  the prediction to another Kafka topic.
â”‚ â”‚  
â”‚ â”‚  ### Preparing the demo model
â”‚ â”‚  
â”‚ â”‚  First we will prepare our model using the Iris dataset so that we can
â”‚ â”‚  demonstrate the predictions using FastKafka. The following call
â”‚ â”‚  downloads the dataset and trains the model.
â”‚ â”‚  
â”‚ â”‚ +We will wrap the model creation into a lifespan of our app so that the
â”‚ â”‚ +model is created just before the app is started.
â”‚ â”‚ +
â”‚ â”‚  ``` python
â”‚ â”‚ +from contextlib import asynccontextmanager
â”‚ â”‚ +
â”‚ â”‚  from sklearn.datasets import load_iris
â”‚ â”‚  from sklearn.linear_model import LogisticRegression
â”‚ â”‚  
â”‚ â”‚ -X, y = load_iris(return_X_y=True)
â”‚ â”‚ -model = LogisticRegression(random_state=0, max_iter=500).fit(X, y)
â”‚ â”‚ -x = X[[0, 55, -1]]
â”‚ â”‚ -print(x)
â”‚ â”‚ -print(model.predict(x))
â”‚ â”‚ -```
â”‚ â”‚ +from fastkafka import FastKafka
â”‚ â”‚ +
â”‚ â”‚ +ml_models = {}
â”‚ â”‚  
â”‚ â”‚ -    [[5.1 3.5 1.4 0.2]
â”‚ â”‚ -     [5.7 2.8 4.5 1.3]
â”‚ â”‚ -     [5.9 3.  5.1 1.8]]
â”‚ â”‚ -    [0 1 2]
â”‚ â”‚ +
â”‚ â”‚ +@asynccontextmanager
â”‚ â”‚ +async def lifespan(app: FastKafka):
â”‚ â”‚ +    # Load the ML model
â”‚ â”‚ +    X, y = load_iris(return_X_y=True)
â”‚ â”‚ +    ml_models["iris_predictor"] = LogisticRegression(random_state=0, max_iter=500).fit(
â”‚ â”‚ +        X, y
â”‚ â”‚ +    )
â”‚ â”‚ +    yield
â”‚ â”‚ +    # Clean up the ML models and release the resources
â”‚ â”‚ +    ml_models.clear()
â”‚ â”‚ +```
â”‚ â”‚  
â”‚ â”‚  ### Messages
â”‚ â”‚  
â”‚ â”‚  FastKafka uses [Pydantic](https://docs.pydantic.dev/) to parse input
â”‚ â”‚  JSON-encoded data into Python objects, making it easy to work with
â”‚ â”‚  structured data in your Kafka-based applications. Pydanticâ€™s
â”‚ â”‚  [`BaseModel`](https://docs.pydantic.dev/usage/models/) class allows you
â”‚ â”‚ @@ -193,15 +213,15 @@
â”‚ â”‚  contains two entries: `"localhost"` and `"production"`, specifying local
â”‚ â”‚  development and production Kafka brokers. Each entry specifies the URL,
â”‚ â”‚  port, and other details of a Kafka broker. This dictionary is used for
â”‚ â”‚  both generating the documentation and later to run the actual server
â”‚ â”‚  against one of the given kafka broker.
â”‚ â”‚  
â”‚ â”‚  Next, an object of the
â”‚ â”‚ -[`FastKafka`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚ +[`FastKafka`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚  class is initialized with the minimum set of arguments:
â”‚ â”‚  
â”‚ â”‚  - `kafka_brokers`: a dictionary used for generation of documentation
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka import FastKafka
â”‚ â”‚  
â”‚ â”‚ @@ -219,14 +239,15 @@
â”‚ â”‚          "security": {"type": "plain"},
â”‚ â”‚      },
â”‚ â”‚  }
â”‚ â”‚  
â”‚ â”‚  kafka_app = FastKafka(
â”‚ â”‚      title="Iris predictions",
â”‚ â”‚      kafka_brokers=kafka_brokers,
â”‚ â”‚ +    lifespan=lifespan,
â”‚ â”‚  )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ### Function decorators
â”‚ â”‚  
â”‚ â”‚  FastKafka provides convenient function decorators `@kafka_app.consumes`
â”‚ â”‚  and `@kafka_app.produces` to allow you to delegate the actual process of
â”‚ â”‚ @@ -264,15 +285,15 @@
â”‚ â”‚    The framework will call the `IrisPrediction.json().encode("utf-8")`
â”‚ â”‚    function on the returned value and produce it to the specified topic.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  @kafka_app.consumes(topic="input_data", auto_offset_reset="latest")
â”‚ â”‚  async def on_input_data(msg: IrisInputData):
â”‚ â”‚      global model
â”‚ â”‚ -    species_class = model.predict(
â”‚ â”‚ +    species_class = ml_models["iris_predictor"].predict(
â”‚ â”‚          [[msg.sepal_length, msg.sepal_width, msg.petal_length, msg.petal_width]]
â”‚ â”‚      )[0]
â”‚ â”‚  
â”‚ â”‚      to_predictions(species_class)
â”‚ â”‚  
â”‚ â”‚  
â”‚ â”‚  @kafka_app.produces(topic="predictions")
â”‚ â”‚ @@ -282,94 +303,83 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ## Testing the service
â”‚ â”‚  
â”‚ â”‚  The service can be tested using the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -instances which internally starts Kafka broker and zookeeper.
â”‚ â”‚ -
â”‚ â”‚ -Before running tests, we have to install Java runtime and Apache Kafka
â”‚ â”‚ -locally. To simplify the process, we provide the following convenience
â”‚ â”‚ -command:
â”‚ â”‚ -
â”‚ â”‚ -``` sh
â”‚ â”‚ -fastkafka testing install_deps
â”‚ â”‚ -```
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Java...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - installing jdk...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - jdk path: /home/kumaran/.jdk/jdk-11.0.18+10
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Kafka...
â”‚ â”‚ -    832969it [00:02, 309324.60it/s]                                                 
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka installed in /home/kumaran/.local/kafka_2.13-3.3.2.
â”‚ â”‚ +[`Tester`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ +instances which internally starts InMemory implementation of Kafka
â”‚ â”‚ +broker.
â”‚ â”‚ +
â”‚ â”‚ +The Tester will redirect your consumes and produces decorated functions
â”‚ â”‚ +to the InMemory Kafka broker so that you can quickly test your app
â”‚ â”‚ +without the need for a running Kafka broker and all its dependencies.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka.testing import Tester
â”‚ â”‚  
â”‚ â”‚  msg = IrisInputData(
â”‚ â”‚      sepal_length=0.1,
â”‚ â”‚      sepal_width=0.2,
â”‚ â”‚      petal_length=0.3,
â”‚ â”‚      petal_width=0.4,
â”‚ â”‚  )
â”‚ â”‚  
â”‚ â”‚ -# Start Tester app and create local Kafka broker for testing
â”‚ â”‚ +# Start Tester app and create InMemory Kafka broker for testing
â”‚ â”‚  async with Tester(kafka_app) as tester:
â”‚ â”‚      # Send IrisInputData message to input_data topic
â”‚ â”‚      await tester.to_input_data(msg)
â”‚ â”‚  
â”‚ â”‚      # Assert that the kafka_app responded with IrisPrediction in predictions topic
â”‚ â”‚      await tester.awaited_mocks.on_predictions.assert_awaited_with(
â”‚ â”‚          IrisPrediction(species="setosa"), timeout=2
â”‚ â”‚      )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._start() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._patch_consumers_and_producers(): Patching consumers and producers!
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker starting
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['input_data']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'predictions'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'predictions'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['predictions']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'predictions': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 547...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 547 terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 173...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 173 terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker stopping
â”‚ â”‚  
â”‚ â”‚  ### Recap
â”‚ â”‚  
â”‚ â”‚  We have created a Iris classification model and encapulated it into our
â”‚ â”‚  fastkafka application. The app will consume the IrisInputData from the
â”‚ â”‚  `input_data` topic and produce the predictions to `predictions` topic.
â”‚ â”‚  
â”‚ â”‚ @@ -453,129 +463,155 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  To run the service, you will need a running Kafka broker on localhost as
â”‚ â”‚  specified in the `kafka_brokers` parameter above. We can start the Kafka
â”‚ â”‚  broker locally using the
â”‚ â”‚ -[`LocalKafkaBroker`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/LocalKafkaBroker/#fastkafka.testing.LocalKafkaBroker).
â”‚ â”‚ -Notice that the same happens automatically in the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -as shown above.
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): entering...
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker).
â”‚ â”‚ +
â”‚ â”‚ +To use
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker),
â”‚ â”‚ +you need to install JRE and Kafka to your environment. To simplify this
â”‚ â”‚ +process, fastkafka comes with a CLI command that does just that, to run
â”‚ â”‚ +it, in your terminal execute the following:
â”‚ â”‚ +
â”‚ â”‚ +``` sh
â”‚ â”‚ +fastkafka testing install_deps
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +Now we can run
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker)
â”‚ â”‚ +that will start a Kafka broker instance for us.
â”‚ â”‚ +
â”‚ â”‚ +``` python
â”‚ â”‚ +from fastkafka.testing import ApacheKafkaBroker
â”‚ â”‚ +
â”‚ â”‚ +broker = ApacheKafkaBroker(apply_nest_asyncio=True)
â”‚ â”‚ +
â”‚ â”‚ +broker.start()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): entering...
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: <class 'fastkafka.testing.LocalKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): exited.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting zookeeper...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting kafka...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: <class 'fastkafka.testing.ApacheKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): exited.
â”‚ â”‚  
â”‚ â”‚      '127.0.0.1:9092'
â”‚ â”‚  
â”‚ â”‚  Then, we start the FastKafka service by running the following command in
â”‚ â”‚  the folder where the `application.py` file is located:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka run --num-workers=2 --kafka-broker localhost application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  In the above command, we use `--num-workers` option to specify how many
â”‚ â”‚  workers to launch and we use `--kafka-broker` option to specify which
â”‚ â”‚  kafka broker configuration to use from earlier specified `kafka_brokers`
â”‚ â”‚  
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2561]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2559]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚      ^C
â”‚ â”‚      Starting process cleanup, this may take a few seconds...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2559...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2561...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2561 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2559 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558863...
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558865...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558863 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558865 was already terminated.
â”‚ â”‚  
â”‚ â”‚  You need to interupt running of the cell above by selecting
â”‚ â”‚  `Runtime->Interupt execution` on the toolbar above.
â”‚ â”‚  
â”‚ â”‚  Finally, we can stop the local Kafka Broker:
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): entering...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 2098...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 2098 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 1725...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 1725 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): exited.
â”‚ â”‚ +``` python
â”‚ â”‚ +broker.stop()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): entering...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 558265...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 558265 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 557885...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 557885 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): exited.
â”‚ â”‚  
â”‚ â”‚  ## Documentation
â”‚ â”‚  
â”‚ â”‚  The kafka app comes with builtin documentation generation using
â”‚ â”‚  [AsyncApi HTML generator](https://www.asyncapi.com/tools/generator).
â”‚ â”‚  
â”‚ â”‚  AsyncApi requires Node.js to be installed and we provide the following
â”‚ â”‚  convenience command line for it:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs install_deps
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.asyncapi: AsyncAPI generator installed
â”‚ â”‚ +    [INFO] fastkafka._components.docs_dependencies: AsyncAPI generator installed
â”‚ â”‚  
â”‚ â”‚  To generate the documentation programatically you just need to call the
â”‚ â”‚  folloving command:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs generate application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ +    [INFO] fastkafka._components.asyncapi: Old async specifications at '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml' does not exist.
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: New async specifications generated at: '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Async docs generated at 'asyncapi/docs'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Output of '$ npx -y -p @asyncapi/generator ag asyncapi/spec/asyncapi.yml @asyncapi/html-template -o asyncapi/docs --force-write'
â”‚ â”‚  
â”‚ â”‚      Done! âœ¨
â”‚ â”‚      Check out your shiny new generated files at /work/fastkafka/nbs/asyncapi/docs.
â”‚ â”‚  
â”‚ â”‚ @@ -584,16 +620,16 @@
â”‚ â”‚  with:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  ls -l asyncapi
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚      total 8
â”‚ â”‚ -    drwxrwxr-x 4 kumaran kumaran 4096 Mar 21 09:14 docs
â”‚ â”‚ -    drwxrwxr-x 2 kumaran kumaran 4096 Mar 21 09:14 spec
â”‚ â”‚ +    drwxrwxr-x 4 tvrtko tvrtko 4096 Apr  5 08:02 docs
â”‚ â”‚ +    drwxrwxr-x 2 tvrtko tvrtko 4096 Apr  5 08:02 spec
â”‚ â”‚  
â”‚ â”‚  In docs folder you will find the servable static html file of your
â”‚ â”‚  documentation. This can also be served using our `fastkafka docs serve`
â”‚ â”‚  CLI command (more on that in our guides).
â”‚ â”‚  
â”‚ â”‚  In spec folder you will find a asyncapi.yml file containing the async
â”‚ â”‚  API specification of your application.
â”‚ â”‚   --- fastkafka-0.4.0rc0/README.md
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/README.md
â”‚ â”‚â”„ Files 8% similar despite different names
â”‚ â”‚ @@ -31,20 +31,30 @@
â”‚ â”‚  With FastKafka, you can quickly prototype and develop high-performance
â”‚ â”‚  Kafka-based services with minimal code, making it an ideal choice for
â”‚ â”‚  developers looking to streamline their workflow and accelerate their
â”‚ â”‚  projects.
â”‚ â”‚  
â”‚ â”‚  ------------------------------------------------------------------------
â”‚ â”‚  
â”‚ â”‚ -#### â­ Stay in touch
â”‚ â”‚ +#### â­â­â­ Stay in touch â­â­â­
â”‚ â”‚  
â”‚ â”‚ -Please show your support and stay in touch by giving our [GitHub
â”‚ â”‚ -repository](https://github.com/airtai/fastkafka/) a star! Your support
â”‚ â”‚ -helps us to stay in touch with you and encourages us to continue
â”‚ â”‚ -developing and improving the library. Thank you for your support!
â”‚ â”‚ +Please show your support and stay in touch by:
â”‚ â”‚ +
â”‚ â”‚ +- giving our [GitHub repository](https://github.com/airtai/fastkafka/) a
â”‚ â”‚ +  star, and
â”‚ â”‚ +
â”‚ â”‚ +- joining our [Discord server](https://discord.gg/CJWmYpyFbc).
â”‚ â”‚ +
â”‚ â”‚ +Your support helps us to stay in touch with you and encourages us to
â”‚ â”‚ +continue developing and improving the library. Thank you for your
â”‚ â”‚ +support!
â”‚ â”‚ +
â”‚ â”‚ +------------------------------------------------------------------------
â”‚ â”‚ +
â”‚ â”‚ +#### ğŸğŸğŸ We were busy lately ğŸğŸğŸ
â”‚ â”‚  
â”‚ â”‚  ![Activity](https://repobeats.axiom.co/api/embed/21f36049093d5eb8e5fdad18c3c5d8df5428ca30.svg "Repobeats analytics image")
â”‚ â”‚  
â”‚ â”‚  ## Install
â”‚ â”‚  
â”‚ â”‚  FastKafka works on macOS, Linux, and most Unix-style operating systems.
â”‚ â”‚  You can install base version of `fastkafka` with `pip` as usual:
â”‚ â”‚ @@ -73,44 +83,54 @@
â”‚ â”‚  
â”‚ â”‚  ## Tutorial
â”‚ â”‚  
â”‚ â”‚  You can start an interactive tutorial in Google Colab by clicking the
â”‚ â”‚  button below:
â”‚ â”‚  
â”‚ â”‚  <a href="https://colab.research.google.com/github/airtai/fastkafka/blob/main/nbs/guides/Guide_00_FastKafka_Demo.ipynb" target=â€_blankâ€>
â”‚ â”‚ -<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
â”‚ â”‚ +<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" />
â”‚ â”‚  </a>
â”‚ â”‚  
â”‚ â”‚  ## Writing server code
â”‚ â”‚  
â”‚ â”‚  Here is an example python script using FastKafka that takes data from a
â”‚ â”‚  Kafka topic, makes a prediction using a predictive model, and outputs
â”‚ â”‚  the prediction to another Kafka topic.
â”‚ â”‚  
â”‚ â”‚  ### Preparing the demo model
â”‚ â”‚  
â”‚ â”‚  First we will prepare our model using the Iris dataset so that we can
â”‚ â”‚  demonstrate the predictions using FastKafka. The following call
â”‚ â”‚  downloads the dataset and trains the model.
â”‚ â”‚  
â”‚ â”‚ +We will wrap the model creation into a lifespan of our app so that the
â”‚ â”‚ +model is created just before the app is started.
â”‚ â”‚ +
â”‚ â”‚  ``` python
â”‚ â”‚ +from contextlib import asynccontextmanager
â”‚ â”‚ +
â”‚ â”‚  from sklearn.datasets import load_iris
â”‚ â”‚  from sklearn.linear_model import LogisticRegression
â”‚ â”‚  
â”‚ â”‚ -X, y = load_iris(return_X_y=True)
â”‚ â”‚ -model = LogisticRegression(random_state=0, max_iter=500).fit(X, y)
â”‚ â”‚ -x = X[[0, 55, -1]]
â”‚ â”‚ -print(x)
â”‚ â”‚ -print(model.predict(x))
â”‚ â”‚ -```
â”‚ â”‚ +from fastkafka import FastKafka
â”‚ â”‚ +
â”‚ â”‚ +ml_models = {}
â”‚ â”‚  
â”‚ â”‚ -    [[5.1 3.5 1.4 0.2]
â”‚ â”‚ -     [5.7 2.8 4.5 1.3]
â”‚ â”‚ -     [5.9 3.  5.1 1.8]]
â”‚ â”‚ -    [0 1 2]
â”‚ â”‚ +
â”‚ â”‚ +@asynccontextmanager
â”‚ â”‚ +async def lifespan(app: FastKafka):
â”‚ â”‚ +    # Load the ML model
â”‚ â”‚ +    X, y = load_iris(return_X_y=True)
â”‚ â”‚ +    ml_models["iris_predictor"] = LogisticRegression(random_state=0, max_iter=500).fit(
â”‚ â”‚ +        X, y
â”‚ â”‚ +    )
â”‚ â”‚ +    yield
â”‚ â”‚ +    # Clean up the ML models and release the resources
â”‚ â”‚ +    ml_models.clear()
â”‚ â”‚ +```
â”‚ â”‚  
â”‚ â”‚  ### Messages
â”‚ â”‚  
â”‚ â”‚  FastKafka uses [Pydantic](https://docs.pydantic.dev/) to parse input
â”‚ â”‚  JSON-encoded data into Python objects, making it easy to work with
â”‚ â”‚  structured data in your Kafka-based applications. Pydanticâ€™s
â”‚ â”‚  [`BaseModel`](https://docs.pydantic.dev/usage/models/) class allows you
â”‚ â”‚ @@ -164,15 +184,15 @@
â”‚ â”‚  contains two entries: `"localhost"` and `"production"`, specifying local
â”‚ â”‚  development and production Kafka brokers. Each entry specifies the URL,
â”‚ â”‚  port, and other details of a Kafka broker. This dictionary is used for
â”‚ â”‚  both generating the documentation and later to run the actual server
â”‚ â”‚  against one of the given kafka broker.
â”‚ â”‚  
â”‚ â”‚  Next, an object of the
â”‚ â”‚ -[`FastKafka`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚ +[`FastKafka`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚  class is initialized with the minimum set of arguments:
â”‚ â”‚  
â”‚ â”‚  - `kafka_brokers`: a dictionary used for generation of documentation
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka import FastKafka
â”‚ â”‚  
â”‚ â”‚ @@ -190,14 +210,15 @@
â”‚ â”‚          "security": {"type": "plain"},
â”‚ â”‚      },
â”‚ â”‚  }
â”‚ â”‚  
â”‚ â”‚  kafka_app = FastKafka(
â”‚ â”‚      title="Iris predictions",
â”‚ â”‚      kafka_brokers=kafka_brokers,
â”‚ â”‚ +    lifespan=lifespan,
â”‚ â”‚  )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ### Function decorators
â”‚ â”‚  
â”‚ â”‚  FastKafka provides convenient function decorators `@kafka_app.consumes`
â”‚ â”‚  and `@kafka_app.produces` to allow you to delegate the actual process of
â”‚ â”‚ @@ -235,15 +256,15 @@
â”‚ â”‚    The framework will call the `IrisPrediction.json().encode("utf-8")`
â”‚ â”‚    function on the returned value and produce it to the specified topic.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  @kafka_app.consumes(topic="input_data", auto_offset_reset="latest")
â”‚ â”‚  async def on_input_data(msg: IrisInputData):
â”‚ â”‚      global model
â”‚ â”‚ -    species_class = model.predict(
â”‚ â”‚ +    species_class = ml_models["iris_predictor"].predict(
â”‚ â”‚          [[msg.sepal_length, msg.sepal_width, msg.petal_length, msg.petal_width]]
â”‚ â”‚      )[0]
â”‚ â”‚  
â”‚ â”‚      to_predictions(species_class)
â”‚ â”‚  
â”‚ â”‚  
â”‚ â”‚  @kafka_app.produces(topic="predictions")
â”‚ â”‚ @@ -253,94 +274,83 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ## Testing the service
â”‚ â”‚  
â”‚ â”‚  The service can be tested using the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -instances which internally starts Kafka broker and zookeeper.
â”‚ â”‚ -
â”‚ â”‚ -Before running tests, we have to install Java runtime and Apache Kafka
â”‚ â”‚ -locally. To simplify the process, we provide the following convenience
â”‚ â”‚ -command:
â”‚ â”‚ -
â”‚ â”‚ -``` sh
â”‚ â”‚ -fastkafka testing install_deps
â”‚ â”‚ -```
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Java...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - installing jdk...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - jdk path: /home/kumaran/.jdk/jdk-11.0.18+10
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Kafka...
â”‚ â”‚ -    832969it [00:02, 309324.60it/s]                                                 
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka installed in /home/kumaran/.local/kafka_2.13-3.3.2.
â”‚ â”‚ +[`Tester`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ +instances which internally starts InMemory implementation of Kafka
â”‚ â”‚ +broker.
â”‚ â”‚ +
â”‚ â”‚ +The Tester will redirect your consumes and produces decorated functions
â”‚ â”‚ +to the InMemory Kafka broker so that you can quickly test your app
â”‚ â”‚ +without the need for a running Kafka broker and all its dependencies.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka.testing import Tester
â”‚ â”‚  
â”‚ â”‚  msg = IrisInputData(
â”‚ â”‚      sepal_length=0.1,
â”‚ â”‚      sepal_width=0.2,
â”‚ â”‚      petal_length=0.3,
â”‚ â”‚      petal_width=0.4,
â”‚ â”‚  )
â”‚ â”‚  
â”‚ â”‚ -# Start Tester app and create local Kafka broker for testing
â”‚ â”‚ +# Start Tester app and create InMemory Kafka broker for testing
â”‚ â”‚  async with Tester(kafka_app) as tester:
â”‚ â”‚      # Send IrisInputData message to input_data topic
â”‚ â”‚      await tester.to_input_data(msg)
â”‚ â”‚  
â”‚ â”‚      # Assert that the kafka_app responded with IrisPrediction in predictions topic
â”‚ â”‚      await tester.awaited_mocks.on_predictions.assert_awaited_with(
â”‚ â”‚          IrisPrediction(species="setosa"), timeout=2
â”‚ â”‚      )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._start() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._patch_consumers_and_producers(): Patching consumers and producers!
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker starting
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['input_data']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'predictions'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'predictions'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['predictions']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'predictions': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 547...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 547 terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 173...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 173 terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker stopping
â”‚ â”‚  
â”‚ â”‚  ### Recap
â”‚ â”‚  
â”‚ â”‚  We have created a Iris classification model and encapulated it into our
â”‚ â”‚  fastkafka application. The app will consume the IrisInputData from the
â”‚ â”‚  `input_data` topic and produce the predictions to `predictions` topic.
â”‚ â”‚  
â”‚ â”‚ @@ -424,129 +434,155 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  To run the service, you will need a running Kafka broker on localhost as
â”‚ â”‚  specified in the `kafka_brokers` parameter above. We can start the Kafka
â”‚ â”‚  broker locally using the
â”‚ â”‚ -[`LocalKafkaBroker`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/LocalKafkaBroker/#fastkafka.testing.LocalKafkaBroker).
â”‚ â”‚ -Notice that the same happens automatically in the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -as shown above.
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): entering...
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker).
â”‚ â”‚ +
â”‚ â”‚ +To use
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker),
â”‚ â”‚ +you need to install JRE and Kafka to your environment. To simplify this
â”‚ â”‚ +process, fastkafka comes with a CLI command that does just that, to run
â”‚ â”‚ +it, in your terminal execute the following:
â”‚ â”‚ +
â”‚ â”‚ +``` sh
â”‚ â”‚ +fastkafka testing install_deps
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +Now we can run
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker)
â”‚ â”‚ +that will start a Kafka broker instance for us.
â”‚ â”‚ +
â”‚ â”‚ +``` python
â”‚ â”‚ +from fastkafka.testing import ApacheKafkaBroker
â”‚ â”‚ +
â”‚ â”‚ +broker = ApacheKafkaBroker(apply_nest_asyncio=True)
â”‚ â”‚ +
â”‚ â”‚ +broker.start()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): entering...
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: <class 'fastkafka.testing.LocalKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): exited.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting zookeeper...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting kafka...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: <class 'fastkafka.testing.ApacheKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): exited.
â”‚ â”‚  
â”‚ â”‚      '127.0.0.1:9092'
â”‚ â”‚  
â”‚ â”‚  Then, we start the FastKafka service by running the following command in
â”‚ â”‚  the folder where the `application.py` file is located:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka run --num-workers=2 --kafka-broker localhost application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  In the above command, we use `--num-workers` option to specify how many
â”‚ â”‚  workers to launch and we use `--kafka-broker` option to specify which
â”‚ â”‚  kafka broker configuration to use from earlier specified `kafka_brokers`
â”‚ â”‚  
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2561]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2559]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚      ^C
â”‚ â”‚      Starting process cleanup, this may take a few seconds...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2559...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2561...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2561 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2559 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558863...
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558865...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558863 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558865 was already terminated.
â”‚ â”‚  
â”‚ â”‚  You need to interupt running of the cell above by selecting
â”‚ â”‚  `Runtime->Interupt execution` on the toolbar above.
â”‚ â”‚  
â”‚ â”‚  Finally, we can stop the local Kafka Broker:
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): entering...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 2098...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 2098 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 1725...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 1725 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): exited.
â”‚ â”‚ +``` python
â”‚ â”‚ +broker.stop()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): entering...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 558265...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 558265 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 557885...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 557885 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): exited.
â”‚ â”‚  
â”‚ â”‚  ## Documentation
â”‚ â”‚  
â”‚ â”‚  The kafka app comes with builtin documentation generation using
â”‚ â”‚  [AsyncApi HTML generator](https://www.asyncapi.com/tools/generator).
â”‚ â”‚  
â”‚ â”‚  AsyncApi requires Node.js to be installed and we provide the following
â”‚ â”‚  convenience command line for it:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs install_deps
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.asyncapi: AsyncAPI generator installed
â”‚ â”‚ +    [INFO] fastkafka._components.docs_dependencies: AsyncAPI generator installed
â”‚ â”‚  
â”‚ â”‚  To generate the documentation programatically you just need to call the
â”‚ â”‚  folloving command:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs generate application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ +    [INFO] fastkafka._components.asyncapi: Old async specifications at '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml' does not exist.
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: New async specifications generated at: '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Async docs generated at 'asyncapi/docs'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Output of '$ npx -y -p @asyncapi/generator ag asyncapi/spec/asyncapi.yml @asyncapi/html-template -o asyncapi/docs --force-write'
â”‚ â”‚  
â”‚ â”‚      Done! âœ¨
â”‚ â”‚      Check out your shiny new generated files at /work/fastkafka/nbs/asyncapi/docs.
â”‚ â”‚  
â”‚ â”‚ @@ -555,16 +591,16 @@
â”‚ â”‚  with:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  ls -l asyncapi
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚      total 8
â”‚ â”‚ -    drwxrwxr-x 4 kumaran kumaran 4096 Mar 21 09:14 docs
â”‚ â”‚ -    drwxrwxr-x 2 kumaran kumaran 4096 Mar 21 09:14 spec
â”‚ â”‚ +    drwxrwxr-x 4 tvrtko tvrtko 4096 Apr  5 08:02 docs
â”‚ â”‚ +    drwxrwxr-x 2 tvrtko tvrtko 4096 Apr  5 08:02 spec
â”‚ â”‚  
â”‚ â”‚  In docs folder you will find the servable static html file of your
â”‚ â”‚  documentation. This can also be served using our `fastkafka docs serve`
â”‚ â”‚  CLI command (more on that in our guides).
â”‚ â”‚  
â”‚ â”‚  In spec folder you will find a asyncapi.yml file containing the async
â”‚ â”‚  API specification of your application.
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_application/app.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_application/app.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_application/tester.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_application/tester.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_cli.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_cli.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_cli_docs.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_cli_docs.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_cli_testing.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_cli_testing.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/_subprocess.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/_subprocess.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/aiokafka_consumer_loop.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/aiokafka_consumer_loop.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/aiokafka_producer_manager.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/aiokafka_producer_manager.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/asyncapi.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/asyncapi.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/benchmarking.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/benchmarking.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/docs_dependencies.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/docs_dependencies.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/helpers.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/helpers.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/logger.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/logger.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/meta.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/meta.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/producer_decorator.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/producer_decorator.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_components/test_dependencies.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_components/test_dependencies.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_docusaurus_helper.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_docusaurus_helper.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_helpers.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_helpers.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_modidx.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_modidx.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_server.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_server.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_testing/apache_kafka_broker.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_testing/apache_kafka_broker.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_testing/in_memory_broker.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_testing/in_memory_broker.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_testing/local_redpanda_broker.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_testing/local_redpanda_broker.py
â”‚ â”‚â”„ Files 1% similar despite different names
â”‚ â”‚ @@ -224,15 +224,15 @@
â”‚ â”‚  
â”‚ â”‚          redpanda_docker_cmd = get_redpanda_docker_cmd(**self.redpanda_kwargs)  # type: ignore
â”‚ â”‚  
â”‚ â”‚          try:
â”‚ â”‚              service_task = await run_and_match(
â”‚ â”‚                  *redpanda_docker_cmd,
â”‚ â”‚                  capture="stderr",
â”‚ â”‚ -                pattern="Successfully started Redpanda",
â”‚ â”‚ +                pattern="Bootstrap complete",
â”‚ â”‚                  timeout=30,
â”‚ â”‚              )
â”‚ â”‚          except Exception as e:
â”‚ â”‚              logger.info(
â”‚ â”‚                  f"{service} startup failed, generating a new port and retrying..."
â”‚ â”‚              )
â”‚ â”‚              port = get_free_port()
â”‚ â”‚ @@ -280,14 +280,15 @@
â”‚ â”‚  async def _start(self: LocalRedpandaBroker) -> str:
â”‚ â”‚      await self._check_deps()
â”‚ â”‚  
â”‚ â”‚      self.temporary_directory = TemporaryDirectory()
â”‚ â”‚      self.temporary_directory_path = Path(self.temporary_directory.__enter__())
â”‚ â”‚  
â”‚ â”‚      await self._start_redpanda()
â”‚ â”‚ +    await asyncio.sleep(5)
â”‚ â”‚  
â”‚ â”‚      listener_port = self.redpanda_kwargs.get("listener_port", 9092)
â”‚ â”‚      bootstrap_server = f"127.0.0.1:{listener_port}"
â”‚ â”‚      logger.info(f"Local Redpanda broker up and running on {bootstrap_server}")
â”‚ â”‚  
â”‚ â”‚      await self._create_topics()
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/_testing/test_utils.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/_testing/test_utils.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka/testing.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka/testing.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka.egg-info/PKG-INFO
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka.egg-info/PKG-INFO
â”‚ â”‚â”„ Files 8% similar despite different names
â”‚ â”‚ @@ -1,10 +1,10 @@
â”‚ â”‚  Metadata-Version: 2.1
â”‚ â”‚  Name: fastkafka
â”‚ â”‚ -Version: 0.4.0rc0
â”‚ â”‚ +Version: 0.4.0rc1
â”‚ â”‚  Summary: FastKafka is a powerful and easy-to-use Python library for building asynchronous web services that interact with Kafka topics. Built on top of FastAPI, Starlette, Pydantic, AIOKafka and AsyncAPI, FastKafka simplifies the process of writing producers and consumers for Kafka topics.
â”‚ â”‚  Home-page: https://github.com/airtai/fastkafka
â”‚ â”‚  Author: airt
â”‚ â”‚  Author-email: info@airt.ai
â”‚ â”‚  License: Apache Software License 2.0
â”‚ â”‚  Project-URL: Bug Tracker, https://github.com/airtai/fastkafka/issues
â”‚ â”‚  Project-URL: CI, https://github.com/airtai/fastkafka/actions
â”‚ â”‚ @@ -60,20 +60,30 @@
â”‚ â”‚  With FastKafka, you can quickly prototype and develop high-performance
â”‚ â”‚  Kafka-based services with minimal code, making it an ideal choice for
â”‚ â”‚  developers looking to streamline their workflow and accelerate their
â”‚ â”‚  projects.
â”‚ â”‚  
â”‚ â”‚  ------------------------------------------------------------------------
â”‚ â”‚  
â”‚ â”‚ -#### â­ Stay in touch
â”‚ â”‚ +#### â­â­â­ Stay in touch â­â­â­
â”‚ â”‚  
â”‚ â”‚ -Please show your support and stay in touch by giving our [GitHub
â”‚ â”‚ -repository](https://github.com/airtai/fastkafka/) a star! Your support
â”‚ â”‚ -helps us to stay in touch with you and encourages us to continue
â”‚ â”‚ -developing and improving the library. Thank you for your support!
â”‚ â”‚ +Please show your support and stay in touch by:
â”‚ â”‚ +
â”‚ â”‚ +- giving our [GitHub repository](https://github.com/airtai/fastkafka/) a
â”‚ â”‚ +  star, and
â”‚ â”‚ +
â”‚ â”‚ +- joining our [Discord server](https://discord.gg/CJWmYpyFbc).
â”‚ â”‚ +
â”‚ â”‚ +Your support helps us to stay in touch with you and encourages us to
â”‚ â”‚ +continue developing and improving the library. Thank you for your
â”‚ â”‚ +support!
â”‚ â”‚ +
â”‚ â”‚ +------------------------------------------------------------------------
â”‚ â”‚ +
â”‚ â”‚ +#### ğŸğŸğŸ We were busy lately ğŸğŸğŸ
â”‚ â”‚  
â”‚ â”‚  ![Activity](https://repobeats.axiom.co/api/embed/21f36049093d5eb8e5fdad18c3c5d8df5428ca30.svg "Repobeats analytics image")
â”‚ â”‚  
â”‚ â”‚  ## Install
â”‚ â”‚  
â”‚ â”‚  FastKafka works on macOS, Linux, and most Unix-style operating systems.
â”‚ â”‚  You can install base version of `fastkafka` with `pip` as usual:
â”‚ â”‚ @@ -102,44 +112,54 @@
â”‚ â”‚  
â”‚ â”‚  ## Tutorial
â”‚ â”‚  
â”‚ â”‚  You can start an interactive tutorial in Google Colab by clicking the
â”‚ â”‚  button below:
â”‚ â”‚  
â”‚ â”‚  <a href="https://colab.research.google.com/github/airtai/fastkafka/blob/main/nbs/guides/Guide_00_FastKafka_Demo.ipynb" target=â€_blankâ€>
â”‚ â”‚ -<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
â”‚ â”‚ +<img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" />
â”‚ â”‚  </a>
â”‚ â”‚  
â”‚ â”‚  ## Writing server code
â”‚ â”‚  
â”‚ â”‚  Here is an example python script using FastKafka that takes data from a
â”‚ â”‚  Kafka topic, makes a prediction using a predictive model, and outputs
â”‚ â”‚  the prediction to another Kafka topic.
â”‚ â”‚  
â”‚ â”‚  ### Preparing the demo model
â”‚ â”‚  
â”‚ â”‚  First we will prepare our model using the Iris dataset so that we can
â”‚ â”‚  demonstrate the predictions using FastKafka. The following call
â”‚ â”‚  downloads the dataset and trains the model.
â”‚ â”‚  
â”‚ â”‚ +We will wrap the model creation into a lifespan of our app so that the
â”‚ â”‚ +model is created just before the app is started.
â”‚ â”‚ +
â”‚ â”‚  ``` python
â”‚ â”‚ +from contextlib import asynccontextmanager
â”‚ â”‚ +
â”‚ â”‚  from sklearn.datasets import load_iris
â”‚ â”‚  from sklearn.linear_model import LogisticRegression
â”‚ â”‚  
â”‚ â”‚ -X, y = load_iris(return_X_y=True)
â”‚ â”‚ -model = LogisticRegression(random_state=0, max_iter=500).fit(X, y)
â”‚ â”‚ -x = X[[0, 55, -1]]
â”‚ â”‚ -print(x)
â”‚ â”‚ -print(model.predict(x))
â”‚ â”‚ -```
â”‚ â”‚ +from fastkafka import FastKafka
â”‚ â”‚ +
â”‚ â”‚ +ml_models = {}
â”‚ â”‚  
â”‚ â”‚ -    [[5.1 3.5 1.4 0.2]
â”‚ â”‚ -     [5.7 2.8 4.5 1.3]
â”‚ â”‚ -     [5.9 3.  5.1 1.8]]
â”‚ â”‚ -    [0 1 2]
â”‚ â”‚ +
â”‚ â”‚ +@asynccontextmanager
â”‚ â”‚ +async def lifespan(app: FastKafka):
â”‚ â”‚ +    # Load the ML model
â”‚ â”‚ +    X, y = load_iris(return_X_y=True)
â”‚ â”‚ +    ml_models["iris_predictor"] = LogisticRegression(random_state=0, max_iter=500).fit(
â”‚ â”‚ +        X, y
â”‚ â”‚ +    )
â”‚ â”‚ +    yield
â”‚ â”‚ +    # Clean up the ML models and release the resources
â”‚ â”‚ +    ml_models.clear()
â”‚ â”‚ +```
â”‚ â”‚  
â”‚ â”‚  ### Messages
â”‚ â”‚  
â”‚ â”‚  FastKafka uses [Pydantic](https://docs.pydantic.dev/) to parse input
â”‚ â”‚  JSON-encoded data into Python objects, making it easy to work with
â”‚ â”‚  structured data in your Kafka-based applications. Pydanticâ€™s
â”‚ â”‚  [`BaseModel`](https://docs.pydantic.dev/usage/models/) class allows you
â”‚ â”‚ @@ -193,15 +213,15 @@
â”‚ â”‚  contains two entries: `"localhost"` and `"production"`, specifying local
â”‚ â”‚  development and production Kafka brokers. Each entry specifies the URL,
â”‚ â”‚  port, and other details of a Kafka broker. This dictionary is used for
â”‚ â”‚  both generating the documentation and later to run the actual server
â”‚ â”‚  against one of the given kafka broker.
â”‚ â”‚  
â”‚ â”‚  Next, an object of the
â”‚ â”‚ -[`FastKafka`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚ +[`FastKafka`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/FastKafka/#fastkafka.FastKafka)
â”‚ â”‚  class is initialized with the minimum set of arguments:
â”‚ â”‚  
â”‚ â”‚  - `kafka_brokers`: a dictionary used for generation of documentation
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka import FastKafka
â”‚ â”‚  
â”‚ â”‚ @@ -219,14 +239,15 @@
â”‚ â”‚          "security": {"type": "plain"},
â”‚ â”‚      },
â”‚ â”‚  }
â”‚ â”‚  
â”‚ â”‚  kafka_app = FastKafka(
â”‚ â”‚      title="Iris predictions",
â”‚ â”‚      kafka_brokers=kafka_brokers,
â”‚ â”‚ +    lifespan=lifespan,
â”‚ â”‚  )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ### Function decorators
â”‚ â”‚  
â”‚ â”‚  FastKafka provides convenient function decorators `@kafka_app.consumes`
â”‚ â”‚  and `@kafka_app.produces` to allow you to delegate the actual process of
â”‚ â”‚ @@ -264,15 +285,15 @@
â”‚ â”‚    The framework will call the `IrisPrediction.json().encode("utf-8")`
â”‚ â”‚    function on the returned value and produce it to the specified topic.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  @kafka_app.consumes(topic="input_data", auto_offset_reset="latest")
â”‚ â”‚  async def on_input_data(msg: IrisInputData):
â”‚ â”‚      global model
â”‚ â”‚ -    species_class = model.predict(
â”‚ â”‚ +    species_class = ml_models["iris_predictor"].predict(
â”‚ â”‚          [[msg.sepal_length, msg.sepal_width, msg.petal_length, msg.petal_width]]
â”‚ â”‚      )[0]
â”‚ â”‚  
â”‚ â”‚      to_predictions(species_class)
â”‚ â”‚  
â”‚ â”‚  
â”‚ â”‚  @kafka_app.produces(topic="predictions")
â”‚ â”‚ @@ -282,94 +303,83 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  ## Testing the service
â”‚ â”‚  
â”‚ â”‚  The service can be tested using the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -instances which internally starts Kafka broker and zookeeper.
â”‚ â”‚ -
â”‚ â”‚ -Before running tests, we have to install Java runtime and Apache Kafka
â”‚ â”‚ -locally. To simplify the process, we provide the following convenience
â”‚ â”‚ -command:
â”‚ â”‚ -
â”‚ â”‚ -``` sh
â”‚ â”‚ -fastkafka testing install_deps
â”‚ â”‚ -```
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Java...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - installing jdk...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies:  - jdk path: /home/kumaran/.jdk/jdk-11.0.18+10
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Installing Kafka...
â”‚ â”‚ -    832969it [00:02, 309324.60it/s]                                                 
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka installed in /home/kumaran/.local/kafka_2.13-3.3.2.
â”‚ â”‚ +[`Tester`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ +instances which internally starts InMemory implementation of Kafka
â”‚ â”‚ +broker.
â”‚ â”‚ +
â”‚ â”‚ +The Tester will redirect your consumes and produces decorated functions
â”‚ â”‚ +to the InMemory Kafka broker so that you can quickly test your app
â”‚ â”‚ +without the need for a running Kafka broker and all its dependencies.
â”‚ â”‚  
â”‚ â”‚  ``` python
â”‚ â”‚  from fastkafka.testing import Tester
â”‚ â”‚  
â”‚ â”‚  msg = IrisInputData(
â”‚ â”‚      sepal_length=0.1,
â”‚ â”‚      sepal_width=0.2,
â”‚ â”‚      petal_length=0.3,
â”‚ â”‚      petal_width=0.4,
â”‚ â”‚  )
â”‚ â”‚  
â”‚ â”‚ -# Start Tester app and create local Kafka broker for testing
â”‚ â”‚ +# Start Tester app and create InMemory Kafka broker for testing
â”‚ â”‚  async with Tester(kafka_app) as tester:
â”‚ â”‚      # Send IrisInputData message to input_data topic
â”‚ â”‚      await tester.to_input_data(msg)
â”‚ â”‚  
â”‚ â”‚      # Assert that the kafka_app responded with IrisPrediction in predictions topic
â”‚ â”‚      await tester.awaited_mocks.on_predictions.assert_awaited_with(
â”‚ â”‚          IrisPrediction(species="setosa"), timeout=2
â”‚ â”‚      )
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._start() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._patch_consumers_and_producers(): Patching consumers and producers!
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker starting
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': '127.0.0.1:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['input_data']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': '127.0.0.1:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'earliest', 'max_poll_records': 100}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched start() called()
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'predictions'})
â”‚ â”‚ -    [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'predictions'}
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched subscribe() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer.subscribe(), subscribing to: ['predictions']
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'predictions': 1}. 
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaConsumer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: AIOKafkaProducer patched stop() called
â”‚ â”‚      [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 547...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 547 terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 173...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 173 terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker._stop() called
â”‚ â”‚ +    [INFO] fastkafka._testing.in_memory_broker: InMemoryBroker stopping
â”‚ â”‚  
â”‚ â”‚  ### Recap
â”‚ â”‚  
â”‚ â”‚  We have created a Iris classification model and encapulated it into our
â”‚ â”‚  fastkafka application. The app will consume the IrisInputData from the
â”‚ â”‚  `input_data` topic and produce the predictions to `predictions` topic.
â”‚ â”‚  
â”‚ â”‚ @@ -453,129 +463,155 @@
â”‚ â”‚      prediction = IrisPrediction(species=iris_species[species_class])
â”‚ â”‚      return prediction
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  To run the service, you will need a running Kafka broker on localhost as
â”‚ â”‚  specified in the `kafka_brokers` parameter above. We can start the Kafka
â”‚ â”‚  broker locally using the
â”‚ â”‚ -[`LocalKafkaBroker`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/LocalKafkaBroker/#fastkafka.testing.LocalKafkaBroker).
â”‚ â”‚ -Notice that the same happens automatically in the
â”‚ â”‚ -[`Tester`](https://airtai.github.io/fastkafka/0.3.0/api/fastkafka/testing/Tester/#fastkafka.testing.Tester)
â”‚ â”‚ -as shown above.
â”‚ â”‚ -
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): entering...
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ -    [WARNING] fastkafka._testing.local_broker: LocalKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker).
â”‚ â”‚ +
â”‚ â”‚ +To use
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker),
â”‚ â”‚ +you need to install JRE and Kafka to your environment. To simplify this
â”‚ â”‚ +process, fastkafka comes with a CLI command that does just that, to run
â”‚ â”‚ +it, in your terminal execute the following:
â”‚ â”‚ +
â”‚ â”‚ +``` sh
â”‚ â”‚ +fastkafka testing install_deps
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +Now we can run
â”‚ â”‚ +[`ApacheKafkaBroker`](https://airtai.github.io/fastkafka/0.4.0rc1/api/fastkafka/testing/ApacheKafkaBroker/#fastkafka.testing.ApacheKafkaBroker)
â”‚ â”‚ +that will start a Kafka broker instance for us.
â”‚ â”‚ +
â”‚ â”‚ +``` python
â”‚ â”‚ +from fastkafka.testing import ApacheKafkaBroker
â”‚ â”‚ +
â”‚ â”‚ +broker = ApacheKafkaBroker(apply_nest_asyncio=True)
â”‚ â”‚ +
â”‚ â”‚ +broker.start()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): entering...
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): (<_UnixSelectorEventLoop running=True closed=False debug=False>) is already running!
â”‚ â”‚ +    [WARNING] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): calling nest_asyncio.apply()
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Java is already installed.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚      [INFO] fastkafka._components.test_dependencies: Kafka is installed.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting zookeeper...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Starting kafka...
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: <class 'fastkafka.testing.LocalKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.start(): exited.
â”‚ â”‚ +    [INFO] fastkafka._components.test_dependencies: But not exported to PATH, exporting...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting zookeeper...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Starting kafka...
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: Local Kafka broker up and running on 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: <class 'fastkafka.testing.ApacheKafkaBroker'>.start(): returning 127.0.0.1:9092
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.start(): exited.
â”‚ â”‚  
â”‚ â”‚      '127.0.0.1:9092'
â”‚ â”‚  
â”‚ â”‚  Then, we start the FastKafka service by running the following command in
â”‚ â”‚  the folder where the `application.py` file is located:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka run --num-workers=2 --kafka-broker localhost application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚  In the above command, we use `--num-workers` option to specify how many
â”‚ â”‚  workers to launch and we use `--kafka-broker` option to specify which
â”‚ â”‚  kafka broker configuration to use from earlier specified `kafka_brokers`
â”‚ â”‚  
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ -    [2561]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ -    [2561]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2559]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ -    [2559]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.22.0.2', 9092)
â”‚ â”‚ -    [2561]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ -    [2559]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: set_kafka_broker() : Setting bootstrap_servers value to 'localhost:9092'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._application.app: _create_producer() : created producer using the config: '{'bootstrap_servers': 'localhost:9092'}'
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Starting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.start(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() starting...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer created using the following parameters: {'bootstrap_servers': 'localhost:9092', 'auto_offset_reset': 'latest', 'max_poll_records': 100}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer started.
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.subscription_state: Updating subscribed topics to: frozenset({'input_data'})
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.consumer: Subscribed to topic(s): {'input_data'}
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer subscribed.
â”‚ â”‚ +    [558863]: [ERROR] aiokafka.cluster: Topic input_data not found in cluster metadata
â”‚ â”‚ +    [558863]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [WARNING] aiokafka.cluster: Topic input_data is not available during auto-create initialization
â”‚ â”‚ +    [558865]: [INFO] aiokafka.consumer.group_coordinator: Metadata for topic has changed from {} to {'input_data': 0}. 
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable connect to node with id 0: [Errno 111] Connect call failed ('172.26.0.2', 9092)
â”‚ â”‚ +    [558865]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚ +    [558863]: [ERROR] aiokafka: Unable to update metadata from [0]
â”‚ â”‚      ^C
â”‚ â”‚      Starting process cleanup, this may take a few seconds...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2559...
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 2561...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2561]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ -    [2559]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2561 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._server: terminate_asyncio_process(): Process 2559 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558863...
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Terminating the process 558865...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558863]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop(): Consumer stopped.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_consumer_loop: aiokafka_consumer_loop() finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Entering...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Exiting send_stream
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: _aiokafka_producer_manager(): Finished.
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Stoping producer...
â”‚ â”‚ +    [558865]: [INFO] fastkafka._components.aiokafka_producer_manager: AIOKafkaProducerManager.stop(): Finished
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558863 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._server: terminate_asyncio_process(): Process 558865 was already terminated.
â”‚ â”‚  
â”‚ â”‚  You need to interupt running of the cell above by selecting
â”‚ â”‚  `Runtime->Interupt execution` on the toolbar above.
â”‚ â”‚  
â”‚ â”‚  Finally, we can stop the local Kafka Broker:
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): entering...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 2098...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 2098 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 1725...
â”‚ â”‚ -    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 1725 was already terminated.
â”‚ â”‚ -    [INFO] fastkafka._testing.local_broker: LocalKafkaBroker.stop(): exited.
â”‚ â”‚ +``` python
â”‚ â”‚ +broker.stop()
â”‚ â”‚ +```
â”‚ â”‚ +
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): entering...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 558265...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 558265 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Terminating the process 557885...
â”‚ â”‚ +    [INFO] fastkafka._components._subprocess: terminate_asyncio_process(): Process 557885 was already terminated.
â”‚ â”‚ +    [INFO] fastkafka._testing.apache_kafka_broker: ApacheKafkaBroker.stop(): exited.
â”‚ â”‚  
â”‚ â”‚  ## Documentation
â”‚ â”‚  
â”‚ â”‚  The kafka app comes with builtin documentation generation using
â”‚ â”‚  [AsyncApi HTML generator](https://www.asyncapi.com/tools/generator).
â”‚ â”‚  
â”‚ â”‚  AsyncApi requires Node.js to be installed and we provide the following
â”‚ â”‚  convenience command line for it:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs install_deps
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ -    [INFO] fastkafka._components.asyncapi: AsyncAPI generator installed
â”‚ â”‚ +    [INFO] fastkafka._components.docs_dependencies: AsyncAPI generator installed
â”‚ â”‚  
â”‚ â”‚  To generate the documentation programatically you just need to call the
â”‚ â”‚  folloving command:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  fastkafka docs generate application:kafka_app
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚ +    [INFO] fastkafka._components.asyncapi: Old async specifications at '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml' does not exist.
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: New async specifications generated at: '/work/fastkafka/nbs/asyncapi/spec/asyncapi.yml'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Async docs generated at 'asyncapi/docs'
â”‚ â”‚      [INFO] fastkafka._components.asyncapi: Output of '$ npx -y -p @asyncapi/generator ag asyncapi/spec/asyncapi.yml @asyncapi/html-template -o asyncapi/docs --force-write'
â”‚ â”‚  
â”‚ â”‚      Done! âœ¨
â”‚ â”‚      Check out your shiny new generated files at /work/fastkafka/nbs/asyncapi/docs.
â”‚ â”‚  
â”‚ â”‚ @@ -584,16 +620,16 @@
â”‚ â”‚  with:
â”‚ â”‚  
â”‚ â”‚  ``` sh
â”‚ â”‚  ls -l asyncapi
â”‚ â”‚  ```
â”‚ â”‚  
â”‚ â”‚      total 8
â”‚ â”‚ -    drwxrwxr-x 4 kumaran kumaran 4096 Mar 21 09:14 docs
â”‚ â”‚ -    drwxrwxr-x 2 kumaran kumaran 4096 Mar 21 09:14 spec
â”‚ â”‚ +    drwxrwxr-x 4 tvrtko tvrtko 4096 Apr  5 08:02 docs
â”‚ â”‚ +    drwxrwxr-x 2 tvrtko tvrtko 4096 Apr  5 08:02 spec
â”‚ â”‚  
â”‚ â”‚  In docs folder you will find the servable static html file of your
â”‚ â”‚  documentation. This can also be served using our `fastkafka docs serve`
â”‚ â”‚  CLI command (more on that in our guides).
â”‚ â”‚  
â”‚ â”‚  In spec folder you will find a asyncapi.yml file containing the async
â”‚ â”‚  API specification of your application.
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka.egg-info/SOURCES.txt
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka.egg-info/SOURCES.txt
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/fastkafka.egg-info/requires.txt
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/fastkafka.egg-info/requires.txt
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- fastkafka-0.4.0rc0/settings.ini
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/settings.ini
â”‚ â”‚â”„ Files 2% similar despite different names
â”‚ â”‚ @@ -1,15 +1,15 @@
â”‚ â”‚  [DEFAULT]
â”‚ â”‚  # All sections below are required unless otherwise specified.
â”‚ â”‚  # See https://github.com/fastai/nbdev/blob/master/settings.ini for examples.
â”‚ â”‚  
â”‚ â”‚  ### Python library ###
â”‚ â”‚  repo = fastkafka
â”‚ â”‚  lib_name = %(repo)s
â”‚ â”‚ -version = 0.4.0rc0
â”‚ â”‚ +version = 0.4.0rc1
â”‚ â”‚  min_python = 3.8
â”‚ â”‚  license = apache2
â”‚ â”‚  
â”‚ â”‚  
â”‚ â”‚  ### nbdev ###
â”‚ â”‚  doc_path = _docs
â”‚ â”‚  lib_path = fastkafka
â”‚ â”‚   --- fastkafka-0.4.0rc0/setup.py
â”‚ â”œâ”€â”€ +++ fastkafka-0.4.0rc1/setup.py
â”‚ â”‚â”„ Files identical despite different names
