--- tmp/drakaina-0.6.8.tar.gz
+++ tmp/drakaina-0.6.9.tar.gz
â”œâ”€â”€ filetype from file(1)
â”‚ @@ -1 +1 @@
â”‚ -gzip compressed data, was "drakaina-0.6.8.tar", max compression
â”‚ +gzip compressed data, was "drakaina-0.6.9.tar", max compression
â”‚   --- drakaina-0.6.8.tar
â”œâ”€â”€ +++ drakaina-0.6.9.tar
â”‚ â”œâ”€â”€ file list
â”‚ â”‚ @@ -1,43 +1,43 @@
â”‚ â”‚ --rw-r--r--   0        0        0     9542 2023-04-05 08:32:48.122842 drakaina-0.6.8/drakaina/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     5953 2023-04-04 20:58:00.642760 drakaina-0.6.8/drakaina/_types.py
â”‚ â”‚ --rw-r--r--   0        0        0     1494 2023-01-27 12:48:38.216236 drakaina-0.6.8/drakaina/asgi.py
â”‚ â”‚ --rw-r--r--   0        0        0     3699 2023-02-13 13:22:12.183448 drakaina-0.6.8/drakaina/client/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     6158 2022-07-08 05:47:38.000000 drakaina-0.6.8/drakaina/client/base.py
â”‚ â”‚ --rw-r--r--   0        0        0     1832 2022-07-08 05:47:38.000000 drakaina-0.6.8/drakaina/client/http.py
â”‚ â”‚ --rw-r--r--   0        0        0    11280 2023-01-27 12:55:37.114745 drakaina-0.6.8/drakaina/client/tcp.py
â”‚ â”‚ --rw-r--r--   0        0        0     8797 2022-07-08 05:47:38.000000 drakaina-0.6.8/drakaina/client/websocket.py
â”‚ â”‚ --rw-r--r--   0        0        0        0 2023-01-24 15:15:01.981448 drakaina-0.6.8/drakaina/contrib/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     1225 2023-04-04 16:39:30.455695 drakaina-0.6.8/drakaina/contrib/django/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     1670 2023-04-04 16:03:12.444188 drakaina-0.6.8/drakaina/contrib/django/__rpc_methods.py
â”‚ â”‚ --rw-r--r--   0        0        0     6176 2023-04-05 13:26:05.508215 drakaina-0.6.8/drakaina/contrib/django/middleware.py
â”‚ â”‚ --rw-r--r--   0        0        0     3182 2023-04-05 13:26:05.517214 drakaina-0.6.8/drakaina/contrib/django/views.py
â”‚ â”‚ --rw-r--r--   0        0        0      340 2023-04-05 08:32:48.122842 drakaina-0.6.8/drakaina/contrib/jwt/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     4831 2023-02-21 13:52:45.250648 drakaina-0.6.8/drakaina/contrib/jwt/auth_procedures.py
â”‚ â”‚ --rw-r--r--   0        0        0      348 2023-03-10 11:02:10.213372 drakaina-0.6.8/drakaina/contrib/jwt/errors.py
â”‚ â”‚ --rw-r--r--   0        0        0     9194 2023-04-05 08:32:48.124842 drakaina-0.6.8/drakaina/contrib/jwt/middleware.py
â”‚ â”‚ --rw-r--r--   0        0        0      913 2023-04-03 15:58:34.495338 drakaina-0.6.8/drakaina/contrib/jwt/types.py
â”‚ â”‚ --rw-r--r--   0        0        0    11148 2023-04-05 10:54:01.194233 drakaina-0.6.8/drakaina/contrib/jwt/utils.py
â”‚ â”‚ --rw-r--r--   0        0        0     1147 2023-04-05 18:02:08.709862 drakaina-0.6.8/drakaina/exceptions.py
â”‚ â”‚ --rw-r--r--   0        0        0      357 2023-04-04 11:19:41.564726 drakaina-0.6.8/drakaina/middleware/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     1378 2023-03-29 21:57:07.601330 drakaina-0.6.8/drakaina/middleware/base.py
â”‚ â”‚ --rw-r--r--   0        0        0     7586 2023-04-05 08:32:48.126844 drakaina-0.6.8/drakaina/middleware/cors.py
â”‚ â”‚ --rw-r--r--   0        0        0     2112 2023-04-05 08:32:48.126844 drakaina-0.6.8/drakaina/middleware/exception.py
â”‚ â”‚ --rw-r--r--   0        0        0      406 2023-04-04 11:19:41.598921 drakaina-0.6.8/drakaina/middleware/gzip.py
â”‚ â”‚ --rw-r--r--   0        0        0      983 2023-04-04 11:19:41.525282 drakaina-0.6.8/drakaina/middleware/logging.py
â”‚ â”‚ --rw-r--r--   0        0        0     1138 2023-01-18 00:52:37.644550 drakaina-0.6.8/drakaina/middleware/openapi/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     1079 2023-04-04 11:19:41.580823 drakaina-0.6.8/drakaina/middleware/request_wrapper.py
â”‚ â”‚ --rw-r--r--   0        0        0     3678 2023-04-05 08:32:48.127841 drakaina-0.6.8/drakaina/registries.py
â”‚ â”‚ --rw-r--r--   0        0        0      155 2023-03-02 17:41:49.563857 drakaina-0.6.8/drakaina/rpc_protocols/__init__.py
â”‚ â”‚ --rw-r--r--   0        0        0     4128 2023-04-06 11:06:25.511203 drakaina-0.6.8/drakaina/rpc_protocols/base.py
â”‚ â”‚ --rw-r--r--   0        0        0     8777 2023-04-06 10:57:47.842893 drakaina-0.6.8/drakaina/rpc_protocols/jsonrpc20.py
â”‚ â”‚ --rw-r--r--   0        0        0      200 2023-01-09 10:12:10.047554 drakaina-0.6.8/drakaina/rsgi.py
â”‚ â”‚ --rw-r--r--   0        0        0     4646 2023-02-27 17:00:44.197509 drakaina-0.6.8/drakaina/serializers.py
â”‚ â”‚ --rw-r--r--   0        0        0    11142 2023-01-27 12:51:42.029067 drakaina-0.6.8/drakaina/tcp.py
â”‚ â”‚ --rw-r--r--   0        0        0      937 2023-04-05 08:32:48.128841 drakaina-0.6.8/drakaina/utils.py
â”‚ â”‚ --rw-r--r--   0        0        0      162 2023-01-25 16:44:10.299855 drakaina-0.6.8/drakaina/ws.py
â”‚ â”‚ --rw-r--r--   0        0        0     7896 2023-04-05 08:32:48.129839 drakaina-0.6.8/drakaina/wsgi.py
â”‚ â”‚ --rw-r--r--   0        0        0    11372 2023-01-24 23:31:45.206801 drakaina-0.6.8/LICENSE
â”‚ â”‚ --rw-r--r--   0        0        0     2461 2023-04-06 11:11:40.331682 drakaina-0.6.8/pyproject.toml
â”‚ â”‚ --rw-r--r--   0        0        0     5017 2023-04-05 08:32:48.121846 drakaina-0.6.8/README.md
â”‚ â”‚ --rw-r--r--   0        0        0     6109 1970-01-01 00:00:00.000000 drakaina-0.6.8/setup.py
â”‚ â”‚ --rw-r--r--   0        0        0     6371 1970-01-01 00:00:00.000000 drakaina-0.6.8/PKG-INFO
â”‚ â”‚ +-rw-r--r--   0        0        0     9542 2023-04-06 14:03:56.083341 drakaina-0.6.9/drakaina/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     5953 2023-04-04 20:58:00.642760 drakaina-0.6.9/drakaina/_types.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1494 2023-01-27 12:48:38.216236 drakaina-0.6.9/drakaina/asgi.py
â”‚ â”‚ +-rw-r--r--   0        0        0     3699 2023-02-13 13:22:12.183448 drakaina-0.6.9/drakaina/client/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     6158 2022-07-08 05:47:38.000000 drakaina-0.6.9/drakaina/client/base.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1832 2022-07-08 05:47:38.000000 drakaina-0.6.9/drakaina/client/http.py
â”‚ â”‚ +-rw-r--r--   0        0        0    11280 2023-01-27 12:55:37.114745 drakaina-0.6.9/drakaina/client/tcp.py
â”‚ â”‚ +-rw-r--r--   0        0        0     8797 2022-07-08 05:47:38.000000 drakaina-0.6.9/drakaina/client/websocket.py
â”‚ â”‚ +-rw-r--r--   0        0        0        0 2023-01-24 15:15:01.981448 drakaina-0.6.9/drakaina/contrib/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1225 2023-04-04 16:39:30.455695 drakaina-0.6.9/drakaina/contrib/django/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1670 2023-04-04 16:03:12.444188 drakaina-0.6.9/drakaina/contrib/django/__rpc_methods.py
â”‚ â”‚ +-rw-r--r--   0        0        0     6176 2023-04-05 13:26:05.508215 drakaina-0.6.9/drakaina/contrib/django/middleware.py
â”‚ â”‚ +-rw-r--r--   0        0        0     3182 2023-04-05 13:26:05.517214 drakaina-0.6.9/drakaina/contrib/django/views.py
â”‚ â”‚ +-rw-r--r--   0        0        0      340 2023-04-06 13:41:31.135135 drakaina-0.6.9/drakaina/contrib/jwt/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     4831 2023-02-21 13:52:45.250648 drakaina-0.6.9/drakaina/contrib/jwt/auth_procedures.py
â”‚ â”‚ +-rw-r--r--   0        0        0      348 2023-03-10 11:02:10.213372 drakaina-0.6.9/drakaina/contrib/jwt/errors.py
â”‚ â”‚ +-rw-r--r--   0        0        0     9194 2023-04-06 14:03:56.084341 drakaina-0.6.9/drakaina/contrib/jwt/middleware.py
â”‚ â”‚ +-rw-r--r--   0        0        0      913 2023-04-03 15:58:34.495338 drakaina-0.6.9/drakaina/contrib/jwt/types.py
â”‚ â”‚ +-rw-r--r--   0        0        0    11530 2023-04-06 14:03:56.084341 drakaina-0.6.9/drakaina/contrib/jwt/utils.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1147 2023-04-05 18:02:08.709862 drakaina-0.6.9/drakaina/exceptions.py
â”‚ â”‚ +-rw-r--r--   0        0        0      357 2023-04-04 11:19:41.564726 drakaina-0.6.9/drakaina/middleware/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1378 2023-03-29 21:57:07.601330 drakaina-0.6.9/drakaina/middleware/base.py
â”‚ â”‚ +-rw-r--r--   0        0        0     7586 2023-04-06 14:03:56.085341 drakaina-0.6.9/drakaina/middleware/cors.py
â”‚ â”‚ +-rw-r--r--   0        0        0     2112 2023-04-06 14:03:56.086341 drakaina-0.6.9/drakaina/middleware/exception.py
â”‚ â”‚ +-rw-r--r--   0        0        0      406 2023-04-04 11:19:41.598921 drakaina-0.6.9/drakaina/middleware/gzip.py
â”‚ â”‚ +-rw-r--r--   0        0        0      983 2023-04-04 11:19:41.525282 drakaina-0.6.9/drakaina/middleware/logging.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1138 2023-01-18 00:52:37.644550 drakaina-0.6.9/drakaina/middleware/openapi/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     1079 2023-04-04 11:19:41.580823 drakaina-0.6.9/drakaina/middleware/request_wrapper.py
â”‚ â”‚ +-rw-r--r--   0        0        0     3678 2023-04-06 14:03:56.086341 drakaina-0.6.9/drakaina/registries.py
â”‚ â”‚ +-rw-r--r--   0        0        0      155 2023-03-02 17:41:49.563857 drakaina-0.6.9/drakaina/rpc_protocols/__init__.py
â”‚ â”‚ +-rw-r--r--   0        0        0     4767 2023-04-06 14:00:17.561234 drakaina-0.6.9/drakaina/rpc_protocols/base.py
â”‚ â”‚ +-rw-r--r--   0        0        0     8968 2023-04-06 14:00:17.568229 drakaina-0.6.9/drakaina/rpc_protocols/jsonrpc20.py
â”‚ â”‚ +-rw-r--r--   0        0        0      200 2023-01-09 10:12:10.047554 drakaina-0.6.9/drakaina/rsgi.py
â”‚ â”‚ +-rw-r--r--   0        0        0     4646 2023-02-27 17:00:44.197509 drakaina-0.6.9/drakaina/serializers.py
â”‚ â”‚ +-rw-r--r--   0        0        0    11142 2023-01-27 12:51:42.029067 drakaina-0.6.9/drakaina/tcp.py
â”‚ â”‚ +-rw-r--r--   0        0        0      937 2023-04-06 14:03:56.086869 drakaina-0.6.9/drakaina/utils.py
â”‚ â”‚ +-rw-r--r--   0        0        0      162 2023-01-25 16:44:10.299855 drakaina-0.6.9/drakaina/ws.py
â”‚ â”‚ +-rw-r--r--   0        0        0     7896 2023-04-06 14:03:56.086869 drakaina-0.6.9/drakaina/wsgi.py
â”‚ â”‚ +-rw-r--r--   0        0        0    11372 2023-01-24 23:31:45.206801 drakaina-0.6.9/LICENSE
â”‚ â”‚ +-rw-r--r--   0        0        0     2461 2023-04-06 12:11:59.718408 drakaina-0.6.9/pyproject.toml
â”‚ â”‚ +-rw-r--r--   0        0        0     5017 2023-04-06 14:03:56.083341 drakaina-0.6.9/README.md
â”‚ â”‚ +-rw-r--r--   0        0        0     6109 1970-01-01 00:00:00.000000 drakaina-0.6.9/setup.py
â”‚ â”‚ +-rw-r--r--   0        0        0     6371 1970-01-01 00:00:00.000000 drakaina-0.6.9/PKG-INFO
â”‚ â”‚   --- drakaina-0.6.8/drakaina/__init__.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/__init__.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/_types.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/_types.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/asgi.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/asgi.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/client/__init__.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/client/__init__.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/client/base.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/client/base.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/client/http.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/client/http.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/client/tcp.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/client/tcp.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/client/websocket.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/client/websocket.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/django/__init__.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/django/__init__.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/django/__rpc_methods.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/django/__rpc_methods.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/django/middleware.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/django/middleware.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/django/views.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/django/views.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/jwt/auth_procedures.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/jwt/auth_procedures.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/jwt/middleware.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/jwt/middleware.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/contrib/jwt/types.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/contrib/jwt/types.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/exceptions.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/exceptions.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/base.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/base.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/cors.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/cors.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/exception.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/exception.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/logging.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/logging.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/openapi/__init__.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/openapi/__init__.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/middleware/request_wrapper.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/middleware/request_wrapper.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/registries.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/registries.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/rpc_protocols/base.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/rpc_protocols/base.py
â”‚ â”‚â”„ Files 16% similar despite different names
â”‚ â”‚ @@ -1,11 +1,11 @@
â”‚ â”‚ +from __future__ import annotations
â”‚ â”‚ +
â”‚ â”‚  from typing import Any
â”‚ â”‚ -from typing import Optional
â”‚ â”‚  from typing import Type
â”‚ â”‚ -from typing import Union
â”‚ â”‚  
â”‚ â”‚  from drakaina import rpc_registry
â”‚ â”‚  from drakaina.exceptions import InternalServerError
â”‚ â”‚  from drakaina.exceptions import RPCError
â”‚ â”‚  from drakaina.registries import RPCRegistry
â”‚ â”‚  from drakaina.serializers import BaseSerializer
â”‚ â”‚  
â”‚ â”‚ @@ -25,39 +25,39 @@
â”‚ â”‚  
â”‚ â”‚      """
â”‚ â”‚  
â”‚ â”‚      __slots__ = ("registry", "serializer", "_errors_map")
â”‚ â”‚  
â”‚ â”‚      def __init__(
â”‚ â”‚          self,
â”‚ â”‚ -        registry: Optional[RPCRegistry] = None,
â”‚ â”‚ -        serializer: Optional[BaseSerializer] = None,
â”‚ â”‚ +        registry: RPCRegistry | None = None,
â”‚ â”‚ +        serializer: BaseSerializer | None = None,
â”‚ â”‚      ):
â”‚ â”‚          self.registry = registry if registry is not None else rpc_registry
â”‚ â”‚          self.serializer = serializer
â”‚ â”‚  
â”‚ â”‚          self._errors_map = {Exception: RPCError}
â”‚ â”‚  
â”‚ â”‚      def handle_raw_request(
â”‚ â”‚          self,
â”‚ â”‚          raw_data: bytes,
â”‚ â”‚ -        request: Optional[Any] = None,
â”‚ â”‚ +        request: Any | None = None,
â”‚ â”‚      ) -> bytes:
â”‚ â”‚ -        """Accepts raw data, serializes, processes the RPC request,
â”‚ â”‚ -        and returns the deserialized result.
â”‚ â”‚ +        """Accepts raw data, deserializes, processes the RPC request,
â”‚ â”‚ +        and returns the serialized result.
â”‚ â”‚  
â”‚ â”‚          :param raw_data:
â”‚ â”‚              Raw request data.
â”‚ â”‚          :type raw_data:
â”‚ â”‚          :param request:
â”‚ â”‚              Request object or context data. Can be provided to
â”‚ â”‚              a remote procedure.
â”‚ â”‚          :type request: Any
â”‚ â”‚          :return:
â”‚ â”‚ -            Deserialized RPC response data.
â”‚ â”‚ +            Serialized RPC response data.
â”‚ â”‚  
â”‚ â”‚          """
â”‚ â”‚          try:
â”‚ â”‚              parsed_data = self.serializer.deserialize(raw_data)
â”‚ â”‚          except Exception as exc:
â”‚ â”‚              return self.get_raw_error(exc)
â”‚ â”‚  
â”‚ â”‚ @@ -68,41 +68,29 @@
â”‚ â”‚          try:
â”‚ â”‚              return self.serializer.serialize(response_data)
â”‚ â”‚          except Exception as exc:
â”‚ â”‚              return self.get_raw_error(exc)
â”‚ â”‚  
â”‚ â”‚      def get_raw_error(
â”‚ â”‚          self,
â”‚ â”‚ -        error: Union[RPCError, Exception, Type[Exception]],
â”‚ â”‚ +        error: RPCError | Type[RPCError] | Exception | Type[Exception],
â”‚ â”‚      ) -> bytes:
â”‚ â”‚ -        """Returns the deserialized error object.
â”‚ â”‚ +        """Returns the serialized error object.
â”‚ â”‚  
â”‚ â”‚          :param error:
â”‚ â”‚              The instance or class of the error.
â”‚ â”‚ -        :type error: RPCError | Type[RPCError] | Exception
â”‚ â”‚ +        :type error: RPCError | Type[RPCError] | Exception | Type[Exception]
â”‚ â”‚          :return:
â”‚ â”‚              Raw error data.
â”‚ â”‚  
â”‚ â”‚          """
â”‚ â”‚ -
â”‚ â”‚ -        if isinstance(error, type) and issubclass(error, Exception):
â”‚ â”‚ -            error = error()
â”‚ â”‚ -
â”‚ â”‚ -        if isinstance(error, self.base_error_class):
â”‚ â”‚ -            rpc_error = error
â”‚ â”‚ -        else:
â”‚ â”‚ -            rpc_error_class = self._errors_map.get(
â”‚ â”‚ -                type(error),
â”‚ â”‚ -                self.default_error_class,
â”‚ â”‚ -            )
â”‚ â”‚ -            rpc_error = rpc_error_class(str(error))
â”‚ â”‚ -
â”‚ â”‚ +        rpc_error = self.handle_error(error)
â”‚ â”‚          return self.serializer.serialize(rpc_error.as_dict())
â”‚ â”‚  
â”‚ â”‚ -    def handle(self, rpc_request: Any, request: Optional[Any] = None) -> Any:
â”‚ â”‚ +    def handle(self, rpc_request: Any, request: Any | None = None) -> Any:
â”‚ â”‚          """Handles a procedure call.
â”‚ â”‚  
â”‚ â”‚          :param rpc_request:
â”‚ â”‚              RPC request in protocol format.
â”‚ â”‚          :param request:
â”‚ â”‚              Optional parameter that can be passed as an
â”‚ â”‚              argument to the procedure. By default, None will be passed.
â”‚ â”‚ @@ -110,20 +98,48 @@
â”‚ â”‚              Returns the result in protocol format.
â”‚ â”‚  
â”‚ â”‚          """
â”‚ â”‚          raise NotImplementedError(
â”‚ â”‚              "You must implement the `handle` method in the child class",
â”‚ â”‚          )
â”‚ â”‚  
â”‚ â”‚ +    def handle_error(
â”‚ â”‚ +        self,
â”‚ â”‚ +        error: RPCError | Type[RPCError] | Exception | Type[Exception],
â”‚ â”‚ +    ) -> RPCError:
â”‚ â”‚ +        """Returns an exception object corresponding to the ROC protocol.
â”‚ â”‚ +
â”‚ â”‚ +        :param error:
â”‚ â”‚ +            The instance or class of the error.
â”‚ â”‚ +        :type error: RPCError | Type[RPCError] | Exception | Type[Exception]
â”‚ â”‚ +        :returns: Protocol specific error object.
â”‚ â”‚ +        :rtype: RPCError
â”‚ â”‚ +
â”‚ â”‚ +        """
â”‚ â”‚ +
â”‚ â”‚ +        if isinstance(error, type) and issubclass(error, Exception):
â”‚ â”‚ +            error = error()
â”‚ â”‚ +
â”‚ â”‚ +        if isinstance(error, self.base_error_class):
â”‚ â”‚ +            return error
â”‚ â”‚ +        else:
â”‚ â”‚ +            rpc_error_class = self._errors_map.get(
â”‚ â”‚ +                type(error),
â”‚ â”‚ +                self.default_error_class,
â”‚ â”‚ +            )
â”‚ â”‚ +            return rpc_error_class(str(error))
â”‚ â”‚ +
â”‚ â”‚      @property
â”‚ â”‚ -    def base_error_class(self):
â”‚ â”‚ +    def base_error_class(self) -> Type[RPCError]:
â”‚ â”‚ +        """Base class for RPC protocol implementation."""
â”‚ â”‚          return RPCError
â”‚ â”‚  
â”‚ â”‚      @property
â”‚ â”‚ -    def default_error_class(self):
â”‚ â”‚ +    def default_error_class(self) -> Type[RPCError]:
â”‚ â”‚ +        """The default error class for representing internal exceptions."""
â”‚ â”‚          return InternalServerError
â”‚ â”‚  
â”‚ â”‚      @property
â”‚ â”‚      def content_type(self) -> str:
â”‚ â”‚          return self.serializer.content_type
â”‚ â”‚  
â”‚ â”‚      def smd_scheme(self) -> bytes:
â”‚ â”‚   --- drakaina-0.6.8/drakaina/rpc_protocols/jsonrpc20.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/rpc_protocols/jsonrpc20.py
â”‚ â”‚â”„ Files 7% similar despite different names
â”‚ â”‚ @@ -1,10 +1,11 @@
â”‚ â”‚ +from __future__ import annotations
â”‚ â”‚ +
â”‚ â”‚  from typing import Any
â”‚ â”‚ -from typing import Optional
â”‚ â”‚ -from typing import Union
â”‚ â”‚ +from typing import Type
â”‚ â”‚  
â”‚ â”‚  from drakaina._types import JSONRPCRequest
â”‚ â”‚  from drakaina._types import JSONRPCRequestObject
â”‚ â”‚  from drakaina._types import JSONRPCResponse
â”‚ â”‚  from drakaina._types import JSONRPCResponseObject
â”‚ â”‚  from drakaina.exceptions import AuthenticationFailedError
â”‚ â”‚  from drakaina.exceptions import BadRequestError
â”‚ â”‚ @@ -29,23 +30,23 @@
â”‚ â”‚      Reserved for implementation-defined server-errors.
â”‚ â”‚      Codes -32000 to -32099.
â”‚ â”‚  
â”‚ â”‚      """
â”‚ â”‚  
â”‚ â”‚      code: int = -32000
â”‚ â”‚      default_message: str = "Server error"
â”‚ â”‚ -    id: Union[int, str] = None
â”‚ â”‚ +    id: int | str = None
â”‚ â”‚      data: Any = None
â”‚ â”‚  
â”‚ â”‚      def __init__(
â”‚ â”‚          self,
â”‚ â”‚          *args,
â”‚ â”‚          message: str = None,
â”‚ â”‚ -        id: Union[int, str] = None,
â”‚ â”‚ -        data: Optional[Any] = None,
â”‚ â”‚ +        id: int | str = None,
â”‚ â”‚ +        data: Any | None = None,
â”‚ â”‚      ):
â”‚ â”‚          super().__init__(*args)
â”‚ â”‚  
â”‚ â”‚          self.id = id
â”‚ â”‚          if message:
â”‚ â”‚              self.message = message
â”‚ â”‚  
â”‚ â”‚ @@ -170,16 +171,16 @@
â”‚ â”‚          Serializer object. Default: `JsonSerializer` (stdlib.json)
â”‚ â”‚      :type serializer: BaseSerializer
â”‚ â”‚  
â”‚ â”‚      """
â”‚ â”‚  
â”‚ â”‚      def __init__(
â”‚ â”‚          self,
â”‚ â”‚ -        registry: Optional[RPCRegistry] = None,
â”‚ â”‚ -        serializer: Optional[BaseSerializer] = None,
â”‚ â”‚ +        registry: RPCRegistry | None = None,
â”‚ â”‚ +        serializer: BaseSerializer | None = None,
â”‚ â”‚      ):
â”‚ â”‚          if serializer is None:
â”‚ â”‚              serializer = JsonSerializer()
â”‚ â”‚          super().__init__(registry=registry, serializer=serializer)
â”‚ â”‚  
â”‚ â”‚          self._errors_map = {
â”‚ â”‚              Exception: JsonRPCError,
â”‚ â”‚ @@ -195,16 +196,16 @@
â”‚ â”‚              ForbiddenError: ForbiddenJRPCError,
â”‚ â”‚              InvalidPermissionsError: InvalidPermissionsJRPCError,
â”‚ â”‚          }
â”‚ â”‚  
â”‚ â”‚      def handle(
â”‚ â”‚          self,
â”‚ â”‚          rpc_request: JSONRPCRequest,
â”‚ â”‚ -        request: Optional[Any] = None,
â”‚ â”‚ -    ) -> Optional[JSONRPCResponse]:
â”‚ â”‚ +        request: Any | None = None,
â”‚ â”‚ +    ) -> JSONRPCResponse | None:
â”‚ â”‚          """Handles a procedure call or batch of procedure call
â”‚ â”‚  
â”‚ â”‚          :param rpc_request:
â”‚ â”‚              RPC request in protocol format.
â”‚ â”‚          :type rpc_request: JSONRPCRequest
â”‚ â”‚          :param request:
â”‚ â”‚              Optional parameter that can be passed as an
â”‚ â”‚ @@ -232,16 +233,16 @@
â”‚ â”‚  
â”‚ â”‚          # Handle single request
â”‚ â”‚          return self.execute(rpc_request, request=request)
â”‚ â”‚  
â”‚ â”‚      def execute(
â”‚ â”‚          self,
â”‚ â”‚          procedure_call: JSONRPCRequestObject,
â”‚ â”‚ -        request: Optional[Any] = None,
â”‚ â”‚ -    ) -> Optional[JSONRPCResponseObject]:
â”‚ â”‚ +        request: Any | None = None,
â”‚ â”‚ +    ) -> JSONRPCResponseObject | None:
â”‚ â”‚          """Execute a remote procedure call.
â”‚ â”‚  
â”‚ â”‚          :param procedure_call:
â”‚ â”‚              RPC request object in protocol format.
â”‚ â”‚          :type procedure_call: JSONRPCRequestObject
â”‚ â”‚          :param request:
â”‚ â”‚              Optional parameter that can be passed as an
â”‚ â”‚ @@ -251,16 +252,16 @@
â”‚ â”‚              Returns a result object in protocol format.
â”‚ â”‚          :rtype: JSONRPCResponseObject
â”‚ â”‚  
â”‚ â”‚          """
â”‚ â”‚          if not isinstance(procedure_call, dict):
â”‚ â”‚              return InvalidRequestError().as_dict()
â”‚ â”‚          method: str = procedure_call.get("method")
â”‚ â”‚ -        params: Optional[Union[list, dict]] = procedure_call.get("params")
â”‚ â”‚ -        request_id: Optional[Union[int, str]] = procedure_call.get("id")
â”‚ â”‚ +        params: list | dict | None = procedure_call.get("params")
â”‚ â”‚ +        request_id: int | str | None = procedure_call.get("id")
â”‚ â”‚  
â”‚ â”‚          # Validate protocol
â”‚ â”‚          if (
â”‚ â”‚              procedure_call.get("jsonrpc") != "2.0"
â”‚ â”‚              or not isinstance(method, str)
â”‚ â”‚              or not (params is None or isinstance(params, (list, dict)))
â”‚ â”‚              or not (request_id is None or isinstance(request_id, (int, str)))
â”‚ â”‚ @@ -283,28 +284,31 @@
â”‚ â”‚                  kwargs = dict(request=request, **params)
â”‚ â”‚          else:
â”‚ â”‚              kwargs = dict(request=request)
â”‚ â”‚  
â”‚ â”‚          # Execute RPC method
â”‚ â”‚          try:
â”‚ â”‚              result = procedure(*args, **kwargs)
â”‚ â”‚ -        except JsonRPCError as err:
â”‚ â”‚ -            err.id = request_id
â”‚ â”‚ -            return err.as_dict()
â”‚ â”‚ +        except RPCError as err:
â”‚ â”‚ +            error = self.handle_error(err)
â”‚ â”‚ +            error.id = request_id
â”‚ â”‚ +            return error.as_dict()
â”‚ â”‚          except Exception as err:
â”‚ â”‚              return InternalError(message=str(err), id=request_id).as_dict()
â”‚ â”‚  
â”‚ â”‚          if request_id is None:
â”‚ â”‚              return None
â”‚ â”‚  
â”‚ â”‚          return dict(jsonrpc="2.0", result=result, id=request_id)
â”‚ â”‚  
â”‚ â”‚      @property
â”‚ â”‚ -    def base_error_class(self):
â”‚ â”‚ +    def base_error_class(self) -> Type[JsonRPCError]:
â”‚ â”‚ +        """Base class for JSON-RPC 2.0 protocol implementation."""
â”‚ â”‚          return JsonRPCError
â”‚ â”‚  
â”‚ â”‚      @property
â”‚ â”‚ -    def default_error_class(self):
â”‚ â”‚ +    def default_error_class(self) -> Type[JsonRPCError]:
â”‚ â”‚ +        """Default JSON-RPC 2.0 error class to represent internal exceptions."""
â”‚ â”‚          return InternalError
â”‚ â”‚  
â”‚ â”‚      def smd_scheme(self):
â”‚ â”‚          return {}
â”‚ â”‚   --- drakaina-0.6.8/drakaina/serializers.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/serializers.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/tcp.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/tcp.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/utils.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/utils.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/drakaina/wsgi.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/drakaina/wsgi.py
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/LICENSE
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/LICENSE
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/pyproject.toml
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/pyproject.toml
â”‚ â”‚â”„ Files 4% similar despite different names
â”‚ â”‚ @@ -1,10 +1,10 @@
â”‚ â”‚  [tool.poetry]
â”‚ â”‚  name = "drakaina"
â”‚ â”‚ -version = "0.6.8"
â”‚ â”‚ +version = "0.6.9"
â”‚ â”‚  description = "Module for simple RPC service implementation"
â”‚ â”‚  authors = ["Aleksey Terentyev <terentyev.a@pm.me>"]
â”‚ â”‚  license = "Apache License 2.0"
â”‚ â”‚  readme = "README.md"
â”‚ â”‚  classifiers = [
â”‚ â”‚      "Development Status :: 4 - Beta",
â”‚ â”‚      "Environment :: Web Environment",
â”‚ â”‚   --- drakaina-0.6.8/README.md
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/README.md
â”‚ â”‚â”„ Files identical despite different names
â”‚ â”‚   --- drakaina-0.6.8/setup.py
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/setup.py
â”‚ â”‚â”„ Files 0% similar despite different names
â”‚ â”‚ @@ -22,15 +22,15 @@
â”‚ â”‚   'msgpack': ['msgpack>=1.0.4,<2.0.0'],
â”‚ â”‚   'orjson': ['orjson>=3.8.5,<4.0.0'],
â”‚ â”‚   'tests': ['pyjwt>=2.6.0,<3.0.0'],
â”‚ â”‚   'ujson': ['ujson>=5.7.0,<6.0.0']}
â”‚ â”‚  
â”‚ â”‚  setup_kwargs = {
â”‚ â”‚      'name': 'drakaina',
â”‚ â”‚ -    'version': '0.6.8',
â”‚ â”‚ +    'version': '0.6.9',
â”‚ â”‚      'description': 'Module for simple RPC service implementation',
â”‚ â”‚      'long_description': '# drakaina\n\n![Drakaina](content/drakaina.png "Drakaina"){width=200px height=205px}\n\n[![image](https://img.shields.io/pypi/v/drakaina.svg)](https://pypi.python.org/pypi/drakaina)\n[![image](https://img.shields.io/pypi/l/drakaina.svg)](https://pypi.python.org/pypi/drakaina)\n[![image](https://img.shields.io/pypi/pyversions/drakaina.svg)](https://pypi.python.org/pypi/drakaina)\n[![Ruff](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/charliermarsh/ruff/main/assets/badge/v1.json)](https://github.com/charliermarsh/ruff)\n[![Code style: black](https://img.shields.io/badge/code%20style-black-black.svg)](https://github.com/psf/black)\n[![libera manifesto](https://img.shields.io/badge/libera-manifesto-lightgrey.svg)](https://liberamanifesto.com)\n\nâ— WIP\n\nModule for simple RPC service implementation\n\n\n## Quickstart\n\nDrakaina may be installed via `pip` and requires Python 3.7 or higher :\n\n```shell\npip install drakaina\n```\n\nA minimal Drakaina example is:\n\n```python\nfrom drakaina import remote_procedure\nfrom drakaina.wsgi import WSGIHandler\n\n\n@remote_procedure\ndef my_method():\n    return "Hello Bro! âœ‹ï¸"\n\n\n@remote_procedure(name="something.get")\ndef get_some_string():\n    return "You called `something.get`."\n\n\n@remote_procedure(provide_request=True)\ndef do_something_with_environ(request):\n    return f"You called `do_something_with_environ`. Request: {request}."\n\n\n@remote_procedure()\ndef tell_the_middleware_something():\n    return "You called `tell_the_middleware_something`. It has a some extra conditions."\n\n\nasync def asynchronous_procedure():\n    await asyncio.sleep(5)\n    return "Ding-Dong ğŸ””!"\n\n\n"""\n>>> JsonRPCv2().handle({"jsonrpc": "2.0", "method": "my_method", "id": 1})\nor define WSGI application\n"""\napp = WSGIHandler(route="/jrpc")\n```\n\nDrakaina may be ran with any WSGI-compliant server,\nsuch as [Gunicorn](http://gunicorn.org).\n\n```shell\ngunicorn main:app\n```\n\n\n## Features\n\n- WSGI protocol implementation\n  - Implemented CORS middleware\n  - Compatible with simple middlewares for others wsgi-frameworks,\n    like as [Werkzeug](https://palletsprojects.com/p/werkzeug/),\n    [Flask](https://palletsprojects.com/p/flask/)\n\n\n# Documentation\n\n\n## Installation\n\n```shell\npip install drakaina\n```\n\n\n## Middlewares\n\n\n### CORS\n\n\n### JWT\n\nDrakaina may be installed via `pip` and requires Python 3.7 or higher :\n\n```shell\npip install drakaina[jwt]\n```\n\nA minimal Drakaina example is:\n\n```python\nfrom functools import partial\nfrom drakaina import ENV_IS_AUTHENTICATED\nfrom drakaina import ENV_USER_ID\nfrom drakaina import remote_procedure\nfrom drakaina import check_permissions\nfrom drakaina import login_required\nfrom drakaina import match_any\nfrom drakaina.contrib.jwt.middleware import JWTAuthenticationMiddleware\nfrom drakaina.wsgi import WSGIHandler\n\n\n@login_required\n@remote_procedure(provide_request=True)\ndef my_method(request):\n    assert request[ENV_IS_AUTHENTICATED]\n    return f"Hello Bro âœ‹! Your ID={request[ENV_USER_ID]}"\n\n\n@check_permissions(\n    scopes=["user_read", "app/user:admin", "username:johndoe"],\n    comparator=match_any,\n)\n@remote_procedure\ndef my_method():\n    return "Hello Bro! âœ‹ï¸"\n\n\n\n\napp = WSGIHandler(\n    middlewares=[\n        partial(\n            JWTAuthenticationMiddleware,\n            secret_phrase="_secret_",\n            credentials_required=True,\n        )\n    ]\n)\n```\n\n\n### Using with Django\n\nCreate file `rpc_views.py` in your django application.\nDefine function and wrap it `remote_procedure` decorator:\n\n```python\nfrom drakaina import remote_procedure\n\n@remote_procedure\ndef my_method():\n    return "Hello, Django Bro! âœ‹"\n```\n\nAdd `RPCView` class to urlpatterns. The `as_view` method\nmust accept the `autodiscover` argument as the name of\nthe remote procedure files.\n\n```python\nfrom django.urls import path\nfrom drakaina.contrib.django.views import RPCView\n\nurlpatterns = [\n    ...,\n    path("api/", RPCView.as_view(autodiscover="rpc_views")),\n]\n```\n\n\n### JWT Authentication in your Django project\n\nWrap an instance of `RPCView` with the `JWTAuthenticationMiddleware`.\n\n```python\nfrom django.urls import path\nfrom drakaina.contrib.django import RPCView, JWTAuthenticationMiddleware\n\nurlpatterns = [\n    ...,\n    path("api/", JWTAuthenticationMiddleware(\n        RPCView.as_view(autodiscover="rpc_views")\n    )),\n]\n```\n\nDefine the parameters in the `settings.py` file.\n\n```python\n...\n\nDRAKAINA_JWT_SECRET_KEY = SECRET_KEY\n\n...\n```\n\n\n## License\n\nApache License 2.0\n\n## Artwork\n\n"[drakaina.png](content/drakaina.png)" by Korolko Anastasia is licensed under\n<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="License Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a> ([CC BY-SA 4.0](http://creativecommons.org/licenses/by-sa/4.0/)).\n',
â”‚ â”‚      'author': 'Aleksey Terentyev',
â”‚ â”‚      'author_email': 'terentyev.a@pm.me',
â”‚ â”‚      'maintainer': 'None',
â”‚ â”‚      'maintainer_email': 'None',
â”‚ â”‚      'url': 'https://gitlab.com/tau_lex/drakaina',
â”‚ â”‚   --- drakaina-0.6.8/PKG-INFO
â”‚ â”œâ”€â”€ +++ drakaina-0.6.9/PKG-INFO
â”‚ â”‚â”„ Files 0% similar despite different names
â”‚ â”‚ @@ -1,10 +1,10 @@
â”‚ â”‚  Metadata-Version: 2.1
â”‚ â”‚  Name: drakaina
â”‚ â”‚ -Version: 0.6.8
â”‚ â”‚ +Version: 0.6.9
â”‚ â”‚  Summary: Module for simple RPC service implementation
â”‚ â”‚  Home-page: https://gitlab.com/tau_lex/drakaina
â”‚ â”‚  License: Apache-2.0
â”‚ â”‚  Keywords: rpc,jsonrpc
â”‚ â”‚  Author: Aleksey Terentyev
â”‚ â”‚  Author-email: terentyev.a@pm.me
â”‚ â”‚  Requires-Python: >=3.7,<4.0
