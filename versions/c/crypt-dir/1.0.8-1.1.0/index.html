<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="IE=edge">
  <meta name="referrer" content="no-referrer" />
  <meta name="generator" content="diffoscope" />
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAADdgAAA3YBfdWCzAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAM8SURBVFiF7dZdaJZlGAfw3/O+e9XNjy3XllZzWImBxIpifqTgsmUHBSIeBNFBdRh0UHQ0xGdb66CFBIERZEFRQRRUw0HkQkLMYQSBdpCFWdgSP6jpNn2393k68Nn2bj3vXtb6UOh/cl/39b/u67mem/913zf/4z9GUDw5xNI8n5WIzW9m/QF2YluJmI8203mALzEvLWAerRs4Pz6vSIkZSlsYk0/GkaB0zEgyDgWMlijyWsJuS2fkQwu8pqpMTA0ypeiShG71Bp0rU8Q+A47MWEDgvHZbZl/Av4SpIgxVYB3IqwZDmoUuYkzosDaNchpAoFqkSmgjGPWzLieF1k3JHVsjvCJQHBYaSy9g1E3m+QImQiK9SbNGqJDzuiDZ0lggQJCsyelDq8BB47sbCWTsnvhG3kqcLL833eqF4hk1EOoTOjZjnnaRdq2l6KtMAyl4/g23bKJrun+Mt9uOq7nvqOVbebWYy9Adc1fM/R/3CO780dONbIeFPHsPw+ULeM5ZHTbXHfUtXpxOZzgT5z02UGsZThRzF/ilht9G+fr4zfbfccIxXIa7uVTup69i7LJXaEEqF3on1d9ludBLpVLOVoT1lky9QYtwQ6p3WAVqSyUslWwSbRrkPJrMtgn0iBVk7BPJ4sGE24EPQKW3jLgdzWKLBTbg0yTuZeGkDsp2gcUGDesHGQ/gK5G8nLMigWiCe3jCrnTRiJ9EYjm1ImsUEq5l8hScPXbpsVtlKhfan+pv0yD0ZqmU5XegGBmnDIo/pylj8oYLOP3Eab/v5Zmi6EtZ3vv1FU/2r7LioYSL2dNybbdiMdptFU57++20Vqh+iq/Tap1WpaWY611wmyWyUzxZDbIWTvEV1Ildn5agfBumoUMTtoisFvhebAAHZWxX0ChwTuScvHdVeVykToysMyJ7ittwbmj31J+6IrRDp5XTfBt1WJ+WYnZdMB0F3xlUgD5uDVj2Sa+a4SrzH+FeyHHmw17V112waBOZgP4WczkLZsILar1fpIliMU4XZoK/poE0XHl+N8v6QcGAUbVymnDIZVnzrTXqGzmnhKLxZX/niyiDjIJgwg4Se1GR/Y8idGPysh6fr0i1i/AHMWHgrwUJgNAAAAAASUVORK5CYII=" />
  <title>/srv/diffoscope/bin/diffoscope --no-progress tmp/crypt-dir-1.0.8.tar.gz tmp/crypt-dir-1.1.0.tar.gz --html versions/c/crypt-dir/1.0.8-1.1.0/index.html --text versions/c/crypt-dir/1.0.8-1.1.0/diff.txt --markdown versions/c/crypt-dir/1.0.8-1.1.0/diff.md</title>
<style>
body.diffoscope {
  background: white;
  color: black;
}
.diffoscope .footer {
  font-size: small;
}
.diffoscope .difference {
  border: outset #888 1px;
  background: #E8E8E8;
  background: rgba(0,0,0,.1);
  padding: 0.5em;
  margin: 0.5em 0;
}
.diffoscope .difference table {
  table-layout: fixed;
  width: 100%;
  border: 0;
}
.diffoscope .difference th,
.diffoscope .difference td {
  border: 0;
}
.diffoscope table.diff {
  border: 0;
  border-collapse:collapse;
  font-size:0.75em;
  font-family: 'Lucida Console', monospace;
  word-break: break-word;
}
.diffoscope table.diff tr:hover td {
  background: #FFFF00;
}
.diffoscope .line {
  color:#8080a0
}
.diffoscope th {
  background: black;
  color: white
}
.diffoscope .diffunmodified td {
  background: #D0D0E0
}
.diffoscope .diffhunk td {
  background: #A0A0A0
}
.diffoscope .diffadded td {
  background: #CCFFCC
}
.diffoscope .diffdeleted td {
  background: #FFCCCC
}
.diffoscope .diffchanged td {
  background: #FFFFA0
}
.diffoscope ins, del {
  background: #E0C880;
  text-decoration: none
}
.diffoscope .dp {
  color: #B08080
}
.diffoscope .comment {
  font-style: italic;
}
.diffoscope .comment.multiline {
  font-style: normal;
  font-family: monospace;
  white-space: pre;
}
.diffoscope .source {
  font-weight: bold;
}
.diffoscope .error {
  border: solid black 1px;
  background: red;
  color: white;
  padding: 0.2em;
}
.diffoscope .anchor {
  margin-left: 0.5em;
  font-size: 80%;
  color: #333;
  text-decoration: none;
  display: none;
}
.diffoscope .diffheader:hover .anchor {
  display: inline;
}
.diffoscope .diffcontrol, .diffoscope .diffcontrol-nochildren {
  float: left;
  margin-right: 0.3em;
  cursor: pointer;
  display: none; /* currently, only available in html-dir output where jquery is enabled */
}
.diffoscope .colines {
  width: 3em;
}
.diffoscope .coldiff {
  width: 99%;
}
.diffoscope .diffsize {
  float: right;
}
.diffoscope table.diff tr.ondemand td, .diffoscope div.ondemand-details {
  background: #f99;
  text-align: center;
  padding: 0.5em 0;
}
.diffoscope table.diff tr.ondemand:hover td, .diffoscope div.ondemand-details:hover {
  background: #faa;
  cursor: pointer;
}
</style>
</head>
<body class="diffoscope">
<div class="difference">
  <div class="diffheader">
  <div class="diffcontrol diffcontrol-double">⊟</div>
  <div><span class="diffsize">30.2 KB</span></div>
  <div><span class="source">tmp/crypt-dir-1.0.8.tar.gz</span> vs.</div>
  <div id="top"><span class="source">tmp/crypt-dir-1.1.0.tar.gz</span>
    <a class="anchor" href="#top">¶</a>
  </div>
  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol">⊟</div>
    <div><span class="diffsize">268 B</span></div>
    <div id="filetype-from-file---"><span class="source">filetype from file(1)</span>
      <a class="anchor" href="#filetype-from-file---">¶</a>
    </div>
    </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 1 lines modified</td><td colspan="2">Offset 1, 1 lines modified</td></tr>
<tr class="diffchanged"><td class="diffline">1 </td><td class="diffpresent">gzip<span class="dp">·</span>compressed<span class="dp">·</span>data,<span class="dp">·</span>was<span class="dp">·</span>&quot;crypt-dir-1.<del>0</del>.<del>8</del>.tar&quot;,<span class="dp">·</span>last<span class="dp">·</span>modified:<span class="dp">·</span><del>Fri</del><span class="dp">·</span><del>Ma</del>r<span class="dp">·</span><del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del><span class="dp">·</span>2023,<span class="dp">·</span>max<span class="dp">·</span>compression</td><td class="diffline">1 </td><td class="diffpresent">gzip<span class="dp">·</span>compressed<span class="dp">·</span>data,<span class="dp">·</span>was<span class="dp">·</span>&quot;crypt-dir-1.<ins>1</ins>.<ins>0</ins>.tar&quot;,<span class="dp">·</span>last<span class="dp">·</span>modified:<span class="dp">·</span><ins>Thu</ins><span class="dp">·</span><ins>Ap</ins>r<span class="dp">·</span><ins><span class="dp">·</span>6</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins><span class="dp">·</span>2023,<span class="dp">·</span>max<span class="dp">·</span>compression</td></tr>
</table>  </div>
  <div class="difference">
    <div class="diffheader">
    <div class="diffcontrol diffcontrol-double">⊟</div>
    <div><span class="diffsize">29.9 KB</span></div>
    <div><span class="source">crypt-dir-1.0.8.tar</span> vs.</div>
    <div id="crypt-dir--.-.-.tar"><span class="source">crypt-dir-1.1.0.tar</span>
      <a class="anchor" href="#crypt-dir--.-.-.tar">¶</a>
    </div>
    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol">⊟</div>
      <div><span class="diffsize">4.54 KB</span></div>
      <div id="crypt-dir--.-.-.tar---file-list"><span class="source">file list</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---file-list">¶</a>
      </div>
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 19 lines modified</td><td colspan="2">Offset 1, 19 lines modified</td></tr>
<tr class="diffchanged"><td class="diffline">1 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.<del>977844</del><span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/</td><td class="diffline">1 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.<ins>395269</ins><span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/</td></tr>
<tr class="diffchanged"><td class="diffline">2 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1069<span class="dp">·</span>2023-03-31<span class="dp">·</span>12:34:48.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/LICENSE</td><td class="diffline">2 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1069<span class="dp">·</span>2023-03-31<span class="dp">·</span>12:34:48.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/LICENSE</td></tr>
<tr class="diffchanged"><td class="diffline">3 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<del>556</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.<del>977693</del><span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/PKG-INFO</td><td class="diffline">3 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<ins>784</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.<ins>395135</ins><span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/PKG-INFO</td></tr>
<tr class="diffchanged"><td class="diffline">4 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<del>311</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:<del>19</del>:<del>49</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/README.md</td><td class="diffline">4 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<ins>526</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>01</ins>:<ins>38</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/README.md</td></tr>
<tr class="diffchanged"><td class="diffline">5 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.9<del>766</del>6<del>3</del><span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/</td><td class="diffline">5 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.<ins>3</ins>9<ins>392</ins>6<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/</td></tr>
<tr class="diffchanged"><td class="diffline">6 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del><span class="dp">·</span>88</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>2</del>:<del>34</del>:<del>4</del>8.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/__init__.py</td><td class="diffline">6 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>126</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>01</ins>:<ins>3</ins>8.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/__init__.py</td></tr>
<tr class="diffchanged"><td class="diffline">7 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<del>579</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:0<del>8</del>:<del>30</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/crypt.py</td><td class="diffline">7 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>2<ins>318</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:0<ins>2</ins>:<ins>52</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/crypt.py</td></tr>
<tr class="diffchanged"><td class="diffline">8 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>60<del>17</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:<del>08</del>:3<del>0</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/crypt_dir.py</td><td class="diffline">8 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>60<ins>83</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>5</ins>:<ins>55</ins>:3<ins>6</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/crypt_dir.py</td></tr>
<tr class="diffchanged"><td class="diffline">9 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<del>618</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:<del>38</del>:<del>51</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/crypt_file.py</td><td class="diffline">9 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<ins>744</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>03</ins>:<ins>15</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/crypt_file.py</td></tr>
<tr class="diffchanged"><td class="diffline">10 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>824</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:<del>44</del>:<del>06</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/si<del>g</del>.py</td><td class="diffline">10 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>257</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>5</ins>:<ins>59</ins>:<ins>40</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/s<ins>erial</ins>i<ins>z</ins><ins>e</ins>.py</td></tr>
<tr class="diffchanged"><td class="diffline">11 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>467</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>4</del>:0<del>2</del>:<del>04</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir/<del>u</del>t<del>il</del>.py</td><td class="diffline">11 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>805</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:0<ins>3</ins>:<ins>15</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir/<ins>sign</ins><ins>a</ins>t<ins>u</ins><ins>re</ins>.py</td></tr>
<tr class="diffchanged"><td class="diffline">12 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.<del>977522</del><span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/</td><td class="diffline">12 </td><td class="diffpresent">drwxr-xr-x<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.<ins>394948</ins><span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/</td></tr>
<tr class="diffchanged"><td class="diffline">13 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<del>556</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/PKG-INFO</td><td class="diffline">13 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<ins>784</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/PKG-INFO</td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<del>13</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/SOURCES.txt</td><td class="diffline">14 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>3<ins>24</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/SOURCES.txt</td></tr>
<tr class="diffchanged"><td class="diffline">15 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/dependency_links.txt</td><td class="diffline">15 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>1<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/dependency_links.txt</td></tr>
<tr class="diffchanged"><td class="diffline">16 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/requires.txt</td><td class="diffline">16 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/requires.txt</td></tr>
<tr class="diffchanged"><td class="diffline">17 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>10<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/crypt_dir.egg-info/top_level.txt</td><td class="diffline">17 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>10<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/crypt_dir.egg-info/top_level.txt</td></tr>
<tr class="diffchanged"><td class="diffline">18 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>38<span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>19</del>:<del>03</del>.<del>977891</del><span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/setup.cfg</td><td class="diffline">18 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>38<span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>08</ins>:<ins>17</ins>.<ins>395317</ins><span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/setup.cfg</td></tr>
<tr class="diffchanged"><td class="diffline">19 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<del>63</del><span class="dp">·</span>2023-0<del>3</del>-<del>31</del><span class="dp">·</span>1<del>5</del>:<del>18</del>:<del>33</del>.000000<span class="dp">·</span>crypt-dir-1.<del>0</del>.<del>8</del>/setup.py</td><td class="diffline">19 </td><td class="diffpresent">-rw-r--r--<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>0<span class="dp">·</span>khanh<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(501)<span class="dp">·</span>staff<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>(20)<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>5<ins>86</ins><span class="dp">·</span>2023-0<ins>4</ins>-<ins>06</ins><span class="dp">·</span>1<ins>6</ins>:<ins>07</ins>:<ins>55</ins>.000000<span class="dp">·</span>crypt-dir-1.<ins>1</ins>.<ins>0</ins>/setup.py</td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">85.0 B</span></div>
      <div><span class="source">crypt-dir-1.0.8/LICENSE</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--LICENSE"><span class="source">crypt-dir-1.1.0/LICENSE</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--LICENSE">¶</a>
      </div>
      </div>
      <div class="comment">Files identical despite different names
      </div>
    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">4.11 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/PKG-INFO</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--PKG-INFO"><span class="source">crypt-dir-1.1.0/PKG-INFO</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--PKG-INFO">¶</a>
      </div>
      </div>
      <div class="comment">Files 6% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 13 lines modified</td><td colspan="2">Offset 1, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">Metadata-Version:<span class="dp">·</span>2.1</td><td class="diffline">1 </td><td class="diffpresent">Metadata-Version:<span class="dp">·</span>2.1</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">Name:<span class="dp">·</span>crypt-dir</td><td class="diffline">2 </td><td class="diffpresent">Name:<span class="dp">·</span>crypt-dir</td></tr>
<tr class="diffchanged"><td class="diffline">3 </td><td class="diffpresent">Version:<span class="dp">·</span>1.<del>0</del>.<del>8</del></td><td class="diffline">3 </td><td class="diffpresent">Version:<span class="dp">·</span>1.<ins>1</ins>.<ins>0</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">Home-page:<span class="dp">·</span>https://github.com/khanh-nguyen-code/crypt-dir</td><td class="diffline">4 </td><td class="diffpresent">Home-page:<span class="dp">·</span>https://github.com/khanh-nguyen-code/crypt-dir</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">Author:<span class="dp">·</span>Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh</td><td class="diffline">5 </td><td class="diffpresent">Author:<span class="dp">·</span>Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">Author-email:<span class="dp">·</span>khanh.nguyen.contact@gmail.com</td><td class="diffline">6 </td><td class="diffpresent">Author-email:<span class="dp">·</span>khanh.nguyen.contact@gmail.com</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">License:<span class="dp">·</span>MIT</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">Description-Content-Type:<span class="dp">·</span>text/markdown</td><td class="diffline">8 </td><td class="diffpresent">Description-Content-Type:<span class="dp">·</span>text/markdown</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">License-File:<span class="dp">·</span>LICENSE</td><td class="diffline">9 </td><td class="diffpresent">License-File:<span class="dp">·</span>LICENSE</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>CRYPT_DIR</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>CRYPT_DIR</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">-<span class="dp">·</span>Encrypt<span class="dp">·</span>all<span class="dp">·</span>your<span class="dp">·</span>files<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>into<span class="dp">·</span>another<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>there<span class="dp">·</span>is<span class="dp">·</span>update</td><td class="diffline">11 </td><td class="diffpresent">-<span class="dp">·</span>Encrypt<span class="dp">·</span>all<span class="dp">·</span>your<span class="dp">·</span>files<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>into<span class="dp">·</span>another<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>there<span class="dp">·</span>is<span class="dp">·</span>update</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">-<span class="dp">·</span>Clean<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>files<span class="dp">·</span>or<span class="dp">·</span>directories<span class="dp">·</span>have<span class="dp">·</span>been<span class="dp">·</span>deleted</td><td class="diffline">12 </td><td class="diffpresent">-<span class="dp">·</span>Clean<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>files<span class="dp">·</span>or<span class="dp">·</span>directories<span class="dp">·</span>have<span class="dp">·</span>been<span class="dp">·</span>deleted</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 85 lines modified</td><td colspan="2">Offset 24, 93 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">25 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">26 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">27 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">28 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td><td class="diffline">30 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td><td class="diffline">31 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">)</td><td class="diffline">34 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">35 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td><td class="diffline">36 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>key=key,</td></tr>
<tr class="diffchanged"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent">)</td><td class="diffline">41 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent">```</td><td class="diffline">42 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent">-<span class="dp">·</span>restore</td><td class="diffline">43 </td><td class="diffpresent">-<span class="dp">·</span>restore</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent">```python</td><td class="diffline">44 </td><td class="diffpresent">```python</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">45 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">46 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">47 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">48 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">49 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">51 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td><td class="diffline">52 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key=key,</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">)</td><td class="diffline">57 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent">```</td><td class="diffline">58 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td><td class="diffline">59 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent">```shell</td><td class="diffline">60 </td><td class="diffpresent">```shell</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td><td class="diffline">61 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent">```</td><td class="diffline">62 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td><td class="diffline">63 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td><td class="diffline">64 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">62 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">65 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">67 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">68 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td><td class="diffline">69 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td><td class="diffline">70 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td><td class="diffline">71 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`header`:</td></tr>
<tr class="diffchanged"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_sig<del>nature</del>`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_sig`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`key_sig<del>nature</del>`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`key_sig`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td></tr>
<tr class="diffchanged"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`iv`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`<ins>in</ins>i<ins>t_</ins>v<ins>ec</ins>`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent">```</td><td class="diffline">78 </td><td class="diffpresent">```</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>header<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffchanged"><td class="diffline">74 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<del>v<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">80 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<ins>nit_vec</ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">81 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent">```</td><td class="diffline">82 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td><td class="diffline">83 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">78 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">84 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">86 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">87 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td><td class="diffline">88 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">3.65 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/README.md</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--README.md"><span class="source">crypt-dir-1.1.0/README.md</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--README.md">¶</a>
      </div>
      </div>
      <div class="comment">Files 6% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 14, 85 lines modified</td><td colspan="2">Offset 14, 93 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">14 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">15 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">16 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">17 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">18 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td><td class="diffline">20 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td><td class="diffline">21 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">)</td><td class="diffline">24 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">25 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td><td class="diffline">26 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>key=key,</td></tr>
<tr class="diffchanged"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent">)</td><td class="diffline">31 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent">```</td><td class="diffline">32 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">-<span class="dp">·</span>restore</td><td class="diffline">33 </td><td class="diffpresent">-<span class="dp">·</span>restore</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">```python</td><td class="diffline">34 </td><td class="diffpresent">```python</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">35 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">36 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">37 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">37 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">38 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">39 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">40 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">41 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td><td class="diffline">42 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key=key,</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent">)</td><td class="diffline">47 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent">```</td><td class="diffline">48 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td><td class="diffline">49 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">```shell</td><td class="diffline">50 </td><td class="diffpresent">```shell</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td><td class="diffline">51 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent">```</td><td class="diffline">52 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td><td class="diffline">53 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td><td class="diffline">54 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">53 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">55 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">57 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">58 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td><td class="diffline">59 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td><td class="diffline">60 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td><td class="diffline">61 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`header`:</td></tr>
<tr class="diffchanged"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_sig<del>nature</del>`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_sig`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`key_sig<del>nature</del>`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`key_sig`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td></tr>
<tr class="diffchanged"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`iv`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`<ins>in</ins>i<ins>t_</ins>v<ins>ec</ins>`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent">```</td><td class="diffline">68 </td><td class="diffpresent">```</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">69 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>header<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffchanged"><td class="diffline">65 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<del>v<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">70 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<ins>nit_vec</ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">71 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent">```</td><td class="diffline">72 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">68 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td><td class="diffline">73 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">69 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">74 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">75 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">70 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">76 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">71 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">77 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">72 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td><td class="diffline">78 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">3.61 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/crypt_dir/crypt.py</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt.py"><span class="source">crypt-dir-1.1.0/crypt_dir/crypt.py</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt.py">¶</a>
      </div>
      </div>
      <div class="comment">Files 26% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 84 lines modified</td><td colspan="2">Offset 1, 78 lines modified</td></tr>
<tr class="diffdeleted"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>io</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>BinaryIO</td><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>BinaryIO</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>Cryptodome.Cipher<span class="dp">·</span>import<span class="dp">·</span>AES</td><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>Cryptodome.Cipher<span class="dp">·</span>import<span class="dp">·</span>AES</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">from<span class="dp">·</span>Cryptodome.Hash<span class="dp">·</span>import<span class="dp">·</span>SHA1</td><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>Cryptodome.Hash<span class="dp">·</span>import<span class="dp">·</span>SHA1</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">HASH_SIZE<span class="dp">·</span>=<span class="dp">·</span>20<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>hash<span class="dp">·</span>value<span class="dp">·</span>in<span class="dp">·</span>bytes</td><td class="diffline">5 </td><td class="diffpresent">HASH_SIZE<span class="dp">·</span>=<span class="dp">·</span>20<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>hash<span class="dp">·</span>value<span class="dp">·</span>in<span class="dp">·</span>bytes</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">BLOCK_SIZE<span class="dp">·</span>=<span class="dp">·</span>AES.block_size<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>AES<span class="dp">·</span>block<span class="dp">·</span>in<span class="dp">·</span>bytes</td><td class="diffline">6 </td><td class="diffpresent">BLOCK_SIZE<span class="dp">·</span>=<span class="dp">·</span>AES.block_size<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>AES<span class="dp">·</span>block<span class="dp">·</span>in<span class="dp">·</span>bytes</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">KEY_SIZE<span class="dp">·</span>=<span class="dp">·</span>32<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>AES<span class="dp">·</span>key<span class="dp">·</span>in<span class="dp">·</span>bytes</td><td class="diffline">7 </td><td class="diffpresent">KEY_SIZE<span class="dp">·</span>=<span class="dp">·</span>32<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>AES<span class="dp">·</span>key<span class="dp">·</span>in<span class="dp">·</span>bytes</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">AES_MODE<span class="dp">·</span>=<span class="dp">·</span>AES.MODE_CBC<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>cipher<span class="dp">·</span>block<span class="dp">·</span>chaining</td><td class="diffline">8 </td><td class="diffpresent">AES_MODE<span class="dp">·</span>=<span class="dp">·</span>AES.MODE_CBC<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>cipher<span class="dp">·</span>block<span class="dp">·</span>chaining</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">CHUNK_SIZE<span class="dp">·</span>=<span class="dp">·</span>2<span class="dp">·</span>**<span class="dp">·</span>30<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>1<span class="dp">·</span>GB<span class="dp">·</span>#<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>to<span class="dp">·</span>read<span class="dp">·</span>from<span class="dp">·</span>io<span class="dp">·</span>in<span class="dp">·</span>bytes</td><td class="diffline">9 </td><td class="diffpresent">CHUNK_SIZE<span class="dp">·</span>=<span class="dp">·</span>2<span class="dp">·</span>**<span class="dp">·</span>30<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>1<span class="dp">·</span>GB<span class="dp">·</span>#<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>to<span class="dp">·</span>read<span class="dp">·</span>from<span class="dp">·</span>io<span class="dp">·</span>in<span class="dp">·</span>bytes</td></tr>
<tr class="diffdeleted"><td class="diffline">11 </td><td class="diffpresent">IV_SIZE<span class="dp">·</span>=<span class="dp">·</span>16<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>iv<span class="dp">·</span>in<span class="dp">·</span>bytes</td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">12 </td><td class="diffpresent">def<span class="dp">·</span>random_bytes(count:<span class="dp">·</span>int<span class="dp">·</span>=<span class="dp">·</span>1)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>os.urandom(count)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent">def<span class="dp">·</span>sha1_hash(f_in:<span class="dp">·</span>BinaryIO)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td><td class="diffline">10 </td><td class="diffpresent">def<span class="dp">·</span>sha1_hash(f_in:<span class="dp">·</span>BinaryIO)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>SHA1.new()</td><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h<span class="dp">·</span>=<span class="dp">·</span>SHA1.new()</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>f_in.read(CHUNK_SIZE)</td><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>f_in.read(CHUNK_SIZE)</td></tr>
<tr class="diffunmodified"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td></tr>
<tr class="diffunmodified"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>h.digest()</td><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>h.digest()</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(b)<span class="dp">·</span>==<span class="dp">·</span>HASH_SIZE</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(b)<span class="dp">·</span>==<span class="dp">·</span>HASH_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>b</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>b</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h.update(chunk)</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h.update(chunk)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent">def<span class="dp">·</span>aes256_encrypt(<del>key:<span class="dp">·</span>bytes,<span class="dp">·</span>iv:<span class="dp">·</span>bytes,<span class="dp">·</span>plain_read_io:<span class="dp">·</span>BinaryIO,<span class="dp">·</span>encrypted_write_io:<span class="dp">·</span>BinaryIO):</del></td><td class="diffline">19 </td><td class="diffpresent">def<span class="dp">·</span>aes256_encrypt(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>init_vec:<span class="dp">·</span>bytes,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain_read_io:<span class="dp">·</span>BinaryIO,<span class="dp">·</span>encrypted_write_io:<span class="dp">·</span>BinaryIO,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">):</td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>16</td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>16</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>CHUNK_SIZE<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>0</td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>CHUNK_SIZE<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>0</td></tr>
<tr class="diffchanged"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(iv)<span class="dp">·</span>==<span class="dp">·</span>BLOCK_SIZE</td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(i<ins>nit_</ins>v<ins>ec</ins>)<span class="dp">·</span>==<span class="dp">·</span>BLOCK_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffchanged"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes<span class="dp">·</span>=<span class="dp">·</span>AES.new(key,<span class="dp">·</span>AES_MODE,<span class="dp">·</span>iv)</td><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes<span class="dp">·</span>=<span class="dp">·</span>AES.new(key,<span class="dp">·</span>AES_MODE,<span class="dp">·</span>i<ins>nit_</ins>v<ins>ec</ins>)</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td></tr>
<tr class="diffunmodified"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>plain_read_io.read(CHUNK_SIZE)</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>plain_read_io.read(CHUNK_SIZE)</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>!=<span class="dp">·</span>0:</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>!=<span class="dp">·</span>0:</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>+=<span class="dp">·</span>b&quot;\0&quot;<span class="dp">·</span>*<span class="dp">·</span>(BLOCK_SIZE<span class="dp">·</span>-<span class="dp">·</span>len(chunk)<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>padded<span class="dp">·</span>with<span class="dp">·</span>0s<span class="dp">·</span>until<span class="dp">·</span>BLOCK_SIZE</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>+=<span class="dp">·</span>b&quot;\0&quot;<span class="dp">·</span>*<span class="dp">·</span>(BLOCK_SIZE<span class="dp">·</span>-<span class="dp">·</span>len(chunk)<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>padded<span class="dp">·</span>with<span class="dp">·</span>0s<span class="dp">·</span>until<span class="dp">·</span>BLOCK_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>aes.encrypt(chunk)</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>aes.encrypt(chunk)</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_write_io.write(b)</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_write_io.write(b)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent">def<span class="dp">·</span>aes256_decrypt(<del>key:<span class="dp">·</span>bytes,<span class="dp">·</span>iv:<span class="dp">·</span>bytes,<span class="dp">·</span>size:<span class="dp">·</span>int,<span class="dp">·</span>encrypted_read_io:<span class="dp">·</span>BinaryIO,<span class="dp">·</span>decrypted_write_io:<span class="dp">·</span>BinaryIO):</del></td><td class="diffline">36 </td><td class="diffpresent">def<span class="dp">·</span>aes256_decrypt(</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>init_vec:<span class="dp">·</span>bytes,<span class="dp">·</span>file_size:<span class="dp">·</span>int,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_read_io:<span class="dp">·</span>BinaryIO,<span class="dp">·</span>decrypted_write_io:<span class="dp">·</span>BinaryIO,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent">):</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>16</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>16</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>CHUNK_SIZE<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>0</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>CHUNK_SIZE<span class="dp">·</span>%<span class="dp">·</span>BLOCK_SIZE<span class="dp">·</span>==<span class="dp">·</span>0</td></tr>
<tr class="diffchanged"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(iv)<span class="dp">·</span>==<span class="dp">·</span>BLOCK_SIZE</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(i<ins>nit_</ins>v<ins>ec</ins>)<span class="dp">·</span>==<span class="dp">·</span>BLOCK_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffchanged"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes<span class="dp">·</span>=<span class="dp">·</span>AES.new(key,<span class="dp">·</span>AES_MODE,<span class="dp">·</span>iv)</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes<span class="dp">·</span>=<span class="dp">·</span>AES.new(key,<span class="dp">·</span>AES_MODE,<span class="dp">·</span>i<ins>nit_</ins>v<ins>ec</ins>)</td></tr>
<tr class="diffchanged"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remaining_size<span class="dp">·</span>=<span class="dp">·</span>size</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remaining_size<span class="dp">·</span>=<span class="dp">·</span><ins>file_</ins>size</td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>while<span class="dp">·</span>True:</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>encrypted_read_io.read(CHUNK_SIZE)</td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>chunk<span class="dp">·</span>=<span class="dp">·</span>encrypted_read_io.read(CHUNK_SIZE)</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>len(chunk)<span class="dp">·</span>==<span class="dp">·</span>0:</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return</td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return</td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>aes.decrypt(chunk)</td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>aes.decrypt(chunk)</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>remaining_size<span class="dp">·</span>&lt;<span class="dp">·</span>len(b):</td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>remaining_size<span class="dp">·</span>&lt;<span class="dp">·</span>len(b):</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>b[:remaining_size]</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>b<span class="dp">·</span>=<span class="dp">·</span>b[:remaining_size]</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_write_io.write(b)</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_write_io.write(b)</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remaining_size<span class="dp">·</span>-=<span class="dp">·</span>len(b)</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>remaining_size<span class="dp">·</span>-=<span class="dp">·</span>len(b)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">55 </td><td class="diffpresent">def<span class="dp">·</span>read_or_create_key(key_path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>read_hex_file(path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(path,<span class="dp">·</span>&quot;r&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>bytes.fromhex(f.read())</td></tr>
<tr class="diffdeleted"><td class="diffline">53 </td><td class="diffpresent">if<span class="dp">·</span>__name__<span class="dp">·</span>==<span class="dp">·</span>&quot;__main__&quot;:</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<span class="dp">·</span>=<span class="dp">·</span>random_bytes(KEY_SIZE)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sig<span class="dp">·</span>=<span class="dp">·</span>sha1_hash(io.BytesIO(key))</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>iv<span class="dp">·</span>=<span class="dp">·</span>random_bytes(IV_SIZE)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain<span class="dp">·</span>=<span class="dp">·</span>b&quot;hello<span class="dp">·</span>world,<span class="dp">·</span>this<span class="dp">·</span>is<span class="dp">·</span>an<span class="dp">·</span>example<span class="dp">·</span>message&quot;</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>print(&quot;plain&quot;,<span class="dp">·</span>plain)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>write_hex_file(path:<span class="dp">·</span>str,<span class="dp">·</span>b:<span class="dp">·</span>bytes):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(path,<span class="dp">·</span>&quot;w&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>f.write(b.hex())</td></tr>
<tr class="diffdeleted"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_io<span class="dp">·</span>=<span class="dp">·</span>io.BytesIO()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_encrypt(key,<span class="dp">·</span>iv,<span class="dp">·</span>io.BytesIO(plain),<span class="dp">·</span>encrypted_io)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_io.seek(0)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted<span class="dp">·</span>=<span class="dp">·</span>encrypted_io.read()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>print(&quot;encrypted&quot;,<span class="dp">·</span>encrypted)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>os.path.exists(key_path):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_hex_file(key_path,<span class="dp">·</span>os.urandom(KEY_SIZE))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<span class="dp">·</span>=<span class="dp">·</span>read_hex_file(key_path)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>key</td></tr>
<tr class="diffdeleted"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_io.seek(0)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_io<span class="dp">·</span>=<span class="dp">·</span>io.BytesIO()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_decrypt(key,<span class="dp">·</span>iv,<span class="dp">·</span>len(plain),<span class="dp">·</span>encrypted_io,<span class="dp">·</span>decrypted_io)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_io.seek(0)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted<span class="dp">·</span>=<span class="dp">·</span>decrypted_io.read()</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>print(&quot;decrypt&quot;,<span class="dp">·</span>decrypted)</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>plain<span class="dp">·</span>==<span class="dp">·</span>decrypted</td><td colspan="2"> </td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">2.6 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/crypt_dir/crypt_dir.py</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt_dir.py"><span class="source">crypt-dir-1.1.0/crypt_dir/crypt_dir.py</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt_dir.py">¶</a>
      </div>
      </div>
      <div class="comment">Files 2% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 3, 14 lines modified</td><td colspan="2">Offset 3, 15 lines modified</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">import<span class="dp">·</span>concurrent.futures</td><td class="diffline">3 </td><td class="diffpresent">import<span class="dp">·</span>concurrent.futures</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">4 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">import<span class="dp">·</span>shutil</td><td class="diffline">5 </td><td class="diffpresent">import<span class="dp">·</span>shutil</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">import<span class="dp">·</span>sys</td><td class="diffline">6 </td><td class="diffpresent">import<span class="dp">·</span>sys</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>*</td><td class="diffline">7 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">from<span class="dp">·</span>.crypt<span class="dp">·</span>import<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">from<span class="dp">·</span>.crypt_file<span class="dp">·</span>import<span class="dp">·</span>Codec</td><td class="diffline">9 </td><td class="diffpresent">from<span class="dp">·</span>.crypt_file<span class="dp">·</span>import<span class="dp">·</span>Codec</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">ENCRYPTED_EXT<span class="dp">·</span>=<span class="dp">·</span>&quot;enc1&quot;</td><td class="diffline">10 </td><td class="diffpresent">ENCRYPTED_EXT<span class="dp">·</span>=<span class="dp">·</span>&quot;enc1&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">def<span class="dp">·</span>delete_if_ok(encrypted_path:<span class="dp">·</span>str):</td><td class="diffline">11 </td><td class="diffpresent">def<span class="dp">·</span>delete_if_ok(encrypted_path:<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>os.path.exists(encrypted_path):</td><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>os.path.exists(encrypted_path):</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 90, 26 lines modified</td><td colspan="2">Offset 91, 27 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">90 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dir_out<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(dir_out)</td><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>dir_out<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(dir_out)</td></tr>
<tr class="diffunmodified"><td class="diffline">91 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>path_in<span class="dp">·</span>in<span class="dp">·</span>walk_dir(dir_in):</td><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>for<span class="dp">·</span>path_in<span class="dp">·</span>in<span class="dp">·</span>walk_dir(dir_in):</td></tr>
<tr class="diffunmodified"><td class="diffline">92 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>path_out<span class="dp">·</span>=<span class="dp">·</span>path_in.replace(dir_in,<span class="dp">·</span>dir_out)</td><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>path_out<span class="dp">·</span>=<span class="dp">·</span>path_in.replace(dir_in,<span class="dp">·</span>dir_out)</td></tr>
<tr class="diffunmodified"><td class="diffline">93 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>os.path.exists(path_out):</td><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>os.path.exists(path_out):</td></tr>
<tr class="diffunmodified"><td class="diffline">94 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(path_out)</td><td class="diffline">95 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(path_out)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">95 </td><td class="diffpresent">def<span class="dp">·</span>update_encrypted_dir(key<del>_file</del>:<span class="dp">·</span><del>s</del>t<del>r</del>,<span class="dp">·</span>plain_dir:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_dir:<span class="dp">·</span>str,<span class="dp">·</span>max_workers:<span class="dp">·</span>int<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None):</td><td class="diffline">96 </td><td class="diffpresent">def<span class="dp">·</span>update_encrypted_dir(key:<span class="dp">·</span><ins>b</ins><ins>y</ins>t<ins>e</ins><ins>s</ins>,<span class="dp">·</span>plain_dir:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_dir:<span class="dp">·</span>str,<span class="dp">·</span>max_workers:<span class="dp">·</span>int<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffunmodified"><td class="diffline">96 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">97 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed</td><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed</td></tr>
<tr class="diffunmodified"><td class="diffline">98 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>plain_dir:</td><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>plain_dir:</td></tr>
<tr class="diffunmodified"><td class="diffline">99 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>encrypted_dir:</td><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>encrypted_dir:</td></tr>
<tr class="diffchanged"><td class="diffline">100 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key<del>_file</del>:</td><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key:</td></tr>
<tr class="diffunmodified"><td class="diffline">101 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>max_workers:</td><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>max_workers:</td></tr>
<tr class="diffunmodified"><td class="diffline">102 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:return:</td><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:return:</td></tr>
<tr class="diffunmodified"><td class="diffline">103 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">104 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(plain_dir)</td><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(plain_dir)</td></tr>
<tr class="diffunmodified"><td class="diffline">105 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(encrypted_dir)</td><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(encrypted_dir)</td></tr>
<tr class="diffchanged"><td class="diffline">106 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>codec<span class="dp">·</span>=<span class="dp">·</span>Codec(key<del>_file</del>)</td><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>codec<span class="dp">·</span>=<span class="dp">·</span>Codec(key)</td></tr>
<tr class="diffunmodified"><td class="diffline">107 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>copy_dir_structure(plain_dir,<span class="dp">·</span>encrypted_dir)</td><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>copy_dir_structure(plain_dir,<span class="dp">·</span>encrypted_dir)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">108 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>make_dir_and_encrypt_file_if_needed(plain_path:<span class="dp">·</span>str):</td><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>make_dir_and_encrypt_file_if_needed(plain_path:<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">109 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_path<span class="dp">·</span>=<span class="dp">·</span>plain_path_to_encrypted_path(plain_dir,<span class="dp">·</span>encrypted_dir,<span class="dp">·</span>plain_path)</td><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_path<span class="dp">·</span>=<span class="dp">·</span>plain_path_to_encrypted_path(plain_dir,<span class="dp">·</span>encrypted_dir,<span class="dp">·</span>plain_path)</td></tr>
<tr class="diffunmodified"><td class="diffline">110 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>try:</td><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>try:</td></tr>
<tr class="diffunmodified"><td class="diffline">111 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(os.path.dirname(encrypted_path))</td><td class="diffline">113 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(os.path.dirname(encrypted_path))</td></tr>
<tr class="diffunmodified"><td class="diffline">112 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>except<span class="dp">·</span>FileExistsError:</td><td class="diffline">114 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>except<span class="dp">·</span>FileExistsError:</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 126, 26 lines modified</td><td colspan="2">Offset 128, 27 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">126 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sys.stdout.write(f&quot;encrypted:<span class="dp">·</span>{encrypted_path}\n&quot;)</td><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>sys.stdout.write(f&quot;encrypted:<span class="dp">·</span>{encrypted_path}\n&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">127 </td><td class="diffpresent">def<span class="dp">·</span>is_encrypted_file(path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td><td class="diffline">129 </td><td class="diffpresent">def<span class="dp">·</span>is_encrypted_file(path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td></tr>
<tr class="diffunmodified"><td class="diffline">128 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>path.endswith(f&quot;.{ENCRYPTED_EXT}&quot;)</td><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>path.endswith(f&quot;.{ENCRYPTED_EXT}&quot;)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">129 </td><td class="diffpresent">def<span class="dp">·</span>restore_encrypted_dir(key<del>_file</del>:<span class="dp">·</span><del>s</del>t<del>r</del>,<span class="dp">·</span>encrypted_dir:<span class="dp">·</span>str,<span class="dp">·</span>restored_dir:<span class="dp">·</span>str,<span class="dp">·</span>max_workers:<span class="dp">·</span>int<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None):</td><td class="diffline">131 </td><td class="diffpresent">def<span class="dp">·</span>restore_encrypted_dir(key:<span class="dp">·</span><ins>b</ins><ins>y</ins>t<ins>e</ins><ins>s</ins>,<span class="dp">·</span>encrypted_dir:<span class="dp">·</span>str,<span class="dp">·</span>restored_dir:<span class="dp">·</span>str,<span class="dp">·</span>max_workers:<span class="dp">·</span>int<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None):</td></tr>
<tr class="diffunmodified"><td class="diffline">130 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">131 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir</td><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypt<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir</td></tr>
<tr class="diffunmodified"><td class="diffline">132 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>restored_dir:</td><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>restored_dir:</td></tr>
<tr class="diffunmodified"><td class="diffline">133 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>encrypted_dir:</td><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>encrypted_dir:</td></tr>
<tr class="diffchanged"><td class="diffline">134 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key<del>_file</del>:</td><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key:</td></tr>
<tr class="diffunmodified"><td class="diffline">135 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>max_workers:</td><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>max_workers:</td></tr>
<tr class="diffunmodified"><td class="diffline">136 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:return:</td><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:return:</td></tr>
<tr class="diffunmodified"><td class="diffline">137 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffunmodified"><td class="diffline">138 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(encrypted_dir)</td><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(encrypted_dir)</td></tr>
<tr class="diffunmodified"><td class="diffline">139 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(restored_dir)</td><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir<span class="dp">·</span>=<span class="dp">·</span>os.path.abspath(restored_dir)</td></tr>
<tr class="diffchanged"><td class="diffline">140 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>codec<span class="dp">·</span>=<span class="dp">·</span>Codec(key<del>_file</del>)</td><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>codec<span class="dp">·</span>=<span class="dp">·</span>Codec(key)</td></tr>
<tr class="diffunmodified"><td class="diffline">141 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>copy_dir_structure(encrypted_dir,<span class="dp">·</span>restored_dir)</td><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>copy_dir_structure(encrypted_dir,<span class="dp">·</span>restored_dir)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">142 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>decrypt_file(encrypted_path:<span class="dp">·</span>str):</td><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>decrypt_file(encrypted_path:<span class="dp">·</span>str):</td></tr>
<tr class="diffunmodified"><td class="diffline">143 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_path<span class="dp">·</span>=<span class="dp">·</span>encrypted_path_to_plain_path(restored_dir,<span class="dp">·</span>encrypted_dir,<span class="dp">·</span>encrypted_path)</td><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_path<span class="dp">·</span>=<span class="dp">·</span>encrypted_path_to_plain_path(restored_dir,<span class="dp">·</span>encrypted_dir,<span class="dp">·</span>encrypted_path)</td></tr>
<tr class="diffunmodified"><td class="diffline">144 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>try:</td><td class="diffline">147 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>try:</td></tr>
<tr class="diffunmodified"><td class="diffline">145 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(os.path.dirname(decrypted_path))</td><td class="diffline">148 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>os.makedirs(os.path.dirname(decrypted_path))</td></tr>
<tr class="diffunmodified"><td class="diffline">146 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>except<span class="dp">·</span>FileExistsError:</td><td class="diffline">149 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>except<span class="dp">·</span>FileExistsError:</td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">5.58 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/crypt_dir/crypt_file.py</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt_file.py"><span class="source">crypt-dir-1.1.0/crypt_dir/crypt_file.py</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-crypt_file.py">¶</a>
      </div>
      </div>
      <div class="comment">Files 17% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 75 lines modified</td><td colspan="2">Offset 1, 100 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">#!/usr/bin/env<span class="dp">·</span>python</td><td class="diffline">1 </td><td class="diffpresent">#!/usr/bin/env<span class="dp">·</span>python</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>__future__<span class="dp">·</span>import<span class="dp">·</span>annotations</td><td class="diffline">2 </td><td class="diffpresent">from<span class="dp">·</span>__future__<span class="dp">·</span>import<span class="dp">·</span>annotations</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">import<span class="dp">·</span>io</td><td class="diffline">3 </td><td class="diffpresent">import<span class="dp">·</span>io</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">4 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">5 </td><td class="diffpresent">from<span class="dp">·</span>dataclasses<span class="dp">·</span>import<span class="dp">·</span>dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">6 </td><td class="diffpresent">from<span class="dp">·</span>typing<span class="dp">·</span>import<span class="dp">·</span>BinaryIO</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">5 </td><td class="diffpresent">from<span class="dp">·</span>.crypt<span class="dp">·</span>import<span class="dp">·</span>aes256_encrypt,<span class="dp">·</span>aes256_decrypt,<span class="dp">·</span>sha1_hash,<span class="dp">·</span><del>random_bytes,<span class="dp">·</span>IV_SIZE,<span class="dp">·</span></del>BLOCK_SIZE,<span class="dp">·</span>KEY_SIZE</td><td class="diffline">7 </td><td class="diffpresent">from<span class="dp">·</span>.crypt<span class="dp">·</span>import<span class="dp">·</span>aes256_encrypt,<span class="dp">·</span>aes256_decrypt,<span class="dp">·</span>sha1_hash,<span class="dp">·</span>BLOCK_SIZE,<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">8 </td><td class="diffpresent">from<span class="dp">·</span>.serialize<span class="dp">·</span>import<span class="dp">·</span>uint64_to_bytes,<span class="dp">·</span>bytes_to_uint64,<span class="dp">·</span>UINT64_SIZE</td></tr>
<tr class="diffchanged"><td class="diffline">6 </td><td class="diffpresent">from<span class="dp">·</span>.sig<span class="dp">·</span>import<span class="dp">·</span>get_file_sig<del>nature</del>,<span class="dp">·</span>FILE_SIG<del>NATURE</del>_SIZE,<span class="dp">·</span>get_key_sig<del>nature</del>,<span class="dp">·</span>KEY_SIG<del>NATURE</del>_SIZE,<span class="dp">·</span>set_file_signature</td><td class="diffline">9 </td><td class="diffpresent">from<span class="dp">·</span>.sig<ins>nature</ins><span class="dp">·</span>import<span class="dp">·</span>get_file_sig,<span class="dp">·</span>FILE_SIG_SIZE,<span class="dp">·</span>get_key_sig,<span class="dp">·</span>KEY_SIG_SIZE,<span class="dp">·</span>set_file_signature</td></tr>
<tr class="diffdeleted"><td class="diffline">7 </td><td class="diffpresent">from<span class="dp">·</span>.util<span class="dp">·</span>import<span class="dp">·</span>uint64_to_bytes,<span class="dp">·</span>bytes_to_uint64,<span class="dp">·</span>write_hex_file,<span class="dp">·</span>read_hex_file,<span class="dp">·</span>UINT64_SIZE</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">10 </td><td class="diffpresent">@dataclass</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">11 </td><td class="diffpresent">class<span class="dp">·</span>Header:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig:<span class="dp">·</span>bytes</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig:<span class="dp">·</span>bytes</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size:<span class="dp">·</span>int</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>init_vec:<span class="dp">·</span>bytes</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">16 </td><td class="diffpresent">def<span class="dp">·</span>read_header(read_io:<span class="dp">·</span>BinaryIO)<span class="dp">·</span>-&gt;<span class="dp">·</span>Header:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<span class="dp">·</span>=<span class="dp">·</span>read_io.read(FILE_SIG_SIZE)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<span class="dp">·</span>=<span class="dp">·</span>read_io.read(KEY_SIG_SIZE)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span>=<span class="dp">·</span>bytes_to_uint64(read_io.read(UINT64_SIZE))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>init_vec<span class="dp">·</span>=<span class="dp">·</span>read_io.read(BLOCK_SIZE)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>Header(file_sig=file_sig,<span class="dp">·</span>key_sig=key_sig,<span class="dp">·</span>file_size=file_size,<span class="dp">·</span>init_vec=init_vec)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">22 </td><td class="diffpresent">def<span class="dp">·</span>write_header(write_io:<span class="dp">·</span>BinaryIO,<span class="dp">·</span>header:<span class="dp">·</span>Header):</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_io.write(header.file_sig)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_io.write(header.key_sig)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_io.write(uint64_to_bytes(header.file_size))</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_io.write(header.init_vec)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">def<span class="dp">·</span>aes256_encrypt_file_if_needed(</td><td class="diffline">27 </td><td class="diffpresent">def<span class="dp">·</span>aes256_encrypt_file_if_needed(</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>plain_path:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str,</td><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>plain_path:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str,</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig:<span class="dp">·</span>bytes<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig:<span class="dp">·</span>bytes<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td><td class="diffline">30 </td><td class="diffpresent">)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>key_sig<span class="dp">·</span>is<span class="dp">·</span>None:</td><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>key_sig<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffchanged"><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<span class="dp">·</span>=<span class="dp">·</span>get_key_sig<del>nature</del>(key)</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<span class="dp">·</span>=<span class="dp">·</span>get_key_sig(key)</td></tr>
<tr class="diffchanged"><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>plain_</del>file_sig<span class="dp">·</span>=<span class="dp">·</span>get_file_sig<del>nature</del>(plain_path)</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<span class="dp">·</span>=<span class="dp">·</span>get_file_sig(plain_path)</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>check<span class="dp">·</span>file<span class="dp">·</span>updated</td><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>check<span class="dp">·</span>file<span class="dp">·</span>updated</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>os.path.exists(encrypted_path):</td><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>os.path.exists(encrypted_path):</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffdeleted"><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_file_sig<span class="dp">·</span>=<span class="dp">·</span>f.read(FILE_SIGNATURE_SIZE)</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">19 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>if</del><span class="dp">·</span><del>plain</del><del>_fil</del>e<del>_sig</del><span class="dp">·</span><del>=</del>=<span class="dp">·</span><del>enc</del>r<del>yp</del><del>te</del>d_<del>file_sig:</del></td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>h</ins>e<ins>ader</ins><span class="dp">·</span>=<span class="dp">·</span>r<ins>ea</ins>d_<ins>header(f)</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>key_sig<span class="dp">·</span>==<span class="dp">·</span>header.key_sig<span class="dp">·</span>and<span class="dp">·</span>file_sig<span class="dp">·</span>==<span class="dp">·</span>header.file_sig:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>only<span class="dp">·</span>skip<span class="dp">·</span>if<span class="dp">·</span>both<span class="dp">·</span>key_sig<span class="dp">·</span>and<span class="dp">·</span>file_sig<span class="dp">·</span>are<span class="dp">·</span>the<span class="dp">·</span>same</td></tr>
<tr class="diffunmodified"><td class="diffline">20 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>False</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>False</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">21 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypted<span class="dp">·</span>file<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>updated<span class="dp">·</span>regardless<span class="dp">·</span>its<span class="dp">·</span>mtime<span class="dp">·</span>is<span class="dp">·</span>sooner<span class="dp">·</span>or<span class="dp">·</span>later</td><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypted<span class="dp">·</span>file<span class="dp">·</span>will<span class="dp">·</span>be<span class="dp">·</span>updated<span class="dp">·</span>regardless<span class="dp">·</span>its<span class="dp">·</span>mtime<span class="dp">·</span>is<span class="dp">·</span>sooner<span class="dp">·</span>or<span class="dp">·</span>later</td></tr>
<tr class="diffunmodified"><td class="diffline">22 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypt</td><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>encrypt</td></tr>
<tr class="diffchanged"><td class="diffline">23 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>iv<span class="dp">·</span>=<span class="dp">·</span>random<del>_by</del><del>tes(IV</del>_SIZE)</td><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<ins>nit_</ins>v<ins>ec</ins><span class="dp">·</span>=<span class="dp">·</span><ins>os.u</ins>random<ins>(BLOCK</ins>_SIZE)</td></tr>
<tr class="diffchanged"><td class="diffline">24 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>size<span class="dp">·</span>=<span class="dp">·</span>os.path.getsize(plain_path)</td><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>file_</ins>size<span class="dp">·</span>=<span class="dp">·</span>os.path.getsize(plain_path)</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(plain_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>plain_f,<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;wb&quot;)<span class="dp">·</span>as<span class="dp">·</span>encrypted_f:</td><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(plain_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>plain_f,<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;wb&quot;)<span class="dp">·</span>as<span class="dp">·</span>encrypted_f:</td></tr>
<tr class="diffdeleted"><td class="diffline">26 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_f.write(plain_file_sig)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>file<span class="dp">·</span>signature<span class="dp">·</span>-<span class="dp">·</span>little<span class="dp">·</span>endian<span class="dp">·</span>of<span class="dp">·</span>mtime<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">27 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_f.write(key_sig)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>key<span class="dp">·</span>signature</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">28 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_f.write(uint64_to_bytes(size))<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>little<span class="dp">·</span>endian<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">29 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><del>encrypt</del>ed<del>_f.</del>write<del>(</del>i<del>v)<span class="dp">·</span></del><del><span class="dp">·</span>#<span class="dp">·</span>16<span class="dp">·</span>by</del>te<del>s<span class="dp">·</span></del><del>-<span class="dp">·</span>initi</del>a<del>li</del><del>zation<span class="dp">·</span>v</del>e<del>ct</del><del>or</del></td><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><ins>write_h</ins>e<ins>a</ins>d<ins>er(</ins>write<ins>_</ins>i<ins>o=encryp</ins>te<ins>d_f,<span class="dp">·</span>he</ins>a<ins>der=Head</ins>e<ins>r(</ins></td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig=file_sig,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">48 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig=key_sig,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size=file_size,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>init_vec=init_vec,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>))</td></tr>
<tr class="diffchanged"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_encrypt(key=key,<span class="dp">·</span>iv=iv,<span class="dp">·</span>plain_read_io=plain_f,<span class="dp">·</span>encrypted_write_io=encrypted_f)</td><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_encrypt(key=key,<span class="dp">·</span>i<ins>nit_</ins>v<ins>ec</ins>=<ins>in</ins>i<ins>t_</ins>v<ins>ec</ins>,<span class="dp">·</span>plain_read_io=plain_f,<span class="dp">·</span>encrypted_write_io=encrypted_f)</td></tr>
<tr class="diffunmodified"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>True</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>True</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">def<span class="dp">·</span>aes256_decrypt_file(</td><td class="diffline">54 </td><td class="diffpresent">def<span class="dp">·</span>aes256_decrypt_file(</td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str,<span class="dp">·</span>decrypted_path:<span class="dp">·</span>str,</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key:<span class="dp">·</span>bytes,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str,<span class="dp">·</span>decrypted_path:<span class="dp">·</span>str,</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig:<span class="dp">·</span>bytes<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None,</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig:<span class="dp">·</span>bytes<span class="dp">·</span>|<span class="dp">·</span>None<span class="dp">·</span>=<span class="dp">·</span>None,</td></tr>
<tr class="diffunmodified"><td class="diffline">35 </td><td class="diffpresent">):</td><td class="diffline">57 </td><td class="diffpresent">):</td></tr>
<tr class="diffunmodified"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>key_sig<span class="dp">·</span>is<span class="dp">·</span>None:</td><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>key_sig<span class="dp">·</span>is<span class="dp">·</span>None:</td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<span class="dp">·</span>=<span class="dp">·</span>get_key_sig<del>nature</del>(key)</td><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<span class="dp">·</span>=<span class="dp">·</span>get_key_sig(key)</td></tr>
<tr class="diffunmodified"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>encrypted_f,<span class="dp">·</span>open(decrypted_path,<span class="dp">·</span>&quot;wb&quot;)<span class="dp">·</span>as<span class="dp">·</span>decrypted_f:</td><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(encrypted_path,<span class="dp">·</span>&quot;rb&quot;)<span class="dp">·</span>as<span class="dp">·</span>encrypted_f,<span class="dp">·</span>open(decrypted_path,<span class="dp">·</span>&quot;wb&quot;)<span class="dp">·</span>as<span class="dp">·</span>decrypted_f:</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>header<span class="dp">·</span>=<span class="dp">·</span>read_header(encrypted_f)</td></tr>
<tr class="diffdeleted"><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_file_sig<span class="dp">·</span>=<span class="dp">·</span>encrypted_f.read(FILE_SIGNATURE_SIZE)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>file<span class="dp">·</span>signature<span class="dp">·</span>-<span class="dp">·</span>little<span class="dp">·</span>endian<span class="dp">·</span>of<span class="dp">·</span>mtime<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_key_sig<span class="dp">·</span>=<span class="dp">·</span>encrypted_f.read(KEY_SIGNATURE_SIZE)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>key<span class="dp">·</span>signature</td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">41 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span><del>enc</del><del>rypt</del>e<del>d_</del>key_sig<span class="dp">·</span>!=<span class="dp">·</span>key_sig:</td><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span><ins>head</ins>e<ins>r.</ins>key_sig<span class="dp">·</span>!=<span class="dp">·</span>key_sig:</td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>RuntimeError(f&quot;signature<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>match<span class="dp">·</span>for<span class="dp">·</span>{encrypted_path}&quot;)</td><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>raise<span class="dp">·</span>RuntimeError(f&quot;signature<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>match<span class="dp">·</span>for<span class="dp">·</span>{encrypted_path}&quot;)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_decrypt(key=key,<span class="dp">·</span>init_vec=header.init_vec,<span class="dp">·</span>file_size=header.file_size,<span class="dp">·</span>encrypted_read_io=encrypted_f,</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">65 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>decrypted_write_io=decrypted_f)</td></tr>
<tr class="diffdeleted"><td class="diffline">43 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>size<span class="dp">·</span>=<span class="dp">·</span>bytes_to_uint64(encrypted_f.read(UINT64_SIZE))<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>little<span class="dp">·</span>endian<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">44 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>iv<span class="dp">·</span>=<span class="dp">·</span>encrypted_f.read(BLOCK_SIZE)<span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span>-<span class="dp">·</span>initialization<span class="dp">·</span>vector</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">45 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>aes256_decrypt(key=key,<span class="dp">·</span>iv=iv,<span class="dp">·</span>size=size,<span class="dp">·</span>encrypted_read_io=encrypted_f,<span class="dp">·</span>decrypted_write_io=decrypted_f)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>file<span class="dp">·</span>signature</td><td class="diffline">66 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>#<span class="dp">·</span>set<span class="dp">·</span>file<span class="dp">·</span>signature</td></tr>
<tr class="diffchanged"><td class="diffline">47 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>set_file_signature(path=decrypted_path,<span class="dp">·</span>sig=<del>enc</del><del>rypt</del>e<del>d_</del>file_sig)</td><td class="diffline">67 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>set_file_signature(path=decrypted_path,<span class="dp">·</span>sig=<ins>head</ins>e<ins>r.</ins>file_sig)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">class<span class="dp">·</span>Codec:</td><td class="diffline">68 </td><td class="diffpresent">class<span class="dp">·</span>Codec:</td></tr>
<tr class="diffchanged"><td class="diffline">49 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>key<del>_path</del>:<span class="dp">·</span><del>s</del>t<del>r</del>):</td><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>__init__(self,<span class="dp">·</span>key:<span class="dp">·</span><ins>b</ins><ins>y</ins>t<ins>e</ins><ins>s</ins>):</td></tr>
<tr class="diffunmodified"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Codec:<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>decrypt<span class="dp">·</span>a<span class="dp">·</span>file</td><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>Codec:<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>decrypt<span class="dp">·</span>a<span class="dp">·</span>file</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted<span class="dp">·</span>file<span class="dp">·</span>structure</td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted<span class="dp">·</span>file<span class="dp">·</span>structure</td></tr>
<tr class="diffchanged"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|file_sig<del>nature</del>|key_sig<del>nature</del>|file_size|iv|encrypted_data|</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|file_sig|key_sig|file_size|<ins>in</ins>i<ins>t_</ins>v<ins>ec</ins>|encrypted_data|</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key<del>_path</del>:<del><span class="dp">·</span>path<span class="dp">·</span>to</del><span class="dp">·</span>key<del><span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>hex</del></td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>:param<span class="dp">·</span>key:<span class="dp">·</span>key</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;&quot;&quot;</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>assert<span class="dp">·</span>len(key)<span class="dp">·</span>==<span class="dp">·</span>KEY_SIZE</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.key<span class="dp">·</span>=<span class="dp">·</span>key</td></tr>
<tr class="diffdeleted"><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>if<span class="dp">·</span>not<span class="dp">·</span>os.path.exists(key_path):</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">57 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>write_hex_file(key_path,<span class="dp">·</span>random_bytes(KEY_SIZE))</td><td colspan="2"> </td></tr>
<tr class="diffdeleted"><td class="diffline">58 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.key<span class="dp">·</span>=<span class="dp">·</span>read_hex_file(key_path)</td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.sig<span class="dp">·</span>=<span class="dp">·</span>sha1_hash(io.BytesIO(self.key))</td><td class="diffline">78 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>self.sig<span class="dp">·</span>=<span class="dp">·</span>sha1_hash(io.BytesIO(self.key))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>encrypt_file_if_needed(self,<span class="dp">·</span>plain_path:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td><td class="diffline">79 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>def<span class="dp">·</span>encrypt_file_if_needed(self,<span class="dp">·</span>plain_path:<span class="dp">·</span>str,<span class="dp">·</span>encrypted_path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bool:</td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>aes256_encrypt_file_if_needed(</td><td class="diffline">80 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>aes256_encrypt_file_if_needed(</td></tr>
<tr class="diffunmodified"><td class="diffline">62 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key=self.key,</td><td class="diffline">81 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key=self.key,</td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain_path=plain_path,</td><td class="diffline">82 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>plain_path=plain_path,</td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_path=encrypted_path,</td><td class="diffline">83 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_path=encrypted_path,</td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">844 B</span></div>
      <div><span class="source">crypt-dir-1.0.8/crypt_dir/sig.py</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-sig.py"><span class="source">crypt-dir-1.1.0/crypt_dir/signature.py</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir-sig.py">¶</a>
      </div>
      </div>
      <div class="comment">Files 5% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 22 lines modified</td><td colspan="2">Offset 1, 22 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>io</td><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>io</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">import<span class="dp">·</span>os</td><td class="diffline">2 </td><td class="diffpresent">import<span class="dp">·</span>os</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>.crypt<span class="dp">·</span>import<span class="dp">·</span>sha1_hash,<span class="dp">·</span>HASH_SIZE</td><td class="diffline">3 </td><td class="diffpresent">from<span class="dp">·</span>.crypt<span class="dp">·</span>import<span class="dp">·</span>sha1_hash,<span class="dp">·</span>HASH_SIZE</td></tr>
<tr class="diffchanged"><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>.<del>ut</del>il<span class="dp">·</span>import<span class="dp">·</span>uint64_to_bytes,<span class="dp">·</span>UINT64_SIZE,<span class="dp">·</span>bytes_to_uint64</td><td class="diffline">4 </td><td class="diffpresent">from<span class="dp">·</span>.<ins>s</ins><ins>er</ins>i<ins>a</ins>l<ins>ize</ins><span class="dp">·</span>import<span class="dp">·</span>uint64_to_bytes,<span class="dp">·</span>UINT64_SIZE,<span class="dp">·</span>bytes_to_uint64</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">5 </td><td class="diffpresent">KEY_SIG<del>NATURE</del>_SIZE<span class="dp">·</span>=<span class="dp">·</span>HASH_SIZE</td><td class="diffline">5 </td><td class="diffpresent">KEY_SIG_SIZE<span class="dp">·</span>=<span class="dp">·</span>HASH_SIZE</td></tr>
<tr class="diffchanged"><td class="diffline">6 </td><td class="diffpresent">FILE_SIG<del>NATURE</del>_SIZE<span class="dp">·</span>=<span class="dp">·</span>UINT64_SIZE</td><td class="diffline">6 </td><td class="diffpresent">FILE_SIG_SIZE<span class="dp">·</span>=<span class="dp">·</span>UINT64_SIZE</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">7 </td><td class="diffpresent">def<span class="dp">·</span>get_key_sig<del>nature</del>(key:<span class="dp">·</span>bytes)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td><td class="diffline">7 </td><td class="diffpresent">def<span class="dp">·</span>get_key_sig(key:<span class="dp">·</span>bytes)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>sha1_hash(io.BytesIO(key))</td><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>sha1_hash(io.BytesIO(key))</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">9 </td><td class="diffpresent">def<span class="dp">·</span>get_file_sig<del>nature</del>(path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td><td class="diffline">9 </td><td class="diffpresent">def<span class="dp">·</span>get_file_sig(path:<span class="dp">·</span>str)<span class="dp">·</span>-&gt;<span class="dp">·</span>bytes:</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stat<span class="dp">·</span>=<span class="dp">·</span>os.stat(path)</td><td class="diffline">10 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>stat<span class="dp">·</span>=<span class="dp">·</span>os.stat(path)</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mtime<span class="dp">·</span>=<span class="dp">·</span>stat.st_mtime_ns</td><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mtime<span class="dp">·</span>=<span class="dp">·</span>stat.st_mtime_ns</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>uint64_to_bytes(mtime)</td><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>return<span class="dp">·</span>uint64_to_bytes(mtime)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent">def<span class="dp">·</span>set_file_signature(path:<span class="dp">·</span>str,<span class="dp">·</span>sig:<span class="dp">·</span>bytes):</td><td class="diffline">13 </td><td class="diffpresent">def<span class="dp">·</span>set_file_signature(path:<span class="dp">·</span>str,<span class="dp">·</span>sig:<span class="dp">·</span>bytes):</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mtime<span class="dp">·</span>=<span class="dp">·</span>bytes_to_uint64(sig)</td><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>mtime<span class="dp">·</span>=<span class="dp">·</span>bytes_to_uint64(sig)</td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">4.15 KB</span></div>
      <div><span class="source">crypt-dir-1.0.8/crypt_dir.egg-info/PKG-INFO</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir.egg-info-PKG-INFO"><span class="source">crypt-dir-1.1.0/crypt_dir.egg-info/PKG-INFO</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--crypt_dir.egg-info-PKG-INFO">¶</a>
      </div>
      </div>
      <div class="comment">Files 6% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 13 lines modified</td><td colspan="2">Offset 1, 14 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">Metadata-Version:<span class="dp">·</span>2.1</td><td class="diffline">1 </td><td class="diffpresent">Metadata-Version:<span class="dp">·</span>2.1</td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">Name:<span class="dp">·</span>crypt-dir</td><td class="diffline">2 </td><td class="diffpresent">Name:<span class="dp">·</span>crypt-dir</td></tr>
<tr class="diffchanged"><td class="diffline">3 </td><td class="diffpresent">Version:<span class="dp">·</span>1.<del>0</del>.<del>8</del></td><td class="diffline">3 </td><td class="diffpresent">Version:<span class="dp">·</span>1.<ins>1</ins>.<ins>0</ins></td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent">Home-page:<span class="dp">·</span>https://github.com/khanh-nguyen-code/crypt-dir</td><td class="diffline">4 </td><td class="diffpresent">Home-page:<span class="dp">·</span>https://github.com/khanh-nguyen-code/crypt-dir</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent">Author:<span class="dp">·</span>Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh</td><td class="diffline">5 </td><td class="diffpresent">Author:<span class="dp">·</span>Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent">Author-email:<span class="dp">·</span>khanh.nguyen.contact@gmail.com</td><td class="diffline">6 </td><td class="diffpresent">Author-email:<span class="dp">·</span>khanh.nguyen.contact@gmail.com</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">7 </td><td class="diffpresent">License:<span class="dp">·</span>MIT</td></tr>
<tr class="diffunmodified"><td class="diffline">7 </td><td class="diffpresent">Description-Content-Type:<span class="dp">·</span>text/markdown</td><td class="diffline">8 </td><td class="diffpresent">Description-Content-Type:<span class="dp">·</span>text/markdown</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent">License-File:<span class="dp">·</span>LICENSE</td><td class="diffline">9 </td><td class="diffpresent">License-File:<span class="dp">·</span>LICENSE</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent">#<span class="dp">·</span>CRYPT_DIR</td><td class="diffline">10 </td><td class="diffpresent">#<span class="dp">·</span>CRYPT_DIR</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent">-<span class="dp">·</span>Encrypt<span class="dp">·</span>all<span class="dp">·</span>your<span class="dp">·</span>files<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>into<span class="dp">·</span>another<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>there<span class="dp">·</span>is<span class="dp">·</span>update</td><td class="diffline">11 </td><td class="diffpresent">-<span class="dp">·</span>Encrypt<span class="dp">·</span>all<span class="dp">·</span>your<span class="dp">·</span>files<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>into<span class="dp">·</span>another<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>there<span class="dp">·</span>is<span class="dp">·</span>update</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent">-<span class="dp">·</span>Clean<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>files<span class="dp">·</span>or<span class="dp">·</span>directories<span class="dp">·</span>have<span class="dp">·</span>been<span class="dp">·</span>deleted</td><td class="diffline">12 </td><td class="diffpresent">-<span class="dp">·</span>Clean<span class="dp">·</span>the<span class="dp">·</span>encrypted<span class="dp">·</span>directory<span class="dp">·</span>if<span class="dp">·</span>files<span class="dp">·</span>or<span class="dp">·</span>directories<span class="dp">·</span>have<span class="dp">·</span>been<span class="dp">·</span>deleted</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 23, 85 lines modified</td><td colspan="2">Offset 24, 93 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">23 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">24 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">24 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">25 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">25 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">26 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">26 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">27 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">27 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">28 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">29 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">28 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td><td class="diffline">30 </td><td class="diffpresent">#<span class="dp">·</span>Delete<span class="dp">·</span>all<span class="dp">·</span>files,<span class="dp">·</span>directories<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>that<span class="dp">·</span>don&#x27;t<span class="dp">·</span>exist<span class="dp">·</span>in<span class="dp">·</span>the<span class="dp">·</span>plain_dir</td></tr>
<tr class="diffunmodified"><td class="diffline">29 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td><td class="diffline">31 </td><td class="diffpresent">crypt_dir.clean_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">30 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">32 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">31 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">33 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">32 </td><td class="diffpresent">)</td><td class="diffline">34 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">33 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">35 </td><td class="diffpresent">#<span class="dp">·</span>read<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>plain_dir,<span class="dp">·</span>encrypt<span class="dp">·</span>and<span class="dp">·</span>write<span class="dp">·</span>files<span class="dp">·</span>into<span class="dp">·</span>encrypted_dir<span class="dp">·</span>if<span class="dp">·</span>needed<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">34 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td><td class="diffline">36 </td><td class="diffpresent">crypt_dir.update_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">35 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>key=key,</td></tr>
<tr class="diffchanged"><td class="diffline">36 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>plain_dir=plain_dir,</td><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>plain_dir=plain_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">37 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">39 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffchanged"><td class="diffline">38 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">40 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">39 </td><td class="diffpresent">)</td><td class="diffline">41 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">40 </td><td class="diffpresent">```</td><td class="diffline">42 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">41 </td><td class="diffpresent">-<span class="dp">·</span>restore</td><td class="diffline">43 </td><td class="diffpresent">-<span class="dp">·</span>restore</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">42 </td><td class="diffpresent">```python</td><td class="diffline">44 </td><td class="diffpresent">```python</td></tr>
<tr class="diffunmodified"><td class="diffline">43 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td><td class="diffline">45 </td><td class="diffpresent">import<span class="dp">·</span>crypt_dir</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">44 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td><td class="diffline">46 </td><td class="diffpresent">key_file<span class="dp">·</span>=<span class="dp">·</span>&quot;key.txt&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">45 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td><td class="diffline">47 </td><td class="diffpresent">plain_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;plain&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">46 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td><td class="diffline">48 </td><td class="diffpresent">encrypted_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;encrypted&quot;</td></tr>
<tr class="diffunmodified"><td class="diffline">47 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td><td class="diffline">49 </td><td class="diffpresent">restored_dir<span class="dp">·</span>=<span class="dp">·</span>&quot;restored&quot;</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">50 </td><td class="diffpresent">key<span class="dp">·</span>=<span class="dp">·</span>crypt_dir.read_or_create_key(key_file)</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">48 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td><td class="diffline">51 </td><td class="diffpresent">#<span class="dp">·</span>restore<span class="dp">·</span>all<span class="dp">·</span>files<span class="dp">·</span>in<span class="dp">·</span>encrypted_dir<span class="dp">·</span>using<span class="dp">·</span>12<span class="dp">·</span>workers</td></tr>
<tr class="diffunmodified"><td class="diffline">49 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td><td class="diffline">52 </td><td class="diffpresent">crypt_dir.restore_encrypted_dir(</td></tr>
<tr class="diffchanged"><td class="diffline">50 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key<del>_file</del>=key<del>_file</del>,</td><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key=key,</td></tr>
<tr class="diffunmodified"><td class="diffline">51 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td><td class="diffline">54 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_dir=encrypted_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">52 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td><td class="diffline">55 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>restored_dir=restored_dir,</td></tr>
<tr class="diffunmodified"><td class="diffline">53 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td><td class="diffline">56 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>max_workers=12,</td></tr>
<tr class="diffunmodified"><td class="diffline">54 </td><td class="diffpresent">)</td><td class="diffline">57 </td><td class="diffpresent">)</td></tr>
<tr class="diffunmodified"><td class="diffline">55 </td><td class="diffpresent">```</td><td class="diffline">58 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">56 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td><td class="diffline">59 </td><td class="diffpresent">#<span class="dp">·</span>INSTALLATION</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">57 </td><td class="diffpresent">```shell</td><td class="diffline">60 </td><td class="diffpresent">```shell</td></tr>
<tr class="diffunmodified"><td class="diffline">58 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td><td class="diffline">61 </td><td class="diffpresent">pip<span class="dp">·</span>install<span class="dp">·</span>--upgrade<span class="dp">·</span>crypt-dir</td></tr>
<tr class="diffunmodified"><td class="diffline">59 </td><td class="diffpresent">```</td><td class="diffline">62 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">60 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td><td class="diffline">63 </td><td class="diffpresent">#<span class="dp">·</span>DECRYPT<span class="dp">·</span>IT<span class="dp">·</span>YOURSELF</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">61 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td><td class="diffline">64 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>1.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">62 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">65 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">66 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">63 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">67 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">64 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">68 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">65 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td><td class="diffline">69 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>modified<span class="dp">·</span>(mtime<span class="dp">·</span>changes)</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">66 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td><td class="diffline">70 </td><td class="diffpresent">-<span class="dp">·</span>file<span class="dp">·</span>is<span class="dp">·</span>decrypt-able<span class="dp">·</span>if<span class="dp">·</span>`signature`<span class="dp">·</span>matches<span class="dp">·</span>`key`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">67 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td><td class="diffline">71 </td><td class="diffpresent">-<span class="dp">·</span>`.enc1`<span class="dp">·</span>file</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`header`:</td></tr>
<tr class="diffchanged"><td class="diffline">68 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_sig<del>nature</del>`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">73 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_sig`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>mtime<span class="dp">·</span>of<span class="dp">·</span>file<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">69 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`key_sig<del>nature</del>`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td><td class="diffline">74 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`key_sig`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>bytes<span class="dp">·</span>of<span class="dp">·</span>key</td></tr>
<tr class="diffchanged"><td class="diffline">70 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td><td class="diffline">75 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file_size`:<span class="dp">·</span>little-endian<span class="dp">·</span>encoded<span class="dp">·</span>file<span class="dp">·</span>size<span class="dp">·</span>in<span class="dp">·</span>uint64</td></tr>
<tr class="diffchanged"><td class="diffline">71 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`iv`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td><td class="diffline">76 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`<ins>in</ins>i<ins>t_</ins>v<ins>ec</ins>`:<span class="dp">·</span>`AES256`<span class="dp">·</span>initialization<span class="dp">·</span>vector</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">72 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td><td class="diffline">77 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><ins><span class="dp">·</span><span class="dp">·</span></ins>-<span class="dp">·</span>`file<span class="dp">·</span>encrypted`:<span class="dp">·</span>`AES256`<span class="dp">·</span>file<span class="dp">·</span>encrypted<span class="dp">·</span>bytes<span class="dp">·</span>with<span class="dp">·</span>chunk<span class="dp">·</span>size<span class="dp">·</span>of<span class="dp">·</span>`2^30`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">73 </td><td class="diffpresent">```</td><td class="diffline">78 </td><td class="diffpresent">```</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">79 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>header<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffchanged"><td class="diffline">74 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<del>nature</del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<del>v<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></del><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">80 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>key_sig<ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span></ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>file_size<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>i<ins>nit_vec</ins><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>encrypted_data<span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">75 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td><td class="diffline">81 </td><td class="diffpresent">|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>20<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>8<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>16<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>n<span class="dp">·</span>bytes<span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>|</td></tr>
<tr class="diffunmodified"><td class="diffline">76 </td><td class="diffpresent">```</td><td class="diffline">82 </td><td class="diffpresent">```</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">77 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td><td class="diffline">83 </td><td class="diffpresent">##<span class="dp">·</span>SPECIFICATION<span class="dp">·</span>0.*</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffchanged"><td class="diffline">78 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here<del><span class="dp">·</span>is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</del></td><td class="diffline">84 </td><td class="diffpresent">You<span class="dp">·</span>don&#x27;t<span class="dp">·</span>need<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>the<span class="dp">·</span>specification.<span class="dp">·</span>For<span class="dp">·</span>some<span class="dp">·</span>folks<span class="dp">·</span>who<span class="dp">·</span>want<span class="dp">·</span>to<span class="dp">·</span>know<span class="dp">·</span>exactly<span class="dp">·</span>what<span class="dp">·</span>happened<span class="dp">·</span>with<span class="dp">·</span>their<span class="dp">·</span>files,<span class="dp">·</span>here</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">85 </td><td class="diffpresent">is<span class="dp">·</span>the<span class="dp">·</span>specification<span class="dp">·</span>for<span class="dp">·</span>`key_file`<span class="dp">·</span>and<span class="dp">·</span>`.enc`<span class="dp">·</span>files:</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">79 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td><td class="diffline">86 </td><td class="diffpresent">-<span class="dp">·</span>if<span class="dp">·</span>`key_file`<span class="dp">·</span>does<span class="dp">·</span>not<span class="dp">·</span>exist,<span class="dp">·</span>`crypt_dir`<span class="dp">·</span>will<span class="dp">·</span>create<span class="dp">·</span>a<span class="dp">·</span>random<span class="dp">·</span>key<span class="dp">·</span>of<span class="dp">·</span>32<span class="dp">·</span>bytes<span class="dp">·</span>using<span class="dp">·</span>`os.urandom`<span class="dp">·</span>encoded<span class="dp">·</span>into<span class="dp">·</span>`hex`</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">80 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td><td class="diffline">87 </td><td class="diffpresent">-<span class="dp">·</span>two<span class="dp">·</span>algorithms<span class="dp">·</span>are<span class="dp">·</span>used<span class="dp">·</span>in<span class="dp">·</span>`crypt_dir`:<span class="dp">·</span>`SHA1`<span class="dp">·</span>and<span class="dp">·</span>`AES-256`<span class="dp">·</span>in<span class="dp">·</span>`CBC`<span class="dp">·</span>mode</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">81 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td><td class="diffline">88 </td><td class="diffpresent">-<span class="dp">·</span>encrypted<span class="dp">·</span>files<span class="dp">·</span>are<span class="dp">·</span>updated<span class="dp">·</span>only<span class="dp">·</span>if<span class="dp">·</span>file_hash<span class="dp">·</span>changes</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
</table>    </div>
    <div class="difference">
      <div class="diffheader">
      <div class="diffcontrol diffcontrol-double">⊟</div>
      <div><span class="diffsize">737 B</span></div>
      <div><span class="source">crypt-dir-1.0.8/setup.py</span> vs.</div>
      <div id="crypt-dir--.-.-.tar---crypt-dir--.-.--setup.py"><span class="source">crypt-dir-1.1.0/setup.py</span>
        <a class="anchor" href="#crypt-dir--.-.-.tar---crypt-dir--.-.--setup.py">¶</a>
      </div>
      </div>
      <div class="comment">Files 3% similar despite different names
      </div>
<table class="diff">
<colgroup><col class="colines"/><col class="coldiff"/>
<col class="colines"/><col class="coldiff"/></colgroup>
<tr style="display:none;"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="diffhunk"><td colspan="2">Offset 1, 18 lines modified</td><td colspan="2">Offset 1, 19 lines modified</td></tr>
<tr class="diffunmodified"><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>setuptools</td><td class="diffline">1 </td><td class="diffpresent">import<span class="dp">·</span>setuptools</td></tr>
<tr class="diffunmodified"><td colspan="2"> </td><td colspan="2"> </td></tr>
<tr class="diffunmodified"><td class="diffline">2 </td><td class="diffpresent">if<span class="dp">·</span>__name__<span class="dp">·</span>==<span class="dp">·</span>&quot;__main__&quot;:</td><td class="diffline">2 </td><td class="diffpresent">if<span class="dp">·</span>__name__<span class="dp">·</span>==<span class="dp">·</span>&quot;__main__&quot;:</td></tr>
<tr class="diffunmodified"><td class="diffline">3 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(&quot;README.md&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td><td class="diffline">3 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>with<span class="dp">·</span>open(&quot;README.md&quot;)<span class="dp">·</span>as<span class="dp">·</span>f:</td></tr>
<tr class="diffunmodified"><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description<span class="dp">·</span>=<span class="dp">·</span>f.read()</td><td class="diffline">4 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description<span class="dp">·</span>=<span class="dp">·</span>f.read()</td></tr>
<tr class="diffunmodified"><td class="diffline">5 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setuptools.setup(</td><td class="diffline">5 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>setuptools.setup(</td></tr>
<tr class="diffunmodified"><td class="diffline">6 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>name=&quot;crypt-dir&quot;,</td><td class="diffline">6 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>name=&quot;crypt-dir&quot;,</td></tr>
<tr class="diffchanged"><td class="diffline">7 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>version=&quot;1.<del>0</del>.<del>8</del>&quot;,</td><td class="diffline">7 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>version=&quot;1.<ins>1</ins>.<ins>0</ins>&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>author=&quot;Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh&quot;,</td><td class="diffline">8 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>author=&quot;Nguyen<span class="dp">·</span>Ngoc<span class="dp">·</span>Khanh&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">9 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>author_email=&quot;khanh.nguyen.contact@gmail.com&quot;,</td><td class="diffline">9 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>author_email=&quot;khanh.nguyen.contact@gmail.com&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">10 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description=long_description,</td><td class="diffline">10 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description=long_description,</td></tr>
<tr class="diffunmodified"><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description_content_type=&quot;text/markdown&quot;,</td><td class="diffline">11 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>long_description_content_type=&quot;text/markdown&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>url=&quot;https://github.com/khanh-nguyen-code/crypt-dir&quot;,</td><td class="diffline">12 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>url=&quot;https://github.com/khanh-nguyen-code/crypt-dir&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>packages=setuptools.find_packages(),</td><td class="diffline">13 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>packages=setuptools.find_packages(),</td></tr>
<tr class="diffadded"><td colspan="2"> </td><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>license=&quot;MIT&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">14 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>install_requires=[</td><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>install_requires=[</td></tr>
<tr class="diffunmodified"><td class="diffline">15 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;pycryptodomex==3.17&quot;,</td><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>&quot;pycryptodomex==3.17&quot;,</td></tr>
<tr class="diffunmodified"><td class="diffline">16 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>],</td><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>],</td></tr>
<tr class="diffunmodified"><td class="diffline">17 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td><td class="diffline">18 </td><td class="diffpresent"><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span><span class="dp">·</span>)</td></tr>
</table>    </div>
  </div>
</div>
<div class="footer">
Generated by
<a href="https://diffoscope.org" rel="noopener noreferrer" target="_blank">
diffoscope</a> 238
</div>
</body>
</html>

