--- tmp/chatgpt4-cli-1.4.5.tar.gz
+++ tmp/chatgpt4-cli-1.4.6.tar.gz
├── filetype from file(1)
│ @@ -1 +1 @@
│ -gzip compressed data, was "chatgpt4-cli-1.4.5.tar", last modified: Sat Apr  1 18:24:09 2023, max compression
│ +gzip compressed data, was "chatgpt4-cli-1.4.6.tar", last modified: Fri Apr  7 11:01:30 2023, max compression
│   --- chatgpt4-cli-1.4.5.tar
├── +++ chatgpt4-cli-1.4.6.tar
│ ├── file list
│ │ @@ -1,19 +1,20 @@
│ │ -drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-01 18:24:09.749989 chatgpt4-cli-1.4.5/
│ │ -drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-01 18:24:09.749989 chatgpt4-cli-1.4.5/GPTCLI/
│ │ --rw-r--r--   0 root         (0) root         (0)      324 2023-04-01 18:09:23.000000 chatgpt4-cli-1.4.5/GPTCLI/__init__.py
│ │ --rw-r--r--   0 root         (0) root         (0)       33 2023-03-31 22:49:48.000000 chatgpt4-cli-1.4.5/GPTCLI/__main__.py
│ │ --rw-r--r--   0 root         (0) root         (0)     7281 2023-04-01 17:39:22.000000 chatgpt4-cli-1.4.5/GPTCLI/emage.py
│ │ --rwxr-xr-x   0 root         (0) root         (0)    25432 2023-04-01 00:00:47.000000 chatgpt4-cli-1.4.5/GPTCLI/gptcli.py
│ │ --rw-r--r--   0 root         (0) root         (0)     5641 2023-03-29 14:11:54.000000 chatgpt4-cli-1.4.5/GPTCLI/helper.py
│ │ --rw-r--r--   0 root         (0) root         (0)     5638 2023-03-29 14:11:54.000000 chatgpt4-cli-1.4.5/GPTCLI/image.py
│ │ --rw-r--r--   0 root         (0) root         (0)    15184 2023-04-01 18:24:09.749989 chatgpt4-cli-1.4.5/PKG-INFO
│ │ --rw-r--r--   0 root         (0) root         (0)    11971 2023-04-01 18:22:17.000000 chatgpt4-cli-1.4.5/README.md
│ │ -drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-01 18:24:09.749989 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/
│ │ --rw-r--r--   0 root         (0) root         (0)    15184 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/PKG-INFO
│ │ --rw-r--r--   0 root         (0) root         (0)      340 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/SOURCES.txt
│ │ --rw-r--r--   0 root         (0) root         (0)        1 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/dependency_links.txt
│ │ --rw-r--r--   0 root         (0) root         (0)      116 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/entry_points.txt
│ │ --rw-r--r--   0 root         (0) root         (0)      111 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/requires.txt
│ │ --rw-r--r--   0 root         (0) root         (0)        7 2023-04-01 18:24:09.000000 chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/top_level.txt
│ │ --rw-r--r--   0 root         (0) root         (0)       38 2023-04-01 18:24:09.749989 chatgpt4-cli-1.4.5/setup.cfg
│ │ --rw-r--r--   0 root         (0) root         (0)     1297 2023-03-29 15:55:13.000000 chatgpt4-cli-1.4.5/setup.py
│ │ +drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-07 11:01:30.657078 chatgpt4-cli-1.4.6/
│ │ +drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-07 11:01:30.657078 chatgpt4-cli-1.4.6/GPTCLI/
│ │ +-rw-r--r--   0 root         (0) root         (0)      324 2023-04-06 18:20:59.000000 chatgpt4-cli-1.4.6/GPTCLI/__init__.py
│ │ +-rw-r--r--   0 root         (0) root         (0)       33 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/GPTCLI/__main__.py
│ │ +-rw-r--r--   0 root         (0) root         (0)     7281 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/GPTCLI/emage.py
│ │ +-rwxr-xr-x   0 root         (0) root         (0)    26504 2023-04-07 10:55:14.000000 chatgpt4-cli-1.4.6/GPTCLI/gptcli.py
│ │ +-rw-r--r--   0 root         (0) root         (0)     5641 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/GPTCLI/helper.py
│ │ +-rw-r--r--   0 root         (0) root         (0)     5638 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/GPTCLI/image.py
│ │ +-rw-r--r--   0 root         (0) root         (0)       20 2023-04-06 14:49:38.000000 chatgpt4-cli-1.4.6/GPTCLI/test.py
│ │ +-rw-r--r--   0 root         (0) root         (0)    15184 2023-04-07 11:01:30.657078 chatgpt4-cli-1.4.6/PKG-INFO
│ │ +-rw-r--r--   0 root         (0) root         (0)    11971 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/README.md
│ │ +drwxr-xr-x   0 root         (0) root         (0)        0 2023-04-07 11:01:30.657078 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/
│ │ +-rw-r--r--   0 root         (0) root         (0)    15184 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/PKG-INFO
│ │ +-rw-r--r--   0 root         (0) root         (0)      355 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/SOURCES.txt
│ │ +-rw-r--r--   0 root         (0) root         (0)        1 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/dependency_links.txt
│ │ +-rw-r--r--   0 root         (0) root         (0)      116 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/entry_points.txt
│ │ +-rw-r--r--   0 root         (0) root         (0)      111 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/requires.txt
│ │ +-rw-r--r--   0 root         (0) root         (0)        7 2023-04-07 11:01:30.000000 chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/top_level.txt
│ │ +-rw-r--r--   0 root         (0) root         (0)       38 2023-04-07 11:01:30.657078 chatgpt4-cli-1.4.6/setup.cfg
│ │ +-rw-r--r--   0 root         (0) root         (0)     1297 2023-04-03 15:13:44.000000 chatgpt4-cli-1.4.6/setup.py
│ │   --- chatgpt4-cli-1.4.5/GPTCLI/emage.py
│ ├── +++ chatgpt4-cli-1.4.6/GPTCLI/emage.py
│ │┄ Files identical despite different names
│ │   --- chatgpt4-cli-1.4.5/GPTCLI/gptcli.py
│ ├── +++ chatgpt4-cli-1.4.6/GPTCLI/gptcli.py
│ │┄ Files 4% similar despite different names
│ │ @@ -112,32 +112,32 @@
│ │          parser.add_argument(
│ │              "-tp",
│ │              "--top-p",
│ │              help="Sampling threshold during inference time",
│ │              type=float,
│ │              choices=self.float_range[0:10],
│ │              metavar="[0.1-1]",
│ │ -            default=0.1,
│ │ +            default=0.0,
│ │          )
│ │          parser.add_argument(
│ │              "-f",
│ │              "--frequency-penalty",
│ │              help="Chances of word being repeated",
│ │              type=float,
│ │              choices=self.float_range,
│ │              metavar="[0.1-2]",
│ │ -            default=0.1,
│ │ +            default=0.0,
│ │          )
│ │          parser.add_argument(
│ │              "-p",
│ │              "--presence-frequency",
│ │              help="Chances of topic being repeated",
│ │              type=float,
│ │              choices=self.float_range,
│ │ -            default=0.1,
│ │ +            default=0.0,
│ │              metavar="[0.1-2]",
│ │          )
│ │          parser.add_argument("-k", "--key", help="OPENAI-API-KEY")
│ │          parser.add_argument(
│ │              "-kp",
│ │              "--key-path",
│ │              help="Path to text-file containing GPT-api key",
│ │ @@ -535,14 +535,24 @@
│ │      interactive = local_interactor()
│ │  
│ │      def apply_color(self):
│ │          print(
│ │              self.bcolor_dict[args.background_color] + self.color_dict[args.input_color]
│ │          )
│ │  
│ │ +    def prompt_is_error_free(self,prompt,resp=True) -> bool:
│ │ +        """Checks if prompt contains [sorry]"""
│ │ +        if isinstance(prompt,list):
│ │ +            if len(prompt)>=2 and prompt[0:2]==["I'm","sorry"]:
│ │ +                resp = False
│ │ +        else:
│ │ +            if prompt.startswith("I'm sorry"):
│ │ +                resp = False
│ │ +        return resp
│ │ +
│ │      def default(self, raw, return_fb=False):
│ │          if not bool(raw):
│ │              return
│ │          # out = lambda b: print(self.color_dict[args.output_color] + b + Fore.RESET)
│ │          if raw[0:2] == "./":
│ │              system((raw[2:]).strip())
│ │              print()
│ │ @@ -567,34 +577,38 @@
│ │          """Generate images based on GPT description"""
│ │          print(
│ │              self.color_dict[args.output_color] + ">>[*] Querying description from GPT",
│ │              end="\r",
│ │          )
│ │          imagiser = imager(line.split(" "))
│ │          description = self.default(imagiser.args.prompt, return_fb=True)
│ │ -        if description:
│ │ +        if description and self.prompt_is_error_free(description):
│ │              print(self.color_dict[args.input_color])
│ │              imagiser.args.prompt = description.strip()
│ │              if imagiser.args.emg:
│ │                  self.do_emg(imagiser.args.prompt, imagiser.args)
│ │              else:
│ │                  rp = imagiser.main()
│ │                  if isinstance(rp, dict):
│ │                      record_keeper.main(rp["url"])
│ │  
│ │          else:
│ │ -            logging.error("Failed to generate description.")
│ │ -
│ │ +            print("")
│ │ +            if not description:
│ │ +                logging.error("Failed to generate description.")
│ │ +        self.do__prompt(self.prompt_disp)
│ │ +                
│ │      def do_img(self, line):
│ │          """Text-to-Image handler"""
│ │          print(self.color_dict[args.output_color], end="\r")
│ │          resp = imager(line.split(" ")).main()
│ │          if isinstance(resp, dict):
│ │              args.message = line
│ │              record_keeper.main(resp["url"])
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do_emg(self, line, args_parsed=False):
│ │          print(
│ │              self.color_dict[args.input_color if args_parsed else args.output_color],
│ │              end="\r",
│ │          )
│ │          try:
│ │ @@ -608,14 +622,15 @@
│ │                      record_keeper.main(download.urls)
│ │              else:
│ │                  logging.warning(
│ │                      "Cookie file is required at launch [--cookie-file {path}]"
│ │                  )
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__prompt(self, line):
│ │          """Modify prompts"""
│ │          self.prompt_disp = line
│ │          self.prompt = time_now_format(line)
│ │  
│ │      def do__font_color(self, line):
│ │ @@ -631,24 +646,26 @@
│ │              else:
│ │                  args.prompt_color = line[1]
│ │                  self.do__prompt(self.prompt_disp)
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │          else:
│ │              self.apply_color()
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__background_color(self, line):
│ │          """Sets background-color"""
│ │  
│ │          try:
│ │              self.bcolor_dict[line.lower()]
│ │              args.background_color = line.lower()
│ │              self.apply_color()
│ │          except Exception as e:
│ │              logging.exception(e)
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__save(self, line):
│ │          try:
│ │              if gpt4:
│ │                  all = (
│ │                      "engine",
│ │                      "session",
│ │ @@ -662,45 +679,50 @@
│ │                      "reply_count",
│ │                  )
│ │                  chatbot.save(join_list(line), *all)
│ │              else:
│ │                  chatbot.save_conversation(join_list(line))
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__load(self, line):
│ │          try:
│ │              if gpt4:
│ │                  chatbot.load(join_list(line))
│ │              else:
│ │                  chatbot.load_conversation(join_list(line))
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │              # logging.exception(e)
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__rollback(self, line):
│ │          try:
│ │              if line.isdigit():
│ │                  chatbot.rollback(int(line))
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__reset(self, line):
│ │          try:
│ │              if gpt4:
│ │                  chatbot.reset(system_prompt=args.system_prompt)
│ │              else:
│ │                  chatbot.reset()
│ │          except Exception as e:
│ │              logging.error(getExc(e))
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │      def do__help(self, line):
│ │          from .helper import help
│ │  
│ │          print(help)
│ │ +        self.do__prompt(self.prompt_disp)
│ │  
│ │  
│ │  def get_api_key() -> str:
│ │      """Gets API from Key_path or args.key"""
│ │      if any([args.key, environ.get("OPENAI_API_KEY")]):
│ │          return args.key or environ.get("OPENAI_API_KEY")
│ │      if args.key_path:
│ │ @@ -761,37 +783,40 @@
│ │  def main():
│ │      global chatbot, gpt4, record_keeper
│ │      args.disable_stream = True if args.markdown else args.disable_stream
│ │      record_keeper = tracker(args.output)
│ │      args.api_key = get_api_key()
│ │      predefined_prompt_used = intro_train()
│ │      openai.api_key = args.api_key
│ │ -    if args.gpt in ("4"):
│ │ -        from revChatGPT.V3 import Chatbot
│ │ -
│ │ -        gpt4 = True
│ │ -        chatbot = Chatbot(
│ │ -            api_key=args.api_key,
│ │ -            engine=args.model if args.model in config_h.v4models else "gpt-3.5-turbo",
│ │ -            # timeout=args.timeout, #Available as from revChatGPT>=4.0.6.1
│ │ -            proxy=args.proxy,  #
│ │ -            max_tokens=args.max_tokens,
│ │ -            temperature=args.temperature,
│ │ -            presence_penalty=args.presence_frequency,
│ │ -            frequency_penalty=args.frequency_penalty,
│ │ -            reply_count=args.reply_count,
│ │ -            system_prompt=args.system_prompt
│ │ -            if args.system_prompt is str
│ │ -            else " ".join(args.system_prompt),
│ │ -        )
│ │ -    else:
│ │ -        gpt4 = False
│ │ -        from revChatGPT.V0 import Chatbot
│ │ -
│ │ -        chatbot = Chatbot(api_key=args.api_key, engine=args.model, proxy=args.proxy)
│ │ +    try:
│ │ +        if args.gpt in ("4"):
│ │ +            from revChatGPT.V3 import Chatbot
│ │ +            
│ │ +            gpt4 = True
│ │ +            chatbot = Chatbot(
│ │ +                api_key=args.api_key,
│ │ +                engine=args.model if args.model in config_h.v4models else "gpt-3.5-turbo",
│ │ +                # timeout=args.timeout, #Available as from revChatGPT>=4.0.6.1
│ │ +                proxy=args.proxy,  #
│ │ +                max_tokens=args.max_tokens,
│ │ +                temperature=args.temperature,
│ │ +                presence_penalty=args.presence_frequency,
│ │ +                frequency_penalty=args.frequency_penalty,
│ │ +                reply_count=args.reply_count,
│ │ +                system_prompt=args.system_prompt
│ │ +                if args.system_prompt is str
│ │ +                else " ".join(args.system_prompt),
│ │ +                )
│ │ +        else:
│ │ +            gpt4 = False
│ │ +            from revChatGPT.V0 import Chatbot
│ │ +            chatbot = Chatbot(api_key=args.api_key, engine=args.model, proxy=args.proxy)
│ │ +    except Exception as e:
│ │ +        exit(logging.critical(getExc(e)))
│ │ +        
│ │      try:
│ │          if args.new_record and path.isfile(args.output):
│ │              remove(args.output)
│ │          run = main_gpt()
│ │          if args.message:
│ │              run.default(
│ │                  " ".join(args.message) if args.message is list else args.message
│ │   --- chatgpt4-cli-1.4.5/GPTCLI/helper.py
│ ├── +++ chatgpt4-cli-1.4.6/GPTCLI/helper.py
│ │┄ Files identical despite different names
│ │   --- chatgpt4-cli-1.4.5/GPTCLI/image.py
│ ├── +++ chatgpt4-cli-1.4.6/GPTCLI/image.py
│ │┄ Files identical despite different names
│ │   --- chatgpt4-cli-1.4.5/PKG-INFO
│ ├── +++ chatgpt4-cli-1.4.6/PKG-INFO
│ │┄ Files 0% similar despite different names
│ │ @@ -1,10 +1,10 @@
│ │  Metadata-Version: 2.1
│ │  Name: chatgpt4-cli
│ │ -Version: 1.4.5
│ │ +Version: 1.4.6
│ │  Summary: Terminal for ChatGPT
│ │  Home-page: https://github.com/Simatwa/gpt-cli
│ │  Author: Smartwa Caleb
│ │  Author-email: smartwacaleb@gmail.com
│ │  Maintainer: Smartwa Caleb
│ │  License: MIT
│ │  Project-URL: Bug Report, https://github.com/Simatwa/gpt-cli/issues/new
│ │ ├── html2text {}
│ │ │ @@ -1,8 +1,8 @@
│ │ │ -Metadata-Version: 2.1 Name: chatgpt4-cli Version: 1.4.5 Summary: Terminal for
│ │ │ +Metadata-Version: 2.1 Name: chatgpt4-cli Version: 1.4.6 Summary: Terminal for
│ │ │  ChatGPT Home-page: https://github.com/Simatwa/gpt-cli Author: Smartwa Caleb
│ │ │  Author-email: smartwacaleb@gmail.com Maintainer: Smartwa Caleb License: MIT
│ │ │  Project-URL: Bug Report, https://github.com/Simatwa/gpt-cli/issues/new
│ │ │  Description:
│ │ │                               ****** gpt-cli ******
│ │ │     [Gihtub] [Pypi]_[wakatime]_[license]_[Progress]_[Code-style]_[Coverage]_
│ │ │                                    [Downloads]
│ │   --- chatgpt4-cli-1.4.5/README.md
│ ├── +++ chatgpt4-cli-1.4.6/README.md
│ │┄ Files identical despite different names
│ │   --- chatgpt4-cli-1.4.5/chatgpt4_cli.egg-info/PKG-INFO
│ ├── +++ chatgpt4-cli-1.4.6/chatgpt4_cli.egg-info/PKG-INFO
│ │┄ Files 0% similar despite different names
│ │ @@ -1,10 +1,10 @@
│ │  Metadata-Version: 2.1
│ │  Name: chatgpt4-cli
│ │ -Version: 1.4.5
│ │ +Version: 1.4.6
│ │  Summary: Terminal for ChatGPT
│ │  Home-page: https://github.com/Simatwa/gpt-cli
│ │  Author: Smartwa Caleb
│ │  Author-email: smartwacaleb@gmail.com
│ │  Maintainer: Smartwa Caleb
│ │  License: MIT
│ │  Project-URL: Bug Report, https://github.com/Simatwa/gpt-cli/issues/new
│ │ ├── html2text {}
│ │ │ @@ -1,8 +1,8 @@
│ │ │ -Metadata-Version: 2.1 Name: chatgpt4-cli Version: 1.4.5 Summary: Terminal for
│ │ │ +Metadata-Version: 2.1 Name: chatgpt4-cli Version: 1.4.6 Summary: Terminal for
│ │ │  ChatGPT Home-page: https://github.com/Simatwa/gpt-cli Author: Smartwa Caleb
│ │ │  Author-email: smartwacaleb@gmail.com Maintainer: Smartwa Caleb License: MIT
│ │ │  Project-URL: Bug Report, https://github.com/Simatwa/gpt-cli/issues/new
│ │ │  Description:
│ │ │                               ****** gpt-cli ******
│ │ │     [Gihtub] [Pypi]_[wakatime]_[license]_[Progress]_[Code-style]_[Coverage]_
│ │ │                                    [Downloads]
│ │   --- chatgpt4-cli-1.4.5/setup.py
│ ├── +++ chatgpt4-cli-1.4.6/setup.py
│ │┄ Files identical despite different names
