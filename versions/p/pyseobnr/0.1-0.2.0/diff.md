# Comparing `tmp/pyseobnr-0.1.tar.gz` & `tmp/pyseobnr-0.2.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyseobnr-0.1.tar", last modified: Fri Mar 31 14:22:00 2023, max compression
+gzip compressed data, was "pyseobnr-0.2.0.tar", last modified: Thu Apr  6 09:21:05 2023, max compression
```

## Comparing `pyseobnr-0.1.tar` & `pyseobnr-0.2.0.tar`

### file list

```diff
@@ -1,159 +1,152 @@
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.465439 pyseobnr-0.1/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       54 2023-03-31 13:47:50.000000 pyseobnr-0.1/.gitignore
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1780 2023-03-27 07:53:18.000000 pyseobnr-0.1/.gitlab-ci.yml
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      452 2023-03-31 13:47:50.000000 pyseobnr-0.1/.pre-commit-config.yaml
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      319 2023-03-31 13:47:50.000000 pyseobnr-0.1/AUTHORS.md
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      197 2023-03-31 13:56:41.000000 pyseobnr-0.1/CHANGELOG.md
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4458 2023-03-31 13:47:50.000000 pyseobnr-0.1/CONTRIBUTING.md
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    35147 2023-03-27 07:53:18.000000 pyseobnr-0.1/LICENSE
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3224 2023-03-31 14:22:00.000000 pyseobnr-0.1/PKG-INFO
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2629 2023-03-31 13:47:50.000000 pyseobnr-0.1/README.rst
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.737442 pyseobnr-0.1/docs/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      580 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/Makefile
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2253 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/conf.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      613 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/index.rst
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.753442 pyseobnr-0.1/docs/source/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3694 2023-03-31 13:47:50.000000 pyseobnr-0.1/docs/source/basic_usage.rst
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1767 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/source/expert_mode.rst
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1558 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/source/installation.rst
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.765442 pyseobnr-0.1/docs/templates/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      639 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/templates/custom-class-template.rst
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1465 2023-03-27 07:53:18.000000 pyseobnr-0.1/docs/templates/custom-module-template.rst
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1583 2023-03-31 14:19:58.000000 pyseobnr-0.1/pyproject.toml
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.781442 pyseobnr-0.1/pyseobnr/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      238 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      155 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr/_version.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.817442 pyseobnr-0.1/pyseobnr/auxiliary/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/__init__.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.829442 pyseobnr-0.1/pyseobnr/auxiliary/external_models/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      122 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/external_models/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3727 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/external_models/default_settings.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    19281 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/external_models/external_models.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.869442 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      676 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/README.md
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    22718 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/_cubic.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)   954743 2023-03-31 14:21:42.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/_ppoly.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     5818 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/_ppoly.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    23808 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/interpolate.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/tests/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3063 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/tests/test_spline.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      362 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/interpolate/vector_spline.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr/auxiliary/mode_mixing/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/mode_mixing/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    15933 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     8717 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/EOB_matches.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    16819 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    10669 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    10093 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    13095 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      708 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    14920 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      710 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2070 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4831 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     8559 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2804 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     6378 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       48 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      389 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/default_settings.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     8405 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     9059 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    16633 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      766 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4114 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    11573 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    15786 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      737 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     7490 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3720 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/parameters.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     8464 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/phenom_matches.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3706 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2322 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     7088 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/templates/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      546 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    18240 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       51 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/__init__.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4538 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     6663 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4612 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py
--rwxr-xr-x   0 sossokine  (2188) cluster   (1111)     8858 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/integrate_ode.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    22258 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/integrate_ode_prec.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    30318 2023-03-30 20:01:42.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/pn_evolution_opt.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1499330 2023-03-31 14:21:43.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      480 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    20897 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1237657 2023-03-31 14:21:44.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_fast.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    12297 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1737753 2023-03-31 14:21:45.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_prec.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    52379 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1068026 2023-03-31 14:21:49.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_aligned.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2655 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_aligned.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1012541 2023-03-31 14:21:50.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_precessing.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      360 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_precessing.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2379 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_precessing.pyx
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/fits/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     9588 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/EOB_fits.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1956 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/GSF_fits.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    30704 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/IV_fits.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    14275 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/MR_fits.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      155 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     5383 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/fits/fits_Hamiltonian.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  2336903 2023-03-31 14:21:52.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)   137434 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  2215514 2023-03-31 14:21:55.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)   119553 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)   939499 2023-03-31 14:00:27.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      798 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      914 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)   989569 2023-03-31 14:00:28.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1253 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1342 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       55 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1235 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/hamiltonian/hamiltonian.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/utils/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/__init__.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1277407 2023-03-31 14:21:56.000000 pyseobnr-0.1/pyseobnr/eob/utils/containers.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     2286 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/containers.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4329 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/containers.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       37 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/eob_parameters.h
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     1409 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/math_ops_opt.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    23772 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/utils_precession_opt.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      784 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/utils/waveform_ops.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/eob/waveform/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       27 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/waveform/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3680 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/eob/waveform/compute_MR.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    19855 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/eob/waveform/compute_hlms.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)  1583050 2023-03-31 14:21:47.000000 pyseobnr-0.1/pyseobnr/eob/waveform/waveform.c
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      624 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/eob/waveform/waveform.pxd
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    85029 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/eob/waveform/waveform.pyx
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    25863 2023-03-30 17:57:27.000000 pyseobnr-0.1/pyseobnr/generate_waveform.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/pyseobnr/models/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)    52200 2023-03-31 13:34:25.000000 pyseobnr-0.1/pyseobnr/models/SEOBNRv5HM.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/models/__init__.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      280 2023-03-27 07:53:18.000000 pyseobnr-0.1/pyseobnr/models/model.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3224 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/PKG-INFO
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     5703 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/SOURCES.txt
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        1 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/dependency_links.txt
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        1 2023-03-31 14:00:31.000000 pyseobnr-0.1/pyseobnr.egg-info/not-zip-safe
--rw-r--r--   0 sossokine  (2188) cluster   (1111)      321 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/requires.txt
--rw-r--r--   0 sossokine  (2188) cluster   (1111)        9 2023-03-31 14:21:59.000000 pyseobnr-0.1/pyseobnr.egg-info/top_level.txt
--rw-r--r--   0 sossokine  (2188) cluster   (1111)       38 2023-03-31 14:22:00.000000 pyseobnr-0.1/setup.cfg
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3141 2023-03-27 07:53:18.000000 pyseobnr-0.1/setup.py
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:21:59.000000 pyseobnr-0.1/test/
-drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-03-31 14:22:00.000000 pyseobnr-0.1/test/regression_tests/
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3386 2023-03-30 17:57:27.000000 pyseobnr-0.1/test/regression_tests/regenerate_SEOBNRv5HM.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     3413 2023-03-27 07:53:18.000000 pyseobnr-0.1/test/regression_tests/regenerate_SEOBNRv5PHM.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4458 2023-03-30 17:57:27.000000 pyseobnr-0.1/test/regression_tests/template_v5HM_tests.jinja
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4494 2023-03-27 07:53:18.000000 pyseobnr-0.1/test/regression_tests/template_v5PHM_tests.jinja
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4591 2023-03-30 17:57:27.000000 pyseobnr-0.1/test/regression_tests/test_SEOBNRv5HM.py
--rw-r--r--   0 sossokine  (2188) cluster   (1111)     4625 2023-03-30 17:57:27.000000 pyseobnr-0.1/test/regression_tests/test_SEOBNRv5PHM.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.619714 pyseobnr-0.2.0/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       54 2023-03-31 13:47:50.000000 pyseobnr-0.2.0/.gitignore
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1949 2023-04-03 16:03:36.000000 pyseobnr-0.2.0/.gitlab-ci.yml
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      452 2023-03-31 13:47:50.000000 pyseobnr-0.2.0/.pre-commit-config.yaml
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      319 2023-03-31 13:47:50.000000 pyseobnr-0.2.0/AUTHORS.md
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      309 2023-04-06 09:02:01.000000 pyseobnr-0.2.0/CHANGELOG.md
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4458 2023-03-31 13:47:50.000000 pyseobnr-0.2.0/CONTRIBUTING.md
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    35147 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/LICENSE
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     5875 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/PKG-INFO
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     5278 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/README.rst
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.043703 pyseobnr-0.2.0/docs/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      580 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/Makefile
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2253 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/conf.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      757 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/docs/index.rst
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.055703 pyseobnr-0.2.0/docs/source/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3694 2023-03-31 13:47:50.000000 pyseobnr-0.2.0/docs/source/basic_usage.rst
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1767 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/source/expert_mode.rst
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1558 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/source/installation.rst
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.063703 pyseobnr-0.2.0/docs/templates/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      639 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/templates/custom-class-template.rst
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1465 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/docs/templates/custom-module-template.rst
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1588 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyproject.toml
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.075703 pyseobnr-0.2.0/pyseobnr/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      238 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      160 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr/_version.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.111704 pyseobnr-0.2.0/pyseobnr/auxiliary/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/__init__.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.123705 pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      122 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3727 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/default_settings.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    19281 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/external_models.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.131705 pyseobnr-0.2.0/pyseobnr/auxiliary/interpolate/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/interpolate/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      362 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/interpolate/vector_spline.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.139705 pyseobnr-0.2.0/pyseobnr/auxiliary/mode_mixing/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/mode_mixing/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    15933 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.247707 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     8717 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/EOB_matches.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    16819 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    10669 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    10093 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    13095 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      708 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    14920 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      710 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2070 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4831 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     8559 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2804 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     6378 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.263707 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       48 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      389 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/default_settings.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     8405 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     9059 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    16633 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      766 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4114 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    11573 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    15786 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      737 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     7490 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3720 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/parameters.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     8464 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/phenom_matches.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3706 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2322 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     7088 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.271707 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/templates/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      546 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    18240 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.275708 pyseobnr-0.2.0/pyseobnr/eob/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       51 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/__init__.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.387710 pyseobnr-0.2.0/pyseobnr/eob/dynamics/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4538 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     6663 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4612 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py
+-rwxr-xr-x   0 sossokine  (2188) cluster   (1111)     8881 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/integrate_ode.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    22408 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/integrate_ode_prec.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    30318 2023-03-30 20:01:42.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/pn_evolution_opt.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1501092 2023-04-06 09:20:52.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      480 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    20902 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1239419 2023-04-06 09:20:53.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_fast.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    12302 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1739532 2023-04-06 09:20:54.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_prec.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    52384 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1070464 2023-04-06 09:20:56.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_aligned.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2655 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_aligned.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1014991 2023-04-06 09:20:57.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_precessing.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      360 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_precessing.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2379 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_precessing.pyx
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     9588 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/EOB_fits.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1956 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/GSF_fits.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    30704 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/IV_fits.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    14275 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/MR_fits.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      155 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     5383 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/fits/fits_Hamiltonian.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  2339148 2023-04-06 09:20:59.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)   137434 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  2217747 2023-04-06 09:21:01.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)   119553 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)   939499 2023-03-31 14:00:27.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      798 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      914 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)   989569 2023-03-31 14:00:28.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1253 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1342 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       55 2023-04-04 16:17:02.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1235 2023-04-04 16:17:02.000000 pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/hamiltonian.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/__init__.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1279061 2023-04-06 09:21:02.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/containers.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2286 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/containers.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4329 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/containers.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       37 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/eob_parameters.h
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     1409 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/math_ops_opt.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    23772 2023-04-04 16:17:02.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/utils_precession_opt.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      784 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/utils/waveform_ops.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       27 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3680 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/compute_MR.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    20048 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/compute_hlms.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)  1585176 2023-04-06 09:20:55.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.c
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      624 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.pxd
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    85029 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.pyx
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    25863 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/pyseobnr/generate_waveform.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr/models/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)    52496 2023-04-06 09:00:37.000000 pyseobnr-0.2.0/pyseobnr/models/SEOBNRv5HM.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        0 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/models/__init__.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      280 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/pyseobnr/models/model.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/pyseobnr.egg-info/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     5875 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr.egg-info/PKG-INFO
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     5441 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr.egg-info/SOURCES.txt
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        1 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr.egg-info/dependency_links.txt
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        1 2023-03-31 14:00:31.000000 pyseobnr-0.2.0/pyseobnr.egg-info/not-zip-safe
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)      326 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr.egg-info/requires.txt
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)        9 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/pyseobnr.egg-info/top_level.txt
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)       38 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/setup.cfg
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     2918 2023-04-05 21:14:32.000000 pyseobnr-0.2.0/setup.py
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:04.000000 pyseobnr-0.2.0/test/
+drwxr-xr-x   0 sossokine  (2188) cluster   (1111)        0 2023-04-06 09:21:05.000000 pyseobnr-0.2.0/test/regression_tests/
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3386 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/test/regression_tests/regenerate_SEOBNRv5HM.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     3413 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/test/regression_tests/regenerate_SEOBNRv5PHM.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4458 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/test/regression_tests/template_v5HM_tests.jinja
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4494 2023-03-27 07:53:18.000000 pyseobnr-0.2.0/test/regression_tests/template_v5PHM_tests.jinja
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4591 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/test/regression_tests/test_SEOBNRv5HM.py
+-rw-r--r--   0 sossokine  (2188) cluster   (1111)     4625 2023-03-30 17:57:27.000000 pyseobnr-0.2.0/test/regression_tests/test_SEOBNRv5PHM.py
```

### Comparing `pyseobnr-0.1/.gitlab-ci.yml` & `pyseobnr-0.2.0/.gitlab-ci.yml`

 * *Files 9% similar despite different names*

```diff
@@ -7,14 +7,15 @@
       # https://computing.docs.ligo.org/gitlab-ci-templates/python/
       - python.yml
 
 stages:
   - build
   - docs
   - test
+  - deploy
 # -- EOB code itself
 
 python:build:
   extends: .python:build
   stage: build
   needs: []
   variables:
@@ -50,14 +51,27 @@
     - pip install .[docs]
     - python setup.py build_ext --inplace # Ugly hack to make cython modules available
     # use the python from the docs environment for the sphinx build
     - PYTHON="$(which python)"
     # configure sphinx
     - !reference [".python:sphinx", before_script]
 
+pages:
+  stage: deploy
+  needs: ["docs"]
+  script:
+    - mv -v html public
+  artifacts:
+    paths:
+      - public
+    expire_in: 30 days
+  only:
+    - main
+
+
 test:
   stage: test
   extends:
     - .conda:base
   image: igwn/base:conda
   variables:
     SRCDIR: "./"
```

### Comparing `pyseobnr-0.1/CONTRIBUTING.md` & `pyseobnr-0.2.0/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/LICENSE` & `pyseobnr-0.2.0/LICENSE`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/Makefile` & `pyseobnr-0.2.0/docs/Makefile`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/conf.py` & `pyseobnr-0.2.0/docs/conf.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/source/basic_usage.rst` & `pyseobnr-0.2.0/docs/source/basic_usage.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/source/expert_mode.rst` & `pyseobnr-0.2.0/docs/source/expert_mode.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/source/installation.rst` & `pyseobnr-0.2.0/docs/source/installation.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/templates/custom-class-template.rst` & `pyseobnr-0.2.0/docs/templates/custom-class-template.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/docs/templates/custom-module-template.rst` & `pyseobnr-0.2.0/docs/templates/custom-module-template.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyproject.toml` & `pyseobnr-0.2.0/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -27,27 +27,27 @@
 
 	]
 	license = { text = "GPL-3.0-or-later" }
 
 	# requirements:
 	requires-python = ">=3.8"
 	dependencies = [
-		"numpy==1.23.0",
+		"numpy>=1.23.0",
 		"scipy>=1.8.0",
 		"matplotlib",
 		"h5py",
 		"numexpr",
 		"numba",
 		"qnm",
 		"scri",
 		"setuptools",
 		"jax",
 		"jaxlib",
 		"rich",
-		"pygsl",
+		"pygsl_lite",
 		"lalsuite",
 	]
 
 	# dynamic properties set by tools:
 	dynamic = ["version"]
 
 [tool.setuptools_scm]
```

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/external_models/default_settings.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/default_settings.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/external_models/external_models.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/external_models/external_models.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/interpolate/_ppoly.c` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.c`

 * *Files 3% similar despite different names*

```diff
@@ -1,29 +1,29 @@
 /* Generated by Cython 0.29.33 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/npy_math.h"
+            "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
-            "-flto",
-            "-O3",
-            "-ftree-vectorize"
+            "-O3"
         ],
         "include_dirs": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include"
+            "pyseobnr/eob/utils",
+            "./pyseobnr/eob/utils",
+            "/local/tmp/sossokine/build-env-e9bsn5qv/lib/python3.9/site-packages/numpy/core/include"
         ],
-        "name": "pyseobnr.auxiliary.interpolate._ppoly",
+        "name": "pyseobnr.eob.hamiltonian.Hamiltonian_C",
         "sources": [
-            "pyseobnr/auxiliary/interpolate/_ppoly.pyx"
+            "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx"
         ]
     },
-    "module_name": "pyseobnr.auxiliary.interpolate._ppoly"
+    "module_name": "pyseobnr.eob.hamiltonian.Hamiltonian_C"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
@@ -757,22 +757,21 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__pyseobnr__auxiliary__interpolate___ppoly
-#define __PYX_HAVE_API__pyseobnr__auxiliary__interpolate___ppoly
+#define __PYX_HAVE__pyseobnr__eob__hamiltonian__Hamiltonian_C
+#define __PYX_HAVE_API__pyseobnr__eob__hamiltonian__Hamiltonian_C
 /* Early includes */
+#include "eob_parameters.h"
+#include "pythread.h"
 #include <string.h>
 #include <stdlib.h>
-#include <math.h>
-#include "numpy/npy_math.h"
-#include "pythread.h"
 #include <stdio.h>
 #include "pystate.h"
 #ifdef _OPENMP
 #include <omp.h>
 #endif /* _OPENMP */
 
 #if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
@@ -998,16 +997,18 @@
 #if CYTHON_CCOMPLEX && !defined(__cplusplus) && defined(__sun__) && defined(__GNUC__)
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 
 static const char *__pyx_f[] = {
-  "pyseobnr/auxiliary/interpolate/_ppoly.pyx",
   "stringsource",
+  "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx",
+  "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd",
+  "pyseobnr/eob/utils/containers.pxd",
 };
 /* MemviewSliceStruct.proto */
 struct __pyx_memoryview_obj;
 typedef struct {
   struct __pyx_memoryview_obj *memview;
   char *data;
   Py_ssize_t shape[8];
@@ -1105,149 +1106,163 @@
   int is_complex;
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
-
-/* "scipy/linalg/cython_lapack.pxd":15
- * # The original libraries should be linked directly.
- * 
- * ctypedef float s             # <<<<<<<<<<<<<<
- * ctypedef double d
- * ctypedef float complex c
- */
-typedef float __pyx_t_5scipy_6linalg_13cython_lapack_s;
-
-/* "scipy/linalg/cython_lapack.pxd":16
- * 
- * ctypedef float s
- * ctypedef double d             # <<<<<<<<<<<<<<
- * ctypedef float complex c
- * ctypedef double complex z
- */
-typedef double __pyx_t_5scipy_6linalg_13cython_lapack_d;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< double > __pyx_t_double_complex;
   #else
     typedef double _Complex __pyx_t_double_complex;
   #endif
 #else
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
-/* Declarations.proto */
-#if CYTHON_CCOMPLEX
-  #ifdef __cplusplus
-    typedef ::std::complex< float > __pyx_t_float_complex;
-  #else
-    typedef float _Complex __pyx_t_float_complex;
-  #endif
-#else
-    typedef struct { float real, imag; } __pyx_t_float_complex;
-#endif
-static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);
-
 
 /*--- Type declarations ---*/
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics;
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams;
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams;
+struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "scipy/linalg/cython_lapack.pxd":22
- * # Function pointer type declarations for
- * # gees and gges families of functions.
- * ctypedef bint cselect1(c*)             # <<<<<<<<<<<<<<
- * ctypedef bint cselect2(c*, c*)
- * ctypedef bint dselect2(d*, d*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_cselect1(__pyx_t_float_complex *);
-
-/* "scipy/linalg/cython_lapack.pxd":23
- * # gees and gges families of functions.
- * ctypedef bint cselect1(c*)
- * ctypedef bint cselect2(c*, c*)             # <<<<<<<<<<<<<<
- * ctypedef bint dselect2(d*, d*)
- * ctypedef bint dselect3(d*, d*, d*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_cselect2(__pyx_t_float_complex *, __pyx_t_float_complex *);
-
-/* "scipy/linalg/cython_lapack.pxd":24
- * ctypedef bint cselect1(c*)
- * ctypedef bint cselect2(c*, c*)
- * ctypedef bint dselect2(d*, d*)             # <<<<<<<<<<<<<<
- * ctypedef bint dselect3(d*, d*, d*)
- * ctypedef bint sselect2(s*, s*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_dselect2(__pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *);
-
-/* "scipy/linalg/cython_lapack.pxd":25
- * ctypedef bint cselect2(c*, c*)
- * ctypedef bint dselect2(d*, d*)
- * ctypedef bint dselect3(d*, d*, d*)             # <<<<<<<<<<<<<<
- * ctypedef bint sselect2(s*, s*)
- * ctypedef bint sselect3(s*, s*, s*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_dselect3(__pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *);
-
-/* "scipy/linalg/cython_lapack.pxd":26
- * ctypedef bint dselect2(d*, d*)
- * ctypedef bint dselect3(d*, d*, d*)
- * ctypedef bint sselect2(s*, s*)             # <<<<<<<<<<<<<<
- * ctypedef bint sselect3(s*, s*, s*)
- * ctypedef bint zselect1(z*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_sselect2(__pyx_t_5scipy_6linalg_13cython_lapack_s *, __pyx_t_5scipy_6linalg_13cython_lapack_s *);
-
-/* "scipy/linalg/cython_lapack.pxd":27
- * ctypedef bint dselect3(d*, d*, d*)
- * ctypedef bint sselect2(s*, s*)
- * ctypedef bint sselect3(s*, s*, s*)             # <<<<<<<<<<<<<<
- * ctypedef bint zselect1(z*)
- * ctypedef bint zselect2(z*, z*)
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_sselect3(__pyx_t_5scipy_6linalg_13cython_lapack_s *, __pyx_t_5scipy_6linalg_13cython_lapack_s *, __pyx_t_5scipy_6linalg_13cython_lapack_s *);
-
-/* "scipy/linalg/cython_lapack.pxd":28
- * ctypedef bint sselect2(s*, s*)
- * ctypedef bint sselect3(s*, s*, s*)
- * ctypedef bint zselect1(z*)             # <<<<<<<<<<<<<<
- * ctypedef bint zselect2(z*, z*)
- * 
- */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_zselect1(__pyx_t_double_complex *);
-
-/* "scipy/linalg/cython_lapack.pxd":29
- * ctypedef bint sselect3(s*, s*, s*)
- * ctypedef bint zselect1(z*)
- * ctypedef bint zselect2(z*, z*)             # <<<<<<<<<<<<<<
+/* "pyseobnr/eob/utils/containers.pxd":8
  * 
- * cdef void cbbcsd(char *jobu1, char *jobu2, char *jobv1t, char *jobv2t, char *trans, int *m, int *p, int *q, s *theta, s *phi, c *u1, int *ldu1, c *u2, int *ldu2, c *v1t, int *ldv1t, c *v2t, int *ldv2t, s *b11d, s *b11e, s *b12d, s *b12e, s *b21d, s *b21e, s *b22d, s *b22e, s *rwork, int *lrwork, int *info) nogil
+ * 
+ * cdef class PhysicalParams:             # <<<<<<<<<<<<<<
+ *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val
  */
-typedef int __pyx_t_5scipy_6linalg_13cython_lapack_zselect2(__pyx_t_double_complex *, __pyx_t_double_complex *);
-struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending;
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
+  PyObject_HEAD
+  struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtab;
+  double m_1;
+  double m_2;
+  double nu;
+  double M;
+  double X_1;
+  double X_2;
+  double delta;
+  double chi_1;
+  double chi_2;
+  double chi_S;
+  double chi_A;
+  double a;
+  double ap;
+  double am;
+  double chi1_L;
+  double chi2_L;
+  double a1;
+  double a2;
+  double H_val;
+  __Pyx_memviewslice chi1_v;
+  __Pyx_memviewslice chi2_v;
+  __Pyx_memviewslice lN;
+  double omega;
+  double omega_circ;
+};
 
-/* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":102
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * cdef int find_interval_ascending(const double *x,             # <<<<<<<<<<<<<<
- *                                  size_t nx,
- *                                  double xval,
- */
-struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending {
-  int __pyx_n;
-  int prev_interval;
-  int extrapolate;
+
+/* "pyseobnr/eob/utils/containers.pxd":23
+ *     cdef public double flagNLOSO,flagNLOSO2,flagNLOSO3,flagNLOSS,flagNLOSS2,flagS3
+ * '''
+ * cdef class CalibCoeffs:             # <<<<<<<<<<<<<<
+ *     cdef public dict dc
+ * 
+ */
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs {
+  PyObject_HEAD
+  PyObject *dc;
+};
+
+
+/* "pyseobnr/eob/utils/containers.pxd":26
+ *     cdef public dict dc
+ * 
+ * cdef class Dynamics:             # <<<<<<<<<<<<<<
+ *     cdef public double[:] p_circ
+ * 
+ */
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics {
+  PyObject_HEAD
+  __Pyx_memviewslice p_circ;
+};
+
+
+/* "pyseobnr/eob/utils/containers.pxd":29
+ *     cdef public double[:] p_circ
+ * 
+ * cdef class FluxParams:             # <<<<<<<<<<<<<<
+ *     # Coefficients entering the amplitude residual
+ *     cdef public double[:,:,:] rho_coeffs
+ */
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams {
+  PyObject_HEAD
+  __Pyx_memviewslice rho_coeffs;
+  __Pyx_memviewslice rho_coeffs_log;
+  __Pyx_memviewslice f_coeffs;
+  __Pyx_memviewslice f_coeffs_vh;
+  __Pyx_memviewslice delta_coeffs;
+  __Pyx_memviewslice delta_coeffs_vh;
+  __Pyx_memviewslice prefixes;
+  __Pyx_memviewslice prefixes_abs;
+  __Pyx_memviewslice Tlm;
+  __Pyx_memviewslice rholm;
+  __Pyx_memviewslice deltalm;
+  __Pyx_memviewslice nqc_coeffs;
+  __Pyx_memviewslice extra_coeffs;
+  __Pyx_memviewslice extra_coeffs_log;
+  PyObject *special_modes;
+  int rho_initialized;
+  int extra_PN_terms;
+};
+
+
+/* "pyseobnr/eob/utils/containers.pxd":67
+ *     cdef public bint extra_PN_terms
+ * 
+ * cdef class EOBParams:             # <<<<<<<<<<<<<<
+ *     cdef public PhysicalParams p_params
+ *     cdef public CalibCoeffs c_coeffs
+ */
+struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams {
+  PyObject_HEAD
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *p_params;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *c_coeffs;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
+  PyObject *mode_array;
+  int aligned;
+};
+
+
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd":3
+ * cimport cython
+ * from pyseobnr.eob.utils.containers cimport EOBParams
+ * cdef class Hamiltonian_C:             # <<<<<<<<<<<<<<
+ *     cdef public EOBParams EOBpars
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
+ */
+struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
+  PyObject_HEAD
+  struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtab;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
 };
 
+
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1318,14 +1333,49 @@
   PyObject *from_object;
   PyObject *(*to_object_func)(char *);
   int (*to_dtype_func)(char *, PyObject *);
 };
 
 
 
+/* "pyseobnr/eob/utils/containers.pxd":8
+ * 
+ * 
+ * cdef class PhysicalParams:             # <<<<<<<<<<<<<<
+ *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val
+ */
+
+struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
+  PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
+  PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
+};
+static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+
+
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":4
+ * from pyseobnr.eob.utils.containers cimport EOBParams
+ * 
+ * cdef class Hamiltonian_C:             # <<<<<<<<<<<<<<
+ *     def __cinit__(self,EOBParams):
+ *         pass
+ */
+
+struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
+  PyObject *(*_call)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*grad)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*hessian)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  double (*csi)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*auxderivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+};
+static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+
+
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1439,49 +1489,54 @@
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
-/* RaiseArgTupleInvalid.proto */
-static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
-    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
-
 /* RaiseDoubleKeywords.proto */
 static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
 
 /* ParseKeywords.proto */
 static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
     const char* function_name);
 
-/* PyDictContains.proto */
-static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject* item, PyObject* dict, int eq) {
-    int result = PyDict_Contains(dict, item);
-    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
-}
+/* RaiseArgTupleInvalid.proto */
+static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
+    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
-/* DictGetItem.proto */
-#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
-static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
-#define __Pyx_PyObject_Dict_GetItem(obj, name)\
-    (likely(PyDict_CheckExact(obj)) ?\
-     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
+/* PyDictVersioning.proto */
+#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
+#define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
+#define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
+#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
+    (version_var) = __PYX_GET_DICT_VERSION(dict);\
+    (cache_var) = (value);
+#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP) {\
+    static PY_UINT64_T __pyx_dict_version = 0;\
+    static PyObject *__pyx_dict_cached_value = NULL;\
+    if (likely(__PYX_GET_DICT_VERSION(DICT) == __pyx_dict_version)) {\
+        (VAR) = __pyx_dict_cached_value;\
+    } else {\
+        (VAR) = __pyx_dict_cached_value = (LOOKUP);\
+        __pyx_dict_version = __PYX_GET_DICT_VERSION(DICT);\
+    }\
+}
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj);
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj);
+static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version);
 #else
-#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
-#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
+#define __PYX_GET_DICT_VERSION(dict)  (0)
+#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
+#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
 #endif
 
-/* PyCFunctionFastCall.proto */
-#if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
-#else
-#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
-#endif
+/* None.proto */
+static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);
 
 /* PyFunctionFastCall.proto */
 #if CYTHON_FAST_PYCALL
 #define __Pyx_PyFunction_FastCall(func, args, nargs)\
     __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
 #if 1 || PY_VERSION_HEX < 0x030600B1
 static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, Py_ssize_t nargs, PyObject *kwargs);
@@ -1506,28 +1561,53 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyCFunctionFastCall.proto */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
+#else
+#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
+#endif
+
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
 #endif
 
-/* PyObjectCallMethO.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
-#endif
-
-/* PyObjectCallOneArg.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
+/* MemviewSliceInit.proto */
+#define __Pyx_BUF_MAX_NDIMS %(BUF_MAX_NDIMS)d
+#define __Pyx_MEMVIEW_DIRECT   1
+#define __Pyx_MEMVIEW_PTR      2
+#define __Pyx_MEMVIEW_FULL     4
+#define __Pyx_MEMVIEW_CONTIG   8
+#define __Pyx_MEMVIEW_STRIDED  16
+#define __Pyx_MEMVIEW_FOLLOW   32
+#define __Pyx_IS_C_CONTIG 1
+#define __Pyx_IS_F_CONTIG 2
+static int __Pyx_init_memviewslice(
+                struct __pyx_memoryview_obj *memview,
+                int ndim,
+                __Pyx_memviewslice *memviewslice,
+                int memview_is_new_reference);
+static CYTHON_INLINE int __pyx_add_acquisition_count_locked(
+    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
+static CYTHON_INLINE int __pyx_sub_acquisition_count_locked(
+    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
+#define __pyx_get_slice_count_pointer(memview) (memview->acquisition_count_aligned_p)
+#define __pyx_get_slice_count(memview) (*__pyx_get_slice_count_pointer(memview))
+#define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
+#define __PYX_XDEC_MEMVIEW(slice, have_gil) __Pyx_XDEC_MEMVIEW(slice, have_gil, __LINE__)
+static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
+static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *, int, int);
 
 /* PyThreadStateGet.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
 #define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
 #define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
 #else
@@ -1557,399 +1637,42 @@
 #define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
 #define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
 #define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
 #define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
 #define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
 #endif
 
-/* RaiseException.proto */
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
-
-/* UnicodeAsUCS4.proto */
-static CYTHON_INLINE Py_UCS4 __Pyx_PyUnicode_AsPy_UCS4(PyObject*);
-
-/* object_ord.proto */
-#if PY_MAJOR_VERSION >= 3
-#define __Pyx_PyObject_Ord(c)\
-    (likely(PyUnicode_Check(c)) ? (long)__Pyx_PyUnicode_AsPy_UCS4(c) : __Pyx__PyObject_Ord(c))
-#else
-#define __Pyx_PyObject_Ord(c) __Pyx__PyObject_Ord(c)
-#endif
-static long __Pyx__PyObject_Ord(PyObject* c);
-
-/* SetItemInt.proto */
-#define __Pyx_SetItemInt(o, i, v, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) :\
-    (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) :\
-               __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
-static int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
-static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
-                                               int is_list, int wraparound, int boundscheck);
-
-/* IterFinish.proto */
-static CYTHON_INLINE int __Pyx_IterFinish(void);
-
-/* PyObjectCallNoArg.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
-#else
-#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
-#endif
-
-/* PyObjectGetMethod.proto */
-static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method);
-
-/* PyObjectCallMethod0.proto */
-static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name);
-
-/* RaiseNeedMoreValuesToUnpack.proto */
-static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);
-
-/* RaiseTooManyValuesToUnpack.proto */
-static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);
-
-/* UnpackItemEndCheck.proto */
-static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);
-
-/* RaiseNoneIterError.proto */
-static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);
-
-/* UnpackTupleError.proto */
-static void __Pyx_UnpackTupleError(PyObject *, Py_ssize_t index);
-
-/* UnpackTuple2.proto */
-#define __Pyx_unpack_tuple2(tuple, value1, value2, is_tuple, has_known_size, decref_tuple)\
-    (likely(is_tuple || PyTuple_Check(tuple)) ?\
-        (likely(has_known_size || PyTuple_GET_SIZE(tuple) == 2) ?\
-            __Pyx_unpack_tuple2_exact(tuple, value1, value2, decref_tuple) :\
-            (__Pyx_UnpackTupleError(tuple, 2), -1)) :\
-        __Pyx_unpack_tuple2_generic(tuple, value1, value2, has_known_size, decref_tuple))
-static CYTHON_INLINE int __Pyx_unpack_tuple2_exact(
-    PyObject* tuple, PyObject** value1, PyObject** value2, int decref_tuple);
-static int __Pyx_unpack_tuple2_generic(
-    PyObject* tuple, PyObject** value1, PyObject** value2, int has_known_size, int decref_tuple);
-
-/* dict_iter.proto */
-static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* dict, int is_dict, PyObject* method_name,
-                                                   Py_ssize_t* p_orig_length, int* p_is_dict);
-static CYTHON_INLINE int __Pyx_dict_iter_next(PyObject* dict_or_iter, Py_ssize_t orig_length, Py_ssize_t* ppos,
-                                              PyObject** pkey, PyObject** pvalue, PyObject** pitem, int is_dict);
-
-/* PyObjectCall2Args.proto */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
-
-/* GetItemInt.proto */
-#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
-    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
-               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
-#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
-                                                     int is_list, int wraparound, int boundscheck);
-
-/* ListAppend.proto */
-#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
-static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
-    PyListObject* L = (PyListObject*) list;
-    Py_ssize_t len = Py_SIZE(list);
-    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
-        Py_INCREF(x);
-        PyList_SET_ITEM(list, len, x);
-        __Pyx_SET_SIZE(list, len + 1);
-        return 0;
-    }
-    return PyList_Append(list, x);
-}
-#else
-#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
-#endif
-
-/* MemviewSliceInit.proto */
-#define __Pyx_BUF_MAX_NDIMS %(BUF_MAX_NDIMS)d
-#define __Pyx_MEMVIEW_DIRECT   1
-#define __Pyx_MEMVIEW_PTR      2
-#define __Pyx_MEMVIEW_FULL     4
-#define __Pyx_MEMVIEW_CONTIG   8
-#define __Pyx_MEMVIEW_STRIDED  16
-#define __Pyx_MEMVIEW_FOLLOW   32
-#define __Pyx_IS_C_CONTIG 1
-#define __Pyx_IS_F_CONTIG 2
-static int __Pyx_init_memviewslice(
-                struct __pyx_memoryview_obj *memview,
-                int ndim,
-                __Pyx_memviewslice *memviewslice,
-                int memview_is_new_reference);
-static CYTHON_INLINE int __pyx_add_acquisition_count_locked(
-    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
-static CYTHON_INLINE int __pyx_sub_acquisition_count_locked(
-    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
-#define __pyx_get_slice_count_pointer(memview) (memview->acquisition_count_aligned_p)
-#define __pyx_get_slice_count(memview) (*__pyx_get_slice_count_pointer(memview))
-#define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
-#define __PYX_XDEC_MEMVIEW(slice, have_gil) __Pyx_XDEC_MEMVIEW(slice, have_gil, __LINE__)
-static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
-static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *, int, int);
-
-/* Profile.proto */
-#ifndef CYTHON_PROFILE
-#if CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_PYSTON
-  #define CYTHON_PROFILE 0
-#else
-  #define CYTHON_PROFILE 1
-#endif
-#endif
-#ifndef CYTHON_TRACE_NOGIL
-  #define CYTHON_TRACE_NOGIL 0
-#else
-  #if CYTHON_TRACE_NOGIL && !defined(CYTHON_TRACE)
-    #define CYTHON_TRACE 1
-  #endif
-#endif
-#ifndef CYTHON_TRACE
-  #define CYTHON_TRACE 0
-#endif
-#if CYTHON_TRACE
-  #undef CYTHON_PROFILE_REUSE_FRAME
-#endif
-#ifndef CYTHON_PROFILE_REUSE_FRAME
-  #define CYTHON_PROFILE_REUSE_FRAME 0
-#endif
-#if CYTHON_PROFILE || CYTHON_TRACE
-  #include "compile.h"
-  #include "frameobject.h"
-  #include "traceback.h"
-#if PY_VERSION_HEX >= 0x030b00a6
-  #ifndef Py_BUILD_CORE
-    #define Py_BUILD_CORE 1
-  #endif
-  #include "internal/pycore_frame.h"
-#endif
-  #if CYTHON_PROFILE_REUSE_FRAME
-    #define CYTHON_FRAME_MODIFIER static
-    #define CYTHON_FRAME_DEL(frame)
-  #else
-    #define CYTHON_FRAME_MODIFIER
-    #define CYTHON_FRAME_DEL(frame) Py_CLEAR(frame)
-  #endif
-  #define __Pyx_TraceDeclarations\
-      static PyCodeObject *__pyx_frame_code = NULL;\
-      CYTHON_FRAME_MODIFIER PyFrameObject *__pyx_frame = NULL;\
-      int __Pyx_use_tracing = 0;
-  #define __Pyx_TraceFrameInit(codeobj)\
-      if (codeobj) __pyx_frame_code = (PyCodeObject*) codeobj;
-#if PY_VERSION_HEX >= 0x030b00a2
-  #define __Pyx_IsTracing(tstate, check_tracing, check_funcs)\
-     (unlikely((tstate)->cframe->use_tracing) &&\
-         (!(check_tracing) || !(tstate)->tracing) &&\
-         (!(check_funcs) || (tstate)->c_profilefunc || (CYTHON_TRACE && (tstate)->c_tracefunc)))
-  #define __Pyx_EnterTracing(tstate) PyThreadState_EnterTracing(tstate)
-  #define __Pyx_LeaveTracing(tstate) PyThreadState_LeaveTracing(tstate)
-#elif PY_VERSION_HEX >= 0x030a00b1
-  #define __Pyx_IsTracing(tstate, check_tracing, check_funcs)\
-     (unlikely((tstate)->cframe->use_tracing) &&\
-         (!(check_tracing) || !(tstate)->tracing) &&\
-         (!(check_funcs) || (tstate)->c_profilefunc || (CYTHON_TRACE && (tstate)->c_tracefunc)))
-  #define __Pyx_EnterTracing(tstate)\
-      do { tstate->tracing++; tstate->cframe->use_tracing = 0; } while (0)
-  #define __Pyx_LeaveTracing(tstate)\
-      do {\
-          tstate->tracing--;\
-          tstate->cframe->use_tracing = ((CYTHON_TRACE && tstate->c_tracefunc != NULL)\
-                                 || tstate->c_profilefunc != NULL);\
-      } while (0)
-#else
-  #define __Pyx_IsTracing(tstate, check_tracing, check_funcs)\
-     (unlikely((tstate)->use_tracing) &&\
-         (!(check_tracing) || !(tstate)->tracing) &&\
-         (!(check_funcs) || (tstate)->c_profilefunc || (CYTHON_TRACE && (tstate)->c_tracefunc)))
-  #define __Pyx_EnterTracing(tstate)\
-      do { tstate->tracing++; tstate->use_tracing = 0; } while (0)
-  #define __Pyx_LeaveTracing(tstate)\
-      do {\
-          tstate->tracing--;\
-          tstate->use_tracing = ((CYTHON_TRACE && tstate->c_tracefunc != NULL)\
-                                         || tstate->c_profilefunc != NULL);\
-      } while (0)
-#endif
-  #ifdef WITH_THREAD
-  #define __Pyx_TraceCall(funcname, srcfile, firstlineno, nogil, goto_error)\
-  if (nogil) {\
-      if (CYTHON_TRACE_NOGIL) {\
-          PyThreadState *tstate;\
-          PyGILState_STATE state = PyGILState_Ensure();\
-          tstate = __Pyx_PyThreadState_Current;\
-          if (__Pyx_IsTracing(tstate, 1, 1)) {\
-              __Pyx_use_tracing = __Pyx_TraceSetupAndCall(&__pyx_frame_code, &__pyx_frame, tstate, funcname, srcfile, firstlineno);\
-          }\
-          PyGILState_Release(state);\
-          if (unlikely(__Pyx_use_tracing < 0)) goto_error;\
-      }\
-  } else {\
-      PyThreadState* tstate = PyThreadState_GET();\
-      if (__Pyx_IsTracing(tstate, 1, 1)) {\
-          __Pyx_use_tracing = __Pyx_TraceSetupAndCall(&__pyx_frame_code, &__pyx_frame, tstate, funcname, srcfile, firstlineno);\
-          if (unlikely(__Pyx_use_tracing < 0)) goto_error;\
-      }\
-  }
-  #else
-  #define __Pyx_TraceCall(funcname, srcfile, firstlineno, nogil, goto_error)\
-  {   PyThreadState* tstate = PyThreadState_GET();\
-      if (__Pyx_IsTracing(tstate, 1, 1)) {\
-          __Pyx_use_tracing = __Pyx_TraceSetupAndCall(&__pyx_frame_code, &__pyx_frame, tstate, funcname, srcfile, firstlineno);\
-          if (unlikely(__Pyx_use_tracing < 0)) goto_error;\
-      }\
-  }
-  #endif
-  #define __Pyx_TraceException()\
-  if (likely(!__Pyx_use_tracing)); else {\
-      PyThreadState* tstate = __Pyx_PyThreadState_Current;\
-      if (__Pyx_IsTracing(tstate, 0, 1)) {\
-          __Pyx_EnterTracing(tstate);\
-          PyObject *exc_info = __Pyx_GetExceptionTuple(tstate);\
-          if (exc_info) {\
-              if (CYTHON_TRACE && tstate->c_tracefunc)\
-                  tstate->c_tracefunc(\
-                      tstate->c_traceobj, __pyx_frame, PyTrace_EXCEPTION, exc_info);\
-              tstate->c_profilefunc(\
-                  tstate->c_profileobj, __pyx_frame, PyTrace_EXCEPTION, exc_info);\
-              Py_DECREF(exc_info);\
-          }\
-          __Pyx_LeaveTracing(tstate);\
-      }\
-  }
-  static void __Pyx_call_return_trace_func(PyThreadState *tstate, PyFrameObject *frame, PyObject *result) {
-      PyObject *type, *value, *traceback;
-      __Pyx_ErrFetchInState(tstate, &type, &value, &traceback);
-      __Pyx_EnterTracing(tstate);
-      if (CYTHON_TRACE && tstate->c_tracefunc)
-          tstate->c_tracefunc(tstate->c_traceobj, frame, PyTrace_RETURN, result);
-      if (tstate->c_profilefunc)
-          tstate->c_profilefunc(tstate->c_profileobj, frame, PyTrace_RETURN, result);
-      CYTHON_FRAME_DEL(frame);
-      __Pyx_LeaveTracing(tstate);
-      __Pyx_ErrRestoreInState(tstate, type, value, traceback);
-  }
-  #ifdef WITH_THREAD
-  #define __Pyx_TraceReturn(result, nogil)\
-  if (likely(!__Pyx_use_tracing)); else {\
-      if (nogil) {\
-          if (CYTHON_TRACE_NOGIL) {\
-              PyThreadState *tstate;\
-              PyGILState_STATE state = PyGILState_Ensure();\
-              tstate = __Pyx_PyThreadState_Current;\
-              if (__Pyx_IsTracing(tstate, 0, 0)) {\
-                  __Pyx_call_return_trace_func(tstate, __pyx_frame, (PyObject*)result);\
-              }\
-              PyGILState_Release(state);\
-          }\
-      } else {\
-          PyThreadState* tstate = __Pyx_PyThreadState_Current;\
-          if (__Pyx_IsTracing(tstate, 0, 0)) {\
-              __Pyx_call_return_trace_func(tstate, __pyx_frame, (PyObject*)result);\
-          }\
-      }\
-  }
-  #else
-  #define __Pyx_TraceReturn(result, nogil)\
-  if (likely(!__Pyx_use_tracing)); else {\
-      PyThreadState* tstate = __Pyx_PyThreadState_Current;\
-      if (__Pyx_IsTracing(tstate, 0, 0)) {\
-          __Pyx_call_return_trace_func(tstate, __pyx_frame, (PyObject*)result);\
-      }\
-  }
-  #endif
-  static PyCodeObject *__Pyx_createFrameCodeObject(const char *funcname, const char *srcfile, int firstlineno);
-  static int __Pyx_TraceSetupAndCall(PyCodeObject** code, PyFrameObject** frame, PyThreadState* tstate, const char *funcname, const char *srcfile, int firstlineno);
-#else
-  #define __Pyx_TraceDeclarations
-  #define __Pyx_TraceFrameInit(codeobj)
-  #define __Pyx_TraceCall(funcname, srcfile, firstlineno, nogil, goto_error)   if ((1)); else goto_error;
-  #define __Pyx_TraceException()
-  #define __Pyx_TraceReturn(result, nogil)
-#endif
-#if CYTHON_TRACE
-  static int __Pyx_call_line_trace_func(PyThreadState *tstate, PyFrameObject *frame, int lineno) {
-      int ret;
-      PyObject *type, *value, *traceback;
-      __Pyx_ErrFetchInState(tstate, &type, &value, &traceback);
-      __Pyx_PyFrame_SetLineNumber(frame, lineno);
-      __Pyx_EnterTracing(tstate);
-      ret = tstate->c_tracefunc(tstate->c_traceobj, frame, PyTrace_LINE, NULL);
-      __Pyx_LeaveTracing(tstate);
-      if (likely(!ret)) {
-          __Pyx_ErrRestoreInState(tstate, type, value, traceback);
-      } else {
-          Py_XDECREF(type);
-          Py_XDECREF(value);
-          Py_XDECREF(traceback);
-      }
-      return ret;
-  }
-  #ifdef WITH_THREAD
-  #define __Pyx_TraceLine(lineno, nogil, goto_error)\
-  if (likely(!__Pyx_use_tracing)); else {\
-      if (nogil) {\
-          if (CYTHON_TRACE_NOGIL) {\
-              int ret = 0;\
-              PyThreadState *tstate;\
-              PyGILState_STATE state = PyGILState_Ensure();\
-              tstate = __Pyx_PyThreadState_Current;\
-              if (__Pyx_IsTracing(tstate, 0, 0) && tstate->c_tracefunc && __pyx_frame->f_trace) {\
-                  ret = __Pyx_call_line_trace_func(tstate, __pyx_frame, lineno);\
-              }\
-              PyGILState_Release(state);\
-              if (unlikely(ret)) goto_error;\
-          }\
-      } else {\
-          PyThreadState* tstate = __Pyx_PyThreadState_Current;\
-          if (__Pyx_IsTracing(tstate, 0, 0) && tstate->c_tracefunc && __pyx_frame->f_trace) {\
-              int ret = __Pyx_call_line_trace_func(tstate, __pyx_frame, lineno);\
-              if (unlikely(ret)) goto_error;\
-          }\
-      }\
-  }
-  #else
-  #define __Pyx_TraceLine(lineno, nogil, goto_error)\
-  if (likely(!__Pyx_use_tracing)); else {\
-      PyThreadState* tstate = __Pyx_PyThreadState_Current;\
-      if (__Pyx_IsTracing(tstate, 0, 0) && tstate->c_tracefunc && __pyx_frame->f_trace) {\
-          int ret = __Pyx_call_line_trace_func(tstate, __pyx_frame, lineno);\
-          if (unlikely(ret)) goto_error;\
-      }\
-  }
-  #endif
-#else
-  #define __Pyx_TraceLine(lineno, nogil, goto_error)   if ((1)); else goto_error;
-#endif
-
 /* WriteUnraisableException.proto */
 static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                   int lineno, const char *filename,
                                   int full_traceback, int nogil);
 
+/* ExtTypeTest.proto */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+
+/* RaiseException.proto */
+static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
+
 /* ArgTypeTest.proto */
 #define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
     ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
         __Pyx__ArgTypeTest(obj, type, name, exact))
 static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
 
+/* PyObjectCall2Args.proto */
+static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
+
+/* PyObjectCallMethO.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
+#endif
+
+/* PyObjectCallOneArg.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
+
 /* IncludeStringH.proto */
 #include <string.h>
 
 /* BytesEquals.proto */
 static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);
 
 /* UnicodeEquals.proto */
@@ -1970,14 +1693,36 @@
         (((x) < 0) & ((unsigned long)(x) == 0-(unsigned long)(x)))
 
 static CYTHON_UNUSED int __pyx_array_getbuffer(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *); /*proto*/
 /* GetAttr.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *, PyObject *);
 
+/* GetItemInt.proto */
+#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
+    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
+               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
+#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
+                                                     int is_list, int wraparound, int boundscheck);
+
 /* ObjectGetItem.proto */
 #if CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key);
 #else
 #define __Pyx_PyObject_GetItem(obj, key)  PyObject_GetItem(obj, key)
 #endif
 
@@ -2008,40 +1753,14 @@
 #else
 #define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
 #endif
 
 /* GetAttr3.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *, PyObject *, PyObject *);
 
-/* PyDictVersioning.proto */
-#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
-#define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
-#define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
-#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
-    (version_var) = __PYX_GET_DICT_VERSION(dict);\
-    (cache_var) = (value);
-#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP) {\
-    static PY_UINT64_T __pyx_dict_version = 0;\
-    static PyObject *__pyx_dict_cached_value = NULL;\
-    if (likely(__PYX_GET_DICT_VERSION(DICT) == __pyx_dict_version)) {\
-        (VAR) = __pyx_dict_cached_value;\
-    } else {\
-        (VAR) = __pyx_dict_cached_value = (LOOKUP);\
-        __pyx_dict_version = __PYX_GET_DICT_VERSION(DICT);\
-    }\
-}
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj);
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj);
-static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version);
-#else
-#define __PYX_GET_DICT_VERSION(dict)  (0)
-#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
-#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
-#endif
-
 /* GetModuleGlobalName.proto */
 #if CYTHON_USE_DICT_VERSIONS
 #define __Pyx_GetModuleGlobalName(var, name)  do {\
     static PY_UINT64_T __pyx_dict_version = 0;\
     static PyObject *__pyx_dict_cached_value = NULL;\
     (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
         (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
@@ -2055,16 +1774,22 @@
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
-/* ExtTypeTest.proto */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+/* RaiseTooManyValuesToUnpack.proto */
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);
+
+/* RaiseNeedMoreValuesToUnpack.proto */
+static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);
+
+/* RaiseNoneIterError.proto */
+static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);
 
 /* GetTopmostException.proto */
 #if CYTHON_USE_EXC_INFO_STACK
 static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
 #endif
 
 /* SaveResetException.proto */
@@ -2145,16 +1870,30 @@
     Py_DECREF(none);
     return 0;
 #else
     return PyList_SetSlice(L, PY_SSIZE_T_MAX, PY_SSIZE_T_MAX, v);
 #endif
 }
 
-/* None.proto */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);
+/* ListAppend.proto */
+#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
+static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
+    PyListObject* L = (PyListObject*) list;
+    Py_ssize_t len = Py_SIZE(list);
+    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
+        Py_INCREF(x);
+        PyList_SET_ITEM(list, len, x);
+        __Pyx_SET_SIZE(list, len + 1);
+        return 0;
+    }
+    return PyList_Append(list, x);
+}
+#else
+#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
+#endif
 
 /* DivInt[long].proto */
 static CYTHON_INLINE long __Pyx_div_long(long, long);
 
 /* PySequenceContains.proto */
 static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
     int result = PySequence_Contains(seq, item);
@@ -2186,85 +1925,27 @@
 
 /* PyObjectGetAttrStrNoError.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStrNoError(PyObject* obj, PyObject* attr_name);
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
-/* FetchCommonType.proto */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
-
-/* CythonFunctionShared.proto */
-#define __Pyx_CyFunction_USED 1
-#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
-#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
-#define __Pyx_CYFUNCTION_CCLASS        0x04
-#define __Pyx_CyFunction_GetClosure(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_closure)
-#define __Pyx_CyFunction_GetClassObj(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_classobj)
-#define __Pyx_CyFunction_Defaults(type, f)\
-    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
-#define __Pyx_CyFunction_SetDefaultsGetter(f, g)\
-    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
-typedef struct {
-    PyCFunctionObject func;
-#if PY_VERSION_HEX < 0x030500A0
-    PyObject *func_weakreflist;
-#endif
-    PyObject *func_dict;
-    PyObject *func_name;
-    PyObject *func_qualname;
-    PyObject *func_doc;
-    PyObject *func_globals;
-    PyObject *func_code;
-    PyObject *func_closure;
-    PyObject *func_classobj;
-    void *defaults;
-    int defaults_pyobjects;
-    size_t defaults_size;  // used by FusedFunction for copying defaults
-    int flags;
-    PyObject *defaults_tuple;
-    PyObject *defaults_kwdict;
-    PyObject *(*defaults_getter)(PyObject *);
-    PyObject *func_annotations;
-} __pyx_CyFunctionObject;
-static PyTypeObject *__pyx_CyFunctionType = 0;
-#define __Pyx_CyFunction_Check(obj)  (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject* op, PyMethodDef *ml,
-                                      int flags, PyObject* qualname,
-                                      PyObject *self,
-                                      PyObject *module, PyObject *globals,
-                                      PyObject* code);
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
-                                                         size_t size,
-                                                         int pyobjects);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
-                                                            PyObject *tuple);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
-                                                             PyObject *dict);
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
-                                                              PyObject *dict);
-static int __pyx_CyFunction_init(void);
+/* TypeImport.proto */
+#ifndef __PYX_HAVE_RT_ImportType_proto
+#define __PYX_HAVE_RT_ImportType_proto
+enum __Pyx_ImportType_CheckSize {
+   __Pyx_ImportType_CheckSize_Error = 0,
+   __Pyx_ImportType_CheckSize_Warn = 1,
+   __Pyx_ImportType_CheckSize_Ignore = 2
+};
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+#endif
 
-/* FusedFunction.proto */
-typedef struct {
-    __pyx_CyFunctionObject func;
-    PyObject *__signatures__;
-    PyObject *type;
-    PyObject *self;
-} __pyx_FusedFunctionObject;
-static PyObject *__pyx_FusedFunction_New(PyMethodDef *ml, int flags,
-                                         PyObject *qualname, PyObject *closure,
-                                         PyObject *module, PyObject *globals,
-                                         PyObject *code);
-static int __pyx_FusedFunction_clear(__pyx_FusedFunctionObject *self);
-static PyTypeObject *__pyx_FusedFunctionType = NULL;
-static int __pyx_FusedFunction_init(void);
-#define __Pyx_FusedFunction_USED
+/* GetVTable.proto */
+static void* __Pyx_GetVtable(PyObject *dict);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
 #define __Pyx_CLineForTraceback(tstate, c_line)  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
 #else
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
 #endif
@@ -2284,74 +1965,14 @@
 static PyCodeObject *__pyx_find_code_object(int code_line);
 static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);
 
 /* AddTraceback.proto */
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename);
 
-/* RealImag.proto */
-#if CYTHON_CCOMPLEX
-  #ifdef __cplusplus
-    #define __Pyx_CREAL(z) ((z).real())
-    #define __Pyx_CIMAG(z) ((z).imag())
-  #else
-    #define __Pyx_CREAL(z) (__real__(z))
-    #define __Pyx_CIMAG(z) (__imag__(z))
-  #endif
-#else
-    #define __Pyx_CREAL(z) ((z).real)
-    #define __Pyx_CIMAG(z) ((z).imag)
-#endif
-#if defined(__cplusplus) && CYTHON_CCOMPLEX\
-        && (defined(_WIN32) || defined(__clang__) || (defined(__GNUC__) && (__GNUC__ >= 5 || __GNUC__ == 4 && __GNUC_MINOR__ >= 4 )) || __cplusplus >= 201103)
-    #define __Pyx_SET_CREAL(z,x) ((z).real(x))
-    #define __Pyx_SET_CIMAG(z,y) ((z).imag(y))
-#else
-    #define __Pyx_SET_CREAL(z,x) __Pyx_CREAL(z) = (x)
-    #define __Pyx_SET_CIMAG(z,y) __Pyx_CIMAG(z) = (y)
-#endif
-
-/* Arithmetic.proto */
-#if CYTHON_CCOMPLEX
-    #define __Pyx_c_eq_double(a, b)   ((a)==(b))
-    #define __Pyx_c_sum_double(a, b)  ((a)+(b))
-    #define __Pyx_c_diff_double(a, b) ((a)-(b))
-    #define __Pyx_c_prod_double(a, b) ((a)*(b))
-    #define __Pyx_c_quot_double(a, b) ((a)/(b))
-    #define __Pyx_c_neg_double(a)     (-(a))
-  #ifdef __cplusplus
-    #define __Pyx_c_is_zero_double(z) ((z)==(double)0)
-    #define __Pyx_c_conj_double(z)    (::std::conj(z))
-    #if 1
-        #define __Pyx_c_abs_double(z)     (::std::abs(z))
-        #define __Pyx_c_pow_double(a, b)  (::std::pow(a, b))
-    #endif
-  #else
-    #define __Pyx_c_is_zero_double(z) ((z)==0)
-    #define __Pyx_c_conj_double(z)    (conj(z))
-    #if 1
-        #define __Pyx_c_abs_double(z)     (cabs(z))
-        #define __Pyx_c_pow_double(a, b)  (cpow(a, b))
-    #endif
- #endif
-#else
-    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex);
-    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
-    #if 1
-        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
-        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    #endif
-#endif
-
 #if PY_MAJOR_VERSION < 3
     static int __Pyx_GetBuffer(PyObject *obj, Py_buffer *view, int flags);
     static void __Pyx_ReleaseBuffer(Py_buffer *view);
 #else
     #define __Pyx_GetBuffer PyObject_GetBuffer
     #define __Pyx_ReleaseBuffer PyBuffer_Release
 #endif
@@ -2402,115 +2023,120 @@
                 int ndim,
                 __Pyx_TypeInfo *dtype,
                 __Pyx_BufFmt_StackElem stack[],
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_d_dc___pyx_t_double_complex(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(PyObject *, int writable_flag);
+/* MemviewDtypeToObject.proto */
+static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
+static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
 
-/* GCCDiagnostics.proto */
-#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
-#define __Pyx_HAS_GCC_DIAGNOSTIC
+/* RealImag.proto */
+#if CYTHON_CCOMPLEX
+  #ifdef __cplusplus
+    #define __Pyx_CREAL(z) ((z).real())
+    #define __Pyx_CIMAG(z) ((z).imag())
+  #else
+    #define __Pyx_CREAL(z) (__real__(z))
+    #define __Pyx_CIMAG(z) (__imag__(z))
+  #endif
+#else
+    #define __Pyx_CREAL(z) ((z).real)
+    #define __Pyx_CIMAG(z) ((z).imag)
+#endif
+#if defined(__cplusplus) && CYTHON_CCOMPLEX\
+        && (defined(_WIN32) || defined(__clang__) || (defined(__GNUC__) && (__GNUC__ >= 5 || __GNUC__ == 4 && __GNUC_MINOR__ >= 4 )) || __cplusplus >= 201103)
+    #define __Pyx_SET_CREAL(z,x) ((z).real(x))
+    #define __Pyx_SET_CIMAG(z,y) ((z).imag(y))
+#else
+    #define __Pyx_SET_CREAL(z,x) __Pyx_CREAL(z) = (x)
+    #define __Pyx_SET_CIMAG(z,y) __Pyx_CIMAG(z) = (y)
 #endif
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_int(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_dc___pyx_t_double_complex(PyObject *, int writable_flag);
-
-/* MemviewDtypeToObject.proto */
-static CYTHON_INLINE PyObject *__pyx_memview_get_double__const__(const char *itemp);
 
 /* Arithmetic.proto */
 #if CYTHON_CCOMPLEX
-    #define __Pyx_c_eq_float(a, b)   ((a)==(b))
-    #define __Pyx_c_sum_float(a, b)  ((a)+(b))
-    #define __Pyx_c_diff_float(a, b) ((a)-(b))
-    #define __Pyx_c_prod_float(a, b) ((a)*(b))
-    #define __Pyx_c_quot_float(a, b) ((a)/(b))
-    #define __Pyx_c_neg_float(a)     (-(a))
+    #define __Pyx_c_eq_double(a, b)   ((a)==(b))
+    #define __Pyx_c_sum_double(a, b)  ((a)+(b))
+    #define __Pyx_c_diff_double(a, b) ((a)-(b))
+    #define __Pyx_c_prod_double(a, b) ((a)*(b))
+    #define __Pyx_c_quot_double(a, b) ((a)/(b))
+    #define __Pyx_c_neg_double(a)     (-(a))
   #ifdef __cplusplus
-    #define __Pyx_c_is_zero_float(z) ((z)==(float)0)
-    #define __Pyx_c_conj_float(z)    (::std::conj(z))
+    #define __Pyx_c_is_zero_double(z) ((z)==(double)0)
+    #define __Pyx_c_conj_double(z)    (::std::conj(z))
     #if 1
-        #define __Pyx_c_abs_float(z)     (::std::abs(z))
-        #define __Pyx_c_pow_float(a, b)  (::std::pow(a, b))
+        #define __Pyx_c_abs_double(z)     (::std::abs(z))
+        #define __Pyx_c_pow_double(a, b)  (::std::pow(a, b))
     #endif
   #else
-    #define __Pyx_c_is_zero_float(z) ((z)==0)
-    #define __Pyx_c_conj_float(z)    (conjf(z))
+    #define __Pyx_c_is_zero_double(z) ((z)==0)
+    #define __Pyx_c_conj_double(z)    (conj(z))
     #if 1
-        #define __Pyx_c_abs_float(z)     (cabsf(z))
-        #define __Pyx_c_pow_float(a, b)  (cpowf(a, b))
+        #define __Pyx_c_abs_double(z)     (cabs(z))
+        #define __Pyx_c_pow_double(a, b)  (cpow(a, b))
     #endif
  #endif
 #else
-    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex, __pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex, __pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex, __pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex, __pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex, __pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex);
-    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex);
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex);
+    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex);
+    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
     #if 1
-        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex);
-        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex, __pyx_t_float_complex);
+        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
+        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
     #endif
 #endif
 
 /* MemviewSliceCopyTemplate.proto */
 static __Pyx_memviewslice
 __pyx_memoryview_copy_new_contig(const __Pyx_memviewslice *from_mvs,
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
+/* GCCDiagnostics.proto */
+#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
+#define __Pyx_HAS_GCC_DIAGNOSTIC
+#endif
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
-
-/* BytesContains.proto */
-static CYTHON_INLINE int __Pyx_BytesContains(PyObject* bytes, char character);
-
-/* ImportNumPyArray.proto */
-static PyObject *__pyx_numpy_ndarray = NULL;
-static PyObject* __Pyx_ImportNumPyArrayTypeIfAvailable(void);
-
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
-/* FunctionImport.proto */
-static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
-
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
 static PyObject *__pyx_memoryview_is_slice(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_obj); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assignment(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_dst, PyObject *__pyx_v_src); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assign_scalar(struct __pyx_memoryview_obj *__pyx_v_self, struct __pyx_memoryview_obj *__pyx_v_dst, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_setitem_indexed(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_convert_item_to_object(struct __pyx_memoryview_obj *__pyx_v_self, char *__pyx_v_itemp); /* proto*/
@@ -2518,40 +2144,34 @@
 static PyObject *__pyx_memoryviewslice_convert_item_to_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp); /* proto*/
 static PyObject *__pyx_memoryviewslice_assign_item_from_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp, PyObject *__pyx_v_value); /* proto*/
 
 /* Module declarations from 'cython.view' */
 
 /* Module declarations from 'cython' */
 
-/* Module declarations from 'libc.string' */
-
-/* Module declarations from 'libc.stdlib' */
+/* Module declarations from 'pyseobnr.eob.utils.containers' */
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = 0;
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = 0;
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = 0;
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = 0;
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = 0;
 
-/* Module declarations from 'libc.math' */
-
-/* Module declarations from 'libc' */
-
-/* Module declarations from 'scipy.linalg.cython_lapack' */
-static void (*__pyx_f_5scipy_6linalg_13cython_lapack_dgeev)(char *, char *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, int *); /*proto*/
-
-/* Module declarations from 'pyseobnr.auxiliary.interpolate._ppoly' */
+/* Module declarations from 'pyseobnr.eob.hamiltonian.Hamiltonian_C' */
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
 static PyTypeObject *__pyx_memoryviewslice_type = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
 static int __pyx_memoryview_thread_locks_used;
 static PyThread_type_lock __pyx_memoryview_thread_locks[8];
-static int __pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending(double const *, size_t, double, struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending *__pyx_optional_args); /*proto*/
-static double __pyx_fuse_0__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1(double, __Pyx_memviewslice, int, int, int); /*proto*/
-static __pyx_t_double_complex __pyx_fuse_1__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1(double, __Pyx_memviewslice, int, int, int); /*proto*/
 static struct __pyx_array_obj *__pyx_array_new(PyObject *, Py_ssize_t, char *, char *, char *); /*proto*/
 static void *__pyx_align_pointer(void *, size_t); /*proto*/
 static PyObject *__pyx_memoryview_new(PyObject *, int, int, __Pyx_TypeInfo *); /*proto*/
 static CYTHON_INLINE int __pyx_memoryview_check(PyObject *); /*proto*/
 static PyObject *_unellipsify(PyObject *, int); /*proto*/
 static PyObject *assert_direct_dimensions(Py_ssize_t *, int); /*proto*/
 static struct __pyx_memoryview_obj *__pyx_memview_slice(struct __pyx_memoryview_obj *, PyObject *); /*proto*/
@@ -2578,111 +2198,95 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo___pyx_t_double_complex = { "double complex", NULL, sizeof(__pyx_t_double_complex), { 0 }, 0, 'C', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_double__const__ = { "const double", NULL, sizeof(double const ), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_int = { "int", NULL, sizeof(int), { 0 }, 0, IS_UNSIGNED(int) ? 'U' : 'I', IS_UNSIGNED(int), 0 };
-#define __Pyx_MODULE_NAME "pyseobnr.auxiliary.interpolate._ppoly"
-extern int __pyx_module_is_main_pyseobnr__auxiliary__interpolate___ppoly;
-int __pyx_module_is_main_pyseobnr__auxiliary__interpolate___ppoly = 0;
+#define __Pyx_MODULE_NAME "pyseobnr.eob.hamiltonian.Hamiltonian_C"
+extern int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C;
+int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C = 0;
 
-/* Implementation of 'pyseobnr.auxiliary.interpolate._ppoly' */
+/* Implementation of 'pyseobnr.eob.hamiltonian.Hamiltonian_C' */
 static PyObject *__pyx_builtin_TypeError;
-static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_enumerate;
+static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
-static const char __pyx_k_[] = "()";
 static const char __pyx_k_O[] = "O";
 static const char __pyx_k_c[] = "c";
-static const char __pyx_k_i[] = "i";
-static const char __pyx_k_s[] = "s";
-static const char __pyx_k_x[] = "x";
-static const char __pyx_k__2[] = "|";
-static const char __pyx_k_dx[] = "dx";
+static const char __pyx_k_p[] = "p";
+static const char __pyx_k_q[] = "q";
 static const char __pyx_k_id[] = "id";
-static const char __pyx_k_ip[] = "ip";
-static const char __pyx_k_jp[] = "jp";
-static const char __pyx_k_np[] = "np";
-static const char __pyx_k_xp[] = "xp";
+static const char __pyx_k_csi[] = "csi";
+static const char __pyx_k_m_1[] = "m_1";
+static const char __pyx_k_m_2[] = "m_2";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
-static const char __pyx_k_out[] = "out";
-static const char __pyx_k_args[] = "args";
 static const char __pyx_k_base[] = "base";
+static const char __pyx_k_call[] = "_call";
 static const char __pyx_k_dict[] = "__dict__";
-static const char __pyx_k_kind[] = "kind";
+static const char __pyx_k_grad[] = "grad";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_ndim[] = "ndim";
 static const char __pyx_k_pack[] = "pack";
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
-static const char __pyx_k_xval[] = "xval";
 static const char __pyx_k_ASCII[] = "ASCII";
+static const char __pyx_k_chi_1[] = "chi_1";
+static const char __pyx_k_chi_2[] = "chi_2";
 static const char __pyx_k_class[] = "__class__";
-static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
-static const char __pyx_k_numpy[] = "numpy";
+static const char __pyx_k_omega[] = "omega";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
-static const char __pyx_k_split[] = "split";
 static const char __pyx_k_start[] = "start";
-static const char __pyx_k_strip[] = "strip";
-static const char __pyx_k_double[] = "double";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
-static const char __pyx_k_kwargs[] = "kwargs";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_fortran[] = "fortran";
-static const char __pyx_k_indices[] = "indices";
+static const char __pyx_k_hessian[] = "hessian";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
-static const char __pyx_k_defaults[] = "defaults";
-static const char __pyx_k_evaluate[] = "evaluate";
+static const char __pyx_k_dynamics[] = "dynamics";
 static const char __pyx_k_getstate[] = "__getstate__";
-static const char __pyx_k_interval[] = "interval";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_setstate[] = "__setstate__";
+static const char __pyx_k_EOBParams[] = "EOBParams";
 static const char __pyx_k_TypeError[] = "TypeError";
+static const char __pyx_k_auxderivs[] = "auxderivs";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
-static const char __pyx_k_signatures[] = "signatures";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
-static const char __pyx_k_extrapolate[] = "extrapolate";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
-static const char __pyx_k_stored_index[] = "stored_index";
 static const char __pyx_k_stringsource[] = "stringsource";
+static const char __pyx_k_Hamiltonian_C[] = "Hamiltonian_C";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
-static const char __pyx_k_double_complex[] = "double complex";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
@@ -2690,157 +2294,144 @@
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
-static const char __pyx_k_No_matching_signature_found[] = "No matching signature found";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
-static const char __pyx_k_pyseobnr_auxiliary_interpolate[] = "pyseobnr/auxiliary/interpolate/_ppoly.pyx";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
-static const char __pyx_k_Expected_at_least_d_argument_s_g[] = "Expected at least %d argument%s, got %d";
-static const char __pyx_k_Function_call_with_ambiguous_arg[] = "Function call with ambiguous argument types";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got %s";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis %d)";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
-static const char __pyx_k_pyseobnr_auxiliary_interpolate_2[] = "pyseobnr.auxiliary.interpolate._ppoly";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
-static PyObject *__pyx_kp_s_;
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_kp_s_Buffer_view_does_not_expose_stri;
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
+static PyObject *__pyx_n_s_EOBParams;
 static PyObject *__pyx_n_s_Ellipsis;
 static PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
-static PyObject *__pyx_kp_s_Expected_at_least_d_argument_s_g;
-static PyObject *__pyx_kp_s_Function_call_with_ambiguous_arg;
+static PyObject *__pyx_n_s_Hamiltonian_C;
 static PyObject *__pyx_kp_s_Incompatible_checksums_0x_x_vs_0;
 static PyObject *__pyx_n_s_IndexError;
 static PyObject *__pyx_kp_s_Indirect_dimensions_not_supporte;
 static PyObject *__pyx_kp_s_Invalid_mode_expected_c_or_fortr;
 static PyObject *__pyx_kp_s_Invalid_shape_in_axis_d_d;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_kp_s_MemoryView_of_r_at_0x_x;
 static PyObject *__pyx_kp_s_MemoryView_of_r_object;
-static PyObject *__pyx_kp_s_No_matching_signature_found;
 static PyObject *__pyx_n_b_O;
 static PyObject *__pyx_kp_s_Out_of_bounds_on_buffer_access_a;
 static PyObject *__pyx_n_s_PickleError;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
-static PyObject *__pyx_kp_s__2;
 static PyObject *__pyx_n_s_allocate_buffer;
-static PyObject *__pyx_n_s_args;
+static PyObject *__pyx_n_s_auxderivs;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_u_c;
+static PyObject *__pyx_n_s_call;
+static PyObject *__pyx_n_s_chi_1;
+static PyObject *__pyx_n_s_chi_2;
 static PyObject *__pyx_n_s_class;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
-static PyObject *__pyx_n_s_defaults;
+static PyObject *__pyx_n_s_csi;
 static PyObject *__pyx_n_s_dict;
-static PyObject *__pyx_n_s_double;
-static PyObject *__pyx_kp_s_double_complex;
-static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_dtype_is_object;
-static PyObject *__pyx_n_s_dx;
+static PyObject *__pyx_n_s_dynamics;
 static PyObject *__pyx_n_s_encode;
 static PyObject *__pyx_n_s_enumerate;
 static PyObject *__pyx_n_s_error;
-static PyObject *__pyx_n_s_evaluate;
-static PyObject *__pyx_n_s_extrapolate;
 static PyObject *__pyx_n_s_flags;
 static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_fortran;
 static PyObject *__pyx_n_u_fortran;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_kp_s_got_differing_extents_in_dimensi;
-static PyObject *__pyx_n_s_i;
+static PyObject *__pyx_n_s_grad;
+static PyObject *__pyx_n_s_hessian;
 static PyObject *__pyx_n_s_id;
 static PyObject *__pyx_n_s_import;
-static PyObject *__pyx_n_s_indices;
-static PyObject *__pyx_n_s_interval;
-static PyObject *__pyx_n_s_ip;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
-static PyObject *__pyx_n_s_jp;
-static PyObject *__pyx_n_s_kind;
-static PyObject *__pyx_n_s_kwargs;
+static PyObject *__pyx_n_s_m_1;
+static PyObject *__pyx_n_s_m_2;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_memview;
 static PyObject *__pyx_n_s_mode;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_name_2;
 static PyObject *__pyx_n_s_ndim;
 static PyObject *__pyx_n_s_new;
 static PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
-static PyObject *__pyx_n_s_np;
-static PyObject *__pyx_n_s_numpy;
 static PyObject *__pyx_n_s_obj;
-static PyObject *__pyx_n_s_out;
+static PyObject *__pyx_n_s_omega;
+static PyObject *__pyx_n_s_p;
 static PyObject *__pyx_n_s_pack;
 static PyObject *__pyx_n_s_pickle;
-static PyObject *__pyx_kp_s_pyseobnr_auxiliary_interpolate;
-static PyObject *__pyx_n_s_pyseobnr_auxiliary_interpolate_2;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
 static PyObject *__pyx_n_s_pyx_type;
 static PyObject *__pyx_n_s_pyx_unpickle_Enum;
 static PyObject *__pyx_n_s_pyx_vtable;
+static PyObject *__pyx_n_s_q;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_reduce;
 static PyObject *__pyx_n_s_reduce_cython;
 static PyObject *__pyx_n_s_reduce_ex;
-static PyObject *__pyx_n_s_s;
 static PyObject *__pyx_n_s_setstate;
 static PyObject *__pyx_n_s_setstate_cython;
 static PyObject *__pyx_n_s_shape;
-static PyObject *__pyx_n_s_signatures;
 static PyObject *__pyx_n_s_size;
-static PyObject *__pyx_n_s_split;
 static PyObject *__pyx_n_s_start;
 static PyObject *__pyx_n_s_step;
 static PyObject *__pyx_n_s_stop;
-static PyObject *__pyx_n_s_stored_index;
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
-static PyObject *__pyx_n_s_strip;
 static PyObject *__pyx_n_s_struct;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_unpack;
 static PyObject *__pyx_n_s_update;
-static PyObject *__pyx_n_s_x;
-static PyObject *__pyx_n_s_xp;
-static PyObject *__pyx_n_s_xval;
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_2evaluate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_c, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_xp, int __pyx_v_dx, int __pyx_v_extrapolate, __Pyx_memviewslice __pyx_v_out, __Pyx_memviewslice __pyx_v_indices); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_4evaluate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_c, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_xp, int __pyx_v_dx, int __pyx_v_extrapolate, __Pyx_memviewslice __pyx_v_out, __Pyx_memviewslice __pyx_v_indices); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -2875,622 +2466,651 @@
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
-static PyObject *__pyx_int_7;
 static PyObject *__pyx_int_112105877;
 static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
+static PyObject *__pyx_tuple_;
+static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
-static PyObject *__pyx_slice__19;
+static PyObject *__pyx_slice__17;
 static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
 static PyObject *__pyx_tuple__12;
 static PyObject *__pyx_tuple__13;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
-static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
+static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
+static PyObject *__pyx_tuple__25;
 static PyObject *__pyx_tuple__26;
 static PyObject *__pyx_tuple__27;
-static PyObject *__pyx_tuple__28;
-static PyObject *__pyx_tuple__29;
-static PyObject *__pyx_tuple__30;
-static PyObject *__pyx_tuple__31;
-static PyObject *__pyx_codeobj__25;
-static PyObject *__pyx_codeobj__32;
+static PyObject *__pyx_codeobj__28;
 /* Late includes */
 
-/* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":5
+ * 
+ * cdef class Hamiltonian_C:
+ *     def __cinit__(self,EOBParams):             # <<<<<<<<<<<<<<
+ *         pass
+ * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_1evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate[] = "\n    Evaluate a piecewise polynomial.\n    Parameters\n    ----------\n    c : ndarray, shape (k, m, n)\n        Coefficients local polynomials of order `k-1` in `m` intervals.\n        There are `n` polynomials in each interval.\n        Coefficient of highest order-term comes first.\n    x : ndarray, shape (m+1,)\n        Breakpoints of polynomials.\n    xp : ndarray, shape (r,)\n        Points to evaluate the piecewise polynomial at.\n    dx : int\n        Order of derivative to evaluate.  The derivative is evaluated\n        piecewise and may have discontinuities.\n    extrapolate : bint\n        Whether to extrapolate to out-of-bounds points based on first\n        and last intervals, or to return NaNs.\n    out : ndarray, shape (r, n)\n        Value of each polynomial at each of the input points.\n        This argument is modified in-place.\n    ";
-static PyMethodDef __pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_1evaluate = {"evaluate", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_1evaluate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate};
-static PyObject *__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_1evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_signatures = 0;
-  PyObject *__pyx_v_args = 0;
-  PyObject *__pyx_v_kwargs = 0;
-  CYTHON_UNUSED PyObject *__pyx_v_defaults = 0;
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  CYTHON_UNUSED PyObject *__pyx_v_EOBParams = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_EOBParams,0};
+    PyObject* values[1] = {0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_EOBParams)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 5, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+    }
+    __pyx_v_EOBParams = values[0];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 5, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_EOBParams);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":9
+ * 
+ * 
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ */
+
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("_call", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_call); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call)) {
+        __Pyx_XDECREF(__pyx_r);
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":10
+ * 
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ */
+
+  /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":9
+ * 
+ * 
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__pyx_fused_cpdef (wrapper)", 0);
+  __Pyx_RefNannySetupContext("_call (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_signatures,&__pyx_n_s_args,&__pyx_n_s_kwargs,&__pyx_n_s_defaults,0};
-    PyObject* values[4] = {0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 1); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 2); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 3); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 4); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 5); __PYX_ERR(1, 9, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 29, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_call") < 0)) __PYX_ERR(1, 9, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
-    __pyx_v_signatures = values[0];
-    __pyx_v_args = values[1];
-    __pyx_v_kwargs = values[2];
-    __pyx_v_defaults = values[3];
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 29, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 9, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.auxiliary.interpolate._ppoly.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_signatures, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, CYTHON_UNUSED PyObject *__pyx_v_defaults) {
-  PyObject *__pyx_v_dest_sig = NULL;
-  Py_ssize_t __pyx_v_i;
-  PyTypeObject *__pyx_v_ndarray = 0;
-  __Pyx_memviewslice __pyx_v_memslice;
-  Py_ssize_t __pyx_v_itemsize;
-  CYTHON_UNUSED int __pyx_v_dtype_signed;
-  char __pyx_v_kind;
-  PyObject *__pyx_v_arg = NULL;
-  PyObject *__pyx_v_dtype = NULL;
-  PyObject *__pyx_v_arg_base = NULL;
-  PyObject *__pyx_v_candidates = NULL;
-  PyObject *__pyx_v_sig = NULL;
-  int __pyx_v_match_found;
-  PyObject *__pyx_v_src_sig = NULL;
-  PyObject *__pyx_v_dst_type = NULL;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
-  int __pyx_t_3;
-  int __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("_call", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":11
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ */
+
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
-  long __pyx_t_7;
-  __Pyx_memviewslice __pyx_t_8;
-  Py_ssize_t __pyx_t_9;
-  int __pyx_t_10;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  Py_ssize_t __pyx_t_15;
-  Py_ssize_t __pyx_t_16;
-  Py_ssize_t __pyx_t_17;
-  int __pyx_t_18;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("evaluate", 0);
-  __Pyx_INCREF(__pyx_v_kwargs);
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(Py_None);
-  __Pyx_GIVEREF(Py_None);
-  PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
-  __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_3 = (__pyx_v_kwargs != Py_None);
-  __pyx_t_4 = (__pyx_t_3 != 0);
-  if (__pyx_t_4) {
-  } else {
-    __pyx_t_2 = __pyx_t_4;
-    goto __pyx_L4_bool_binop_done;
-  }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_t_3 = ((!__pyx_t_4) != 0);
-  __pyx_t_2 = __pyx_t_3;
-  __pyx_L4_bool_binop_done:;
-  if (__pyx_t_2) {
-    __Pyx_INCREF(Py_None);
-    __Pyx_DECREF_SET(__pyx_v_kwargs, Py_None);
-  }
-  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_v_itemsize = -1L;
-  if (unlikely(__pyx_v_args == Py_None)) {
-    PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_t_2 = ((0 < __pyx_t_5) != 0);
-  if (__pyx_t_2) {
-    if (unlikely(__pyx_v_args == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 29, __pyx_L1_error)
-    }
-    __pyx_t_1 = PyTuple_GET_ITEM(((PyObject*)__pyx_v_args), 0);
-    __Pyx_INCREF(__pyx_t_1);
-    __pyx_v_arg = __pyx_t_1;
-    __pyx_t_1 = 0;
-    goto __pyx_L6;
-  }
-  __pyx_t_3 = (__pyx_v_kwargs != Py_None);
-  __pyx_t_4 = (__pyx_t_3 != 0);
-  if (__pyx_t_4) {
-  } else {
-    __pyx_t_2 = __pyx_t_4;
-    goto __pyx_L7_bool_binop_done;
-  }
-  if (unlikely(__pyx_v_kwargs == Py_None)) {
-    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_c, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_t_3 = (__pyx_t_4 != 0);
-  __pyx_t_2 = __pyx_t_3;
-  __pyx_L7_bool_binop_done:;
-  if (__pyx_t_2) {
-    if (unlikely(__pyx_v_kwargs == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 29, __pyx_L1_error)
-    }
-    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_v_arg = __pyx_t_1;
-    __pyx_t_1 = 0;
-    goto __pyx_L6;
-  }
-  /*else*/ {
-    if (unlikely(__pyx_v_args == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 29, __pyx_L1_error)
-    }
-    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_INCREF(__pyx_int_7);
-    __Pyx_GIVEREF(__pyx_int_7);
-    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_7);
-    __Pyx_INCREF(__pyx_n_s_s);
-    __Pyx_GIVEREF(__pyx_n_s_s);
-    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_n_s_s);
-    __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  __pyx_L6:;
-  while (1) {
-    __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
-    __pyx_t_3 = (__pyx_t_2 != 0);
-    if (__pyx_t_3) {
-      __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg, __pyx_v_ndarray); 
-      __pyx_t_2 = (__pyx_t_3 != 0);
-      if (__pyx_t_2) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_v_dtype = __pyx_t_6;
-        __pyx_t_6 = 0;
-        goto __pyx_L12;
-      }
-      __pyx_t_2 = __pyx_memoryview_check(__pyx_v_arg); 
-      __pyx_t_3 = (__pyx_t_2 != 0);
-      if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_v_arg_base = __pyx_t_6;
-        __pyx_t_6 = 0;
-        __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg_base, __pyx_v_ndarray); 
-        __pyx_t_2 = (__pyx_t_3 != 0);
-        if (__pyx_t_2) {
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __pyx_v_dtype = __pyx_t_6;
-          __pyx_t_6 = 0;
-          goto __pyx_L13;
-        }
-        /*else*/ {
-          __Pyx_INCREF(Py_None);
-          __pyx_v_dtype = Py_None;
-        }
-        __pyx_L13:;
-        goto __pyx_L12;
-      }
-      /*else*/ {
-        __Pyx_INCREF(Py_None);
-        __pyx_v_dtype = Py_None;
-      }
-      __pyx_L12:;
-      __pyx_v_itemsize = -1L;
-      __pyx_t_2 = (__pyx_v_dtype != Py_None);
-      __pyx_t_3 = (__pyx_t_2 != 0);
-      if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_v_itemsize = __pyx_t_5;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __Pyx_RefNannySetupContext("grad", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_grad); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad)) {
+        __Pyx_XDECREF(__pyx_r);
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_v_kind = __pyx_t_7;
-        __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
-        switch (__pyx_v_kind) {
-          case 'i':
-          case 'u':
-          break;
-          case 'f':
-          __pyx_t_2 = (((sizeof(double)) == __pyx_v_itemsize) != 0);
-          if (__pyx_t_2) {
-          } else {
-            __pyx_t_3 = __pyx_t_2;
-            goto __pyx_L16_bool_binop_done;
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L1_error)
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
-          __pyx_t_3 = __pyx_t_2;
-          __pyx_L16_bool_binop_done:;
-          if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-            goto __pyx_L10_break;
-          }
-          break;
-          case 'c':
-          __pyx_t_2 = (((sizeof(__pyx_t_double_complex)) == __pyx_v_itemsize) != 0);
-          if (__pyx_t_2) {
-          } else {
-            __pyx_t_3 = __pyx_t_2;
-            goto __pyx_L19_bool_binop_done;
-          }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
-          __pyx_t_3 = __pyx_t_2;
-          __pyx_L19_bool_binop_done:;
-          if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-            goto __pyx_L10_break;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
           }
-          break;
-          case 'O':
-          break;
-          default: break;
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
-      }
-    }
-    __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
-    if (!__pyx_t_2) {
-    } else {
-      __pyx_t_3 = __pyx_t_2;
-      goto __pyx_L22_bool_binop_done;
-    }
-    __pyx_t_2 = ((__pyx_v_itemsize == (sizeof(double))) != 0);
-    __pyx_t_3 = __pyx_t_2;
-    __pyx_L22_bool_binop_done:;
-    if (__pyx_t_3) {
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_v_arg, 0); 
-      __pyx_v_memslice = __pyx_t_8;
-      __pyx_t_3 = (__pyx_v_memslice.memview != 0);
-      if (__pyx_t_3) {
-        __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-        goto __pyx_L10_break;
-      }
-      /*else*/ {
-        PyErr_Clear(); 
-      }
-    }
-    __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
-    if (!__pyx_t_2) {
-    } else {
-      __pyx_t_3 = __pyx_t_2;
-      goto __pyx_L26_bool_binop_done;
-    }
-    __pyx_t_2 = ((__pyx_v_itemsize == (sizeof(__pyx_t_double_complex))) != 0);
-    __pyx_t_3 = __pyx_t_2;
-    __pyx_L26_bool_binop_done:;
-    if (__pyx_t_3) {
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc___pyx_t_double_complex(__pyx_v_arg, 0); 
-      __pyx_v_memslice = __pyx_t_8;
-      __pyx_t_3 = (__pyx_v_memslice.memview != 0);
-      if (__pyx_t_3) {
-        __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_double_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-        goto __pyx_L10_break;
-      }
-      /*else*/ {
-        PyErr_Clear(); 
-      }
-    }
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 0) < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-    goto __pyx_L10_break;
-  }
-  __pyx_L10_break:;
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_v_candidates = ((PyObject*)__pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_5 = 0;
-  if (unlikely(__pyx_v_signatures == Py_None)) {
-    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_6);
-  __pyx_t_6 = __pyx_t_1;
-  __pyx_t_1 = 0;
-  while (1) {
-    __pyx_t_11 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_9, &__pyx_t_5, &__pyx_t_1, NULL, NULL, __pyx_t_10);
-    if (unlikely(__pyx_t_11 == 0)) break;
-    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_XDECREF_SET(__pyx_v_sig, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_v_match_found = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_13);
-    __pyx_t_14 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
-      __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-      if (likely(__pyx_t_14)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-        __Pyx_INCREF(__pyx_t_14);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_13, function);
-      }
-    }
-    __pyx_t_12 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_kp_s_) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s_);
-    __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_12);
-    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_13);
-    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __pyx_t_12 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
-      __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
-      if (likely(__pyx_t_12)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-        __Pyx_INCREF(__pyx_t_12);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_13, function);
-      }
-    }
-    __pyx_t_1 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_12, __pyx_kp_s__2) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__2);
-    __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __Pyx_XDECREF_SET(__pyx_v_src_sig, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-    __pyx_t_16 = __pyx_t_15;
-    for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
-      __pyx_v_i = __pyx_t_17;
-      __pyx_t_1 = PyList_GET_ITEM(__pyx_v_dest_sig, __pyx_v_i);
-      __Pyx_INCREF(__pyx_t_1);
-      __Pyx_XDECREF_SET(__pyx_v_dst_type, __pyx_t_1);
-      __pyx_t_1 = 0;
-      __pyx_t_3 = (__pyx_v_dst_type != Py_None);
-      __pyx_t_2 = (__pyx_t_3 != 0);
-      if (__pyx_t_2) {
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 29, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        if (__pyx_t_2) {
-          __pyx_v_match_found = 1;
-          goto __pyx_L34;
-        }
-        /*else*/ {
-          __pyx_v_match_found = 0;
-          goto __pyx_L32_break;
-        }
-        __pyx_L34:;
+        goto __pyx_L0;
       }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
-    __pyx_L32_break:;
-    __pyx_t_2 = (__pyx_v_match_found != 0);
-    if (__pyx_t_2) {
-      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-    }
-  }
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_2 = (PyList_GET_SIZE(__pyx_v_candidates) != 0);
-  __pyx_t_3 = ((!__pyx_t_2) != 0);
-  if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_t_3 = ((__pyx_t_9 > 1) != 0);
-  if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 29, __pyx_L1_error)
-  }
-  /*else*/ {
-    __Pyx_XDECREF(__pyx_r);
-    if (unlikely(__pyx_v_signatures == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 29, __pyx_L1_error)
-    }
-    __pyx_t_6 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), PyList_GET_ITEM(__pyx_v_candidates, 0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_r = __pyx_t_6;
-    __pyx_t_6 = 0;
-    goto __pyx_L0;
+    #endif
   }
 
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":12
+ *         pass
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ */
+
   /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_AddTraceback("pyseobnr.auxiliary.interpolate._ppoly.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_dest_sig);
-  __Pyx_XDECREF(__pyx_v_ndarray);
-  __Pyx_XDECREF(__pyx_v_arg);
-  __Pyx_XDECREF(__pyx_v_dtype);
-  __Pyx_XDECREF(__pyx_v_arg_base);
-  __Pyx_XDECREF(__pyx_v_candidates);
-  __Pyx_XDECREF(__pyx_v_sig);
-  __Pyx_XDECREF(__pyx_v_src_sig);
-  __Pyx_XDECREF(__pyx_v_dst_type);
-  __Pyx_XDECREF(__pyx_v_kwargs);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":11
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ */
+
 /* Python wrapper */
-static PyObject *__pyx_fuse_0__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_3evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_fuse_0__pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_3evaluate = {"__pyx_fuse_0evaluate", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_fuse_0__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_3evaluate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate};
-static PyObject *__pyx_fuse_0__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_3evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_c = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_xp = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_v_dx;
-  int __pyx_v_extrapolate;
-  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("evaluate (wrapper)", 0);
+  __Pyx_RefNannySetupContext("grad (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_c,&__pyx_n_s_x,&__pyx_n_s_xp,&__pyx_n_s_dx,&__pyx_n_s_extrapolate,&__pyx_n_s_out,&__pyx_n_s_indices,0};
-    PyObject* values[7] = {0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3501,361 +3121,316 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_c)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 1); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 1); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_xp)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 2); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 2); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 3); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 3); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_extrapolate)) != 0)) kw_args--;
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 4); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 4); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_out)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 5); __PYX_ERR(0, 29, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_indices)) != 0)) kw_args--;
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 6); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 5); __PYX_ERR(1, 11, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "evaluate") < 0)) __PYX_ERR(0, 29, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "grad") < 0)) __PYX_ERR(1, 11, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
     }
-    __pyx_v_c = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_c.memview)) __PYX_ERR(0, 29, __pyx_L3_error)
-    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(values[1], 0); if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 30, __pyx_L3_error)
-    __pyx_v_xp = __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(values[2], 0); if (unlikely(!__pyx_v_xp.memview)) __PYX_ERR(0, 31, __pyx_L3_error)
-    __pyx_v_dx = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_dx == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 32, __pyx_L3_error)
-    __pyx_v_extrapolate = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_extrapolate == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L3_error)
-    __pyx_v_out = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_out.memview)) __PYX_ERR(0, 34, __pyx_L3_error)
-    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_dc_int(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 35, __pyx_L3_error)
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 29, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 11, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.auxiliary.interpolate._ppoly.evaluate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_2evaluate(__pyx_self, __pyx_v_c, __pyx_v_x, __pyx_v_xp, __pyx_v_dx, __pyx_v_extrapolate, __pyx_v_out, __pyx_v_indices);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_2evaluate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_c, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_xp, int __pyx_v_dx, int __pyx_v_extrapolate, __Pyx_memviewslice __pyx_v_out, __Pyx_memviewslice __pyx_v_indices) {
-  int __pyx_v_ip;
-  int __pyx_v_jp;
-  int __pyx_v_interval;
-  int __pyx_v_stored_index;
-  double __pyx_v_xval;
-  int __pyx_v_i;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  size_t __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  int __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  int __pyx_t_5;
-  int __pyx_t_6;
-  struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending __pyx_t_7;
-  Py_ssize_t __pyx_t_8;
-  Py_ssize_t __pyx_t_9;
-  Py_ssize_t __pyx_t_10;
-  Py_ssize_t __pyx_t_11;
-  __Pyx_RefNannySetupContext("__pyx_fuse_0evaluate", 0);
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":64
- * 
- * 
- *     interval = 0             # <<<<<<<<<<<<<<
- *     cdef int i
- *     # Evaluate.
- */
-  __pyx_v_interval = 0;
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":67
- *     cdef int i
- *     # Evaluate.
- *     for ip in range(len(xp)):             # <<<<<<<<<<<<<<
- *         xval = xp[ip]
- * 
- */
-  __pyx_t_1 = __Pyx_MemoryView_Len(__pyx_v_xp); 
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_ip = __pyx_t_3;
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":68
- *     # Evaluate.
- *     for ip in range(len(xp)):
- *         xval = xp[ip]             # <<<<<<<<<<<<<<
- * 
- *         # Find correct interval
- */
-    __pyx_t_4 = __pyx_v_ip;
-    __pyx_v_xval = (*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_xp.data) + __pyx_t_4)) )));
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":71
- * 
- *         # Find correct interval
- *         stored_index = indices[ip]             # <<<<<<<<<<<<<<
- *         if stored_index >=0:
- *             i = stored_index
- */
-    __pyx_t_4 = __pyx_v_ip;
-    __pyx_v_stored_index = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_indices.data) + __pyx_t_4)) )));
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":72
- *         # Find correct interval
- *         stored_index = indices[ip]
- *         if stored_index >=0:             # <<<<<<<<<<<<<<
- *             i = stored_index
- *         else:
- */
-    __pyx_t_5 = ((__pyx_v_stored_index >= 0) != 0);
-    if (__pyx_t_5) {
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":73
- *         stored_index = indices[ip]
- *         if stored_index >=0:
- *             i = stored_index             # <<<<<<<<<<<<<<
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
- */
-      __pyx_v_i = __pyx_v_stored_index;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":72
- *         # Find correct interval
- *         stored_index = indices[ip]
- *         if stored_index >=0:             # <<<<<<<<<<<<<<
- *             i = stored_index
- *         else:
- */
-      goto __pyx_L5;
-    }
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("grad", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":75
- *             i = stored_index
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,             # <<<<<<<<<<<<<<
- *                                 extrapolate)
- *             indices[ip] = i
- */
-    /*else*/ {
-      __pyx_t_4 = 0;
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":76
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
- *                                 extrapolate)             # <<<<<<<<<<<<<<
- *             indices[ip] = i
- * 
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":13
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-      __pyx_t_7.__pyx_n = 2;
-      __pyx_t_7.prev_interval = __pyx_v_interval;
-      __pyx_t_7.extrapolate = __pyx_v_extrapolate;
-      __pyx_t_6 = __pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending((&(*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_x.data) + __pyx_t_4)) )))), (__pyx_v_x.shape[0]), __pyx_v_xval, &__pyx_t_7); 
-      __pyx_v_i = __pyx_t_6;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":77
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
- *                                 extrapolate)
- *             indices[ip] = i             # <<<<<<<<<<<<<<
- * 
- *         if i < 0:
- */
-      __pyx_t_4 = __pyx_v_ip;
-      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_indices.data) + __pyx_t_4)) )) = __pyx_v_i;
-    }
-    __pyx_L5:;
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":79
- *             indices[ip] = i
- * 
- *         if i < 0:             # <<<<<<<<<<<<<<
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- */
-    __pyx_t_5 = ((__pyx_v_i < 0) != 0);
-    if (__pyx_t_5) {
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":81
- *         if i < 0:
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):             # <<<<<<<<<<<<<<
- *                 out[ip, jp] = nan
- *             continue
- */
-      __pyx_t_8 = (__pyx_v_c.shape[2]);
-      __pyx_t_9 = __pyx_t_8;
-      for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_9; __pyx_t_6+=1) {
-        __pyx_v_jp = __pyx_t_6;
-
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":82
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- *                 out[ip, jp] = nan             # <<<<<<<<<<<<<<
- *             continue
- *         else:
- */
-        __pyx_t_4 = __pyx_v_ip;
-        __pyx_t_10 = __pyx_v_jp;
-        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_4 * __pyx_v_out.strides[0]) )) + __pyx_t_10)) )) = NPY_NAN;
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("hessian", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_hessian); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian)) {
+        __Pyx_XDECREF(__pyx_r);
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
       }
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":83
- *             for jp in range(c.shape[2]):
- *                 out[ip, jp] = nan
- *             continue             # <<<<<<<<<<<<<<
- *         else:
- *             interval = i
- */
-      goto __pyx_L3_continue;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":79
- *             indices[ip] = i
- * 
- *         if i < 0:             # <<<<<<<<<<<<<<
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- */
-    }
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":85
- *             continue
- *         else:
- *             interval = i             # <<<<<<<<<<<<<<
- * 
- *         # Evaluate the local polynomial(s)
- */
-    /*else*/ {
-      __pyx_v_interval = __pyx_v_i;
-    }
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":89
- *         # Evaluate the local polynomial(s)
- * 
- *         for jp in range(c.shape[2]):             # <<<<<<<<<<<<<<
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,
- *                                          jp, dx)
- */
-    __pyx_t_8 = (__pyx_v_c.shape[2]);
-    __pyx_t_9 = __pyx_t_8;
-    for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_9; __pyx_t_6+=1) {
-      __pyx_v_jp = __pyx_t_6;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":90
- * 
- *         for jp in range(c.shape[2]):
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,             # <<<<<<<<<<<<<<
- *                                          jp, dx)
- * 
- */
-      __pyx_t_10 = __pyx_v_interval;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":91
- *         for jp in range(c.shape[2]):
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,
- *                                          jp, dx)             # <<<<<<<<<<<<<<
- * 
- * 
- */
-      __pyx_t_4 = __pyx_v_ip;
-      __pyx_t_11 = __pyx_v_jp;
-      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_4 * __pyx_v_out.strides[0]) )) + __pyx_t_11)) )) = __pyx_fuse_0__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1((__pyx_v_xval - (*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_x.data) + __pyx_t_10)) )))), __pyx_v_c, __pyx_v_interval, __pyx_v_jp, __pyx_v_dx);
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
-    __pyx_L3_continue:;
+    #endif
   }
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":14
+ *         pass
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_c, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_xp, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_out, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_indices, 1);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":13
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ */
+
 /* Python wrapper */
-static PyObject *__pyx_fuse_1__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_5evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_fuse_1__pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_5evaluate = {"__pyx_fuse_1evaluate", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_fuse_1__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_5evaluate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate};
-static PyObject *__pyx_fuse_1__pyx_pw_8pyseobnr_9auxiliary_11interpolate_6_ppoly_5evaluate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_c = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_xp = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_v_dx;
-  int __pyx_v_extrapolate;
-  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("evaluate (wrapper)", 0);
+  __Pyx_RefNannySetupContext("hessian (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_c,&__pyx_n_s_x,&__pyx_n_s_xp,&__pyx_n_s_dx,&__pyx_n_s_extrapolate,&__pyx_n_s_out,&__pyx_n_s_indices,0};
-    PyObject* values[7] = {0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3866,1040 +3441,1606 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_c)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 1); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 1); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_xp)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 2); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 2); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 3); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 3); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_extrapolate)) != 0)) kw_args--;
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 4); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 4); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_out)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 5); __PYX_ERR(0, 29, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_indices)) != 0)) kw_args--;
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, 6); __PYX_ERR(0, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 5); __PYX_ERR(1, 13, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "evaluate") < 0)) __PYX_ERR(0, 29, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hessian") < 0)) __PYX_ERR(1, 13, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
     }
-    __pyx_v_c = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc___pyx_t_double_complex(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_c.memview)) __PYX_ERR(0, 29, __pyx_L3_error)
-    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(values[1], 0); if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 30, __pyx_L3_error)
-    __pyx_v_xp = __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(values[2], 0); if (unlikely(!__pyx_v_xp.memview)) __PYX_ERR(0, 31, __pyx_L3_error)
-    __pyx_v_dx = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_dx == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 32, __pyx_L3_error)
-    __pyx_v_extrapolate = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_extrapolate == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L3_error)
-    __pyx_v_out = __Pyx_PyObject_to_MemoryviewSlice_d_dc___pyx_t_double_complex(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_out.memview)) __PYX_ERR(0, 34, __pyx_L3_error)
-    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_dc_int(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 35, __pyx_L3_error)
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("evaluate", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 29, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 13, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.auxiliary.interpolate._ppoly.evaluate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_4evaluate(__pyx_self, __pyx_v_c, __pyx_v_x, __pyx_v_xp, __pyx_v_dx, __pyx_v_extrapolate, __pyx_v_out, __pyx_v_indices);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_9auxiliary_11interpolate_6_ppoly_4evaluate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_c, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_xp, int __pyx_v_dx, int __pyx_v_extrapolate, __Pyx_memviewslice __pyx_v_out, __Pyx_memviewslice __pyx_v_indices) {
-  int __pyx_v_ip;
-  int __pyx_v_jp;
-  int __pyx_v_interval;
-  int __pyx_v_stored_index;
-  double __pyx_v_xval;
-  int __pyx_v_i;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  size_t __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  int __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  int __pyx_t_5;
-  int __pyx_t_6;
-  struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending __pyx_t_7;
-  Py_ssize_t __pyx_t_8;
-  Py_ssize_t __pyx_t_9;
-  Py_ssize_t __pyx_t_10;
-  Py_ssize_t __pyx_t_11;
-  __Pyx_RefNannySetupContext("__pyx_fuse_1evaluate", 0);
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":64
- * 
- * 
- *     interval = 0             # <<<<<<<<<<<<<<
- *     cdef int i
- *     # Evaluate.
- */
-  __pyx_v_interval = 0;
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":67
- *     cdef int i
- *     # Evaluate.
- *     for ip in range(len(xp)):             # <<<<<<<<<<<<<<
- *         xval = xp[ip]
- * 
- */
-  __pyx_t_1 = __Pyx_MemoryView_Len(__pyx_v_xp); 
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_ip = __pyx_t_3;
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":68
- *     # Evaluate.
- *     for ip in range(len(xp)):
- *         xval = xp[ip]             # <<<<<<<<<<<<<<
- * 
- *         # Find correct interval
- */
-    __pyx_t_4 = __pyx_v_ip;
-    __pyx_v_xval = (*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_xp.data) + __pyx_t_4)) )));
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":71
- * 
- *         # Find correct interval
- *         stored_index = indices[ip]             # <<<<<<<<<<<<<<
- *         if stored_index >=0:
- *             i = stored_index
- */
-    __pyx_t_4 = __pyx_v_ip;
-    __pyx_v_stored_index = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_indices.data) + __pyx_t_4)) )));
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("hessian", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":72
- *         # Find correct interval
- *         stored_index = indices[ip]
- *         if stored_index >=0:             # <<<<<<<<<<<<<<
- *             i = stored_index
- *         else:
- */
-    __pyx_t_5 = ((__pyx_v_stored_index >= 0) != 0);
-    if (__pyx_t_5) {
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":73
- *         stored_index = indices[ip]
- *         if stored_index >=0:
- *             i = stored_index             # <<<<<<<<<<<<<<
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":15
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-      __pyx_v_i = __pyx_v_stored_index;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":72
- *         # Find correct interval
- *         stored_index = indices[ip]
- *         if stored_index >=0:             # <<<<<<<<<<<<<<
- *             i = stored_index
- *         else:
- */
-      goto __pyx_L5;
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  double __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  double __pyx_t_13;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("csi", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_csi); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi)) {
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_r = __pyx_t_13;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
+    #endif
+  }
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":75
- *             i = stored_index
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,             # <<<<<<<<<<<<<<
- *                                 extrapolate)
- *             indices[ip] = i
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":16
+ *         pass
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
  */
-    /*else*/ {
-      __pyx_t_4 = 0;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":76
- *         else:
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
- *                                 extrapolate)             # <<<<<<<<<<<<<<
- *             indices[ip] = i
- * 
- */
-      __pyx_t_7.__pyx_n = 2;
-      __pyx_t_7.prev_interval = __pyx_v_interval;
-      __pyx_t_7.extrapolate = __pyx_v_extrapolate;
-      __pyx_t_6 = __pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending((&(*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_x.data) + __pyx_t_4)) )))), (__pyx_v_x.shape[0]), __pyx_v_xval, &__pyx_t_7); 
-      __pyx_v_i = __pyx_t_6;
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":77
- *             i = find_interval_ascending(&x[0], x.shape[0], xval, interval,
- *                                 extrapolate)
- *             indices[ip] = i             # <<<<<<<<<<<<<<
- * 
- *         if i < 0:
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":15
+ *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-      __pyx_t_4 = __pyx_v_ip;
-      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_indices.data) + __pyx_t_4)) )) = __pyx_v_i;
-    }
-    __pyx_L5:;
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":79
- *             indices[ip] = i
- * 
- *         if i < 0:             # <<<<<<<<<<<<<<
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- */
-    __pyx_t_5 = ((__pyx_v_i < 0) != 0);
-    if (__pyx_t_5) {
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":81
- *         if i < 0:
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):             # <<<<<<<<<<<<<<
- *                 out[ip, jp] = nan
- *             continue
- */
-      __pyx_t_8 = (__pyx_v_c.shape[2]);
-      __pyx_t_9 = __pyx_t_8;
-      for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_9; __pyx_t_6+=1) {
-        __pyx_v_jp = __pyx_t_6;
-
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":82
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- *                 out[ip, jp] = nan             # <<<<<<<<<<<<<<
- *             continue
- *         else:
- */
-        __pyx_t_4 = __pyx_v_ip;
-        __pyx_t_10 = __pyx_v_jp;
-        *((__pyx_t_double_complex *) ( /* dim=1 */ ((char *) (((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_4 * __pyx_v_out.strides[0]) )) + __pyx_t_10)) )) = __pyx_t_double_complex_from_parts(NPY_NAN, 0);
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("csi (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
       }
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":83
- *             for jp in range(c.shape[2]):
- *                 out[ip, jp] = nan
- *             continue             # <<<<<<<<<<<<<<
- *         else:
- *             interval = i
- */
-      goto __pyx_L3_continue;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":79
- *             indices[ip] = i
- * 
- *         if i < 0:             # <<<<<<<<<<<<<<
- *             # xval was nan etc
- *             for jp in range(c.shape[2]):
- */
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 1); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 2); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 3); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 4); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 5); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "csi") < 0)) __PYX_ERR(1, 15, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 15, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":85
- *             continue
- *         else:
- *             interval = i             # <<<<<<<<<<<<<<
- * 
- *         # Evaluate the local polynomial(s)
- */
-    /*else*/ {
-      __pyx_v_interval = __pyx_v_i;
-    }
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":89
- *         # Evaluate the local polynomial(s)
- * 
- *         for jp in range(c.shape[2]):             # <<<<<<<<<<<<<<
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,
- *                                          jp, dx)
- */
-    __pyx_t_8 = (__pyx_v_c.shape[2]);
-    __pyx_t_9 = __pyx_t_8;
-    for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_9; __pyx_t_6+=1) {
-      __pyx_v_jp = __pyx_t_6;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("csi", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":90
- * 
- *         for jp in range(c.shape[2]):
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,             # <<<<<<<<<<<<<<
- *                                          jp, dx)
- * 
- */
-      __pyx_t_10 = __pyx_v_interval;
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":91
- *         for jp in range(c.shape[2]):
- *             out[ip, jp] = evaluate_poly1(xval - x[interval], c, interval,
- *                                          jp, dx)             # <<<<<<<<<<<<<<
- * 
- * 
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":17
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-      __pyx_t_4 = __pyx_v_ip;
-      __pyx_t_11 = __pyx_v_jp;
-      *((__pyx_t_double_complex *) ( /* dim=1 */ ((char *) (((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_4 * __pyx_v_out.strides[0]) )) + __pyx_t_11)) )) = __pyx_fuse_1__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1((__pyx_v_xval - (*((double const  *) ( /* dim=0 */ ((char *) (((double const  *) __pyx_v_x.data) + __pyx_t_10)) )))), __pyx_v_c, __pyx_v_interval, __pyx_v_jp, __pyx_v_dx);
+
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("dynamics", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_dynamics); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics)) {
+        __Pyx_XDECREF(__pyx_r);
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
-    __pyx_L3_continue:;
+    #endif
   }
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":18
+ *         pass
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_c, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_xp, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_out, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_indices, 1);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":102
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * cdef int find_interval_ascending(const double *x,             # <<<<<<<<<<<<<<
- *                                  size_t nx,
- *                                  double xval,
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":17
+ *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
 
-static int __pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending(double const *__pyx_v_x, size_t __pyx_v_nx, double __pyx_v_xval, struct __pyx_opt_args_8pyseobnr_9auxiliary_11interpolate_6_ppoly_find_interval_ascending *__pyx_optional_args) {
-  int __pyx_v_prev_interval = ((int)0);
-  int __pyx_v_extrapolate = ((int)1);
-  int __pyx_v_interval;
-  int __pyx_v_high;
-  int __pyx_v_low;
-  int __pyx_v_mid;
-  double __pyx_v_a;
-  double __pyx_v_b;
-  int __pyx_r;
-  int __pyx_t_1;
-  int __pyx_t_2;
-  if (__pyx_optional_args) {
-    if (__pyx_optional_args->__pyx_n > 0) {
-      __pyx_v_prev_interval = __pyx_optional_args->prev_interval;
-      if (__pyx_optional_args->__pyx_n > 1) {
-        __pyx_v_extrapolate = __pyx_optional_args->extrapolate;
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("dynamics (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 1); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 2); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 3); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 4); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 5); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dynamics") < 0)) __PYX_ERR(1, 17, __pyx_L3_error)
       }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
   }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 17, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":130
- *     cdef double a, b
- * 
- *     a = x[0]             # <<<<<<<<<<<<<<
- *     b = x[nx-1]
- * 
- */
-  __pyx_v_a = (__pyx_v_x[0]);
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":131
- * 
- *     a = x[0]
- *     b = x[nx-1]             # <<<<<<<<<<<<<<
- * 
- *     interval = prev_interval
- */
-  __pyx_v_b = (__pyx_v_x[(__pyx_v_nx - 1)]);
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":133
- *     b = x[nx-1]
- * 
- *     interval = prev_interval             # <<<<<<<<<<<<<<
- *     if interval < 0 or interval >= nx:
- *         interval = 0
- */
-  __pyx_v_interval = __pyx_v_prev_interval;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("dynamics", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":134
- * 
- *     interval = prev_interval
- *     if interval < 0 or interval >= nx:             # <<<<<<<<<<<<<<
- *         interval = 0
- * 
- */
-  __pyx_t_2 = ((__pyx_v_interval < 0) != 0);
-  if (!__pyx_t_2) {
-  } else {
-    __pyx_t_1 = __pyx_t_2;
-    goto __pyx_L4_bool_binop_done;
-  }
-  __pyx_t_2 = ((__pyx_v_interval >= __pyx_v_nx) != 0);
-  __pyx_t_1 = __pyx_t_2;
-  __pyx_L4_bool_binop_done:;
-  if (__pyx_t_1) {
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":135
- *     interval = prev_interval
- *     if interval < 0 or interval >= nx:
- *         interval = 0             # <<<<<<<<<<<<<<
- * 
- *     if not (a <= xval <= b):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":19
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-    __pyx_v_interval = 0;
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":134
- * 
- *     interval = prev_interval
- *     if interval < 0 or interval >= nx:             # <<<<<<<<<<<<<<
- *         interval = 0
- * 
- */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  double __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  double __pyx_t_13;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("omega", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega)) {
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_r = __pyx_t_13;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
   }
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":137
- *         interval = 0
- * 
- *     if not (a <= xval <= b):             # <<<<<<<<<<<<<<
- *         # Out-of-bounds (or nan)
- *         if xval < a and extrapolate:
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":20
+ *         pass
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
  */
-  __pyx_t_1 = (__pyx_v_a <= __pyx_v_xval);
-  if (__pyx_t_1) {
-    __pyx_t_1 = (__pyx_v_xval <= __pyx_v_b);
-  }
-  __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
-  if (__pyx_t_2) {
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":139
- *     if not (a <= xval <= b):
- *         # Out-of-bounds (or nan)
- *         if xval < a and extrapolate:             # <<<<<<<<<<<<<<
- *             # below
- *             interval = 0
- */
-    __pyx_t_1 = ((__pyx_v_xval < __pyx_v_a) != 0);
-    if (__pyx_t_1) {
-    } else {
-      __pyx_t_2 = __pyx_t_1;
-      goto __pyx_L8_bool_binop_done;
-    }
-    __pyx_t_1 = (__pyx_v_extrapolate != 0);
-    __pyx_t_2 = __pyx_t_1;
-    __pyx_L8_bool_binop_done:;
-    if (__pyx_t_2) {
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":141
- *         if xval < a and extrapolate:
- *             # below
- *             interval = 0             # <<<<<<<<<<<<<<
- *         elif xval > b and extrapolate:
- *             # above
- */
-      __pyx_v_interval = 0;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":139
- *     if not (a <= xval <= b):
- *         # Out-of-bounds (or nan)
- *         if xval < a and extrapolate:             # <<<<<<<<<<<<<<
- *             # below
- *             interval = 0
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":19
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
  */
-      goto __pyx_L7;
-    }
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":142
- *             # below
- *             interval = 0
- *         elif xval > b and extrapolate:             # <<<<<<<<<<<<<<
- *             # above
- *             interval = nx - 2
- */
-    __pyx_t_1 = ((__pyx_v_xval > __pyx_v_b) != 0);
-    if (__pyx_t_1) {
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("omega (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 1); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 2); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 3); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 4); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 5); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "omega") < 0)) __PYX_ERR(1, 19, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+      goto __pyx_L5_argtuple_error;
     } else {
-      __pyx_t_2 = __pyx_t_1;
-      goto __pyx_L10_bool_binop_done;
-    }
-    __pyx_t_1 = (__pyx_v_extrapolate != 0);
-    __pyx_t_2 = __pyx_t_1;
-    __pyx_L10_bool_binop_done:;
-    if (__pyx_t_2) {
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":144
- *         elif xval > b and extrapolate:
- *             # above
- *             interval = nx - 2             # <<<<<<<<<<<<<<
- *         else:
- *             # nan or no extrapolation
- */
-      __pyx_v_interval = (__pyx_v_nx - 2);
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":142
- *             # below
- *             interval = 0
- *         elif xval > b and extrapolate:             # <<<<<<<<<<<<<<
- *             # above
- *             interval = nx - 2
- */
-      goto __pyx_L7;
-    }
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":147
- *         else:
- *             # nan or no extrapolation
- *             interval = -1             # <<<<<<<<<<<<<<
- *     elif xval == b:
- *         # Make the interval closed from the right
- */
-    /*else*/ {
-      __pyx_v_interval = -1;
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
-    __pyx_L7:;
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":137
- *         interval = 0
- * 
- *     if not (a <= xval <= b):             # <<<<<<<<<<<<<<
- *         # Out-of-bounds (or nan)
- *         if xval < a and extrapolate:
- */
-    goto __pyx_L6;
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
   }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 19, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":148
- *             # nan or no extrapolation
- *             interval = -1
- *     elif xval == b:             # <<<<<<<<<<<<<<
- *         # Make the interval closed from the right
- *         interval = nx - 2
- */
-  __pyx_t_2 = ((__pyx_v_xval == __pyx_v_b) != 0);
-  if (__pyx_t_2) {
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":150
- *     elif xval == b:
- *         # Make the interval closed from the right
- *         interval = nx - 2             # <<<<<<<<<<<<<<
- *     else:
- *         # Find the interval the coordinate is in
- */
-    __pyx_v_interval = (__pyx_v_nx - 2);
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":148
- *             # nan or no extrapolation
- *             interval = -1
- *     elif xval == b:             # <<<<<<<<<<<<<<
- *         # Make the interval closed from the right
- *         interval = nx - 2
- */
-    goto __pyx_L6;
-  }
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":154
- *         # Find the interval the coordinate is in
- *         # (binary search with locality)
- *         if xval >= x[interval]:             # <<<<<<<<<<<<<<
- *             low = interval
- *             high = nx - 2
- */
-  /*else*/ {
-    __pyx_t_2 = ((__pyx_v_xval >= (__pyx_v_x[__pyx_v_interval])) != 0);
-    if (__pyx_t_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("omega", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":155
- *         # (binary search with locality)
- *         if xval >= x[interval]:
- *             low = interval             # <<<<<<<<<<<<<<
- *             high = nx - 2
- *         else:
- */
-      __pyx_v_low = __pyx_v_interval;
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":156
- *         if xval >= x[interval]:
- *             low = interval
- *             high = nx - 2             # <<<<<<<<<<<<<<
- *         else:
- *             low = 0
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":21
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
  */
-      __pyx_v_high = (__pyx_v_nx - 2);
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":154
- *         # Find the interval the coordinate is in
- *         # (binary search with locality)
- *         if xval >= x[interval]:             # <<<<<<<<<<<<<<
- *             low = interval
- *             high = nx - 2
- */
-      goto __pyx_L12;
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("auxderivs", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_auxderivs); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs)) {
+        __Pyx_XDECREF(__pyx_r);
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
+        __pyx_t_11 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
+          if (likely(__pyx_t_10)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_9, function);
+            __pyx_t_11 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          if (__pyx_t_10) {
+            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          __Pyx_GIVEREF(__pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          __Pyx_GIVEREF(__pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_5 = 0;
+          __pyx_t_6 = 0;
+          __pyx_t_7 = 0;
+          __pyx_t_8 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
+    #endif
+  }
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":158
- *             high = nx - 2
- *         else:
- *             low = 0             # <<<<<<<<<<<<<<
- *             high = interval
- * 
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":22
+ *         pass
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass             # <<<<<<<<<<<<<<
  */
-    /*else*/ {
-      __pyx_v_low = 0;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":159
- *         else:
- *             low = 0
- *             high = interval             # <<<<<<<<<<<<<<
- * 
- *         if xval < x[low+1]:
- */
-      __pyx_v_high = __pyx_v_interval;
-    }
-    __pyx_L12:;
-
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":161
- *             high = interval
- * 
- *         if xval < x[low+1]:             # <<<<<<<<<<<<<<
- *             high = low
- * 
- */
-    __pyx_t_2 = ((__pyx_v_xval < (__pyx_v_x[(__pyx_v_low + 1)])) != 0);
-    if (__pyx_t_2) {
+  /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":162
- * 
- *         if xval < x[low+1]:
- *             high = low             # <<<<<<<<<<<<<<
- * 
- *         while low < high:
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":21
+ *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *         pass
+ *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *         pass
  */
-      __pyx_v_high = __pyx_v_low;
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":161
- *             high = interval
- * 
- *         if xval < x[low+1]:             # <<<<<<<<<<<<<<
- *             high = low
- * 
- */
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_m_1;
+  double __pyx_v_m_2;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("auxderivs (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 1); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 2); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 3); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 4); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 5); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "auxderivs") < 0)) __PYX_ERR(1, 21, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 21, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":164
- *             high = low
- * 
- *         while low < high:             # <<<<<<<<<<<<<<
- *             mid = (high + low)//2
- *             if xval < x[mid]:
- */
-    while (1) {
-      __pyx_t_2 = ((__pyx_v_low < __pyx_v_high) != 0);
-      if (!__pyx_t_2) break;
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":165
- * 
- *         while low < high:
- *             mid = (high + low)//2             # <<<<<<<<<<<<<<
- *             if xval < x[mid]:
- *                 # mid < high
- */
-      __pyx_v_mid = ((__pyx_v_high + __pyx_v_low) / 2);
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":166
- *         while low < high:
- *             mid = (high + low)//2
- *             if xval < x[mid]:             # <<<<<<<<<<<<<<
- *                 # mid < high
- *                 high = mid
- */
-      __pyx_t_2 = ((__pyx_v_xval < (__pyx_v_x[__pyx_v_mid])) != 0);
-      if (__pyx_t_2) {
-
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":168
- *             if xval < x[mid]:
- *                 # mid < high
- *                 high = mid             # <<<<<<<<<<<<<<
- *             elif xval >= x[mid + 1]:
- *                 low = mid + 1
- */
-        __pyx_v_high = __pyx_v_mid;
-
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":166
- *         while low < high:
- *             mid = (high + low)//2
- *             if xval < x[mid]:             # <<<<<<<<<<<<<<
- *                 # mid < high
- *                 high = mid
- */
-        goto __pyx_L16;
-      }
-
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":169
- *                 # mid < high
- *                 high = mid
- *             elif xval >= x[mid + 1]:             # <<<<<<<<<<<<<<
- *                 low = mid + 1
- *             else:
- */
-      __pyx_t_2 = ((__pyx_v_xval >= (__pyx_v_x[(__pyx_v_mid + 1)])) != 0);
-      if (__pyx_t_2) {
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":170
- *                 high = mid
- *             elif xval >= x[mid + 1]:
- *                 low = mid + 1             # <<<<<<<<<<<<<<
- *             else:
- *                 # x[mid] <= xval < x[mid+1]
- */
-        __pyx_v_low = (__pyx_v_mid + 1);
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("auxderivs", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":169
- *                 # mid < high
- *                 high = mid
- *             elif xval >= x[mid + 1]:             # <<<<<<<<<<<<<<
- *                 low = mid + 1
- *             else:
- */
-        goto __pyx_L16;
-      }
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":173
- *             else:
- *                 # x[mid] <= xval < x[mid+1]
- *                 low = mid             # <<<<<<<<<<<<<<
- *                 break
- * 
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd":4
+ * from pyseobnr.eob.utils.containers cimport EOBParams
+ * cdef class Hamiltonian_C:
+ *     cdef public EOBParams EOBpars             # <<<<<<<<<<<<<<
+ *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
+ *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
  */
-      /*else*/ {
-        __pyx_v_low = __pyx_v_mid;
 
-        /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":174
- *                 # x[mid] <= xval < x[mid+1]
- *                 low = mid
- *                 break             # <<<<<<<<<<<<<<
- * 
- *         interval = low
- */
-        goto __pyx_L15_break;
-      }
-      __pyx_L16:;
-    }
-    __pyx_L15_break:;
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":176
- *                 break
- * 
- *         interval = low             # <<<<<<<<<<<<<<
- * 
- *     return interval
- */
-    __pyx_v_interval = __pyx_v_low;
-  }
-  __pyx_L6:;
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":178
- *         interval = low
- * 
- *     return interval             # <<<<<<<<<<<<<<
- * 
- * 
- */
-  __pyx_r = __pyx_v_interval;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->EOBpars));
+  __pyx_r = ((PyObject *)__pyx_v_self->EOBpars);
   goto __pyx_L0;
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":102
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * cdef int find_interval_ascending(const double *x,             # <<<<<<<<<<<<<<
- *                                  size_t nx,
- *                                  double xval,
- */
-
   /* function exit code */
   __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":185
- * @cython.cdivision(True)
- * @cython.profile(True)
- * cdef double_or_complex evaluate_poly1(double s, double_or_complex[:,:,::1] c, int ci, int cj, int dx) nogil:             # <<<<<<<<<<<<<<
- *     """
- *     Evaluate polynomial, derivative, or antiderivative in a single interval.
- */
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), ((PyObject *)__pyx_v_value));
 
-static double __pyx_fuse_0__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1(double __pyx_v_s, __Pyx_memviewslice __pyx_v_c, int __pyx_v_ci, int __pyx_v_cj, int __pyx_v_dx) {
-  int __pyx_v_kp;
-  double __pyx_v_res;
-  double __pyx_v_z;
-  double __pyx_r;
-  __Pyx_TraceDeclarations
-  Py_ssize_t __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  int __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  Py_ssize_t __pyx_t_6;
-  int __pyx_t_7;
-  int __pyx_t_8;
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("__pyx_fuse_0evaluate_poly1", __pyx_f[0], 185, 1, __PYX_ERR(0, 185, __pyx_L1_error));
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":203
- *     cdef double_or_complex res, z
- * 
- *     res = 0.0             # <<<<<<<<<<<<<<
- *     z = 1.0
- * 
- */
-  __pyx_v_res = 0.0;
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":204
- * 
- *     res = 0.0
- *     z = 1.0             # <<<<<<<<<<<<<<
- * 
- * 
- */
-  __pyx_v_z = 1.0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams))))) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->EOBpars);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
+  __pyx_v_self->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_t_1);
+  __pyx_t_1 = 0;
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":207
- * 
- * 
- *     for kp in range(c.shape[0]):             # <<<<<<<<<<<<<<
- * 
- *         res = res + c[c.shape[0] - kp - 1, ci, cj] * z
- */
-  __pyx_t_1 = (__pyx_v_c.shape[0]);
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_kp = __pyx_t_3;
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.EOBpars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":209
- *     for kp in range(c.shape[0]):
- * 
- *         res = res + c[c.shape[0] - kp - 1, ci, cj] * z             # <<<<<<<<<<<<<<
- * 
- *         # compute x**max(k-dx,0)
- */
-    __pyx_t_4 = (((__pyx_v_c.shape[0]) - __pyx_v_kp) - 1);
-    __pyx_t_5 = __pyx_v_ci;
-    __pyx_t_6 = __pyx_v_cj;
-    __pyx_v_res = (__pyx_v_res + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_c.data + __pyx_t_4 * __pyx_v_c.strides[0]) ) + __pyx_t_5 * __pyx_v_c.strides[1]) )) + __pyx_t_6)) ))) * __pyx_v_z));
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":212
- * 
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:             # <<<<<<<<<<<<<<
- *             z *= s
- * 
- */
-    __pyx_t_8 = ((__pyx_v_kp < ((__pyx_v_c.shape[0]) - 1)) != 0);
-    if (__pyx_t_8) {
-    } else {
-      __pyx_t_7 = __pyx_t_8;
-      goto __pyx_L6_bool_binop_done;
-    }
-    __pyx_t_8 = ((__pyx_v_kp >= __pyx_v_dx) != 0);
-    __pyx_t_7 = __pyx_t_8;
-    __pyx_L6_bool_binop_done:;
-    if (__pyx_t_7) {
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":213
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:
- *             z *= s             # <<<<<<<<<<<<<<
- * 
- *     return res
- */
-      __pyx_v_z = (__pyx_v_z * __pyx_v_s);
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->EOBpars);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
+  __pyx_v_self->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None);
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":212
- * 
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:             # <<<<<<<<<<<<<<
- *             z *= s
- * 
- */
-    }
-  }
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":215
- *             z *= s
- * 
- *     return res             # <<<<<<<<<<<<<<
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
  */
-  __pyx_r = __pyx_v_res;
-  goto __pyx_L0;
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":185
- * @cython.cdivision(True)
- * @cython.profile(True)
- * cdef double_or_complex evaluate_poly1(double s, double_or_complex[:,:,::1] c, int ci, int cj, int dx) nogil:             # <<<<<<<<<<<<<<
- *     """
- *     Evaluate polynomial, derivative, or antiderivative in a single interval.
- */
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
 
   /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_WriteUnraisable("pyseobnr.auxiliary.interpolate._ppoly.evaluate_poly1", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
-  __pyx_r = 0;
-  __pyx_L0:;
-  __Pyx_TraceReturn(Py_None, 1);
+  __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static __pyx_t_double_complex __pyx_fuse_1__pyx_f_8pyseobnr_9auxiliary_11interpolate_6_ppoly_evaluate_poly1(double __pyx_v_s, __Pyx_memviewslice __pyx_v_c, int __pyx_v_ci, int __pyx_v_cj, int __pyx_v_dx) {
-  int __pyx_v_kp;
-  __pyx_t_double_complex __pyx_v_res;
-  __pyx_t_double_complex __pyx_v_z;
-  __pyx_t_double_complex __pyx_r;
-  __Pyx_TraceDeclarations
-  Py_ssize_t __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  int __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  Py_ssize_t __pyx_t_6;
-  int __pyx_t_7;
-  int __pyx_t_8;
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("__pyx_fuse_1evaluate_poly1", __pyx_f[0], 185, 1, __PYX_ERR(0, 185, __pyx_L1_error));
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":203
- *     cdef double_or_complex res, z
- * 
- *     res = 0.0             # <<<<<<<<<<<<<<
- *     z = 1.0
- * 
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_v_res = __pyx_t_double_complex_from_parts(0.0, 0);
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 2, __pyx_L1_error)
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":204
- * 
- *     res = 0.0
- *     z = 1.0             # <<<<<<<<<<<<<<
- * 
- * 
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
  */
-  __pyx_v_z = __pyx_t_double_complex_from_parts(1.0, 0);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":207
- * 
- * 
- *     for kp in range(c.shape[0]):             # <<<<<<<<<<<<<<
- * 
- *         res = res + c[c.shape[0] - kp - 1, ci, cj] * z
- */
-  __pyx_t_1 = (__pyx_v_c.shape[0]);
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_kp = __pyx_t_3;
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":209
- *     for kp in range(c.shape[0]):
- * 
- *         res = res + c[c.shape[0] - kp - 1, ci, cj] * z             # <<<<<<<<<<<<<<
- * 
- *         # compute x**max(k-dx,0)
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-    __pyx_t_4 = (((__pyx_v_c.shape[0]) - __pyx_v_kp) - 1);
-    __pyx_t_5 = __pyx_v_ci;
-    __pyx_t_6 = __pyx_v_cj;
-    __pyx_v_res = __Pyx_c_sum_double(__pyx_v_res, __Pyx_c_prod_double((*((__pyx_t_double_complex *) ( /* dim=2 */ ((char *) (((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_c.data + __pyx_t_4 * __pyx_v_c.strides[0]) ) + __pyx_t_5 * __pyx_v_c.strides[1]) )) + __pyx_t_6)) ))), __pyx_v_z));
 
-    /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":212
- * 
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:             # <<<<<<<<<<<<<<
- *             z *= s
- * 
- */
-    __pyx_t_8 = ((__pyx_v_kp < ((__pyx_v_c.shape[0]) - 1)) != 0);
-    if (__pyx_t_8) {
-    } else {
-      __pyx_t_7 = __pyx_t_8;
-      goto __pyx_L6_bool_binop_done;
-    }
-    __pyx_t_8 = ((__pyx_v_kp >= __pyx_v_dx) != 0);
-    __pyx_t_7 = __pyx_t_8;
-    __pyx_L6_bool_binop_done:;
-    if (__pyx_t_7) {
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":213
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:
- *             z *= s             # <<<<<<<<<<<<<<
- * 
- *     return res
- */
-      __pyx_v_z = __Pyx_c_prod_double(__pyx_v_z, __pyx_t_double_complex_from_parts(__pyx_v_s, 0));
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-      /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":212
- * 
- *         # compute x**max(k-dx,0)
- *         if kp < c.shape[0] - 1 and kp >= dx:             # <<<<<<<<<<<<<<
- *             z *= s
- * 
- */
-    }
-  }
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":215
- *             z *= s
- * 
- *     return res             # <<<<<<<<<<<<<<
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_r = __pyx_v_res;
-  goto __pyx_L0;
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 4, __pyx_L1_error)
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":185
- * @cython.cdivision(True)
- * @cython.profile(True)
- * cdef double_or_complex evaluate_poly1(double s, double_or_complex[:,:,::1] c, int ci, int cj, int dx) nogil:             # <<<<<<<<<<<<<<
- *     """
- *     Evaluate polynomial, derivative, or antiderivative in a single interval.
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_WriteUnraisable("pyseobnr.auxiliary.interpolate._ppoly.evaluate_poly1", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
-  __pyx_r = __pyx_t_double_complex_from_parts(0, 0);
-  __pyx_L0:;
-  __Pyx_TraceReturn(Py_None, 1);
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
@@ -4947,21 +5088,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_itemsize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 1); __PYX_ERR(1, 123, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 1); __PYX_ERR(0, 123, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_format)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 2); __PYX_ERR(1, 123, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, 2); __PYX_ERR(0, 123, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mode);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -4969,15 +5110,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allocate_buffer);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 123, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 123, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -4985,42 +5126,42 @@
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_shape = ((PyObject*)values[0]);
-    __pyx_v_itemsize = __Pyx_PyIndex_AsSsize_t(values[1]); if (unlikely((__pyx_v_itemsize == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 123, __pyx_L3_error)
+    __pyx_v_itemsize = __Pyx_PyIndex_AsSsize_t(values[1]); if (unlikely((__pyx_v_itemsize == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 123, __pyx_L3_error)
     __pyx_v_format = values[2];
     __pyx_v_mode = values[3];
     if (values[4]) {
-      __pyx_v_allocate_buffer = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_allocate_buffer == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 124, __pyx_L3_error)
+      __pyx_v_allocate_buffer = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_allocate_buffer == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 124, __pyx_L3_error)
     } else {
 
       /* "View.MemoryView":124
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,
  *                   mode="c", bint allocate_buffer=True):             # <<<<<<<<<<<<<<
  * 
  *         cdef int idx
  */
       __pyx_v_allocate_buffer = ((int)1);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 123, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 123, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.array.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shape), (&PyTuple_Type), 1, "shape", 1))) __PYX_ERR(1, 123, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_shape), (&PyTuple_Type), 1, "shape", 1))) __PYX_ERR(0, 123, __pyx_L1_error)
   if (unlikely(((PyObject *)__pyx_v_format) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "format"); __PYX_ERR(1, 123, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "format"); __PYX_ERR(0, 123, __pyx_L1_error)
   }
   __pyx_r = __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(((struct __pyx_array_obj *)__pyx_v_self), __pyx_v_shape, __pyx_v_itemsize, __pyx_v_format, __pyx_v_mode, __pyx_v_allocate_buffer);
 
   /* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
@@ -5067,17 +5208,17 @@
  * 
  *         self.ndim = <int> len(shape)             # <<<<<<<<<<<<<<
  *         self.itemsize = itemsize
  * 
  */
   if (unlikely(__pyx_v_shape == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(1, 130, __pyx_L1_error)
+    __PYX_ERR(0, 130, __pyx_L1_error)
   }
-  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_shape); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(1, 130, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_shape); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 130, __pyx_L1_error)
   __pyx_v_self->ndim = ((int)__pyx_t_1);
 
   /* "View.MemoryView":131
  * 
  *         self.ndim = <int> len(shape)
  *         self.itemsize = itemsize             # <<<<<<<<<<<<<<
  * 
@@ -5098,19 +5239,19 @@
     /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 134, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 134, __pyx_L1_error)
+    __PYX_ERR(0, 134, __pyx_L1_error)
 
     /* "View.MemoryView":133
  *         self.itemsize = itemsize
  * 
  *         if not self.ndim:             # <<<<<<<<<<<<<<
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
@@ -5130,19 +5271,19 @@
     /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 137, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 137, __pyx_L1_error)
+    __PYX_ERR(0, 137, __pyx_L1_error)
 
     /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
  * 
  *         if itemsize <= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("itemsize <= 0 for cython.array")
  * 
@@ -5163,29 +5304,29 @@
     /* "View.MemoryView":140
  * 
  *         if not isinstance(format, bytes):
  *             format = format.encode('ASCII')             # <<<<<<<<<<<<<<
  *         self._format = format  # keep a reference to the byte string
  *         self.format = self._format
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_format, __pyx_n_s_encode); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 140, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_format, __pyx_n_s_encode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_n_s_ASCII) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_n_s_ASCII);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 140, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_format, __pyx_t_3);
     __pyx_t_3 = 0;
 
     /* "View.MemoryView":139
  *             raise ValueError("itemsize <= 0 for cython.array")
@@ -5199,15 +5340,15 @@
   /* "View.MemoryView":141
  *         if not isinstance(format, bytes):
  *             format = format.encode('ASCII')
  *         self._format = format  # keep a reference to the byte string             # <<<<<<<<<<<<<<
  *         self.format = self._format
  * 
  */
-  if (!(likely(PyBytes_CheckExact(__pyx_v_format))||((__pyx_v_format) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_format)->tp_name), 0))) __PYX_ERR(1, 141, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_v_format))||((__pyx_v_format) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_v_format)->tp_name), 0))) __PYX_ERR(0, 141, __pyx_L1_error)
   __pyx_t_3 = __pyx_v_format;
   __Pyx_INCREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->_format);
   __Pyx_DECREF(__pyx_v_self->_format);
   __pyx_v_self->_format = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
@@ -5217,17 +5358,17 @@
  *         self._format = format  # keep a reference to the byte string
  *         self.format = self._format             # <<<<<<<<<<<<<<
  * 
  * 
  */
   if (unlikely(__pyx_v_self->_format == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(1, 142, __pyx_L1_error)
+    __PYX_ERR(0, 142, __pyx_L1_error)
   }
-  __pyx_t_7 = __Pyx_PyBytes_AsWritableString(__pyx_v_self->_format); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(1, 142, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyBytes_AsWritableString(__pyx_v_self->_format); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(0, 142, __pyx_L1_error)
   __pyx_v_self->format = __pyx_t_7;
 
   /* "View.MemoryView":145
  * 
  * 
  *         self._shape = <Py_ssize_t *> PyObject_Malloc(sizeof(Py_ssize_t)*self.ndim*2)             # <<<<<<<<<<<<<<
  *         self._strides = self._shape + self.ndim
@@ -5257,19 +5398,19 @@
     /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 149, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 149, __pyx_L1_error)
+    __PYX_ERR(0, 149, __pyx_L1_error)
 
     /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
  * 
  *         if not self._shape:             # <<<<<<<<<<<<<<
  *             raise MemoryError("unable to allocate shape and strides.")
  * 
@@ -5284,20 +5425,20 @@
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  */
   __pyx_t_8 = 0;
   __pyx_t_3 = __pyx_v_shape; __Pyx_INCREF(__pyx_t_3); __pyx_t_1 = 0;
   for (;;) {
     if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(1, 152, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 152, __pyx_L1_error)
     #else
-    __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 152, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 152, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_dim = __pyx_t_9;
     __pyx_v_idx = __pyx_t_8;
     __pyx_t_8 = (__pyx_t_8 + 1);
 
     /* "View.MemoryView":153
  * 
@@ -5312,35 +5453,35 @@
       /* "View.MemoryView":154
  *         for idx, dim in enumerate(shape):
  *             if dim <= 0:
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))             # <<<<<<<<<<<<<<
  *             self._shape[idx] = dim
  * 
  */
-      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 154, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 154, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 154, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_6);
       __pyx_t_5 = 0;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 154, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 154, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 154, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __PYX_ERR(1, 154, __pyx_L1_error)
+      __PYX_ERR(0, 154, __pyx_L1_error)
 
       /* "View.MemoryView":153
  * 
  *         for idx, dim in enumerate(shape):
  *             if dim <= 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError("Invalid shape in axis %d: %d." % (idx, dim))
  *             self._shape[idx] = dim
@@ -5369,15 +5510,15 @@
   /* "View.MemoryView":158
  * 
  *         cdef char order
  *         if mode == 'fortran':             # <<<<<<<<<<<<<<
  *             order = b'F'
  *             self.mode = u'fortran'
  */
-  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_fortran, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 158, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_fortran, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 158, __pyx_L1_error)
   if (__pyx_t_4) {
 
     /* "View.MemoryView":159
  *         cdef char order
  *         if mode == 'fortran':
  *             order = b'F'             # <<<<<<<<<<<<<<
  *             self.mode = u'fortran'
@@ -5411,15 +5552,15 @@
   /* "View.MemoryView":161
  *             order = b'F'
  *             self.mode = u'fortran'
  *         elif mode == 'c':             # <<<<<<<<<<<<<<
  *             order = b'C'
  *             self.mode = u'c'
  */
-  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_c, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(1, 161, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyString_Equals(__pyx_v_mode, __pyx_n_s_c, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 161, __pyx_L1_error)
   if (likely(__pyx_t_4)) {
 
     /* "View.MemoryView":162
  *             self.mode = u'fortran'
  *         elif mode == 'c':
  *             order = b'C'             # <<<<<<<<<<<<<<
  *             self.mode = u'c'
@@ -5454,22 +5595,22 @@
  *             self.mode = u'c'
  *         else:
  *             raise ValueError("Invalid mode, expected 'c' or 'fortran', got %s" % mode)             # <<<<<<<<<<<<<<
  * 
  *         self.len = fill_contig_strides_array(self._shape, self._strides,
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 165, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 165, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_Raise(__pyx_t_10, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __PYX_ERR(1, 165, __pyx_L1_error)
+    __PYX_ERR(0, 165, __pyx_L1_error)
   }
   __pyx_L10:;
 
   /* "View.MemoryView":167
  *             raise ValueError("Invalid mode, expected 'c' or 'fortran', got %s" % mode)
  * 
  *         self.len = fill_contig_strides_array(self._shape, self._strides,             # <<<<<<<<<<<<<<
@@ -5490,16 +5631,16 @@
   /* "View.MemoryView":171
  * 
  *         self.free_data = allocate_buffer
  *         self.dtype_is_object = format == b'O'             # <<<<<<<<<<<<<<
  *         if allocate_buffer:
  * 
  */
-  __pyx_t_10 = PyObject_RichCompare(__pyx_v_format, __pyx_n_b_O, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 171, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 171, __pyx_L1_error)
+  __pyx_t_10 = PyObject_RichCompare(__pyx_v_format, __pyx_n_b_O, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_v_self->dtype_is_object = __pyx_t_4;
 
   /* "View.MemoryView":172
  *         self.free_data = allocate_buffer
  *         self.dtype_is_object = format == b'O'
  *         if allocate_buffer:             # <<<<<<<<<<<<<<
@@ -5531,19 +5672,19 @@
       /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 177, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 177, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __PYX_ERR(1, 177, __pyx_L1_error)
+      __PYX_ERR(0, 177, __pyx_L1_error)
 
       /* "View.MemoryView":176
  * 
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:             # <<<<<<<<<<<<<<
  *                 raise MemoryError("unable to allocate array data.")
  * 
@@ -5574,19 +5715,19 @@
  *                 p = <PyObject **> self.data
  *                 for i in range(self.len / itemsize):             # <<<<<<<<<<<<<<
  *                     p[i] = Py_None
  *                     Py_INCREF(Py_None)
  */
       if (unlikely(__pyx_v_itemsize == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(1, 181, __pyx_L1_error)
+        __PYX_ERR(0, 181, __pyx_L1_error)
       }
       else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((Py_ssize_t)-1) > 0)) && unlikely(__pyx_v_itemsize == (Py_ssize_t)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_self->len))) {
         PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-        __PYX_ERR(1, 181, __pyx_L1_error)
+        __PYX_ERR(0, 181, __pyx_L1_error)
       }
       __pyx_t_1 = __Pyx_div_Py_ssize_t(__pyx_v_self->len, __pyx_v_itemsize);
       __pyx_t_9 = __pyx_t_1;
       for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_9; __pyx_t_11+=1) {
         __pyx_v_i = __pyx_t_11;
 
         /* "View.MemoryView":182
@@ -5705,15 +5846,15 @@
   /* "View.MemoryView":188
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         cdef int bufmode = -1
  *         if self.mode == u"c":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_c, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 188, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_c, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 188, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
     /* "View.MemoryView":189
  *         cdef int bufmode = -1
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS             # <<<<<<<<<<<<<<
@@ -5735,15 +5876,15 @@
   /* "View.MemoryView":190
  *         if self.mode == u"c":
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":             # <<<<<<<<<<<<<<
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_fortran, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 190, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mode, __pyx_n_u_fortran, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 190, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
     /* "View.MemoryView":191
  *             bufmode = PyBUF_C_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS             # <<<<<<<<<<<<<<
@@ -5775,19 +5916,19 @@
     /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 193, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 193, __pyx_L1_error)
+    __PYX_ERR(0, 193, __pyx_L1_error)
 
     /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):             # <<<<<<<<<<<<<<
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")
  *         info.buf = self.data
@@ -6122,15 +6263,15 @@
  *     @property
  *     def memview(self):
  *         return self.get_memview()             # <<<<<<<<<<<<<<
  * 
  *     @cname('get_memview')
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = ((struct __pyx_vtabstruct_array *)__pyx_v_self->__pyx_vtab)->get_memview(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 224, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_array *)__pyx_v_self->__pyx_vtab)->get_memview(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":223
  * 
@@ -6184,30 +6325,30 @@
  *     cdef get_memview(self):
  *         flags =  PyBUF_ANY_CONTIGUOUS|PyBUF_FORMAT|PyBUF_WRITABLE
  *         return  memoryview(self, flags, self.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 229, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 229, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 229, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
   PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_self));
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 229, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":227
@@ -6316,17 +6457,17 @@
  * 
  *     def __getattr__(self, attr):
  *         return getattr(self.memview, attr)             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, item):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 235, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetAttr(__pyx_t_1, __pyx_v_attr); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 235, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetAttr(__pyx_t_1, __pyx_v_attr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":234
@@ -6384,17 +6525,17 @@
  * 
  *     def __getitem__(self, item):
  *         return self.memview[item]             # <<<<<<<<<<<<<<
  * 
  *     def __setitem__(self, item, value):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 238, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_item); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 238, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_item); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":237
@@ -6450,17 +6591,17 @@
   /* "View.MemoryView":241
  * 
  *     def __setitem__(self, item, value):
  *         self.memview[item] = value             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 241, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_memview); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_item, __pyx_v_value) < 0)) __PYX_ERR(1, 241, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_item, __pyx_v_value) < 0)) __PYX_ERR(0, 241, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "View.MemoryView":240
  *         return self.memview[item]
  * 
  *     def __setitem__(self, item, value):             # <<<<<<<<<<<<<<
  *         self.memview[item] = value
@@ -6509,19 +6650,19 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 2, __pyx_L1_error)
+  __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
@@ -6565,19 +6706,19 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 4, __pyx_L1_error)
+  __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
@@ -6627,35 +6768,35 @@
     /* "View.MemoryView":250
  * 
  *     if buf == NULL:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))             # <<<<<<<<<<<<<<
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),
  */
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 250, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 250, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 250, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 250, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_shape);
     __Pyx_GIVEREF(__pyx_v_shape);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_shape);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 250, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_result = ((struct __pyx_array_obj *)__pyx_t_4);
     __pyx_t_4 = 0;
 
     /* "View.MemoryView":249
  *     cdef array result
@@ -6671,21 +6812,21 @@
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),             # <<<<<<<<<<<<<<
  *                        allocate_buffer=False)
  *         result.data = buf
  */
   /*else*/ {
-    __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_itemsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyBytes_FromString(__pyx_v_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_mode, 0, strlen(__pyx_v_mode), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_shape);
     __Pyx_GIVEREF(__pyx_v_shape);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_shape);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
@@ -6699,26 +6840,26 @@
     /* "View.MemoryView":253
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),
  *                        allocate_buffer=False)             # <<<<<<<<<<<<<<
  *         result.data = buf
  * 
  */
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 253, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_allocate_buffer, Py_False) < 0) __PYX_ERR(1, 253, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_allocate_buffer, Py_False) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
 
     /* "View.MemoryView":252
  *         result = array(shape, itemsize, format, mode.decode('ASCII'))
  *     else:
  *         result = array(shape, itemsize, format, mode.decode('ASCII'),             # <<<<<<<<<<<<<<
  *                        allocate_buffer=False)
  *         result.data = buf
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 252, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_array_type), __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_result = ((struct __pyx_array_obj *)__pyx_t_5);
     __pyx_t_5 = 0;
 
     /* "View.MemoryView":254
@@ -6800,26 +6941,26 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(1, 282, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 282, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_name = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 282, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 282, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.Enum.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_MemviewEnum___pyx_pf_15View_dot_MemoryView_4Enum___init__(((struct __pyx_MemviewEnum_obj *)__pyx_v_self), __pyx_v_name);
 
@@ -6951,30 +7092,30 @@
   /* "(tree fragment)":5
  *     cdef object _dict
  *     cdef bint use_setstate
  *     state = (self.name,)             # <<<<<<<<<<<<<<
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:
  */
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_self->name);
   __Pyx_GIVEREF(__pyx_v_self->name);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_self->name);
   __pyx_v_state = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "(tree fragment)":6
  *     cdef bint use_setstate
  *     state = (self.name,)
  *     _dict = getattr(self, '__dict__', None)             # <<<<<<<<<<<<<<
  *     if _dict is not None:
  *         state += (_dict,)
  */
-  __pyx_t_1 = __Pyx_GetAttr3(((PyObject *)__pyx_v_self), __pyx_n_s_dict, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 6, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetAttr3(((PyObject *)__pyx_v_self), __pyx_n_s_dict, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v__dict = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "(tree fragment)":7
  *     state = (self.name,)
  *     _dict = getattr(self, '__dict__', None)
@@ -6989,20 +7130,20 @@
     /* "(tree fragment)":8
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:
  *         state += (_dict,)             # <<<<<<<<<<<<<<
  *         use_setstate = True
  *     else:
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 8, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v__dict);
     __Pyx_GIVEREF(__pyx_v__dict);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v__dict);
-    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_v_state, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 8, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_v_state, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 8, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_state, ((PyObject*)__pyx_t_4));
     __pyx_t_4 = 0;
 
     /* "(tree fragment)":9
  *     if _dict is not None:
@@ -7050,28 +7191,28 @@
  *         use_setstate = self.name is not None
  *     if use_setstate:
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, None), state             # <<<<<<<<<<<<<<
  *     else:
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pyx_unpickle_Enum); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pyx_unpickle_Enum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_INCREF(__pyx_int_184977713);
     __Pyx_GIVEREF(__pyx_int_184977713);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_184977713);
     __Pyx_INCREF(Py_None);
     __Pyx_GIVEREF(Py_None);
     PyTuple_SET_ITEM(__pyx_t_1, 2, Py_None);
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_state);
     __Pyx_GIVEREF(__pyx_v_state);
@@ -7096,28 +7237,28 @@
  *     else:
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     __pyx_unpickle_Enum__set_state(self, __pyx_state)
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pyx_unpickle_Enum); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pyx_unpickle_Enum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 15, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_INCREF(__pyx_int_184977713);
     __Pyx_GIVEREF(__pyx_int_184977713);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_184977713);
     __Pyx_INCREF(__pyx_v_state);
     __Pyx_GIVEREF(__pyx_v_state);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_state);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 15, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_5 = 0;
     __pyx_t_1 = 0;
@@ -7177,16 +7318,16 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":17
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)
  * def __setstate_cython__(self, __pyx_state):
  *     __pyx_unpickle_Enum__set_state(self, __pyx_state)             # <<<<<<<<<<<<<<
  */
-  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 17, __pyx_L1_error)
-  __pyx_t_1 = __pyx_unpickle_Enum__set_state(__pyx_v_self, ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(0, 17, __pyx_L1_error)
+  __pyx_t_1 = __pyx_unpickle_Enum__set_state(__pyx_v_self, ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "(tree fragment)":16
  *     else:
  *         return __pyx_unpickle_Enum, (type(self), 0xb068931, state)
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
@@ -7330,47 +7471,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_obj)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_flags)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, 1); __PYX_ERR(1, 346, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, 1); __PYX_ERR(0, 346, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dtype_is_object);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 346, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 346, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_obj = values[0];
-    __pyx_v_flags = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_flags == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 346, __pyx_L3_error)
+    __pyx_v_flags = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_flags == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 346, __pyx_L3_error)
     if (values[2]) {
-      __pyx_v_dtype_is_object = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_dtype_is_object == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 346, __pyx_L3_error)
+      __pyx_v_dtype_is_object = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_dtype_is_object == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 346, __pyx_L3_error)
     } else {
       __pyx_v_dtype_is_object = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 346, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 346, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.memoryview.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview___cinit__(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_obj, __pyx_v_flags, __pyx_v_dtype_is_object);
 
@@ -7436,15 +7577,15 @@
     /* "View.MemoryView":350
  *         self.flags = flags
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)             # <<<<<<<<<<<<<<
  *             if <PyObject *> self.view.obj == NULL:
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  */
-    __pyx_t_4 = __Pyx_GetBuffer(__pyx_v_obj, (&__pyx_v_self->view), __pyx_v_flags); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 350, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetBuffer(__pyx_v_obj, (&__pyx_v_self->view), __pyx_v_flags); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 350, __pyx_L1_error)
 
     /* "View.MemoryView":351
  *         if type(self) is memoryview or obj is not None:
  *             __Pyx_GetBuffer(obj, &self.view, flags)
  *             if <PyObject *> self.view.obj == NULL:             # <<<<<<<<<<<<<<
  *                 (<__pyx_buffer *> &self.view).obj = Py_None
  *                 Py_INCREF(Py_None)
@@ -7567,15 +7708,15 @@
         /* "View.MemoryView":363
  *                 self.lock = PyThread_allocate_lock()
  *                 if self.lock is NULL:
  *                     raise MemoryError             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_FORMAT:
  */
-        PyErr_NoMemory(); __PYX_ERR(1, 363, __pyx_L1_error)
+        PyErr_NoMemory(); __PYX_ERR(0, 363, __pyx_L1_error)
 
         /* "View.MemoryView":362
  *             if self.lock is NULL:
  *                 self.lock = PyThread_allocate_lock()
  *                 if self.lock is NULL:             # <<<<<<<<<<<<<<
  *                     raise MemoryError
  * 
@@ -7961,44 +8102,44 @@
  * 
  */
   __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_v_index)) || PyTuple_CheckExact(__pyx_v_index)) {
     __pyx_t_2 = __pyx_v_index; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 399, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 399, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 399, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 399, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 399, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(1, 399, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 399, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 399, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 399, __pyx_L1_error)
+          else __PYX_ERR(0, 399, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_5);
     __pyx_t_5 = 0;
@@ -8008,16 +8149,16 @@
     /* "View.MemoryView":400
  * 
  *         for dim, idx in enumerate(index):
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)             # <<<<<<<<<<<<<<
  * 
  *         return itemp
  */
-    __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_v_idx); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 400, __pyx_L1_error)
-    __pyx_t_7 = __pyx_pybuffer_index((&__pyx_v_self->view), __pyx_v_itemp, __pyx_t_6, __pyx_v_dim); if (unlikely(__pyx_t_7 == ((char *)NULL))) __PYX_ERR(1, 400, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_v_idx); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 400, __pyx_L1_error)
+    __pyx_t_7 = __pyx_pybuffer_index((&__pyx_v_self->view), __pyx_v_itemp, __pyx_t_6, __pyx_v_dim); if (unlikely(__pyx_t_7 == ((char *)NULL))) __PYX_ERR(0, 400, __pyx_L1_error)
     __pyx_v_itemp = __pyx_t_7;
 
     /* "View.MemoryView":399
  *         cdef char *itemp = <char *> self.view.buf
  * 
  *         for dim, idx in enumerate(index):             # <<<<<<<<<<<<<<
  *             itemp = pybuffer_index(&self.view, itemp, idx, dim)
@@ -8129,63 +8270,63 @@
   /* "View.MemoryView":409
  *             return self
  * 
  *         have_slices, indices = _unellipsify(index, self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *         cdef char *itemp
  */
-  __pyx_t_3 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 409, __pyx_L1_error)
+  __pyx_t_3 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 409, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (likely(__pyx_t_3 != Py_None)) {
     PyObject* sequence = __pyx_t_3;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(1, 409, __pyx_L1_error)
+      __PYX_ERR(0, 409, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
     __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
     __Pyx_INCREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 409, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 409, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 409, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else {
-    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 409, __pyx_L1_error)
+    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(0, 409, __pyx_L1_error)
   }
   __pyx_v_have_slices = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_indices = __pyx_t_5;
   __pyx_t_5 = 0;
 
   /* "View.MemoryView":412
  * 
  *         cdef char *itemp
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             return memview_slice(self, indices)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 412, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 412, __pyx_L1_error)
   if (__pyx_t_2) {
 
     /* "View.MemoryView":413
  *         cdef char *itemp
  *         if have_slices:
  *             return memview_slice(self, indices)             # <<<<<<<<<<<<<<
  *         else:
  *             itemp = self.get_item_pointer(indices)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = ((PyObject *)__pyx_memview_slice(__pyx_v_self, __pyx_v_indices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 413, __pyx_L1_error)
+    __pyx_t_3 = ((PyObject *)__pyx_memview_slice(__pyx_v_self, __pyx_v_indices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":412
  * 
@@ -8200,26 +8341,26 @@
  *             return memview_slice(self, indices)
  *         else:
  *             itemp = self.get_item_pointer(indices)             # <<<<<<<<<<<<<<
  *             return self.convert_item_to_object(itemp)
  * 
  */
   /*else*/ {
-    __pyx_t_6 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_indices); if (unlikely(__pyx_t_6 == ((char *)NULL))) __PYX_ERR(1, 415, __pyx_L1_error)
+    __pyx_t_6 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_indices); if (unlikely(__pyx_t_6 == ((char *)NULL))) __PYX_ERR(0, 415, __pyx_L1_error)
     __pyx_v_itemp = __pyx_t_6;
 
     /* "View.MemoryView":416
  *         else:
  *             itemp = self.get_item_pointer(indices)
  *             return self.convert_item_to_object(itemp)             # <<<<<<<<<<<<<<
  * 
  *     def __setitem__(memoryview self, object index, object value):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->convert_item_to_object(__pyx_v_self, __pyx_v_itemp); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 416, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->convert_item_to_object(__pyx_v_self, __pyx_v_itemp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
   }
 
   /* "View.MemoryView":405
@@ -8294,19 +8435,19 @@
     /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 420, __pyx_L1_error)
+    __PYX_ERR(0, 420, __pyx_L1_error)
 
     /* "View.MemoryView":419
  * 
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise TypeError("Cannot assign to read-only memoryview")
  * 
@@ -8316,86 +8457,86 @@
   /* "View.MemoryView":422
  *             raise TypeError("Cannot assign to read-only memoryview")
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *         if have_slices:
  */
-  __pyx_t_2 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 422, __pyx_L1_error)
+  __pyx_t_2 = _unellipsify(__pyx_v_index, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(__pyx_t_2 != Py_None)) {
     PyObject* sequence = __pyx_t_2;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(1, 422, __pyx_L1_error)
+      __PYX_ERR(0, 422, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
     __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_4);
     #else
-    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 422, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 422, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     #endif
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else {
-    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 422, __pyx_L1_error)
+    __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(0, 422, __pyx_L1_error)
   }
   __pyx_v_have_slices = __pyx_t_3;
   __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_index, __pyx_t_4);
   __pyx_t_4 = 0;
 
   /* "View.MemoryView":424
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  * 
  *         if have_slices:             # <<<<<<<<<<<<<<
  *             obj = self.is_slice(value)
  *             if obj:
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 424, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_have_slices); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 424, __pyx_L1_error)
   if (__pyx_t_1) {
 
     /* "View.MemoryView":425
  * 
  *         if have_slices:
  *             obj = self.is_slice(value)             # <<<<<<<<<<<<<<
  *             if obj:
  *                 self.setitem_slice_assignment(self[index], obj)
  */
-    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->is_slice(__pyx_v_self, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 425, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->is_slice(__pyx_v_self, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 425, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_obj = __pyx_t_2;
     __pyx_t_2 = 0;
 
     /* "View.MemoryView":426
  *         if have_slices:
  *             obj = self.is_slice(value)
  *             if obj:             # <<<<<<<<<<<<<<
  *                 self.setitem_slice_assignment(self[index], obj)
  *             else:
  */
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_obj); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 426, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_obj); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 426, __pyx_L1_error)
     if (__pyx_t_1) {
 
       /* "View.MemoryView":427
  *             obj = self.is_slice(value)
  *             if obj:
  *                 self.setitem_slice_assignment(self[index], obj)             # <<<<<<<<<<<<<<
  *             else:
  *                 self.setitem_slice_assign_scalar(self[index], value)
  */
-      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 427, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assignment(__pyx_v_self, __pyx_t_2, __pyx_v_obj); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 427, __pyx_L1_error)
+      __pyx_t_4 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assignment(__pyx_v_self, __pyx_t_2, __pyx_v_obj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 427, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
       /* "View.MemoryView":426
  *         if have_slices:
  *             obj = self.is_slice(value)
@@ -8410,18 +8551,18 @@
  *                 self.setitem_slice_assignment(self[index], obj)
  *             else:
  *                 self.setitem_slice_assign_scalar(self[index], value)             # <<<<<<<<<<<<<<
  *         else:
  *             self.setitem_indexed(index, value)
  */
     /*else*/ {
-      __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 429, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 429, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_memoryview_type))))) __PYX_ERR(1, 429, __pyx_L1_error)
-      __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assign_scalar(__pyx_v_self, ((struct __pyx_memoryview_obj *)__pyx_t_4), __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 429, __pyx_L1_error)
+      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_memoryview_type))))) __PYX_ERR(0, 429, __pyx_L1_error)
+      __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_slice_assign_scalar(__pyx_v_self, ((struct __pyx_memoryview_obj *)__pyx_t_4), __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __pyx_L5:;
 
     /* "View.MemoryView":424
@@ -8438,15 +8579,15 @@
  *                 self.setitem_slice_assign_scalar(self[index], value)
  *         else:
  *             self.setitem_indexed(index, value)             # <<<<<<<<<<<<<<
  * 
  *     cdef is_slice(self, obj):
  */
   /*else*/ {
-    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_indexed(__pyx_v_self, __pyx_v_index, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 431, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->setitem_indexed(__pyx_v_self, __pyx_v_index, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __pyx_L4:;
 
   /* "View.MemoryView":418
  *             return self.convert_item_to_object(itemp)
@@ -8529,46 +8670,46 @@
         /* "View.MemoryView":436
  *         if not isinstance(obj, memoryview):
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,             # <<<<<<<<<<<<<<
  *                                  self.dtype_is_object)
  *             except TypeError:
  */
-        __pyx_t_6 = __Pyx_PyInt_From_int(((__pyx_v_self->flags & (~PyBUF_WRITABLE)) | PyBUF_ANY_CONTIGUOUS)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 436, __pyx_L4_error)
+        __pyx_t_6 = __Pyx_PyInt_From_int(((__pyx_v_self->flags & (~PyBUF_WRITABLE)) | PyBUF_ANY_CONTIGUOUS)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_6);
 
         /* "View.MemoryView":437
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,
  *                                  self.dtype_is_object)             # <<<<<<<<<<<<<<
  *             except TypeError:
  *                 return None
  */
-        __pyx_t_7 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 437, __pyx_L4_error)
+        __pyx_t_7 = __Pyx_PyBool_FromLong(__pyx_v_self->dtype_is_object); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 437, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_7);
 
         /* "View.MemoryView":436
  *         if not isinstance(obj, memoryview):
  *             try:
  *                 obj = memoryview(obj, self.flags & ~PyBUF_WRITABLE | PyBUF_ANY_CONTIGUOUS,             # <<<<<<<<<<<<<<
  *                                  self.dtype_is_object)
  *             except TypeError:
  */
-        __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 436, __pyx_L4_error)
+        __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_INCREF(__pyx_v_obj);
         __Pyx_GIVEREF(__pyx_v_obj);
         PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_obj);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_7);
         __pyx_t_6 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 436, __pyx_L4_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF_SET(__pyx_v_obj, __pyx_t_7);
         __pyx_t_7 = 0;
 
         /* "View.MemoryView":435
  *     cdef is_slice(self, obj):
@@ -8593,15 +8734,15 @@
  *             except TypeError:             # <<<<<<<<<<<<<<
  *                 return None
  * 
  */
       __pyx_t_9 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
       if (__pyx_t_9) {
         __Pyx_AddTraceback("View.MemoryView.memoryview.is_slice", __pyx_clineno, __pyx_lineno, __pyx_filename);
-        if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_6) < 0) __PYX_ERR(1, 438, __pyx_L6_except_error)
+        if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_6) < 0) __PYX_ERR(0, 438, __pyx_L6_except_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_GOTREF(__pyx_t_6);
 
         /* "View.MemoryView":439
  *                                  self.dtype_is_object)
  *             except TypeError:
@@ -8710,51 +8851,51 @@
   /* "View.MemoryView":447
  *         cdef __Pyx_memviewslice src_slice
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],             # <<<<<<<<<<<<<<
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  */
-  if (!(likely(((__pyx_v_src) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_src, __pyx_memoryview_type))))) __PYX_ERR(1, 447, __pyx_L1_error)
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_src), (&__pyx_v_src_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 447, __pyx_L1_error)
+  if (!(likely(((__pyx_v_src) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_src, __pyx_memoryview_type))))) __PYX_ERR(0, 447, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_src), (&__pyx_v_src_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(0, 447, __pyx_L1_error)
 
   /* "View.MemoryView":448
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],
  *                                  get_slice_from_memview(dst, &dst_slice)[0],             # <<<<<<<<<<<<<<
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  * 
  */
-  if (!(likely(((__pyx_v_dst) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dst, __pyx_memoryview_type))))) __PYX_ERR(1, 448, __pyx_L1_error)
-  __pyx_t_2 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_dst), (&__pyx_v_dst_slice)); if (unlikely(__pyx_t_2 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 448, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dst) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dst, __pyx_memoryview_type))))) __PYX_ERR(0, 448, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_get_slice_from_memoryview(((struct __pyx_memoryview_obj *)__pyx_v_dst), (&__pyx_v_dst_slice)); if (unlikely(__pyx_t_2 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(0, 448, __pyx_L1_error)
 
   /* "View.MemoryView":449
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     cdef setitem_slice_assign_scalar(self, memoryview dst, value):
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_src, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 449, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_src, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 449, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_dst, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 449, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_dst, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 449, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "View.MemoryView":447
  *         cdef __Pyx_memviewslice src_slice
  * 
  *         memoryview_copy_contents(get_slice_from_memview(src, &src_slice)[0],             # <<<<<<<<<<<<<<
  *                                  get_slice_from_memview(dst, &dst_slice)[0],
  *                                  src.ndim, dst.ndim, self.dtype_is_object)
  */
-  __pyx_t_6 = __pyx_memoryview_copy_contents((__pyx_t_1[0]), (__pyx_t_2[0]), __pyx_t_4, __pyx_t_5, __pyx_v_self->dtype_is_object); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 447, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_copy_contents((__pyx_t_1[0]), (__pyx_t_2[0]), __pyx_t_4, __pyx_t_5, __pyx_v_self->dtype_is_object); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 447, __pyx_L1_error)
 
   /* "View.MemoryView":443
  *         return obj
  * 
  *     cdef setitem_slice_assignment(self, dst, src):             # <<<<<<<<<<<<<<
  *         cdef __Pyx_memviewslice dst_slice
  *         cdef __Pyx_memviewslice src_slice
@@ -8818,15 +8959,15 @@
   /* "View.MemoryView":458
  *         cdef __Pyx_memviewslice *dst_slice
  *         cdef __Pyx_memviewslice tmp_slice
  *         dst_slice = get_slice_from_memview(dst, &tmp_slice)             # <<<<<<<<<<<<<<
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_dst, (&__pyx_v_tmp_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 458, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_dst, (&__pyx_v_tmp_slice)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(0, 458, __pyx_L1_error)
   __pyx_v_dst_slice = __pyx_t_1;
 
   /* "View.MemoryView":460
  *         dst_slice = get_slice_from_memview(dst, &tmp_slice)
  * 
  *         if <size_t>self.view.itemsize > sizeof(array):             # <<<<<<<<<<<<<<
  *             tmp = PyMem_Malloc(self.view.itemsize)
@@ -8857,15 +8998,15 @@
       /* "View.MemoryView":463
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:
  *                 raise MemoryError             # <<<<<<<<<<<<<<
  *             item = tmp
  *         else:
  */
-      PyErr_NoMemory(); __PYX_ERR(1, 463, __pyx_L1_error)
+      PyErr_NoMemory(); __PYX_ERR(0, 463, __pyx_L1_error)
 
       /* "View.MemoryView":462
  *         if <size_t>self.view.itemsize > sizeof(array):
  *             tmp = PyMem_Malloc(self.view.itemsize)
  *             if tmp == NULL:             # <<<<<<<<<<<<<<
  *                 raise MemoryError
  *             item = tmp
@@ -8945,15 +9086,15 @@
  *                 (<PyObject **> item)[0] = <PyObject *> value
  *             else:
  *                 self.assign_item_from_object(<char *> item, value)             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else*/ {
-      __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, ((char *)__pyx_v_item), __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 472, __pyx_L6_error)
+      __pyx_t_3 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, ((char *)__pyx_v_item), __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_L8:;
 
     /* "View.MemoryView":476
  * 
@@ -8968,15 +9109,15 @@
       /* "View.MemoryView":477
  * 
  *             if self.view.suboffsets != NULL:
  *                 assert_direct_dimensions(self.view.suboffsets, self.view.ndim)             # <<<<<<<<<<<<<<
  *             slice_assign_scalar(dst_slice, dst.view.ndim, self.view.itemsize,
  *                                 item, self.dtype_is_object)
  */
-      __pyx_t_3 = assert_direct_dimensions(__pyx_v_self->view.suboffsets, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 477, __pyx_L6_error)
+      __pyx_t_3 = assert_direct_dimensions(__pyx_v_self->view.suboffsets, __pyx_v_self->view.ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "View.MemoryView":476
  * 
  * 
  *             if self.view.suboffsets != NULL:             # <<<<<<<<<<<<<<
@@ -9085,25 +9226,25 @@
   /* "View.MemoryView":484
  * 
  *     cdef setitem_indexed(self, index, value):
  *         cdef char *itemp = self.get_item_pointer(index)             # <<<<<<<<<<<<<<
  *         self.assign_item_from_object(itemp, value)
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_index); if (unlikely(__pyx_t_1 == ((char *)NULL))) __PYX_ERR(1, 484, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->get_item_pointer(__pyx_v_self, __pyx_v_index); if (unlikely(__pyx_t_1 == ((char *)NULL))) __PYX_ERR(0, 484, __pyx_L1_error)
   __pyx_v_itemp = __pyx_t_1;
 
   /* "View.MemoryView":485
  *     cdef setitem_indexed(self, index, value):
  *         cdef char *itemp = self.get_item_pointer(index)
  *         self.assign_item_from_object(itemp, value)             # <<<<<<<<<<<<<<
  * 
  *     cdef convert_item_to_object(self, char *itemp):
  */
-  __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 485, __pyx_L1_error)
+  __pyx_t_2 = ((struct __pyx_vtabstruct_memoryview *)__pyx_v_self->__pyx_vtab)->assign_item_from_object(__pyx_v_self, __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "View.MemoryView":483
  *             PyMem_Free(tmp)
  * 
  *     cdef setitem_indexed(self, index, value):             # <<<<<<<<<<<<<<
@@ -9157,27 +9298,27 @@
   /* "View.MemoryView":490
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  *         import struct             # <<<<<<<<<<<<<<
  *         cdef bytes bytesitem
  * 
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 490, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_struct = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":493
  *         cdef bytes bytesitem
  * 
  *         bytesitem = itemp[:self.view.itemsize]             # <<<<<<<<<<<<<<
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)
  */
-  __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_itemp + 0, __pyx_v_self->view.itemsize - 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 493, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_itemp + 0, __pyx_v_self->view.itemsize - 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_bytesitem = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":494
  * 
  *         bytesitem = itemp[:self.view.itemsize]
@@ -9197,17 +9338,17 @@
       /* "View.MemoryView":495
  *         bytesitem = itemp[:self.view.itemsize]
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)             # <<<<<<<<<<<<<<
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")
  */
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_unpack); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 495, __pyx_L3_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_unpack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 495, __pyx_L3_error)
+      __pyx_t_6 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_7 = NULL;
       __pyx_t_8 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -9216,42 +9357,42 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_8 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_v_bytesitem};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L3_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_v_bytesitem};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L3_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 495, __pyx_L3_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 495, __pyx_L3_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_7) {
           __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_t_6);
         __Pyx_INCREF(__pyx_v_bytesitem);
         __Pyx_GIVEREF(__pyx_v_bytesitem);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_bytesitem);
         __pyx_t_6 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 495, __pyx_L3_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L3_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_result = __pyx_t_1;
       __pyx_t_1 = 0;
 
@@ -9280,15 +9421,15 @@
  *         else:
  *             if len(self.view.format) == 1:
  *                 return result[0]             # <<<<<<<<<<<<<<
  *             return result
  * 
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 500, __pyx_L5_except_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L5_except_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L6_except_return;
 
         /* "View.MemoryView":499
  *             raise ValueError("Unable to convert item to object")
@@ -9322,39 +9463,39 @@
  *         try:
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:             # <<<<<<<<<<<<<<
  *             raise ValueError("Unable to convert item to object")
  *         else:
  */
     __Pyx_ErrFetch(&__pyx_t_1, &__pyx_t_5, &__pyx_t_9);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 496, __pyx_L5_except_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 496, __pyx_L5_except_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_8 = __Pyx_PyErr_GivenExceptionMatches(__pyx_t_1, __pyx_t_6);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_ErrRestore(__pyx_t_1, __pyx_t_5, __pyx_t_9);
     __pyx_t_1 = 0; __pyx_t_5 = 0; __pyx_t_9 = 0;
     if (__pyx_t_8) {
       __Pyx_AddTraceback("View.MemoryView.memoryview.convert_item_to_object", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_5, &__pyx_t_1) < 0) __PYX_ERR(1, 496, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_5, &__pyx_t_1) < 0) __PYX_ERR(0, 496, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_1);
 
       /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 497, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 497, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(1, 497, __pyx_L5_except_error)
+      __PYX_ERR(0, 497, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
     /* "View.MemoryView":494
  * 
  *         bytesitem = itemp[:self.view.itemsize]
@@ -9438,15 +9579,15 @@
   /* "View.MemoryView":506
  *         """Only used if instantiated manually by the user, or if Cython doesn't
  *         know how to convert the type"""
  *         import struct             # <<<<<<<<<<<<<<
  *         cdef char c
  *         cdef bytes bytesvalue
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 506, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_struct, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_struct = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":511
  *         cdef Py_ssize_t i
  * 
@@ -9461,34 +9602,34 @@
     /* "View.MemoryView":512
  * 
  *         if isinstance(value, tuple):
  *             bytesvalue = struct.pack(self.view.format, *value)             # <<<<<<<<<<<<<<
  *         else:
  *             bytesvalue = struct.pack(self.view.format, value)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 512, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 512, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(0, 512, __pyx_L1_error)
     __pyx_v_bytesvalue = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
 
     /* "View.MemoryView":511
  *         cdef Py_ssize_t i
  * 
  *         if isinstance(value, tuple):             # <<<<<<<<<<<<<<
@@ -9502,17 +9643,17 @@
  *             bytesvalue = struct.pack(self.view.format, *value)
  *         else:
  *             bytesvalue = struct.pack(self.view.format, value)             # <<<<<<<<<<<<<<
  * 
  *         for i, c in enumerate(bytesvalue):
  */
   /*else*/ {
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 514, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_struct, __pyx_n_s_pack); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 514, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 514, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyBytes_FromString(__pyx_v_self->view.format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -9521,47 +9662,47 @@
         __Pyx_DECREF_SET(__pyx_t_6, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_1, __pyx_v_value};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_1, __pyx_v_value};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 514, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_5) {
         __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_1);
       __Pyx_INCREF(__pyx_v_value);
       __Pyx_GIVEREF(__pyx_v_value);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_value);
       __pyx_t_1 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 514, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(1, 514, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_4))||((__pyx_t_4) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_4)->tp_name), 0))) __PYX_ERR(0, 514, __pyx_L1_error)
     __pyx_v_bytesvalue = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
   }
   __pyx_L3:;
 
   /* "View.MemoryView":516
  *             bytesvalue = struct.pack(self.view.format, value)
@@ -9569,15 +9710,15 @@
  *         for i, c in enumerate(bytesvalue):             # <<<<<<<<<<<<<<
  *             itemp[i] = c
  * 
  */
   __pyx_t_9 = 0;
   if (unlikely(__pyx_v_bytesvalue == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' is not iterable");
-    __PYX_ERR(1, 516, __pyx_L1_error)
+    __PYX_ERR(0, 516, __pyx_L1_error)
   }
   __Pyx_INCREF(__pyx_v_bytesvalue);
   __pyx_t_10 = __pyx_v_bytesvalue;
   __pyx_t_12 = PyBytes_AS_STRING(__pyx_t_10);
   __pyx_t_13 = (__pyx_t_12 + PyBytes_GET_SIZE(__pyx_t_10));
   for (__pyx_t_14 = __pyx_t_12; __pyx_t_14 < __pyx_t_13; __pyx_t_14++) {
     __pyx_t_11 = __pyx_t_14;
@@ -9704,19 +9845,19 @@
     /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 522, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 522, __pyx_L1_error)
+    __PYX_ERR(0, 522, __pyx_L1_error)
 
     /* "View.MemoryView":521
  *     @cname('getbuffer')
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:             # <<<<<<<<<<<<<<
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")
  * 
@@ -10019,28 +10160,28 @@
   /* "View.MemoryView":556
  *     @property
  *     def T(self):
  *         cdef _memoryviewslice result = memoryview_copy(self)             # <<<<<<<<<<<<<<
  *         transpose_memslice(&result.from_slice)
  *         return result
  */
-  __pyx_t_1 = __pyx_memoryview_copy_object(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 556, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_object(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_memoryviewslice_type))))) __PYX_ERR(1, 556, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_memoryviewslice_type))))) __PYX_ERR(0, 556, __pyx_L1_error)
   __pyx_v_result = ((struct __pyx_memoryviewslice_obj *)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":557
  *     def T(self):
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)             # <<<<<<<<<<<<<<
  *         return result
  * 
  */
-  __pyx_t_2 = __pyx_memslice_transpose((&__pyx_v_result->from_slice)); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 557, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memslice_transpose((&__pyx_v_result->from_slice)); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(0, 557, __pyx_L1_error)
 
   /* "View.MemoryView":558
  *         cdef _memoryviewslice result = memoryview_copy(self)
  *         transpose_memslice(&result.from_slice)
  *         return result             # <<<<<<<<<<<<<<
  * 
  *     @property
@@ -10162,26 +10303,26 @@
  *     @property
  *     def shape(self):
  *         return tuple([length for length in self.view.shape[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 566, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = (__pyx_v_self->view.shape + __pyx_v_self->view.ndim);
   for (__pyx_t_4 = __pyx_v_self->view.shape; __pyx_t_4 < __pyx_t_3; __pyx_t_4++) {
     __pyx_t_2 = __pyx_t_4;
     __pyx_v_length = (__pyx_t_2[0]);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 566, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(1, 566, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_5 = PyList_AsTuple(((PyObject*)__pyx_t_1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 566, __pyx_L1_error)
+  __pyx_t_5 = PyList_AsTuple(((PyObject*)__pyx_t_1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":565
@@ -10253,19 +10394,19 @@
     /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 572, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 572, __pyx_L1_error)
+    __PYX_ERR(0, 572, __pyx_L1_error)
 
     /* "View.MemoryView":570
  *     @property
  *     def strides(self):
  *         if self.view.strides == NULL:             # <<<<<<<<<<<<<<
  * 
  *             raise ValueError("Buffer view does not expose strides")
@@ -10276,26 +10417,26 @@
  *             raise ValueError("Buffer view does not expose strides")
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 574, __pyx_L1_error)
+  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = (__pyx_v_self->view.strides + __pyx_v_self->view.ndim);
   for (__pyx_t_5 = __pyx_v_self->view.strides; __pyx_t_5 < __pyx_t_4; __pyx_t_5++) {
     __pyx_t_3 = __pyx_t_5;
     __pyx_v_stride = (__pyx_t_3[0]);
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_stride); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 574, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_stride); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(1, 574, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
-  __pyx_t_6 = PyList_AsTuple(((PyObject*)__pyx_t_2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 574, __pyx_L1_error)
+  __pyx_t_6 = PyList_AsTuple(((PyObject*)__pyx_t_2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_6;
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":569
@@ -10368,17 +10509,17 @@
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 579, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__16, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__14, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":578
@@ -10394,26 +10535,26 @@
  *             return (-1,) * self.view.ndim
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 581, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = (__pyx_v_self->view.suboffsets + __pyx_v_self->view.ndim);
   for (__pyx_t_6 = __pyx_v_self->view.suboffsets; __pyx_t_6 < __pyx_t_5; __pyx_t_6++) {
     __pyx_t_4 = __pyx_t_6;
     __pyx_v_suboffset = (__pyx_t_4[0]);
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_suboffset); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 581, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_suboffset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(1, 581, __pyx_L1_error)
+    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 581, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_2 = PyList_AsTuple(((PyObject*)__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 581, __pyx_L1_error)
+  __pyx_t_2 = PyList_AsTuple(((PyObject*)__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":577
@@ -10470,15 +10611,15 @@
  *     @property
  *     def ndim(self):
  *         return self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 585, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":584
  * 
@@ -10533,15 +10674,15 @@
  *     @property
  *     def itemsize(self):
  *         return self.view.itemsize             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 589, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 589, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":588
  * 
@@ -10598,19 +10739,19 @@
  *     @property
  *     def nbytes(self):
  *         return self.size * self.view.itemsize             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 593, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 593, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->view.itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 593, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
@@ -10699,27 +10840,27 @@
  *             for length in self.view.shape[:self.view.ndim]:             # <<<<<<<<<<<<<<
  *                 result *= length
  * 
  */
     __pyx_t_4 = (__pyx_v_self->view.shape + __pyx_v_self->view.ndim);
     for (__pyx_t_5 = __pyx_v_self->view.shape; __pyx_t_5 < __pyx_t_4; __pyx_t_5++) {
       __pyx_t_3 = __pyx_t_5;
-      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_3[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 600, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_3[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 600, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_XDECREF_SET(__pyx_v_length, __pyx_t_6);
       __pyx_t_6 = 0;
 
       /* "View.MemoryView":601
  * 
  *             for length in self.view.shape[:self.view.ndim]:
  *                 result *= length             # <<<<<<<<<<<<<<
  * 
  *             self._size = result
  */
-      __pyx_t_6 = PyNumber_InPlaceMultiply(__pyx_v_result, __pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 601, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_InPlaceMultiply(__pyx_v_result, __pyx_v_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF_SET(__pyx_v_result, __pyx_t_6);
       __pyx_t_6 = 0;
     }
 
     /* "View.MemoryView":603
  *                 result *= length
@@ -10892,49 +11033,49 @@
  * 
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,             # <<<<<<<<<<<<<<
  *                                                id(self))
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 614, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 614, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 614, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "View.MemoryView":615
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,
  *                                                id(self))             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self):
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_id, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 615, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_id, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
   /* "View.MemoryView":614
  * 
  *     def __repr__(self):
  *         return "<MemoryView of %r at 0x%x>" % (self.base.__class__.__name__,             # <<<<<<<<<<<<<<
  *                                                id(self))
  * 
  */
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 614, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 614, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":613
@@ -10993,28 +11134,28 @@
  * 
  *     def __str__(self):
  *         return "<MemoryView of %r object>" % (self.base.__class__.__name__,)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 618, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_class); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_name_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 618, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_object, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 618, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_MemoryView_of_r_object, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":617
@@ -11073,26 +11214,26 @@
   /* "View.MemoryView":624
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)             # <<<<<<<<<<<<<<
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 624, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(0, 624, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
   /* "View.MemoryView":625
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *     def is_f_contig(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'C', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 625, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'C', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":621
  * 
@@ -11149,26 +11290,26 @@
   /* "View.MemoryView":630
  *         cdef __Pyx_memviewslice *mslice
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)             # <<<<<<<<<<<<<<
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(1, 630, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_get_slice_from_memoryview(__pyx_v_self, (&__pyx_v_tmp)); if (unlikely(__pyx_t_1 == ((__Pyx_memviewslice *)NULL))) __PYX_ERR(0, 630, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
   /* "View.MemoryView":631
  *         cdef __Pyx_memviewslice tmp
  *         mslice = get_slice_from_memview(self, &tmp)
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)             # <<<<<<<<<<<<<<
  * 
  *     def copy(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'F', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 631, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_memviewslice_is_contig((__pyx_v_mslice[0]), 'F', __pyx_v_self->view.ndim)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":627
  *         return slice_is_contig(mslice[0], 'C', self.view.ndim)
@@ -11243,26 +11384,26 @@
   /* "View.MemoryView":638
  * 
  *         slice_copy(self, &mslice)
  *         mslice = slice_copy_contig(&mslice, "c", self.view.ndim,             # <<<<<<<<<<<<<<
  *                                    self.view.itemsize,
  *                                    flags|PyBUF_C_CONTIGUOUS,
  */
-  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_mslice), ((char *)"c"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_C_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 638, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_mslice), ((char *)"c"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_C_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 638, __pyx_L1_error)
   __pyx_v_mslice = __pyx_t_1;
 
   /* "View.MemoryView":643
  *                                    self.dtype_is_object)
  * 
  *         return memoryview_copy_from_slice(self, &mslice)             # <<<<<<<<<<<<<<
  * 
  *     def copy_fortran(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_mslice)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 643, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_mslice)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":633
  *         return slice_is_contig(mslice[0], 'F', self.view.ndim)
@@ -11338,26 +11479,26 @@
   /* "View.MemoryView":650
  * 
  *         slice_copy(self, &src)
  *         dst = slice_copy_contig(&src, "fortran", self.view.ndim,             # <<<<<<<<<<<<<<
  *                                 self.view.itemsize,
  *                                 flags|PyBUF_F_CONTIGUOUS,
  */
-  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_src), ((char *)"fortran"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_F_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 650, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_new_contig((&__pyx_v_src), ((char *)"fortran"), __pyx_v_self->view.ndim, __pyx_v_self->view.itemsize, (__pyx_v_flags | PyBUF_F_CONTIGUOUS), __pyx_v_self->dtype_is_object); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 650, __pyx_L1_error)
   __pyx_v_dst = __pyx_t_1;
 
   /* "View.MemoryView":655
  *                                 self.dtype_is_object)
  * 
  *         return memoryview_copy_from_slice(self, &dst)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_dst)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 655, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_copy_object_from_slice(__pyx_v_self, (&__pyx_v_dst)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":645
  *         return memoryview_copy_from_slice(self, &mslice)
@@ -11408,19 +11549,19 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 2, __pyx_L1_error)
+  __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
@@ -11464,19 +11605,19 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 4, __pyx_L1_error)
+  __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
@@ -11514,30 +11655,30 @@
   /* "View.MemoryView":660
  * @cname('__pyx_memoryview_new')
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):
  *     cdef memoryview result = memoryview(o, flags, dtype_is_object)             # <<<<<<<<<<<<<<
  *     result.typeinfo = typeinfo
  *     return result
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 660, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 660, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 660, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_o);
   __Pyx_GIVEREF(__pyx_v_o);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_o);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 660, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryview_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = ((struct __pyx_memoryview_obj *)__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":661
  * cdef memoryview_cwrapper(object o, int flags, bint dtype_is_object, __Pyx_TypeInfo *typeinfo):
@@ -11669,15 +11810,15 @@
     /* "View.MemoryView":674
  *     """
  *     if not isinstance(index, tuple):
  *         tup = (index,)             # <<<<<<<<<<<<<<
  *     else:
  *         tup = index
  */
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 674, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_index);
     __Pyx_GIVEREF(__pyx_v_index);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_index);
     __pyx_v_tup = __pyx_t_3;
     __pyx_t_3 = 0;
 
@@ -11707,15 +11848,15 @@
   /* "View.MemoryView":678
  *         tup = index
  * 
  *     result = []             # <<<<<<<<<<<<<<
  *     have_slices = False
  *     seen_ellipsis = False
  */
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 678, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_result = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
   /* "View.MemoryView":679
  * 
  *     result = []
@@ -11743,54 +11884,54 @@
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_t_3 = __pyx_int_0;
   if (likely(PyList_CheckExact(__pyx_v_tup)) || PyTuple_CheckExact(__pyx_v_tup)) {
     __pyx_t_4 = __pyx_v_tup; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_tup); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 681, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_tup); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 681, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 681, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_4))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 681, __pyx_L1_error)
+        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 681, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 681, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 681, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 681, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 681, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       }
     } else {
       __pyx_t_7 = __pyx_t_6(__pyx_t_4);
       if (unlikely(!__pyx_t_7)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 681, __pyx_L1_error)
+          else __PYX_ERR(0, 681, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_7);
     }
     __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_7);
     __pyx_t_7 = 0;
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_XDECREF_SET(__pyx_v_idx, __pyx_t_3);
-    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 681, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3);
     __pyx_t_3 = __pyx_t_7;
     __pyx_t_7 = 0;
 
     /* "View.MemoryView":682
  *     seen_ellipsis = False
@@ -11816,25 +11957,25 @@
         /* "View.MemoryView":684
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))             # <<<<<<<<<<<<<<
  *                 seen_ellipsis = True
  *             else:
  */
-        __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
-        __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 684, __pyx_L1_error)
+        __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 684, __pyx_L1_error)
+        __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
-            __Pyx_INCREF(__pyx_slice__19);
-            __Pyx_GIVEREF(__pyx_slice__19);
-            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__19);
+            __Pyx_INCREF(__pyx_slice__17);
+            __Pyx_GIVEREF(__pyx_slice__17);
+            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__17);
           }
         }
-        __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 684, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "View.MemoryView":685
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))
  *                 seen_ellipsis = True             # <<<<<<<<<<<<<<
  *             else:
@@ -11856,15 +11997,15 @@
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__19); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 687, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__17); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 687, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":688
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
@@ -11906,22 +12047,22 @@
         /* "View.MemoryView":691
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):
  *                 raise TypeError("Cannot index with type '%s'" % type(item))             # <<<<<<<<<<<<<<
  * 
  *             have_slices = have_slices or isinstance(item, slice)
  */
-        __pyx_t_7 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Cannot_index_with_type_s, ((PyObject *)Py_TYPE(__pyx_v_item))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 691, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Cannot_index_with_type_s, ((PyObject *)Py_TYPE(__pyx_v_item))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 691, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_11, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __PYX_ERR(1, 691, __pyx_L1_error)
+        __PYX_ERR(0, 691, __pyx_L1_error)
 
         /* "View.MemoryView":690
  *             have_slices = True
  *         else:
  *             if not isinstance(item, slice) and not PyIndex_Check(item):             # <<<<<<<<<<<<<<
  *                 raise TypeError("Cannot index with type '%s'" % type(item))
  * 
@@ -11950,15 +12091,15 @@
       /* "View.MemoryView":694
  * 
  *             have_slices = have_slices or isinstance(item, slice)
  *             result.append(item)             # <<<<<<<<<<<<<<
  * 
  *     nslices = ndim - len(result)
  */
-      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_v_item); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 694, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_v_item); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 694, __pyx_L1_error)
     }
     __pyx_L6:;
 
     /* "View.MemoryView":681
  *     have_slices = False
  *     seen_ellipsis = False
  *     for idx, item in enumerate(tup):             # <<<<<<<<<<<<<<
@@ -11972,15 +12113,15 @@
   /* "View.MemoryView":696
  *             result.append(item)
  * 
  *     nslices = ndim - len(result)             # <<<<<<<<<<<<<<
  *     if nslices:
  *         result.extend([slice(None)] * nslices)
  */
-  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_result); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(1, 696, __pyx_L1_error)
+  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_result); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 696, __pyx_L1_error)
   __pyx_v_nslices = (__pyx_v_ndim - __pyx_t_5);
 
   /* "View.MemoryView":697
  * 
  *     nslices = ndim - len(result)
  *     if nslices:             # <<<<<<<<<<<<<<
  *         result.extend([slice(None)] * nslices)
@@ -11992,24 +12133,24 @@
     /* "View.MemoryView":698
  *     nslices = ndim - len(result)
  *     if nslices:
  *         result.extend([slice(None)] * nslices)             # <<<<<<<<<<<<<<
  * 
  *     return have_slices or nslices, tuple(result)
  */
-    __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 698, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
-        __Pyx_INCREF(__pyx_slice__19);
-        __Pyx_GIVEREF(__pyx_slice__19);
-        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__19);
+        __Pyx_INCREF(__pyx_slice__17);
+        __Pyx_GIVEREF(__pyx_slice__17);
+        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__17);
       }
     }
-    __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 698, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "View.MemoryView":697
  * 
  *     nslices = ndim - len(result)
  *     if nslices:             # <<<<<<<<<<<<<<
  *         result.extend([slice(None)] * nslices)
@@ -12023,28 +12164,28 @@
  *     return have_slices or nslices, tuple(result)             # <<<<<<<<<<<<<<
  * 
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  */
   __Pyx_XDECREF(__pyx_r);
   if (!__pyx_v_have_slices) {
   } else {
-    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_have_slices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_have_slices); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __pyx_t_4;
     __pyx_t_4 = 0;
     goto __pyx_L14_bool_binop_done;
   }
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_nslices); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_nslices); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_L14_bool_binop_done:;
-  __pyx_t_4 = PyList_AsTuple(__pyx_v_result); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 700, __pyx_L1_error)
+  __pyx_t_4 = PyList_AsTuple(__pyx_v_result); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 700, __pyx_L1_error)
+  __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_4);
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
@@ -12125,19 +12266,19 @@
       /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 705, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(1, 705, __pyx_L1_error)
+      __PYX_ERR(0, 705, __pyx_L1_error)
 
       /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("Indirect dimensions not supported")
  * 
@@ -12236,15 +12377,15 @@
  * 
  *     if isinstance(memview, _memoryviewslice):
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(!Py_OptimizeFlag)) {
     if (unlikely(!((__pyx_v_memview->view.ndim > 0) != 0))) {
       PyErr_SetNone(PyExc_AssertionError);
-      __PYX_ERR(1, 724, __pyx_L1_error)
+      __PYX_ERR(0, 724, __pyx_L1_error)
     }
   }
   #endif
 
   /* "View.MemoryView":726
  *     assert memview.view.ndim > 0
  * 
@@ -12259,15 +12400,15 @@
     /* "View.MemoryView":727
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         memviewsliceobj = memview             # <<<<<<<<<<<<<<
  *         p_src = &memviewsliceobj.from_slice
  *     else:
  */
-    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 727, __pyx_L1_error)
+    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(0, 727, __pyx_L1_error)
     __pyx_t_3 = ((PyObject *)__pyx_v_memview);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_v_memviewsliceobj = ((struct __pyx_memoryviewslice_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
 
     /* "View.MemoryView":728
  *     if isinstance(memview, _memoryviewslice):
@@ -12355,44 +12496,44 @@
  *             slice_memviewslice(
  */
   __pyx_t_6 = 0;
   if (likely(PyList_CheckExact(__pyx_v_indices)) || PyTuple_CheckExact(__pyx_v_indices)) {
     __pyx_t_3 = __pyx_v_indices; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
     __pyx_t_8 = NULL;
   } else {
-    __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 748, __pyx_L1_error)
+    __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 748, __pyx_L1_error)
+    __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 748, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_8)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 748, __pyx_L1_error)
+        __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 748, __pyx_L1_error)
         #else
-        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 748, __pyx_L1_error)
+        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 748, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         #endif
       } else {
         if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(1, 748, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 748, __pyx_L1_error)
         #else
-        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 748, __pyx_L1_error)
+        __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 748, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         #endif
       }
     } else {
       __pyx_t_9 = __pyx_t_8(__pyx_t_3);
       if (unlikely(!__pyx_t_9)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(1, 748, __pyx_L1_error)
+          else __PYX_ERR(0, 748, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_9);
     }
     __Pyx_XDECREF_SET(__pyx_v_index, __pyx_t_9);
     __pyx_t_9 = 0;
@@ -12412,24 +12553,24 @@
       /* "View.MemoryView":753
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  *                 index, 0, 0, # start, stop, step             # <<<<<<<<<<<<<<
  *                 0, 0, 0, # have_{start,stop,step}
  *                 False)
  */
-      __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_index); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 753, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_index); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 753, __pyx_L1_error)
 
       /* "View.MemoryView":750
  *     for dim, index in enumerate(indices):
  *         if PyIndex_Check(index):
  *             slice_memviewslice(             # <<<<<<<<<<<<<<
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  */
-      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_t_10, 0, 0, 0, 0, 0, 0); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 750, __pyx_L1_error)
+      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_t_10, 0, 0, 0, 0, 0, 0); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 750, __pyx_L1_error)
 
       /* "View.MemoryView":749
  * 
  *     for dim, index in enumerate(indices):
  *         if PyIndex_Check(index):             # <<<<<<<<<<<<<<
  *             slice_memviewslice(
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
@@ -12498,21 +12639,21 @@
  *             new_ndim += 1
  *         else:
  *             start = index.start or 0             # <<<<<<<<<<<<<<
  *             stop = index.stop or 0
  *             step = index.step or 0
  */
     /*else*/ {
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 762, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 762, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 762, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 762, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 762, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 762, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L7_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L7_bool_binop_done:;
       __pyx_v_start = __pyx_t_10;
@@ -12520,21 +12661,21 @@
       /* "View.MemoryView":763
  *         else:
  *             start = index.start or 0
  *             stop = index.stop or 0             # <<<<<<<<<<<<<<
  *             step = index.step or 0
  * 
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 763, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 763, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 763, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 763, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 763, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L9_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L9_bool_binop_done:;
       __pyx_v_stop = __pyx_t_10;
@@ -12542,21 +12683,21 @@
       /* "View.MemoryView":764
  *             start = index.start or 0
  *             stop = index.stop or 0
  *             step = index.step or 0             # <<<<<<<<<<<<<<
  * 
  *             have_start = index.start is not None
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 764, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 764, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(1, 764, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 764, __pyx_L1_error)
       if (!__pyx_t_1) {
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else {
-        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 764, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 764, __pyx_L1_error)
         __pyx_t_10 = __pyx_t_12;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L11_bool_binop_done;
       }
       __pyx_t_10 = 0;
       __pyx_L11_bool_binop_done:;
       __pyx_v_step = __pyx_t_10;
@@ -12564,54 +12705,54 @@
       /* "View.MemoryView":766
  *             step = index.step or 0
  * 
  *             have_start = index.start is not None             # <<<<<<<<<<<<<<
  *             have_stop = index.stop is not None
  *             have_step = index.step is not None
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 766, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 766, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_start = __pyx_t_1;
 
       /* "View.MemoryView":767
  * 
  *             have_start = index.start is not None
  *             have_stop = index.stop is not None             # <<<<<<<<<<<<<<
  *             have_step = index.step is not None
  * 
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 767, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_stop); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 767, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_stop = __pyx_t_1;
 
       /* "View.MemoryView":768
  *             have_start = index.start is not None
  *             have_stop = index.stop is not None
  *             have_step = index.step is not None             # <<<<<<<<<<<<<<
  * 
  *             slice_memviewslice(
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 768, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_index, __pyx_n_s_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 768, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_1 = (__pyx_t_9 != Py_None);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_have_step = __pyx_t_1;
 
       /* "View.MemoryView":770
  *             have_step = index.step is not None
  * 
  *             slice_memviewslice(             # <<<<<<<<<<<<<<
  *                 p_dst, p_src.shape[dim], p_src.strides[dim], p_src.suboffsets[dim],
  *                 dim, new_ndim, p_suboffset_dim,
  */
-      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_v_start, __pyx_v_stop, __pyx_v_step, __pyx_v_have_start, __pyx_v_have_stop, __pyx_v_have_step, 1); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(1, 770, __pyx_L1_error)
+      __pyx_t_11 = __pyx_memoryview_slice_memviewslice(__pyx_v_p_dst, (__pyx_v_p_src->shape[__pyx_v_dim]), (__pyx_v_p_src->strides[__pyx_v_dim]), (__pyx_v_p_src->suboffsets[__pyx_v_dim]), __pyx_v_dim, __pyx_v_new_ndim, __pyx_v_p_suboffset_dim, __pyx_v_start, __pyx_v_stop, __pyx_v_step, __pyx_v_have_start, __pyx_v_have_stop, __pyx_v_have_step, 1); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 770, __pyx_L1_error)
 
       /* "View.MemoryView":776
  *                 have_start, have_stop, have_step,
  *                 True)
  *             new_ndim += 1             # <<<<<<<<<<<<<<
  * 
  *     if isinstance(memview, _memoryviewslice):
@@ -12653,35 +12794,35 @@
     /* "View.MemoryView":780
  *     if isinstance(memview, _memoryviewslice):
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,             # <<<<<<<<<<<<<<
  *                                     memviewsliceobj.to_dtype_func,
  *                                     memview.dtype_is_object)
  */
-    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 780, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(0, 780, __pyx_L1_error) }
 
     /* "View.MemoryView":781
  *         return memoryview_fromslice(dst, new_ndim,
  *                                     memviewsliceobj.to_object_func,
  *                                     memviewsliceobj.to_dtype_func,             # <<<<<<<<<<<<<<
  *                                     memview.dtype_is_object)
  *     else:
  */
-    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(1, 781, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_memviewsliceobj)) { __Pyx_RaiseUnboundLocalError("memviewsliceobj"); __PYX_ERR(0, 781, __pyx_L1_error) }
 
     /* "View.MemoryView":779
  * 
  *     if isinstance(memview, _memoryviewslice):
  *         return memoryview_fromslice(dst, new_ndim,             # <<<<<<<<<<<<<<
  *                                     memviewsliceobj.to_object_func,
  *                                     memviewsliceobj.to_dtype_func,
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, __pyx_v_memviewsliceobj->to_object_func, __pyx_v_memviewsliceobj->to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 779, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, __pyx_v_memviewsliceobj->to_object_func, __pyx_v_memviewsliceobj->to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 779, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(0, 779, __pyx_L1_error)
     __pyx_r = ((struct __pyx_memoryview_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":778
  *             new_ndim += 1
  * 
@@ -12704,25 +12845,25 @@
     /* "View.MemoryView":785
  *     else:
  *         return memoryview_fromslice(dst, new_ndim, NULL, NULL,
  *                                     memview.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, NULL, NULL, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 784, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dst, __pyx_v_new_ndim, NULL, NULL, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
 
     /* "View.MemoryView":784
  *                                     memview.dtype_is_object)
  *     else:
  *         return memoryview_fromslice(dst, new_ndim, NULL, NULL,             # <<<<<<<<<<<<<<
  *                                     memview.dtype_is_object)
  * 
  */
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(1, 784, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_memoryview_type))))) __PYX_ERR(0, 784, __pyx_L1_error)
     __pyx_r = ((struct __pyx_memoryview_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
     goto __pyx_L0;
   }
 
   /* "View.MemoryView":712
  * 
@@ -12820,15 +12961,15 @@
       /* "View.MemoryView":834
  *             start += shape
  *         if not 0 <= start < shape:
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)             # <<<<<<<<<<<<<<
  *     else:
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"Index out of bounds (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 834, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"Index out of bounds (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 834, __pyx_L1_error)
 
       /* "View.MemoryView":833
  *         if start < 0:
  *             start += shape
  *         if not 0 <= start < shape:             # <<<<<<<<<<<<<<
  *             _err_dim(IndexError, "Index out of bounds (axis %d)", dim)
  *     else:
@@ -12885,15 +13026,15 @@
       /* "View.MemoryView":840
  * 
  *         if have_step and step == 0:
  *             _err_dim(ValueError, "Step may not be zero (axis %d)", dim)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Step may not be zero (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 840, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Step may not be zero (axis %d)"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 840, __pyx_L1_error)
 
       /* "View.MemoryView":839
  *         negative_step = have_step != 0 and step < 0
  * 
  *         if have_step and step == 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Step may not be zero (axis %d)", dim)
  * 
@@ -13457,15 +13598,15 @@
         /* "View.MemoryView":902
  *             else:
  *                 _err_dim(IndexError, "All dimensions preceding dimension %d "
  *                                      "must be indexed and not sliced", dim)             # <<<<<<<<<<<<<<
  *         else:
  *             suboffset_dim[0] = new_ndim
  */
-        __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"All dimensions preceding dimension %d must be indexed and not sliced"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 901, __pyx_L1_error)
+        __pyx_t_3 = __pyx_memoryview_err_dim(__pyx_builtin_IndexError, ((char *)"All dimensions preceding dimension %d must be indexed and not sliced"), __pyx_v_dim); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 901, __pyx_L1_error)
       }
       __pyx_L26:;
 
       /* "View.MemoryView":897
  * 
  *     if suboffset >= 0:
  *         if not is_slice:             # <<<<<<<<<<<<<<
@@ -13589,19 +13730,19 @@
  *     if view.ndim == 0:
  *         shape = view.len / itemsize             # <<<<<<<<<<<<<<
  *         stride = itemsize
  *     else:
  */
     if (unlikely(__pyx_v_itemsize == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-      __PYX_ERR(1, 919, __pyx_L1_error)
+      __PYX_ERR(0, 919, __pyx_L1_error)
     }
     else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((Py_ssize_t)-1) > 0)) && unlikely(__pyx_v_itemsize == (Py_ssize_t)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_view->len))) {
       PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-      __PYX_ERR(1, 919, __pyx_L1_error)
+      __PYX_ERR(0, 919, __pyx_L1_error)
     }
     __pyx_v_shape = __Pyx_div_Py_ssize_t(__pyx_v_view->len, __pyx_v_itemsize);
 
     /* "View.MemoryView":920
  *     if view.ndim == 0:
  *         shape = view.len / itemsize
  *         stride = itemsize             # <<<<<<<<<<<<<<
@@ -13701,25 +13842,25 @@
       /* "View.MemoryView":930
  *         index += view.shape[dim]
  *         if index < 0:
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)             # <<<<<<<<<<<<<<
  * 
  *     if index >= shape:
  */
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 930, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 930, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 930, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 930, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(1, 930, __pyx_L1_error)
+      __PYX_ERR(0, 930, __pyx_L1_error)
 
       /* "View.MemoryView":929
  *     if index < 0:
  *         index += view.shape[dim]
  *         if index < 0:             # <<<<<<<<<<<<<<
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
@@ -13748,25 +13889,25 @@
     /* "View.MemoryView":933
  * 
  *     if index >= shape:
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)             # <<<<<<<<<<<<<<
  * 
  *     resultp = bufp + index * stride
  */
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 933, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 933, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 933, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 933, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 933, __pyx_L1_error)
+    __PYX_ERR(0, 933, __pyx_L1_error)
 
     /* "View.MemoryView":932
  *             raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
  *     if index >= shape:             # <<<<<<<<<<<<<<
  *         raise IndexError("Out of bounds on buffer access (axis %d)" % dim)
  * 
@@ -13963,15 +14104,15 @@
       /* "View.MemoryView":959
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")             # <<<<<<<<<<<<<<
  * 
  *     return 1
  */
-      __pyx_t_9 = __pyx_memoryview_err(__pyx_builtin_ValueError, ((char *)"Cannot transpose memoryview with indirect dimensions")); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 959, __pyx_L1_error)
+      __pyx_t_9 = __pyx_memoryview_err(__pyx_builtin_ValueError, ((char *)"Cannot transpose memoryview with indirect dimensions")); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 959, __pyx_L1_error)
 
       /* "View.MemoryView":958
  *         shape[i], shape[j] = shape[j], shape[i]
  * 
  *         if memslice.suboffsets[i] >= 0 or memslice.suboffsets[j] >= 0:             # <<<<<<<<<<<<<<
  *             _err(ValueError, "Cannot transpose memoryview with indirect dimensions")
  * 
@@ -14089,15 +14230,15 @@
  *     cdef convert_item_to_object(self, char *itemp):
  *         if self.to_object_func != NULL:
  *             return self.to_object_func(itemp)             # <<<<<<<<<<<<<<
  *         else:
  *             return memoryview.convert_item_to_object(self, itemp)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __pyx_v_self->to_object_func(__pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 983, __pyx_L1_error)
+    __pyx_t_2 = __pyx_v_self->to_object_func(__pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":982
  * 
@@ -14113,15 +14254,15 @@
  *         else:
  *             return memoryview.convert_item_to_object(self, itemp)             # <<<<<<<<<<<<<<
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = __pyx_memoryview_convert_item_to_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 985, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_convert_item_to_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
   }
 
   /* "View.MemoryView":981
@@ -14175,15 +14316,15 @@
     /* "View.MemoryView":989
  *     cdef assign_item_from_object(self, char *itemp, object value):
  *         if self.to_dtype_func != NULL:
  *             self.to_dtype_func(itemp, value)             # <<<<<<<<<<<<<<
  *         else:
  *             memoryview.assign_item_from_object(self, itemp, value)
  */
-    __pyx_t_2 = __pyx_v_self->to_dtype_func(__pyx_v_itemp, __pyx_v_value); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(1, 989, __pyx_L1_error)
+    __pyx_t_2 = __pyx_v_self->to_dtype_func(__pyx_v_itemp, __pyx_v_value); if (unlikely(__pyx_t_2 == ((int)0))) __PYX_ERR(0, 989, __pyx_L1_error)
 
     /* "View.MemoryView":988
  * 
  *     cdef assign_item_from_object(self, char *itemp, object value):
  *         if self.to_dtype_func != NULL:             # <<<<<<<<<<<<<<
  *             self.to_dtype_func(itemp, value)
  *         else:
@@ -14195,15 +14336,15 @@
  *             self.to_dtype_func(itemp, value)
  *         else:
  *             memoryview.assign_item_from_object(self, itemp, value)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   /*else*/ {
-    __pyx_t_3 = __pyx_memoryview_assign_item_from_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 991, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_assign_item_from_object(((struct __pyx_memoryview_obj *)__pyx_v_self), __pyx_v_itemp, __pyx_v_value); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_L3:;
 
   /* "View.MemoryView":987
  *             return memoryview.convert_item_to_object(self, itemp)
@@ -14309,19 +14450,19 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 2, __pyx_L1_error)
+  __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
@@ -14365,19 +14506,19 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 4, __pyx_L1_error)
+  __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
@@ -14453,28 +14594,28 @@
   /* "View.MemoryView":1015
  * 
  * 
  *     result = _memoryviewslice(None, 0, dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  *     result.from_slice = memviewslice
  */
-  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1015, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_v_dtype_is_object); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1015, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyTuple_SET_ITEM(__pyx_t_3, 0, Py_None);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryviewslice_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1015, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_memoryviewslice_type), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = ((struct __pyx_memoryviewslice_obj *)__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":1017
  *     result = _memoryviewslice(None, 0, dtype_is_object)
@@ -14497,15 +14638,15 @@
   /* "View.MemoryView":1020
  *     __PYX_INC_MEMVIEW(&memviewslice, 1)
  * 
  *     result.from_object = (<memoryview> memviewslice.memview).base             # <<<<<<<<<<<<<<
  *     result.typeinfo = memviewslice.memview.typeinfo
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_memviewslice.memview), __pyx_n_s_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1020, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_memviewslice.memview), __pyx_n_s_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_result->from_object);
   __Pyx_DECREF(__pyx_v_result->from_object);
   __pyx_v_result->from_object = __pyx_t_2;
   __pyx_t_2 = 0;
 
@@ -14700,32 +14841,32 @@
  *     for length in result.view.shape[:ndim]:             # <<<<<<<<<<<<<<
  *         result.view.len *= length
  * 
  */
   __pyx_t_7 = (__pyx_v_result->__pyx_base.view.shape + __pyx_v_ndim);
   for (__pyx_t_8 = __pyx_v_result->__pyx_base.view.shape; __pyx_t_8 < __pyx_t_7; __pyx_t_8++) {
     __pyx_t_6 = __pyx_t_8;
-    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_6[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1045, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_6[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_length, __pyx_t_2);
     __pyx_t_2 = 0;
 
     /* "View.MemoryView":1046
  *     result.view.len = result.view.itemsize
  *     for length in result.view.shape[:ndim]:
  *         result.view.len *= length             # <<<<<<<<<<<<<<
  * 
  *     result.to_object_func = to_object_func
  */
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_result->__pyx_base.view.len); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1046, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_result->__pyx_base.view.len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_InPlaceMultiply(__pyx_t_2, __pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1046, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceMultiply(__pyx_t_2, __pyx_v_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1046, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(1, 1046, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1046, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_result->__pyx_base.view.len = __pyx_t_9;
   }
 
   /* "View.MemoryView":1048
  *         result.view.len *= length
  * 
@@ -14812,15 +14953,15 @@
     /* "View.MemoryView":1058
  *     cdef _memoryviewslice obj
  *     if isinstance(memview, _memoryviewslice):
  *         obj = memview             # <<<<<<<<<<<<<<
  *         return &obj.from_slice
  *     else:
  */
-    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(1, 1058, __pyx_L1_error)
+    if (!(likely(((((PyObject *)__pyx_v_memview)) == Py_None) || likely(__Pyx_TypeTest(((PyObject *)__pyx_v_memview), __pyx_memoryviewslice_type))))) __PYX_ERR(0, 1058, __pyx_L1_error)
     __pyx_t_3 = ((PyObject *)__pyx_v_memview);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_v_obj = ((struct __pyx_memoryviewslice_obj *)__pyx_t_3);
     __pyx_t_3 = 0;
 
     /* "View.MemoryView":1059
  *     if isinstance(memview, _memoryviewslice):
@@ -15038,15 +15179,15 @@
  *     cdef __Pyx_memviewslice memviewslice
  *     slice_copy(memview, &memviewslice)
  *     return memoryview_copy_from_slice(memview, &memviewslice)             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_object_from_slice')
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_copy_object_from_slice(__pyx_v_memview, (&__pyx_v_memviewslice)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1086, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_copy_object_from_slice(__pyx_v_memview, (&__pyx_v_memviewslice)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":1082
  * 
@@ -15164,15 +15305,15 @@
   /* "View.MemoryView":1105
  *     return memoryview_fromslice(memviewslice[0], memview.view.ndim,
  *                                 to_object_func, to_dtype_func,
  *                                 memview.dtype_is_object)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5 = __pyx_memoryview_fromslice((__pyx_v_memviewslice[0]), __pyx_v_memview->view.ndim, __pyx_v_to_object_func, __pyx_v_to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 1103, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice((__pyx_v_memviewslice[0]), __pyx_v_memview->view.ndim, __pyx_v_to_object_func, __pyx_v_to_dtype_func, __pyx_v_memview->dtype_is_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
   /* "View.MemoryView":1089
  * 
@@ -15975,15 +16116,15 @@
     /* "View.MemoryView":1226
  *     result = malloc(size)
  *     if not result:
  *         _err(MemoryError, NULL)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_err(__pyx_builtin_MemoryError, NULL); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(1, 1226, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_err(__pyx_builtin_MemoryError, NULL); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1226, __pyx_L1_error)
 
     /* "View.MemoryView":1225
  * 
  *     result = malloc(size)
  *     if not result:             # <<<<<<<<<<<<<<
  *         _err(MemoryError, NULL)
  * 
@@ -16191,21 +16332,21 @@
   /* "View.MemoryView":1256
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %
  *                                                         (i, extent1, extent2))             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_err_dim')
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1256, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_extent1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1256, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_extent1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_extent2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1256, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_extent2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1256, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
@@ -16216,23 +16357,23 @@
   /* "View.MemoryView":1255
  * cdef int _err_extents(int i, Py_ssize_t extent1,
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %             # <<<<<<<<<<<<<<
  *                                                         (i, extent1, extent2))
  * 
  */
-  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1255, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1255, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1255, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_Raise(__pyx_t_4, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __PYX_ERR(1, 1255, __pyx_L1_error)
+  __PYX_ERR(0, 1255, __pyx_L1_error)
 
   /* "View.MemoryView":1253
  * 
  * @cname('__pyx_memoryview_err_extents')
  * cdef int _err_extents(int i, Py_ssize_t extent1,             # <<<<<<<<<<<<<<
  *                              Py_ssize_t extent2) except -1 with gil:
  *     raise ValueError("got differing extents in dimension %d (got %d and %d)" %
@@ -16280,19 +16421,19 @@
   /* "View.MemoryView":1260
  * @cname('__pyx_memoryview_err_dim')
  * cdef int _err_dim(object error, char *msg, int dim) except -1 with gil:
  *     raise error(msg.decode('ascii') % dim)             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_err')
  */
-  __pyx_t_2 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1260, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1260, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_dim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyUnicode_Format(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1260, __pyx_L1_error)
+  __pyx_t_4 = PyUnicode_Format(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_INCREF(__pyx_v_error);
   __pyx_t_3 = __pyx_v_error; __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -16302,20 +16443,20 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1260, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(1, 1260, __pyx_L1_error)
+  __PYX_ERR(0, 1260, __pyx_L1_error)
 
   /* "View.MemoryView":1259
  * 
  * @cname('__pyx_memoryview_err_dim')
  * cdef int _err_dim(object error, char *msg, int dim) except -1 with gil:             # <<<<<<<<<<<<<<
  *     raise error(msg.decode('ascii') % dim)
  * 
@@ -16375,15 +16516,15 @@
     /* "View.MemoryView":1265
  * cdef int _err(object error, char *msg) except -1 with gil:
  *     if msg != NULL:
  *         raise error(msg.decode('ascii'))             # <<<<<<<<<<<<<<
  *     else:
  *         raise error
  */
-    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1265, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_decode_c_string(__pyx_v_msg, 0, strlen(__pyx_v_msg), NULL, NULL, PyUnicode_DecodeASCII); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_error);
     __pyx_t_4 = __pyx_v_error; __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -16391,20 +16532,20 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1265, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(1, 1265, __pyx_L1_error)
+    __PYX_ERR(0, 1265, __pyx_L1_error)
 
     /* "View.MemoryView":1264
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:
  *     if msg != NULL:             # <<<<<<<<<<<<<<
  *         raise error(msg.decode('ascii'))
  *     else:
@@ -16416,15 +16557,15 @@
  *     else:
  *         raise error             # <<<<<<<<<<<<<<
  * 
  * @cname('__pyx_memoryview_copy_contents')
  */
   /*else*/ {
     __Pyx_Raise(__pyx_v_error, 0, 0, 0);
-    __PYX_ERR(1, 1267, __pyx_L1_error)
+    __PYX_ERR(0, 1267, __pyx_L1_error)
   }
 
   /* "View.MemoryView":1263
  * 
  * @cname('__pyx_memoryview_err')
  * cdef int _err(object error, char *msg) except -1 with gil:             # <<<<<<<<<<<<<<
  *     if msg != NULL:
@@ -16661,15 +16802,15 @@
  *                 src.strides[i] = 0
  *             else:
  *                 _err_extents(i, dst.shape[i], src.shape[i])             # <<<<<<<<<<<<<<
  * 
  *         if src.suboffsets[i] >= 0:
  */
       /*else*/ {
-        __pyx_t_6 = __pyx_memoryview_err_extents(__pyx_v_i, (__pyx_v_dst.shape[__pyx_v_i]), (__pyx_v_src.shape[__pyx_v_i])); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1299, __pyx_L1_error)
+        __pyx_t_6 = __pyx_memoryview_err_extents(__pyx_v_i, (__pyx_v_dst.shape[__pyx_v_i]), (__pyx_v_src.shape[__pyx_v_i])); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1299, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":1294
  * 
  *     for i in range(ndim):
  *         if src.shape[i] != dst.shape[i]:             # <<<<<<<<<<<<<<
@@ -16691,15 +16832,15 @@
       /* "View.MemoryView":1302
  * 
  *         if src.suboffsets[i] >= 0:
  *             _err_dim(ValueError, "Dimension %d is not direct", i)             # <<<<<<<<<<<<<<
  * 
  *     if slices_overlap(&src, &dst, ndim, itemsize):
  */
-      __pyx_t_6 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Dimension %d is not direct"), __pyx_v_i); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(1, 1302, __pyx_L1_error)
+      __pyx_t_6 = __pyx_memoryview_err_dim(__pyx_builtin_ValueError, ((char *)"Dimension %d is not direct"), __pyx_v_i); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1302, __pyx_L1_error)
 
       /* "View.MemoryView":1301
  *                 _err_extents(i, dst.shape[i], src.shape[i])
  * 
  *         if src.suboffsets[i] >= 0:             # <<<<<<<<<<<<<<
  *             _err_dim(ValueError, "Dimension %d is not direct", i)
  * 
@@ -16748,15 +16889,15 @@
     /* "View.MemoryView":1309
  *             order = get_best_order(&dst, ndim)
  * 
  *         tmpdata = copy_data_to_temp(&src, &tmp, order, ndim)             # <<<<<<<<<<<<<<
  *         src = tmp
  * 
  */
-    __pyx_t_7 = __pyx_memoryview_copy_data_to_temp((&__pyx_v_src), (&__pyx_v_tmp), __pyx_v_order, __pyx_v_ndim); if (unlikely(__pyx_t_7 == ((void *)NULL))) __PYX_ERR(1, 1309, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_copy_data_to_temp((&__pyx_v_src), (&__pyx_v_tmp), __pyx_v_order, __pyx_v_ndim); if (unlikely(__pyx_t_7 == ((void *)NULL))) __PYX_ERR(0, 1309, __pyx_L1_error)
     __pyx_v_tmpdata = __pyx_t_7;
 
     /* "View.MemoryView":1310
  * 
  *         tmpdata = copy_data_to_temp(&src, &tmp, order, ndim)
  *         src = tmp             # <<<<<<<<<<<<<<
  * 
@@ -16932,24 +17073,24 @@
     /* "View.MemoryView":1331
  * 
  * 
  *         transpose_memslice(&src)             # <<<<<<<<<<<<<<
  *         transpose_memslice(&dst)
  * 
  */
-    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_src)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1331, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_src)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(0, 1331, __pyx_L1_error)
 
     /* "View.MemoryView":1332
  * 
  *         transpose_memslice(&src)
  *         transpose_memslice(&dst)             # <<<<<<<<<<<<<<
  * 
  *     refcount_copying(&dst, dtype_is_object, ndim, False)
  */
-    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_dst)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(1, 1332, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memslice_transpose((&__pyx_v_dst)); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(0, 1332, __pyx_L1_error)
 
     /* "View.MemoryView":1328
  *             return 0
  * 
  *     if order == 'F' == get_best_order(&dst, ndim):             # <<<<<<<<<<<<<<
  * 
  * 
@@ -17579,40 +17720,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_type)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_checksum)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, 1); __PYX_ERR(1, 1, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, 1); __PYX_ERR(0, 1, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_state)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, 2); __PYX_ERR(1, 1, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, 2); __PYX_ERR(0, 1, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_unpickle_Enum") < 0)) __PYX_ERR(1, 1, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_unpickle_Enum") < 0)) __PYX_ERR(0, 1, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v___pyx_type = values[0];
-    __pyx_v___pyx_checksum = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v___pyx_checksum == (long)-1) && PyErr_Occurred())) __PYX_ERR(1, 1, __pyx_L3_error)
+    __pyx_v___pyx_checksum = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v___pyx_checksum == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1, __pyx_L3_error)
     __pyx_v___pyx_state = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 1, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_Enum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(__pyx_self, __pyx_v___pyx_type, __pyx_v___pyx_checksum, __pyx_v___pyx_state);
 
@@ -17640,53 +17781,53 @@
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
-  __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__23, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__21, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
  *         from pickle import PickleError as __pyx_PickleError             # <<<<<<<<<<<<<<
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)
  */
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_s_PickleError);
     __Pyx_GIVEREF(__pyx_n_s_PickleError);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_PickleError);
-    __pyx_t_4 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_t_1);
     __pyx_v___pyx_PickleError = __pyx_t_1;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":6
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)             # <<<<<<<<<<<<<<
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:
  */
-    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_INCREF(__pyx_v___pyx_PickleError);
     __pyx_t_1 = __pyx_v___pyx_PickleError; __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
@@ -17695,20 +17836,20 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 6, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(1, 6, __pyx_L1_error)
+    __PYX_ERR(0, 6, __pyx_L1_error)
 
     /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
@@ -17718,29 +17859,29 @@
   /* "(tree fragment)":7
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)             # <<<<<<<<<<<<<<
  *     if __pyx_state is not None:
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_MemviewEnum_type), __pyx_n_s_new); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 7, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_MemviewEnum_type), __pyx_n_s_new); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v___pyx_type);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 7, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v___pyx_result = __pyx_t_4;
   __pyx_t_4 = 0;
 
   /* "(tree fragment)":8
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
@@ -17756,16 +17897,16 @@
     /* "(tree fragment)":9
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)             # <<<<<<<<<<<<<<
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  */
-    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 9, __pyx_L1_error)
-    __pyx_t_4 = __pyx_unpickle_Enum__set_state(((struct __pyx_MemviewEnum_obj *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 9, __pyx_L1_error)
+    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(0, 9, __pyx_L1_error)
+    __pyx_t_4 = __pyx_unpickle_Enum__set_state(((struct __pyx_MemviewEnum_obj *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 9, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":8
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  *     __pyx_result = Enum.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
@@ -17837,17 +17978,17 @@
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  *     __pyx_result.name = __pyx_state[0]             # <<<<<<<<<<<<<<
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  *         __pyx_result.__dict__.update(__pyx_state[1])
  */
   if (unlikely(__pyx_v___pyx_state == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-    __PYX_ERR(1, 12, __pyx_L1_error)
+    __PYX_ERR(0, 12, __pyx_L1_error)
   }
-  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v___pyx_result->name);
   __Pyx_DECREF(__pyx_v___pyx_result->name);
   __pyx_v___pyx_result->name = __pyx_t_1;
   __pyx_t_1 = 0;
 
@@ -17855,59 +17996,59 @@
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):             # <<<<<<<<<<<<<<
  *         __pyx_result.__dict__.update(__pyx_state[1])
  */
   if (unlikely(__pyx_v___pyx_state == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(1, 13, __pyx_L1_error)
+    __PYX_ERR(0, 13, __pyx_L1_error)
   }
-  __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v___pyx_state); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(1, 13, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v___pyx_state); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 13, __pyx_L1_error)
   __pyx_t_4 = ((__pyx_t_3 > 1) != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = __Pyx_HasAttr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 13, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_HasAttr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 13, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_4 != 0);
   __pyx_t_2 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
 
     /* "(tree fragment)":14
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  *         __pyx_result.__dict__.update(__pyx_state[1])             # <<<<<<<<<<<<<<
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 14, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_update); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_update); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 14, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (unlikely(__pyx_v___pyx_state == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(1, 14, __pyx_L1_error)
+      __PYX_ERR(0, 14, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 14, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 14, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
     /* "(tree fragment)":13
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):
  *     __pyx_result.name = __pyx_state[0]
@@ -17935,14 +18076,167 @@
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
+static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o);
+  p->__pyx_vtab = __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+  p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(o, a, k) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->EOBpars);
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+  if (p->EOBpars) {
+    e = (*v)(((PyObject *)p->EOBpars), a); if (e) return e;
+  }
+  return 0;
+}
+
+static int __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o) {
+  PyObject* tmp;
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+  tmp = ((PyObject*)p->EOBpars);
+  p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(o);
+  }
+}
+
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C[] = {
+  {"_call", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call, METH_VARARGS|METH_KEYWORDS, 0},
+  {"grad", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad, METH_VARARGS|METH_KEYWORDS, 0},
+  {"hessian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian, METH_VARARGS|METH_KEYWORDS, 0},
+  {"csi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi, METH_VARARGS|METH_KEYWORDS, 0},
+  {"dynamics", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics, METH_VARARGS|METH_KEYWORDS, 0},
+  {"omega", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega, METH_VARARGS|METH_KEYWORDS, 0},
+  {"auxderivs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs, METH_VARARGS|METH_KEYWORDS, 0},
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__, METH_O, 0},
+  {0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C[] = {
+  {(char *)"EOBpars", __pyx_getprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars, __pyx_setprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars, (char *)0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PyTypeObject __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  0, /*tp_doc*/
+  __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_traverse*/
+  __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_methods*/
+  0, /*tp_members*/
+  __pyx_getsets_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_array_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
@@ -18058,15 +18352,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.auxiliary.interpolate._ppoly.array", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_C.array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18180,15 +18474,15 @@
   {"__reduce_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_1__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_3__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.auxiliary.interpolate._ppoly.Enum", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_C.Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18444,15 +18738,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.auxiliary.interpolate._ppoly.memoryview", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_C.memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18585,15 +18879,15 @@
 static struct PyGetSetDef __pyx_getsets__memoryviewslice[] = {
   {(char *)"base", __pyx_getprop___pyx_memoryviewslice_base, 0, (char *)0, 0},
   {0, 0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.auxiliary.interpolate._ppoly._memoryviewslice", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_C._memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18670,25 +18964,25 @@
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec__ppoly(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_Hamiltonian_C(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec__ppoly},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_Hamiltonian_C},
   {0, NULL}
 };
 #endif
 
 static struct PyModuleDef __pyx_moduledef = {
     PyModuleDef_HEAD_INIT,
-    "_ppoly",
+    "Hamiltonian_C",
     0, /* m_doc */
   #if CYTHON_PEP489_MULTI_PHASE_INIT
     0, /* m_size */
   #else
     -1, /* m_size */
   #endif
     __pyx_methods /* m_methods */,
@@ -18709,461 +19003,428 @@
     #define CYTHON_SMALL_CODE __attribute__((cold))
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
-  {&__pyx_kp_s_, __pyx_k_, sizeof(__pyx_k_), 0, 0, 1, 0},
   {&__pyx_n_s_ASCII, __pyx_k_ASCII, sizeof(__pyx_k_ASCII), 0, 0, 1, 1},
   {&__pyx_kp_s_Buffer_view_does_not_expose_stri, __pyx_k_Buffer_view_does_not_expose_stri, sizeof(__pyx_k_Buffer_view_does_not_expose_stri), 0, 0, 1, 0},
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
+  {&__pyx_n_s_EOBParams, __pyx_k_EOBParams, sizeof(__pyx_k_EOBParams), 0, 0, 1, 1},
   {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
   {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
-  {&__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_k_Expected_at_least_d_argument_s_g, sizeof(__pyx_k_Expected_at_least_d_argument_s_g), 0, 0, 1, 0},
-  {&__pyx_kp_s_Function_call_with_ambiguous_arg, __pyx_k_Function_call_with_ambiguous_arg, sizeof(__pyx_k_Function_call_with_ambiguous_arg), 0, 0, 1, 0},
+  {&__pyx_n_s_Hamiltonian_C, __pyx_k_Hamiltonian_C, sizeof(__pyx_k_Hamiltonian_C), 0, 0, 1, 1},
   {&__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_k_Incompatible_checksums_0x_x_vs_0, sizeof(__pyx_k_Incompatible_checksums_0x_x_vs_0), 0, 0, 1, 0},
   {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
   {&__pyx_kp_s_Indirect_dimensions_not_supporte, __pyx_k_Indirect_dimensions_not_supporte, sizeof(__pyx_k_Indirect_dimensions_not_supporte), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_k_Invalid_mode_expected_c_or_fortr, sizeof(__pyx_k_Invalid_mode_expected_c_or_fortr), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_k_Invalid_shape_in_axis_d_d, sizeof(__pyx_k_Invalid_shape_in_axis_d_d), 0, 0, 1, 0},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_k_MemoryView_of_r_at_0x_x, sizeof(__pyx_k_MemoryView_of_r_at_0x_x), 0, 0, 1, 0},
   {&__pyx_kp_s_MemoryView_of_r_object, __pyx_k_MemoryView_of_r_object, sizeof(__pyx_k_MemoryView_of_r_object), 0, 0, 1, 0},
-  {&__pyx_kp_s_No_matching_signature_found, __pyx_k_No_matching_signature_found, sizeof(__pyx_k_No_matching_signature_found), 0, 0, 1, 0},
   {&__pyx_n_b_O, __pyx_k_O, sizeof(__pyx_k_O), 0, 0, 0, 1},
   {&__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_k_Out_of_bounds_on_buffer_access_a, sizeof(__pyx_k_Out_of_bounds_on_buffer_access_a), 0, 0, 1, 0},
   {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
-  {&__pyx_kp_s__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 0, 1, 0},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
-  {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
+  {&__pyx_n_s_auxderivs, __pyx_k_auxderivs, sizeof(__pyx_k_auxderivs), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
+  {&__pyx_n_s_call, __pyx_k_call, sizeof(__pyx_k_call), 0, 0, 1, 1},
+  {&__pyx_n_s_chi_1, __pyx_k_chi_1, sizeof(__pyx_k_chi_1), 0, 0, 1, 1},
+  {&__pyx_n_s_chi_2, __pyx_k_chi_2, sizeof(__pyx_k_chi_2), 0, 0, 1, 1},
   {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
-  {&__pyx_n_s_defaults, __pyx_k_defaults, sizeof(__pyx_k_defaults), 0, 0, 1, 1},
+  {&__pyx_n_s_csi, __pyx_k_csi, sizeof(__pyx_k_csi), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
-  {&__pyx_n_s_double, __pyx_k_double, sizeof(__pyx_k_double), 0, 0, 1, 1},
-  {&__pyx_kp_s_double_complex, __pyx_k_double_complex, sizeof(__pyx_k_double_complex), 0, 0, 1, 0},
-  {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
-  {&__pyx_n_s_dx, __pyx_k_dx, sizeof(__pyx_k_dx), 0, 0, 1, 1},
+  {&__pyx_n_s_dynamics, __pyx_k_dynamics, sizeof(__pyx_k_dynamics), 0, 0, 1, 1},
   {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
   {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
-  {&__pyx_n_s_evaluate, __pyx_k_evaluate, sizeof(__pyx_k_evaluate), 0, 0, 1, 1},
-  {&__pyx_n_s_extrapolate, __pyx_k_extrapolate, sizeof(__pyx_k_extrapolate), 0, 0, 1, 1},
   {&__pyx_n_s_flags, __pyx_k_flags, sizeof(__pyx_k_flags), 0, 0, 1, 1},
   {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
   {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 0, 1, 0},
-  {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
+  {&__pyx_n_s_grad, __pyx_k_grad, sizeof(__pyx_k_grad), 0, 0, 1, 1},
+  {&__pyx_n_s_hessian, __pyx_k_hessian, sizeof(__pyx_k_hessian), 0, 0, 1, 1},
   {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
-  {&__pyx_n_s_indices, __pyx_k_indices, sizeof(__pyx_k_indices), 0, 0, 1, 1},
-  {&__pyx_n_s_interval, __pyx_k_interval, sizeof(__pyx_k_interval), 0, 0, 1, 1},
-  {&__pyx_n_s_ip, __pyx_k_ip, sizeof(__pyx_k_ip), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
-  {&__pyx_n_s_jp, __pyx_k_jp, sizeof(__pyx_k_jp), 0, 0, 1, 1},
-  {&__pyx_n_s_kind, __pyx_k_kind, sizeof(__pyx_k_kind), 0, 0, 1, 1},
-  {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
+  {&__pyx_n_s_m_1, __pyx_k_m_1, sizeof(__pyx_k_m_1), 0, 0, 1, 1},
+  {&__pyx_n_s_m_2, __pyx_k_m_2, sizeof(__pyx_k_m_2), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
   {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
   {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
   {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
   {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
-  {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
-  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
   {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
-  {&__pyx_n_s_out, __pyx_k_out, sizeof(__pyx_k_out), 0, 0, 1, 1},
+  {&__pyx_n_s_omega, __pyx_k_omega, sizeof(__pyx_k_omega), 0, 0, 1, 1},
+  {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
   {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
-  {&__pyx_kp_s_pyseobnr_auxiliary_interpolate, __pyx_k_pyseobnr_auxiliary_interpolate, sizeof(__pyx_k_pyseobnr_auxiliary_interpolate), 0, 0, 1, 0},
-  {&__pyx_n_s_pyseobnr_auxiliary_interpolate_2, __pyx_k_pyseobnr_auxiliary_interpolate_2, sizeof(__pyx_k_pyseobnr_auxiliary_interpolate_2), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
+  {&__pyx_n_s_q, __pyx_k_q, sizeof(__pyx_k_q), 0, 0, 1, 1},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
-  {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
   {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
   {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
   {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
-  {&__pyx_n_s_signatures, __pyx_k_signatures, sizeof(__pyx_k_signatures), 0, 0, 1, 1},
   {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
-  {&__pyx_n_s_split, __pyx_k_split, sizeof(__pyx_k_split), 0, 0, 1, 1},
   {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
   {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
   {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
-  {&__pyx_n_s_stored_index, __pyx_k_stored_index, sizeof(__pyx_k_stored_index), 0, 0, 1, 1},
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
-  {&__pyx_n_s_strip, __pyx_k_strip, sizeof(__pyx_k_strip), 0, 0, 1, 1},
   {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
   {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
   {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
-  {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
-  {&__pyx_n_s_xp, __pyx_k_xp, sizeof(__pyx_k_xp), 0, 0, 1, 1},
-  {&__pyx_n_s_xval, __pyx_k_xval, sizeof(__pyx_k_xval), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 29, __pyx_L1_error)
-  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 134, __pyx_L1_error)
-  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 149, __pyx_L1_error)
-  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 152, __pyx_L1_error)
-  __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 406, __pyx_L1_error)
-  __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 615, __pyx_L1_error)
-  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 834, __pyx_L1_error)
+  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 134, __pyx_L1_error)
+  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 149, __pyx_L1_error)
+  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 152, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 181, __pyx_L1_error)
+  __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(0, 406, __pyx_L1_error)
+  __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(0, 834, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_No_matching_signature_found); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
-  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_Function_call_with_ambiguous_arg); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__4);
-  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple_);
+  __Pyx_GIVEREF(__pyx_tuple_);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__2);
+  __Pyx_GIVEREF(__pyx_tuple__2);
 
   /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(1, 134, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__5);
-  __Pyx_GIVEREF(__pyx_tuple__5);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
   /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(1, 137, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__6);
-  __Pyx_GIVEREF(__pyx_tuple__6);
+  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
 
   /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(1, 149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
 
   /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 177, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__8);
-  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 177, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__6);
+  __Pyx_GIVEREF(__pyx_tuple__6);
 
   /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(1, 193, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__9);
-  __Pyx_GIVEREF(__pyx_tuple__9);
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__10);
-  __Pyx_GIVEREF(__pyx_tuple__10);
+  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__8);
+  __Pyx_GIVEREF(__pyx_tuple__8);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__11);
-  __Pyx_GIVEREF(__pyx_tuple__11);
+  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
 
   /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(1, 420, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__12);
-  __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 420, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__10);
+  __Pyx_GIVEREF(__pyx_tuple__10);
 
   /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(1, 497, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__11);
+  __Pyx_GIVEREF(__pyx_tuple__11);
 
   /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(1, 522, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 522, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__12);
+  __Pyx_GIVEREF(__pyx_tuple__12);
 
   /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(1, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__13);
+  __Pyx_GIVEREF(__pyx_tuple__13);
 
   /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__16 = PyTuple_New(1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(1, 579, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
+  __pyx_tuple__14 = PyTuple_New(1); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__16, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  PyTuple_SET_ITEM(__pyx_tuple__14, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__14);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__17);
-  __Pyx_GIVEREF(__pyx_tuple__17);
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
 
   /* "View.MemoryView":684
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))             # <<<<<<<<<<<<<<
  *                 seen_ellipsis = True
  *             else:
  */
-  __pyx_slice__19 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__19)) __PYX_ERR(1, 684, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__19);
-  __Pyx_GIVEREF(__pyx_slice__19);
+  __pyx_slice__17 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__17)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__17);
+  __Pyx_GIVEREF(__pyx_slice__17);
 
   /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 705, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 705, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
-  __pyx_tuple__23 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
- */
-  __pyx_tuple__24 = PyTuple_Pack(13, __pyx_n_s_c, __pyx_n_s_x, __pyx_n_s_xp, __pyx_n_s_dx, __pyx_n_s_extrapolate, __pyx_n_s_out, __pyx_n_s_indices, __pyx_n_s_ip, __pyx_n_s_jp, __pyx_n_s_interval, __pyx_n_s_stored_index, __pyx_n_s_xval, __pyx_n_s_i); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(7, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_auxiliary_interpolate, __pyx_n_s_evaluate, 29, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__21 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(1, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(1, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(1, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(1, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(1, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__31 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_tuple__27 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
-  /* InitThreads.init */
-  #if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0
-PyEval_InitThreads();
-#endif
-
-if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1, __pyx_L1_error)
-
-  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_7 = PyInt_FromLong(7); if (unlikely(!__pyx_int_7)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(1, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
 static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
@@ -19205,106 +19466,135 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
+  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.csi = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.omega = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.auxderivs = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_dictoffset && __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (__Pyx_SetVtable(__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_dict, __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Hamiltonian_C, (PyObject *)&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = &__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
-  if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
-  if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
   __pyx_array_type = &__pyx_type___pyx_array;
-  if (PyType_Ready(&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 280, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(0, 280, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_MemviewEnum.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_MemviewEnum.tp_dictoffset && __pyx_type___pyx_MemviewEnum.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_MemviewEnum.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(1, 280, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_MemviewEnum) < 0) __PYX_ERR(0, 280, __pyx_L1_error)
   __pyx_MemviewEnum_type = &__pyx_type___pyx_MemviewEnum;
   __pyx_vtabptr_memoryview = &__pyx_vtable_memoryview;
   __pyx_vtable_memoryview.get_item_pointer = (char *(*)(struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_get_item_pointer;
   __pyx_vtable_memoryview.is_slice = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_is_slice;
   __pyx_vtable_memoryview.setitem_slice_assignment = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *, PyObject *))__pyx_memoryview_setitem_slice_assignment;
   __pyx_vtable_memoryview.setitem_slice_assign_scalar = (PyObject *(*)(struct __pyx_memoryview_obj *, struct __pyx_memoryview_obj *, PyObject *))__pyx_memoryview_setitem_slice_assign_scalar;
   __pyx_vtable_memoryview.setitem_indexed = (PyObject *(*)(struct __pyx_memoryview_obj *, PyObject *, PyObject *))__pyx_memoryview_setitem_indexed;
   __pyx_vtable_memoryview.convert_item_to_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *))__pyx_memoryview_convert_item_to_object;
   __pyx_vtable_memoryview.assign_item_from_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *, PyObject *))__pyx_memoryview_assign_item_from_object;
-  if (PyType_Ready(&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_memoryview.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_memoryview.tp_dictoffset && __pyx_type___pyx_memoryview.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_memoryview.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type___pyx_memoryview.tp_dict, __pyx_vtabptr_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(1, 331, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_memoryview.tp_dict, __pyx_vtabptr_memoryview) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryview) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
   __pyx_memoryview_type = &__pyx_type___pyx_memoryview;
   __pyx_vtabptr__memoryviewslice = &__pyx_vtable__memoryviewslice;
   __pyx_vtable__memoryviewslice.__pyx_base = *__pyx_vtabptr_memoryview;
   __pyx_vtable__memoryviewslice.__pyx_base.convert_item_to_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *))__pyx_memoryviewslice_convert_item_to_object;
   __pyx_vtable__memoryviewslice.__pyx_base.assign_item_from_object = (PyObject *(*)(struct __pyx_memoryview_obj *, char *, PyObject *))__pyx_memoryviewslice_assign_item_from_object;
   __pyx_type___pyx_memoryviewslice.tp_base = __pyx_memoryview_type;
-  if (PyType_Ready(&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_memoryviewslice.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type___pyx_memoryviewslice.tp_dictoffset && __pyx_type___pyx_memoryviewslice.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type___pyx_memoryviewslice.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type___pyx_memoryviewslice.tp_dict, __pyx_vtabptr__memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(1, 967, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type___pyx_memoryviewslice.tp_dict, __pyx_vtabptr__memoryviewslice) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type___pyx_memoryviewslice) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
   __pyx_memoryviewslice_type = &__pyx_type___pyx_memoryviewslice;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static int __Pyx_modinit_type_import_code(void) {
   __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_RefNannyFinishContext();
+  return -1;
 }
 
 static int __Pyx_modinit_variable_import_code(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_modinit_variable_import_code", 0);
   /*--- Variable import code ---*/
   __Pyx_RefNannyFinishContext();
   return 0;
 }
 
 static int __Pyx_modinit_function_import_code(void) {
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
-  __pyx_t_1 = PyImport_ImportModule("scipy.linalg.cython_lapack"); if (!__pyx_t_1) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_ImportFunction(__pyx_t_1, "dgeev", (void (**)(void))&__pyx_f_5scipy_6linalg_13cython_lapack_dgeev, "void (char *, char *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, __pyx_t_5scipy_6linalg_13cython_lapack_d *, int *, int *)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_RefNannyFinishContext();
-  return -1;
 }
 
 
 #ifndef CYTHON_NO_PYINIT_EXPORT
 #define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
 #elif PY_MAJOR_VERSION < 3
 #ifdef __cplusplus
@@ -19318,19 +19608,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC init_ppoly(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC init_ppoly(void)
+__Pyx_PyMODINIT_FUNC initHamiltonian_C(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initHamiltonian_C(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit__ppoly(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit__ppoly(void)
+__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -19389,258 +19679,217 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec__ppoly(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_Hamiltonian_C(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  static PyThread_type_lock __pyx_t_3[8];
+  static PyThread_type_lock __pyx_t_2[8];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module '_ppoly' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'Hamiltonian_C' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   #if CYTHON_REFNANNY
 __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit__ppoly(void)", 0);
-  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void)", 0);
+  if (__Pyx_check_binary_version() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
-  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(1, 1, __pyx_L1_error)
   #ifdef __Pyx_CyFunction_USED
-  if (__pyx_CyFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_CyFunction_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_FusedFunction_USED
-  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_Coroutine_USED
-  if (__pyx_Coroutine_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_Coroutine_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_Generator_USED
-  if (__pyx_Generator_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_Generator_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_AsyncGen_USED
-  if (__pyx_AsyncGen_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_AsyncGen_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_StopAsyncIteration_USED
-  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
   #if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0 && defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
   PyEval_InitThreads();
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("_ppoly", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("Hamiltonian_C", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
-  if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (unlikely(!__pyx_m)) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
-  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(1, 1, __pyx_L1_error)
   Py_INCREF(__pyx_d);
-  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(1, 1, __pyx_L1_error)
   Py_INCREF(__pyx_b);
-  __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(1, 1, __pyx_L1_error)
   Py_INCREF(__pyx_cython_runtime);
-  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   /*--- Initialize various global constants etc. ---*/
-  if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_InitGlobals() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
-  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_pyseobnr__auxiliary__interpolate___ppoly) {
-    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C) {
+    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
-    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "pyseobnr.auxiliary.interpolate._ppoly")) {
-      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.auxiliary.interpolate._ppoly", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
+    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(1, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_C")) {
+      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_C", __pyx_m) < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
-  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
-  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   /*--- Global type/function init code ---*/
   (void)__Pyx_modinit_global_init_code();
   (void)__Pyx_modinit_variable_export_code();
   (void)__Pyx_modinit_function_export_code();
-  if (unlikely(__Pyx_modinit_type_init_code() < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
-  (void)__Pyx_modinit_type_import_code();
+  if (unlikely(__Pyx_modinit_type_init_code() < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (unlikely(__Pyx_modinit_type_import_code() < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
   (void)__Pyx_modinit_variable_import_code();
-  if (unlikely(__Pyx_modinit_function_import_code() < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
+  (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
-  if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_patch_abc() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":5
- * #------------------------------------------------------------------------------
- * #cython: language_level=3
- * import numpy as np             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":1
+ * cimport cython             # <<<<<<<<<<<<<<
+ * from pyseobnr.eob.utils.containers cimport EOBParams
  * 
- * cimport cython
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":29
- * @cython.boundscheck(False)
- * @cython.cdivision(True)
- * def evaluate(double_or_complex[:,:,::1] c,             # <<<<<<<<<<<<<<
- *              const double[::1] x,
- *              const double[::1] xp,
- */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_FusedFunction_New(&__pyx_fuse_0__pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_3evaluate, 0, __pyx_n_s_evaluate, NULL, __pyx_n_s_pyseobnr_auxiliary_interpolate_2, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_double, __pyx_t_2) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_FusedFunction_New(&__pyx_fuse_1__pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_5evaluate, 0, __pyx_n_s_evaluate, NULL, __pyx_n_s_pyseobnr_auxiliary_interpolate_2, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_kp_s_double_complex, __pyx_t_2) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_FusedFunction_New(&__pyx_mdef_8pyseobnr_9auxiliary_11interpolate_6_ppoly_1evaluate, 0, __pyx_n_s_evaluate, NULL, __pyx_n_s_pyseobnr_auxiliary_interpolate_2, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_empty_tuple);
-  ((__pyx_FusedFunctionObject *) __pyx_t_2)->__signatures__ = __pyx_t_1;
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_evaluate, __pyx_t_2) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "pyseobnr/auxiliary/interpolate/_ppoly.pyx":1
- * #------------------------------------------------------------------------------             # <<<<<<<<<<<<<<
- * # Piecewise power basis polynomials
- * #------------------------------------------------------------------------------
- */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
   /* "View.MemoryView":210
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(array self):
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 210, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 210, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(0, 210, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_array_type);
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(generic);
-  __Pyx_DECREF_SET(generic, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(generic, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(strided);
-  __Pyx_DECREF_SET(strided, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(strided, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect);
-  __Pyx_DECREF_SET(indirect, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(indirect, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(contiguous);
-  __Pyx_DECREF_SET(contiguous, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(contiguous, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect_contiguous);
-  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":317
  * 
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0             # <<<<<<<<<<<<<<
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [
  *     PyThread_allocate_lock(),
@@ -19650,81 +19899,80 @@
   /* "View.MemoryView":318
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [             # <<<<<<<<<<<<<<
  *     PyThread_allocate_lock(),
  *     PyThread_allocate_lock(),
  */
-  __pyx_t_3[0] = PyThread_allocate_lock();
-  __pyx_t_3[1] = PyThread_allocate_lock();
-  __pyx_t_3[2] = PyThread_allocate_lock();
-  __pyx_t_3[3] = PyThread_allocate_lock();
-  __pyx_t_3[4] = PyThread_allocate_lock();
-  __pyx_t_3[5] = PyThread_allocate_lock();
-  __pyx_t_3[6] = PyThread_allocate_lock();
-  __pyx_t_3[7] = PyThread_allocate_lock();
-  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_3, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
+  __pyx_t_2[0] = PyThread_allocate_lock();
+  __pyx_t_2[1] = PyThread_allocate_lock();
+  __pyx_t_2[2] = PyThread_allocate_lock();
+  __pyx_t_2[3] = PyThread_allocate_lock();
+  __pyx_t_2[4] = PyThread_allocate_lock();
+  __pyx_t_2[5] = PyThread_allocate_lock();
+  __pyx_t_2[6] = PyThread_allocate_lock();
+  __pyx_t_2[7] = PyThread_allocate_lock();
+  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_2, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
 
   /* "View.MemoryView":551
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 551, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 551, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryview_type);
 
   /* "View.MemoryView":997
  *         return self.from_object
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 997, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 997, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryviewslice_type);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_2) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "(tree fragment)":11
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  */
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init pyseobnr.auxiliary.interpolate._ppoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init pyseobnr.eob.hamiltonian.Hamiltonian_C", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init pyseobnr.auxiliary.interpolate._ppoly");
+    PyErr_SetString(PyExc_ImportError, "init pyseobnr.eob.hamiltonian.Hamiltonian_C");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -19775,40 +20023,14 @@
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
-/* RaiseArgTupleInvalid */
-static void __Pyx_RaiseArgtupleInvalid(
-    const char* func_name,
-    int exact,
-    Py_ssize_t num_min,
-    Py_ssize_t num_max,
-    Py_ssize_t num_found)
-{
-    Py_ssize_t num_expected;
-    const char *more_or_less;
-    if (num_found < num_min) {
-        num_expected = num_min;
-        more_or_less = "at least";
-    } else {
-        num_expected = num_max;
-        more_or_less = "at most";
-    }
-    if (exact) {
-        more_or_less = "exactly";
-    }
-    PyErr_Format(PyExc_TypeError,
-                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                 func_name, more_or_less, num_expected,
-                 (num_expected == 1) ? "" : "s", num_found);
-}
-
 /* RaiseDoubleKeywords */
 static void __Pyx_RaiseDoubleKeywordsError(
     const char* func_name,
     PyObject* kw_name)
 {
     PyErr_Format(PyExc_TypeError,
         #if PY_MAJOR_VERSION >= 3
@@ -19917,61 +20139,71 @@
         "%s() got an unexpected keyword argument '%U'",
         function_name, key);
     #endif
 bad:
     return -1;
 }
 
-/* DictGetItem */
-#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
-static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
-    PyObject *value;
-    value = PyDict_GetItemWithError(d, key);
-    if (unlikely(!value)) {
-        if (!PyErr_Occurred()) {
-            if (unlikely(PyTuple_Check(key))) {
-                PyObject* args = PyTuple_Pack(1, key);
-                if (likely(args)) {
-                    PyErr_SetObject(PyExc_KeyError, args);
-                    Py_DECREF(args);
-                }
-            } else {
-                PyErr_SetObject(PyExc_KeyError, key);
-            }
-        }
-        return NULL;
+/* RaiseArgTupleInvalid */
+static void __Pyx_RaiseArgtupleInvalid(
+    const char* func_name,
+    int exact,
+    Py_ssize_t num_min,
+    Py_ssize_t num_max,
+    Py_ssize_t num_found)
+{
+    Py_ssize_t num_expected;
+    const char *more_or_less;
+    if (num_found < num_min) {
+        num_expected = num_min;
+        more_or_less = "at least";
+    } else {
+        num_expected = num_max;
+        more_or_less = "at most";
     }
-    Py_INCREF(value);
-    return value;
+    if (exact) {
+        more_or_less = "exactly";
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
+                 func_name, more_or_less, num_expected,
+                 (num_expected == 1) ? "" : "s", num_found);
 }
-#endif
 
-/* PyCFunctionFastCall */
-#if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
-    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
-    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
-    PyObject *self = PyCFunction_GET_SELF(func);
-    int flags = PyCFunction_GET_FLAGS(func);
-    assert(PyCFunction_Check(func));
-    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
-    assert(nargs >= 0);
-    assert(nargs == 0 || args != NULL);
-    /* _PyCFunction_FastCallDict() must not be called with an exception set,
-       because it may clear it (directly or indirectly) and so the
-       caller loses its exception */
-    assert(!PyErr_Occurred());
-    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
-        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
-    } else {
-        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
+/* PyDictVersioning */
+#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
+    PyObject *dict = Py_TYPE(obj)->tp_dict;
+    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
+}
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
+    PyObject **dictptr = NULL;
+    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
+    if (offset) {
+#if CYTHON_COMPILING_IN_CPYTHON
+        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
+#else
+        dictptr = _PyObject_GetDictPtr(obj);
+#endif
     }
+    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
+}
+static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
+    PyObject *dict = Py_TYPE(obj)->tp_dict;
+    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
+        return 0;
+    return obj_dict_version == __Pyx_get_object_dict_version(obj);
 }
 #endif
 
+/* None */
+static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
+    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
+}
+
 /* PyFunctionFastCall */
 #if CYTHON_FAST_PYCALL
 static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
                                                PyObject *globals) {
     PyFrameObject *f;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
     PyObject **fastlocals;
@@ -20083,14 +20315,37 @@
 done:
     Py_LeaveRecursiveCall();
     return result;
 }
 #endif
 #endif
 
+/* PyCFunctionFastCall */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
+    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
+    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
+    PyObject *self = PyCFunction_GET_SELF(func);
+    int flags = PyCFunction_GET_FLAGS(func);
+    assert(PyCFunction_Check(func));
+    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
+    assert(nargs >= 0);
+    assert(nargs == 0 || args != NULL);
+    /* _PyCFunction_FastCallDict() must not be called with an exception set,
+       because it may clear it (directly or indirectly) and so the
+       caller loses its exception */
+    assert(!PyErr_Occurred());
+    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
+        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
+    } else {
+        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
+    }
+}
+#endif
+
 /* PyObjectCall */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
     PyObject *result;
     ternaryfunc call = Py_TYPE(func)->tp_call;
     if (unlikely(!call))
         return PyObject_Call(func, arg, kw);
@@ -20103,73 +20358,145 @@
             PyExc_SystemError,
             "NULL result without error in PyObject_Call");
     }
     return result;
 }
 #endif
 
-/* PyObjectCallMethO */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
-    PyObject *self, *result;
-    PyCFunction cfunc;
-    cfunc = PyCFunction_GET_FUNCTION(func);
-    self = PyCFunction_GET_SELF(func);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = cfunc(self, arg);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
+/* MemviewSliceInit */
+static int
+__Pyx_init_memviewslice(struct __pyx_memoryview_obj *memview,
+                        int ndim,
+                        __Pyx_memviewslice *memviewslice,
+                        int memview_is_new_reference)
+{
+    __Pyx_RefNannyDeclarations
+    int i, retval=-1;
+    Py_buffer *buf = &memview->view;
+    __Pyx_RefNannySetupContext("init_memviewslice", 0);
+    if (unlikely(memviewslice->memview || memviewslice->data)) {
+        PyErr_SetString(PyExc_ValueError,
+            "memviewslice is already initialized!");
+        goto fail;
     }
-    return result;
+    if (buf->strides) {
+        for (i = 0; i < ndim; i++) {
+            memviewslice->strides[i] = buf->strides[i];
+        }
+    } else {
+        Py_ssize_t stride = buf->itemsize;
+        for (i = ndim - 1; i >= 0; i--) {
+            memviewslice->strides[i] = stride;
+            stride *= buf->shape[i];
+        }
+    }
+    for (i = 0; i < ndim; i++) {
+        memviewslice->shape[i]   = buf->shape[i];
+        if (buf->suboffsets) {
+            memviewslice->suboffsets[i] = buf->suboffsets[i];
+        } else {
+            memviewslice->suboffsets[i] = -1;
+        }
+    }
+    memviewslice->memview = memview;
+    memviewslice->data = (char *)buf->buf;
+    if (__pyx_add_acquisition_count(memview) == 0 && !memview_is_new_reference) {
+        Py_INCREF(memview);
+    }
+    retval = 0;
+    goto no_fail;
+fail:
+    memviewslice->memview = 0;
+    memviewslice->data = 0;
+    retval = -1;
+no_fail:
+    __Pyx_RefNannyFinishContext();
+    return retval;
 }
+#ifndef Py_NO_RETURN
+#define Py_NO_RETURN
 #endif
-
-/* PyObjectCallOneArg */
-#if CYTHON_COMPILING_IN_CPYTHON
-static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-    PyObject *result;
-    PyObject *args = PyTuple_New(1);
-    if (unlikely(!args)) return NULL;
-    Py_INCREF(arg);
-    PyTuple_SET_ITEM(args, 0, arg);
-    result = __Pyx_PyObject_Call(func, args, NULL);
-    Py_DECREF(args);
+static void __pyx_fatalerror(const char *fmt, ...) Py_NO_RETURN {
+    va_list vargs;
+    char msg[200];
+#if PY_VERSION_HEX >= 0x030A0000 || defined(HAVE_STDARG_PROTOTYPES)
+    va_start(vargs, fmt);
+#else
+    va_start(vargs);
+#endif
+    vsnprintf(msg, 200, fmt, vargs);
+    va_end(vargs);
+    Py_FatalError(msg);
+}
+static CYTHON_INLINE int
+__pyx_add_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
+                                   PyThread_type_lock lock)
+{
+    int result;
+    PyThread_acquire_lock(lock, 1);
+    result = (*acquisition_count)++;
+    PyThread_release_lock(lock);
     return result;
 }
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, &arg, 1);
-    }
-#endif
-    if (likely(PyCFunction_Check(func))) {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
-            return __Pyx_PyObject_CallMethO(func, arg);
-#if CYTHON_FAST_PYCCALL
-        } else if (__Pyx_PyFastCFunction_Check(func)) {
-            return __Pyx_PyCFunction_FastCall(func, &arg, 1);
-#endif
+static CYTHON_INLINE int
+__pyx_sub_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
+                                   PyThread_type_lock lock)
+{
+    int result;
+    PyThread_acquire_lock(lock, 1);
+    result = (*acquisition_count)--;
+    PyThread_release_lock(lock);
+    return result;
+}
+static CYTHON_INLINE void
+__Pyx_INC_MEMVIEW(__Pyx_memviewslice *memslice, int have_gil, int lineno)
+{
+    int first_time;
+    struct __pyx_memoryview_obj *memview = memslice->memview;
+    if (unlikely(!memview || (PyObject *) memview == Py_None))
+        return;
+    if (unlikely(__pyx_get_slice_count(memview) < 0))
+        __pyx_fatalerror("Acquisition count is %d (line %d)",
+                         __pyx_get_slice_count(memview), lineno);
+    first_time = __pyx_add_acquisition_count(memview) == 0;
+    if (unlikely(first_time)) {
+        if (have_gil) {
+            Py_INCREF((PyObject *) memview);
+        } else {
+            PyGILState_STATE _gilstate = PyGILState_Ensure();
+            Py_INCREF((PyObject *) memview);
+            PyGILState_Release(_gilstate);
         }
     }
-    return __Pyx__PyObject_CallOneArg(func, arg);
 }
-#else
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-    PyObject *result;
-    PyObject *args = PyTuple_Pack(1, arg);
-    if (unlikely(!args)) return NULL;
-    result = __Pyx_PyObject_Call(func, args, NULL);
-    Py_DECREF(args);
-    return result;
+static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *memslice,
+                                             int have_gil, int lineno) {
+    int last_time;
+    struct __pyx_memoryview_obj *memview = memslice->memview;
+    if (unlikely(!memview || (PyObject *) memview == Py_None)) {
+        memslice->memview = NULL;
+        return;
+    }
+    if (unlikely(__pyx_get_slice_count(memview) <= 0))
+        __pyx_fatalerror("Acquisition count is %d (line %d)",
+                         __pyx_get_slice_count(memview), lineno);
+    last_time = __pyx_sub_acquisition_count(memview) == 1;
+    memslice->data = NULL;
+    if (unlikely(last_time)) {
+        if (have_gil) {
+            Py_CLEAR(memslice->memview);
+        } else {
+            PyGILState_STATE _gilstate = PyGILState_Ensure();
+            Py_CLEAR(memslice->memview);
+            PyGILState_Release(_gilstate);
+        }
+    } else {
+        memslice->memview = NULL;
+    }
 }
-#endif
 
 /* PyErrFetchRestore */
 #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     tmp_type = tstate->curexc_type;
     tmp_value = tstate->curexc_value;
@@ -20187,14 +20514,67 @@
     *tb = tstate->curexc_traceback;
     tstate->curexc_type = 0;
     tstate->curexc_value = 0;
     tstate->curexc_traceback = 0;
 }
 #endif
 
+/* WriteUnraisableException */
+static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
+                                  CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename,
+                                  int full_traceback, CYTHON_UNUSED int nogil) {
+    PyObject *old_exc, *old_val, *old_tb;
+    PyObject *ctx;
+    __Pyx_PyThreadState_declare
+#ifdef WITH_THREAD
+    PyGILState_STATE state;
+    if (nogil)
+        state = PyGILState_Ensure();
+    else state = (PyGILState_STATE)0;
+#endif
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
+    if (full_traceback) {
+        Py_XINCREF(old_exc);
+        Py_XINCREF(old_val);
+        Py_XINCREF(old_tb);
+        __Pyx_ErrRestore(old_exc, old_val, old_tb);
+        PyErr_PrintEx(1);
+    }
+    #if PY_MAJOR_VERSION < 3
+    ctx = PyString_FromString(name);
+    #else
+    ctx = PyUnicode_FromString(name);
+    #endif
+    __Pyx_ErrRestore(old_exc, old_val, old_tb);
+    if (!ctx) {
+        PyErr_WriteUnraisable(Py_None);
+    } else {
+        PyErr_WriteUnraisable(ctx);
+        Py_DECREF(ctx);
+    }
+#ifdef WITH_THREAD
+    if (nogil)
+        PyGILState_Release(state);
+#endif
+}
+
+/* ExtTypeTest */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    if (likely(__Pyx_TypeCheck(obj, type)))
+        return 1;
+    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
+                 Py_TYPE(obj)->tp_name, type->tp_name);
+    return 0;
+}
+
 /* RaiseException */
 #if PY_MAJOR_VERSION < 3
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                         CYTHON_UNUSED PyObject *cause) {
     __Pyx_PyThreadState_declare
     Py_XINCREF(type);
     if (!value || value == Py_None)
@@ -20346,494 +20726,33 @@
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
 
-/* UnicodeAsUCS4 */
-static CYTHON_INLINE Py_UCS4 __Pyx_PyUnicode_AsPy_UCS4(PyObject* x) {
-   Py_ssize_t length;
-   #if CYTHON_PEP393_ENABLED
-   length = PyUnicode_GET_LENGTH(x);
-   if (likely(length == 1)) {
-       return PyUnicode_READ_CHAR(x, 0);
-   }
-   #else
-   length = PyUnicode_GET_SIZE(x);
-   if (likely(length == 1)) {
-       return PyUnicode_AS_UNICODE(x)[0];
-   }
-   #if Py_UNICODE_SIZE == 2
-   else if (PyUnicode_GET_SIZE(x) == 2) {
-       Py_UCS4 high_val = PyUnicode_AS_UNICODE(x)[0];
-       if (high_val >= 0xD800 && high_val <= 0xDBFF) {
-           Py_UCS4 low_val = PyUnicode_AS_UNICODE(x)[1];
-           if (low_val >= 0xDC00 && low_val <= 0xDFFF) {
-               return 0x10000 + (((high_val & ((1<<10)-1)) << 10) | (low_val & ((1<<10)-1)));
-           }
-       }
-   }
-   #endif
-   #endif
-   PyErr_Format(PyExc_ValueError,
-                "only single character unicode strings can be converted to Py_UCS4, "
-                "got length %" CYTHON_FORMAT_SSIZE_T "d", length);
-   return (Py_UCS4)-1;
-}
-
-/* object_ord */
-static long __Pyx__PyObject_Ord(PyObject* c) {
-    Py_ssize_t size;
-    if (PyBytes_Check(c)) {
-        size = PyBytes_GET_SIZE(c);
-        if (likely(size == 1)) {
-            return (unsigned char) PyBytes_AS_STRING(c)[0];
-        }
-#if PY_MAJOR_VERSION < 3
-    } else if (PyUnicode_Check(c)) {
-        return (long)__Pyx_PyUnicode_AsPy_UCS4(c);
-#endif
-#if (!CYTHON_COMPILING_IN_PYPY) || (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
-    } else if (PyByteArray_Check(c)) {
-        size = PyByteArray_GET_SIZE(c);
-        if (likely(size == 1)) {
-            return (unsigned char) PyByteArray_AS_STRING(c)[0];
-        }
-#endif
-    } else {
-        PyErr_Format(PyExc_TypeError,
-            "ord() expected string of length 1, but %.200s found", Py_TYPE(c)->tp_name);
-        return (long)(Py_UCS4)-1;
-    }
-    PyErr_Format(PyExc_TypeError,
-        "ord() expected a character, but string of length %zd found", size);
-    return (long)(Py_UCS4)-1;
-}
-
-/* SetItemInt */
-static int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
-    int r;
-    if (!j) return -1;
-    r = PyObject_SetItem(o, j, v);
-    Py_DECREF(j);
-    return r;
-}
-static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v, int is_list,
-                                               CYTHON_NCP_UNUSED int wraparound, CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
-    if (is_list || PyList_CheckExact(o)) {
-        Py_ssize_t n = (!wraparound) ? i : ((likely(i >= 0)) ? i : i + PyList_GET_SIZE(o));
-        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o)))) {
-            PyObject* old = PyList_GET_ITEM(o, n);
-            Py_INCREF(v);
-            PyList_SET_ITEM(o, n, v);
-            Py_DECREF(old);
-            return 1;
-        }
-    } else {
-        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
-        if (likely(m && m->sq_ass_item)) {
-            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
-                Py_ssize_t l = m->sq_length(o);
-                if (likely(l >= 0)) {
-                    i += l;
-                } else {
-                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                        return -1;
-                    PyErr_Clear();
-                }
-            }
-            return m->sq_ass_item(o, i, v);
-        }
-    }
-#else
-#if CYTHON_COMPILING_IN_PYPY
-    if (is_list || (PySequence_Check(o) && !PyDict_Check(o)))
-#else
-    if (is_list || PySequence_Check(o))
-#endif
-    {
-        return PySequence_SetItem(o, i, v);
-    }
-#endif
-    return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
-}
-
-/* IterFinish */
-static CYTHON_INLINE int __Pyx_IterFinish(void) {
-#if CYTHON_FAST_THREAD_STATE
-    PyThreadState *tstate = __Pyx_PyThreadState_Current;
-    PyObject* exc_type = tstate->curexc_type;
-    if (unlikely(exc_type)) {
-        if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) {
-            PyObject *exc_value, *exc_tb;
-            exc_value = tstate->curexc_value;
-            exc_tb = tstate->curexc_traceback;
-            tstate->curexc_type = 0;
-            tstate->curexc_value = 0;
-            tstate->curexc_traceback = 0;
-            Py_DECREF(exc_type);
-            Py_XDECREF(exc_value);
-            Py_XDECREF(exc_tb);
-            return 0;
-        } else {
-            return -1;
-        }
-    }
-    return 0;
-#else
-    if (unlikely(PyErr_Occurred())) {
-        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
-            PyErr_Clear();
-            return 0;
-        } else {
-            return -1;
-        }
-    }
-    return 0;
-#endif
-}
-
-/* PyObjectCallNoArg */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, NULL, 0);
-    }
-#endif
-#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
-    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
-#else
-    if (likely(PyCFunction_Check(func)))
-#endif
-    {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
-            return __Pyx_PyObject_CallMethO(func, NULL);
-        }
-    }
-    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
-}
-#endif
-
-/* PyObjectGetMethod */
-static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
-    PyObject *attr;
-#if CYTHON_UNPACK_METHODS && CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_PYTYPE_LOOKUP
-    PyTypeObject *tp = Py_TYPE(obj);
-    PyObject *descr;
-    descrgetfunc f = NULL;
-    PyObject **dictptr, *dict;
-    int meth_found = 0;
-    assert (*method == NULL);
-    if (unlikely(tp->tp_getattro != PyObject_GenericGetAttr)) {
-        attr = __Pyx_PyObject_GetAttrStr(obj, name);
-        goto try_unpack;
-    }
-    if (unlikely(tp->tp_dict == NULL) && unlikely(PyType_Ready(tp) < 0)) {
+/* ArgTypeTest */
+static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
+{
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
         return 0;
     }
-    descr = _PyType_Lookup(tp, name);
-    if (likely(descr != NULL)) {
-        Py_INCREF(descr);
-#if PY_MAJOR_VERSION >= 3
-        #ifdef __Pyx_CyFunction_USED
-        if (likely(PyFunction_Check(descr) || (Py_TYPE(descr) == &PyMethodDescr_Type) || __Pyx_CyFunction_Check(descr)))
-        #else
-        if (likely(PyFunction_Check(descr) || (Py_TYPE(descr) == &PyMethodDescr_Type)))
-        #endif
-#else
-        #ifdef __Pyx_CyFunction_USED
-        if (likely(PyFunction_Check(descr) || __Pyx_CyFunction_Check(descr)))
-        #else
-        if (likely(PyFunction_Check(descr)))
+    else if (exact) {
+        #if PY_MAJOR_VERSION == 2
+        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
         #endif
-#endif
-        {
-            meth_found = 1;
-        } else {
-            f = Py_TYPE(descr)->tp_descr_get;
-            if (f != NULL && PyDescr_IsData(descr)) {
-                attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
-                Py_DECREF(descr);
-                goto try_unpack;
-            }
-        }
-    }
-    dictptr = _PyObject_GetDictPtr(obj);
-    if (dictptr != NULL && (dict = *dictptr) != NULL) {
-        Py_INCREF(dict);
-        attr = __Pyx_PyDict_GetItemStr(dict, name);
-        if (attr != NULL) {
-            Py_INCREF(attr);
-            Py_DECREF(dict);
-            Py_XDECREF(descr);
-            goto try_unpack;
-        }
-        Py_DECREF(dict);
-    }
-    if (meth_found) {
-        *method = descr;
-        return 1;
-    }
-    if (f != NULL) {
-        attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
-        Py_DECREF(descr);
-        goto try_unpack;
-    }
-    if (descr != NULL) {
-        *method = descr;
-        return 0;
-    }
-    PyErr_Format(PyExc_AttributeError,
-#if PY_MAJOR_VERSION >= 3
-                 "'%.50s' object has no attribute '%U'",
-                 tp->tp_name, name);
-#else
-                 "'%.50s' object has no attribute '%.400s'",
-                 tp->tp_name, PyString_AS_STRING(name));
-#endif
-    return 0;
-#else
-    attr = __Pyx_PyObject_GetAttrStr(obj, name);
-    goto try_unpack;
-#endif
-try_unpack:
-#if CYTHON_UNPACK_METHODS
-    if (likely(attr) && PyMethod_Check(attr) && likely(PyMethod_GET_SELF(attr) == obj)) {
-        PyObject *function = PyMethod_GET_FUNCTION(attr);
-        Py_INCREF(function);
-        Py_DECREF(attr);
-        *method = function;
-        return 1;
-    }
-#endif
-    *method = attr;
-    return 0;
-}
-
-/* PyObjectCallMethod0 */
-static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
-    PyObject *method = NULL, *result = NULL;
-    int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
-    if (likely(is_method)) {
-        result = __Pyx_PyObject_CallOneArg(method, obj);
-        Py_DECREF(method);
-        return result;
-    }
-    if (unlikely(!method)) goto bad;
-    result = __Pyx_PyObject_CallNoArg(method);
-    Py_DECREF(method);
-bad:
-    return result;
-}
-
-/* RaiseNeedMoreValuesToUnpack */
-static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
-    PyErr_Format(PyExc_ValueError,
-                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
-                 index, (index == 1) ? "" : "s");
-}
-
-/* RaiseTooManyValuesToUnpack */
-static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
-    PyErr_Format(PyExc_ValueError,
-                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
-}
-
-/* UnpackItemEndCheck */
-static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
-    if (unlikely(retval)) {
-        Py_DECREF(retval);
-        __Pyx_RaiseTooManyValuesError(expected);
-        return -1;
-    }
-    return __Pyx_IterFinish();
-}
-
-/* RaiseNoneIterError */
-static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
-    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-}
-
-/* UnpackTupleError */
-static void __Pyx_UnpackTupleError(PyObject *t, Py_ssize_t index) {
-    if (t == Py_None) {
-      __Pyx_RaiseNoneNotIterableError();
-    } else if (PyTuple_GET_SIZE(t) < index) {
-      __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(t));
-    } else {
-      __Pyx_RaiseTooManyValuesError(index);
     }
-}
-
-/* UnpackTuple2 */
-static CYTHON_INLINE int __Pyx_unpack_tuple2_exact(
-        PyObject* tuple, PyObject** pvalue1, PyObject** pvalue2, int decref_tuple) {
-    PyObject *value1 = NULL, *value2 = NULL;
-#if CYTHON_COMPILING_IN_PYPY
-    value1 = PySequence_ITEM(tuple, 0);  if (unlikely(!value1)) goto bad;
-    value2 = PySequence_ITEM(tuple, 1);  if (unlikely(!value2)) goto bad;
-#else
-    value1 = PyTuple_GET_ITEM(tuple, 0);  Py_INCREF(value1);
-    value2 = PyTuple_GET_ITEM(tuple, 1);  Py_INCREF(value2);
-#endif
-    if (decref_tuple) {
-        Py_DECREF(tuple);
+    else {
+        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
     }
-    *pvalue1 = value1;
-    *pvalue2 = value2;
-    return 0;
-#if CYTHON_COMPILING_IN_PYPY
-bad:
-    Py_XDECREF(value1);
-    Py_XDECREF(value2);
-    if (decref_tuple) { Py_XDECREF(tuple); }
-    return -1;
-#endif
-}
-static int __Pyx_unpack_tuple2_generic(PyObject* tuple, PyObject** pvalue1, PyObject** pvalue2,
-                                       int has_known_size, int decref_tuple) {
-    Py_ssize_t index;
-    PyObject *value1 = NULL, *value2 = NULL, *iter = NULL;
-    iternextfunc iternext;
-    iter = PyObject_GetIter(tuple);
-    if (unlikely(!iter)) goto bad;
-    if (decref_tuple) { Py_DECREF(tuple); tuple = NULL; }
-    iternext = Py_TYPE(iter)->tp_iternext;
-    value1 = iternext(iter); if (unlikely(!value1)) { index = 0; goto unpacking_failed; }
-    value2 = iternext(iter); if (unlikely(!value2)) { index = 1; goto unpacking_failed; }
-    if (!has_known_size && unlikely(__Pyx_IternextUnpackEndCheck(iternext(iter), 2))) goto bad;
-    Py_DECREF(iter);
-    *pvalue1 = value1;
-    *pvalue2 = value2;
+    PyErr_Format(PyExc_TypeError,
+        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
+        name, type->tp_name, Py_TYPE(obj)->tp_name);
     return 0;
-unpacking_failed:
-    if (!has_known_size && __Pyx_IterFinish() == 0)
-        __Pyx_RaiseNeedMoreValuesError(index);
-bad:
-    Py_XDECREF(iter);
-    Py_XDECREF(value1);
-    Py_XDECREF(value2);
-    if (decref_tuple) { Py_XDECREF(tuple); }
-    return -1;
-}
-
-/* dict_iter */
-static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* iterable, int is_dict, PyObject* method_name,
-                                                   Py_ssize_t* p_orig_length, int* p_source_is_dict) {
-    is_dict = is_dict || likely(PyDict_CheckExact(iterable));
-    *p_source_is_dict = is_dict;
-    if (is_dict) {
-#if !CYTHON_COMPILING_IN_PYPY
-        *p_orig_length = PyDict_Size(iterable);
-        Py_INCREF(iterable);
-        return iterable;
-#elif PY_MAJOR_VERSION >= 3
-        static PyObject *py_items = NULL, *py_keys = NULL, *py_values = NULL;
-        PyObject **pp = NULL;
-        if (method_name) {
-            const char *name = PyUnicode_AsUTF8(method_name);
-            if (strcmp(name, "iteritems") == 0) pp = &py_items;
-            else if (strcmp(name, "iterkeys") == 0) pp = &py_keys;
-            else if (strcmp(name, "itervalues") == 0) pp = &py_values;
-            if (pp) {
-                if (!*pp) {
-                    *pp = PyUnicode_FromString(name + 4);
-                    if (!*pp)
-                        return NULL;
-                }
-                method_name = *pp;
-            }
-        }
-#endif
-    }
-    *p_orig_length = 0;
-    if (method_name) {
-        PyObject* iter;
-        iterable = __Pyx_PyObject_CallMethod0(iterable, method_name);
-        if (!iterable)
-            return NULL;
-#if !CYTHON_COMPILING_IN_PYPY
-        if (PyTuple_CheckExact(iterable) || PyList_CheckExact(iterable))
-            return iterable;
-#endif
-        iter = PyObject_GetIter(iterable);
-        Py_DECREF(iterable);
-        return iter;
-    }
-    return PyObject_GetIter(iterable);
-}
-static CYTHON_INLINE int __Pyx_dict_iter_next(
-        PyObject* iter_obj, CYTHON_NCP_UNUSED Py_ssize_t orig_length, CYTHON_NCP_UNUSED Py_ssize_t* ppos,
-        PyObject** pkey, PyObject** pvalue, PyObject** pitem, int source_is_dict) {
-    PyObject* next_item;
-#if !CYTHON_COMPILING_IN_PYPY
-    if (source_is_dict) {
-        PyObject *key, *value;
-        if (unlikely(orig_length != PyDict_Size(iter_obj))) {
-            PyErr_SetString(PyExc_RuntimeError, "dictionary changed size during iteration");
-            return -1;
-        }
-        if (unlikely(!PyDict_Next(iter_obj, ppos, &key, &value))) {
-            return 0;
-        }
-        if (pitem) {
-            PyObject* tuple = PyTuple_New(2);
-            if (unlikely(!tuple)) {
-                return -1;
-            }
-            Py_INCREF(key);
-            Py_INCREF(value);
-            PyTuple_SET_ITEM(tuple, 0, key);
-            PyTuple_SET_ITEM(tuple, 1, value);
-            *pitem = tuple;
-        } else {
-            if (pkey) {
-                Py_INCREF(key);
-                *pkey = key;
-            }
-            if (pvalue) {
-                Py_INCREF(value);
-                *pvalue = value;
-            }
-        }
-        return 1;
-    } else if (PyTuple_CheckExact(iter_obj)) {
-        Py_ssize_t pos = *ppos;
-        if (unlikely(pos >= PyTuple_GET_SIZE(iter_obj))) return 0;
-        *ppos = pos + 1;
-        next_item = PyTuple_GET_ITEM(iter_obj, pos);
-        Py_INCREF(next_item);
-    } else if (PyList_CheckExact(iter_obj)) {
-        Py_ssize_t pos = *ppos;
-        if (unlikely(pos >= PyList_GET_SIZE(iter_obj))) return 0;
-        *ppos = pos + 1;
-        next_item = PyList_GET_ITEM(iter_obj, pos);
-        Py_INCREF(next_item);
-    } else
-#endif
-    {
-        next_item = PyIter_Next(iter_obj);
-        if (unlikely(!next_item)) {
-            return __Pyx_IterFinish();
-        }
-    }
-    if (pitem) {
-        *pitem = next_item;
-    } else if (pkey && pvalue) {
-        if (__Pyx_unpack_tuple2(next_item, pkey, pvalue, source_is_dict, source_is_dict, 1))
-            return -1;
-    } else if (pkey) {
-        *pkey = next_item;
-    } else {
-        *pvalue = next_item;
-    }
-    return 1;
 }
 
 /* PyObjectCall2Args */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
     PyObject *args, *result = NULL;
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(function)) {
@@ -20857,384 +20776,74 @@
     result = __Pyx_PyObject_Call(function, args, NULL);
     Py_DECREF(args);
     Py_DECREF(function);
 done:
     return result;
 }
 
-/* GetItemInt */
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
-    PyObject *r;
-    if (!j) return NULL;
-    r = PyObject_GetItem(o, j);
-    Py_DECREF(j);
-    return r;
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyList_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
-        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
-    }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyTuple_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
-        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
+/* PyObjectCallMethO */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
+    PyObject *self, *result;
+    PyCFunction cfunc;
+    cfunc = PyCFunction_GET_FUNCTION(func);
+    self = PyCFunction_GET_SELF(func);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = cfunc(self, arg);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
     }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
+    return result;
 }
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
-                                                     CYTHON_NCP_UNUSED int wraparound,
-                                                     CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
-    if (is_list || PyList_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
-        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
-            PyObject *r = PyList_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    }
-    else if (PyTuple_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
-        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
-            PyObject *r = PyTuple_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    } else {
-        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
-        if (likely(m && m->sq_item)) {
-            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
-                Py_ssize_t l = m->sq_length(o);
-                if (likely(l >= 0)) {
-                    i += l;
-                } else {
-                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                        return NULL;
-                    PyErr_Clear();
-                }
-            }
-            return m->sq_item(o, i);
-        }
-    }
-#else
-    if (is_list || PySequence_Check(o)) {
-        return PySequence_GetItem(o, i);
-    }
 #endif
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-}
 
-/* MemviewSliceInit */
-static int
-__Pyx_init_memviewslice(struct __pyx_memoryview_obj *memview,
-                        int ndim,
-                        __Pyx_memviewslice *memviewslice,
-                        int memview_is_new_reference)
-{
-    __Pyx_RefNannyDeclarations
-    int i, retval=-1;
-    Py_buffer *buf = &memview->view;
-    __Pyx_RefNannySetupContext("init_memviewslice", 0);
-    if (unlikely(memviewslice->memview || memviewslice->data)) {
-        PyErr_SetString(PyExc_ValueError,
-            "memviewslice is already initialized!");
-        goto fail;
-    }
-    if (buf->strides) {
-        for (i = 0; i < ndim; i++) {
-            memviewslice->strides[i] = buf->strides[i];
-        }
-    } else {
-        Py_ssize_t stride = buf->itemsize;
-        for (i = ndim - 1; i >= 0; i--) {
-            memviewslice->strides[i] = stride;
-            stride *= buf->shape[i];
-        }
-    }
-    for (i = 0; i < ndim; i++) {
-        memviewslice->shape[i]   = buf->shape[i];
-        if (buf->suboffsets) {
-            memviewslice->suboffsets[i] = buf->suboffsets[i];
-        } else {
-            memviewslice->suboffsets[i] = -1;
-        }
-    }
-    memviewslice->memview = memview;
-    memviewslice->data = (char *)buf->buf;
-    if (__pyx_add_acquisition_count(memview) == 0 && !memview_is_new_reference) {
-        Py_INCREF(memview);
-    }
-    retval = 0;
-    goto no_fail;
-fail:
-    memviewslice->memview = 0;
-    memviewslice->data = 0;
-    retval = -1;
-no_fail:
-    __Pyx_RefNannyFinishContext();
-    return retval;
-}
-#ifndef Py_NO_RETURN
-#define Py_NO_RETURN
-#endif
-static void __pyx_fatalerror(const char *fmt, ...) Py_NO_RETURN {
-    va_list vargs;
-    char msg[200];
-#if PY_VERSION_HEX >= 0x030A0000 || defined(HAVE_STDARG_PROTOTYPES)
-    va_start(vargs, fmt);
-#else
-    va_start(vargs);
-#endif
-    vsnprintf(msg, 200, fmt, vargs);
-    va_end(vargs);
-    Py_FatalError(msg);
-}
-static CYTHON_INLINE int
-__pyx_add_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
-                                   PyThread_type_lock lock)
-{
-    int result;
-    PyThread_acquire_lock(lock, 1);
-    result = (*acquisition_count)++;
-    PyThread_release_lock(lock);
-    return result;
-}
-static CYTHON_INLINE int
-__pyx_sub_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
-                                   PyThread_type_lock lock)
-{
-    int result;
-    PyThread_acquire_lock(lock, 1);
-    result = (*acquisition_count)--;
-    PyThread_release_lock(lock);
+/* PyObjectCallOneArg */
+#if CYTHON_COMPILING_IN_CPYTHON
+static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+    PyObject *result;
+    PyObject *args = PyTuple_New(1);
+    if (unlikely(!args)) return NULL;
+    Py_INCREF(arg);
+    PyTuple_SET_ITEM(args, 0, arg);
+    result = __Pyx_PyObject_Call(func, args, NULL);
+    Py_DECREF(args);
     return result;
 }
-static CYTHON_INLINE void
-__Pyx_INC_MEMVIEW(__Pyx_memviewslice *memslice, int have_gil, int lineno)
-{
-    int first_time;
-    struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (unlikely(!memview || (PyObject *) memview == Py_None))
-        return;
-    if (unlikely(__pyx_get_slice_count(memview) < 0))
-        __pyx_fatalerror("Acquisition count is %d (line %d)",
-                         __pyx_get_slice_count(memview), lineno);
-    first_time = __pyx_add_acquisition_count(memview) == 0;
-    if (unlikely(first_time)) {
-        if (have_gil) {
-            Py_INCREF((PyObject *) memview);
-        } else {
-            PyGILState_STATE _gilstate = PyGILState_Ensure();
-            Py_INCREF((PyObject *) memview);
-            PyGILState_Release(_gilstate);
-        }
-    }
-}
-static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *memslice,
-                                             int have_gil, int lineno) {
-    int last_time;
-    struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (unlikely(!memview || (PyObject *) memview == Py_None)) {
-        memslice->memview = NULL;
-        return;
-    }
-    if (unlikely(__pyx_get_slice_count(memview) <= 0))
-        __pyx_fatalerror("Acquisition count is %d (line %d)",
-                         __pyx_get_slice_count(memview), lineno);
-    last_time = __pyx_sub_acquisition_count(memview) == 1;
-    memslice->data = NULL;
-    if (unlikely(last_time)) {
-        if (have_gil) {
-            Py_CLEAR(memslice->memview);
-        } else {
-            PyGILState_STATE _gilstate = PyGILState_Ensure();
-            Py_CLEAR(memslice->memview);
-            PyGILState_Release(_gilstate);
-        }
-    } else {
-        memslice->memview = NULL;
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, &arg, 1);
     }
-}
-
-/* Profile */
-#if CYTHON_PROFILE
-static int __Pyx_TraceSetupAndCall(PyCodeObject** code,
-                                   PyFrameObject** frame,
-                                   PyThreadState* tstate,
-                                   const char *funcname,
-                                   const char *srcfile,
-                                   int firstlineno) {
-    PyObject *type, *value, *traceback;
-    int retval;
-    if (*frame == NULL || !CYTHON_PROFILE_REUSE_FRAME) {
-        if (*code == NULL) {
-            *code = __Pyx_createFrameCodeObject(funcname, srcfile, firstlineno);
-            if (*code == NULL) return 0;
-        }
-        *frame = PyFrame_New(
-            tstate,                          /*PyThreadState *tstate*/
-            *code,                           /*PyCodeObject *code*/
-            __pyx_d,                  /*PyObject *globals*/
-            0                                /*PyObject *locals*/
-        );
-        if (*frame == NULL) return 0;
-        if (CYTHON_TRACE && (*frame)->f_trace == NULL) {
-            Py_INCREF(Py_None);
-            (*frame)->f_trace = Py_None;
-        }
-#if PY_VERSION_HEX < 0x030400B1
-    } else {
-        (*frame)->f_tstate = tstate;
 #endif
+    if (likely(PyCFunction_Check(func))) {
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
+            return __Pyx_PyObject_CallMethO(func, arg);
+#if CYTHON_FAST_PYCCALL
+        } else if (__Pyx_PyFastCFunction_Check(func)) {
+            return __Pyx_PyCFunction_FastCall(func, &arg, 1);
+#endif
+        }
     }
-    __Pyx_PyFrame_SetLineNumber(*frame, firstlineno);
-    retval = 1;
-    __Pyx_EnterTracing(tstate);
-    __Pyx_ErrFetchInState(tstate, &type, &value, &traceback);
-    #if CYTHON_TRACE
-    if (tstate->c_tracefunc)
-        retval = tstate->c_tracefunc(tstate->c_traceobj, *frame, PyTrace_CALL, NULL) == 0;
-    if (retval && tstate->c_profilefunc)
-    #endif
-        retval = tstate->c_profilefunc(tstate->c_profileobj, *frame, PyTrace_CALL, NULL) == 0;
-    __Pyx_LeaveTracing(tstate);
-    if (retval) {
-        __Pyx_ErrRestoreInState(tstate, type, value, traceback);
-        return __Pyx_IsTracing(tstate, 0, 0) && retval;
-    } else {
-        Py_XDECREF(type);
-        Py_XDECREF(value);
-        Py_XDECREF(traceback);
-        return -1;
-    }
+    return __Pyx__PyObject_CallOneArg(func, arg);
 }
-static PyCodeObject *__Pyx_createFrameCodeObject(const char *funcname, const char *srcfile, int firstlineno) {
-    PyCodeObject *py_code = 0;
-#if PY_MAJOR_VERSION >= 3
-    py_code = PyCode_NewEmpty(srcfile, funcname, firstlineno);
-    if (likely(py_code)) {
-        py_code->co_flags |= CO_OPTIMIZED | CO_NEWLOCALS;
-    }
 #else
-    PyObject *py_srcfile = 0;
-    PyObject *py_funcname = 0;
-    py_funcname = PyString_FromString(funcname);
-    if (unlikely(!py_funcname)) goto bad;
-    py_srcfile = PyString_FromString(srcfile);
-    if (unlikely(!py_srcfile)) goto bad;
-    py_code = PyCode_New(
-        0,
-        0,
-        0,
-        CO_OPTIMIZED | CO_NEWLOCALS,
-        __pyx_empty_bytes,     /*PyObject *code,*/
-        __pyx_empty_tuple,     /*PyObject *consts,*/
-        __pyx_empty_tuple,     /*PyObject *names,*/
-        __pyx_empty_tuple,     /*PyObject *varnames,*/
-        __pyx_empty_tuple,     /*PyObject *freevars,*/
-        __pyx_empty_tuple,     /*PyObject *cellvars,*/
-        py_srcfile,       /*PyObject *filename,*/
-        py_funcname,      /*PyObject *name,*/
-        firstlineno,
-        __pyx_empty_bytes      /*PyObject *lnotab*/
-    );
-bad:
-    Py_XDECREF(py_srcfile);
-    Py_XDECREF(py_funcname);
-#endif
-    return py_code;
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+    PyObject *result;
+    PyObject *args = PyTuple_Pack(1, arg);
+    if (unlikely(!args)) return NULL;
+    result = __Pyx_PyObject_Call(func, args, NULL);
+    Py_DECREF(args);
+    return result;
 }
 #endif
 
-/* WriteUnraisableException */
-static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
-                                  CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename,
-                                  int full_traceback, CYTHON_UNUSED int nogil) {
-    PyObject *old_exc, *old_val, *old_tb;
-    PyObject *ctx;
-    __Pyx_PyThreadState_declare
-#ifdef WITH_THREAD
-    PyGILState_STATE state;
-    if (nogil)
-        state = PyGILState_Ensure();
-    else state = (PyGILState_STATE)0;
-#endif
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
-    if (full_traceback) {
-        Py_XINCREF(old_exc);
-        Py_XINCREF(old_val);
-        Py_XINCREF(old_tb);
-        __Pyx_ErrRestore(old_exc, old_val, old_tb);
-        PyErr_PrintEx(1);
-    }
-    #if PY_MAJOR_VERSION < 3
-    ctx = PyString_FromString(name);
-    #else
-    ctx = PyUnicode_FromString(name);
-    #endif
-    __Pyx_ErrRestore(old_exc, old_val, old_tb);
-    if (!ctx) {
-        PyErr_WriteUnraisable(Py_None);
-    } else {
-        PyErr_WriteUnraisable(ctx);
-        Py_DECREF(ctx);
-    }
-#ifdef WITH_THREAD
-    if (nogil)
-        PyGILState_Release(state);
-#endif
-}
-
-/* ArgTypeTest */
-static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
-{
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
-    }
-    else if (exact) {
-        #if PY_MAJOR_VERSION == 2
-        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
-        #endif
-    }
-    else {
-        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
-    }
-    PyErr_Format(PyExc_TypeError,
-        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
-        name, type->tp_name, Py_TYPE(obj)->tp_name);
-    return 0;
-}
-
 /* BytesEquals */
 static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
 #if CYTHON_COMPILING_IN_PYPY
     return PyObject_RichCompareBool(s1, s2, equals);
 #else
     if (s1 == s2) {
         return (equals == Py_EQ);
@@ -21397,14 +21006,101 @@
     if (likely(PyString_Check(n)))
 #endif
         return __Pyx_PyObject_GetAttrStr(o, n);
 #endif
     return PyObject_GetAttr(o, n);
 }
 
+/* GetItemInt */
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
+    PyObject *r;
+    if (!j) return NULL;
+    r = PyObject_GetItem(o, j);
+    Py_DECREF(j);
+    return r;
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyList_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
+        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyTuple_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
+        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
+                                                     CYTHON_NCP_UNUSED int wraparound,
+                                                     CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
+    if (is_list || PyList_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
+        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
+            PyObject *r = PyList_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    }
+    else if (PyTuple_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
+        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
+            PyObject *r = PyTuple_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    } else {
+        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
+        if (likely(m && m->sq_item)) {
+            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
+                Py_ssize_t l = m->sq_length(o);
+                if (likely(l >= 0)) {
+                    i += l;
+                } else {
+                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
+                        return NULL;
+                    PyErr_Clear();
+                }
+            }
+            return m->sq_item(o, i);
+        }
+    }
+#else
+    if (is_list || PySequence_Check(o)) {
+        return PySequence_GetItem(o, i);
+    }
+#endif
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+}
+
 /* ObjectGetItem */
 #if CYTHON_USE_TYPE_SLOTS
 static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject* index) {
     PyObject *runerr = NULL;
     Py_ssize_t key_value;
     PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
     if (unlikely(!(m && m->sq_item))) {
@@ -21499,40 +21195,14 @@
     return d;
 }
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *o, PyObject *n, PyObject *d) {
     PyObject *r = __Pyx_GetAttr(o, n);
     return (likely(r)) ? r : __Pyx_GetAttr3Default(d);
 }
 
-/* PyDictVersioning */
-#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
-}
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
-    PyObject **dictptr = NULL;
-    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
-    if (offset) {
-#if CYTHON_COMPILING_IN_CPYTHON
-        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
-#else
-        dictptr = _PyObject_GetDictPtr(obj);
-#endif
-    }
-    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
-}
-static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
-        return 0;
-    return obj_dict_version == __Pyx_get_object_dict_version(obj);
-}
-#endif
-
 /* GetModuleGlobalName */
 #if CYTHON_USE_DICT_VERSIONS
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
 #else
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
 #endif
 {
@@ -21560,25 +21230,30 @@
         return __Pyx_NewRef(result);
     }
     PyErr_Clear();
 #endif
     return __Pyx_GetBuiltinName(name);
 }
 
-/* ExtTypeTest */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
-    }
-    if (likely(__Pyx_TypeCheck(obj, type)))
-        return 1;
-    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
-                 Py_TYPE(obj)->tp_name, type->tp_name);
-    return 0;
+/* RaiseTooManyValuesToUnpack */
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
+    PyErr_Format(PyExc_ValueError,
+                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
+}
+
+/* RaiseNeedMoreValuesToUnpack */
+static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
+    PyErr_Format(PyExc_ValueError,
+                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
+                 index, (index == 1) ? "" : "s");
+}
+
+/* RaiseNoneIterError */
+static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
 }
 
 /* GetTopmostException */
 #if CYTHON_USE_EXC_INFO_STACK
 static _PyErr_StackItem *
 __Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
 {
@@ -22027,19 +21702,14 @@
             PyFPE_END_PROTECT(result)
             return PyFloat_FromDouble(result);
     }
     return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
 }
 #endif
 
-/* None */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
-    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
-}
-
 /* DivInt[long] */
 static CYTHON_INLINE long __Pyx_div_long(long a, long b) {
     long q = a / b;
     long r = a - q*b;
     q -= ((r != 0) & ((r ^ b) < 0));
     return q;
 }
@@ -22266,1026 +21936,93 @@
     Py_XDECREF(reduce_ex);
     Py_XDECREF(reduce_cython);
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 
-/* FetchCommonType */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
-    PyObject* fake_module;
-    PyTypeObject* cached_type = NULL;
-    fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
-    if (!fake_module) return NULL;
-    Py_INCREF(fake_module);
-    cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
-    if (cached_type) {
-        if (!PyType_Check((PyObject*)cached_type)) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s is not a type object",
-                type->tp_name);
-            goto bad;
-        }
-        if (cached_type->tp_basicsize != type->tp_basicsize) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s has the wrong size, try recompiling",
-                type->tp_name);
-            goto bad;
-        }
-    } else {
-        if (!PyErr_ExceptionMatches(PyExc_AttributeError)) goto bad;
-        PyErr_Clear();
-        if (PyType_Ready(type) < 0) goto bad;
-        if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject*) type) < 0)
-            goto bad;
-        Py_INCREF(type);
-        cached_type = type;
-    }
-done:
-    Py_DECREF(fake_module);
-    return cached_type;
-bad:
-    Py_XDECREF(cached_type);
-    cached_type = NULL;
-    goto done;
-}
-
-/* CythonFunctionShared */
-#include <structmember.h>
-static PyObject *
-__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
-{
-    if (unlikely(op->func_doc == NULL)) {
-        if (op->func.m_ml->ml_doc) {
-#if PY_MAJOR_VERSION >= 3
-            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
-#else
-            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
-#endif
-            if (unlikely(op->func_doc == NULL))
-                return NULL;
-        } else {
-            Py_INCREF(Py_None);
-            return Py_None;
-        }
-    }
-    Py_INCREF(op->func_doc);
-    return op->func_doc;
-}
-static int
-__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp = op->func_doc;
-    if (value == NULL) {
-        value = Py_None;
-    }
-    Py_INCREF(value);
-    op->func_doc = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_name == NULL)) {
-#if PY_MAJOR_VERSION >= 3
-        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
-#else
-        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
-#endif
-        if (unlikely(op->func_name == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_name);
-    return op->func_name;
-}
-static int
-__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
+/* TypeImport */
+#ifndef __PYX_HAVE_RT_ImportType
+#define __PYX_HAVE_RT_ImportType
+static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, enum __Pyx_ImportType_CheckSize check_size)
 {
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
+    PyObject *result = 0;
+    char warning[200];
+    Py_ssize_t basicsize;
+#ifdef Py_LIMITED_API
+    PyObject *py_basicsize;
 #endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__name__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_name;
-    Py_INCREF(value);
-    op->func_name = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_qualname);
-    return op->func_qualname;
-}
-static int
-__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
-#endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__qualname__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_qualname;
-    Py_INCREF(value);
-    op->func_qualname = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
-{
-    PyObject *self;
-    self = m->func_closure;
-    if (self == NULL)
-        self = Py_None;
-    Py_INCREF(self);
-    return self;
-}
-static PyObject *
-__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_dict == NULL)) {
-        op->func_dict = PyDict_New();
-        if (unlikely(op->func_dict == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_dict);
-    return op->func_dict;
-}
-static int
-__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-    if (unlikely(value == NULL)) {
-        PyErr_SetString(PyExc_TypeError,
-               "function's dictionary may not be deleted");
-        return -1;
-    }
-    if (unlikely(!PyDict_Check(value))) {
-        PyErr_SetString(PyExc_TypeError,
-               "setting function's dictionary to a non-dict");
-        return -1;
-    }
-    tmp = op->func_dict;
-    Py_INCREF(value);
-    op->func_dict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_globals);
-    return op->func_globals;
-}
-static PyObject *
-__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(Py_None);
-    return Py_None;
-}
-static PyObject *
-__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    PyObject* result = (op->func_code) ? op->func_code : Py_None;
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
-    int result = 0;
-    PyObject *res = op->defaults_getter((PyObject *) op);
-    if (unlikely(!res))
-        return -1;
-    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
-    Py_INCREF(op->defaults_tuple);
-    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
-    Py_INCREF(op->defaults_kwdict);
-    #else
-    op->defaults_tuple = PySequence_ITEM(res, 0);
-    if (unlikely(!op->defaults_tuple)) result = -1;
-    else {
-        op->defaults_kwdict = PySequence_ITEM(res, 1);
-        if (unlikely(!op->defaults_kwdict)) result = -1;
-    }
-    #endif
-    Py_DECREF(res);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyTuple_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__defaults__ must be set to a tuple object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_tuple;
-    op->defaults_tuple = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_tuple;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_tuple;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__kwdefaults__ must be set to a dict object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_kwdict;
-    op->defaults_kwdict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_kwdict;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_kwdict;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value || value == Py_None) {
-        value = NULL;
-    } else if (!PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__annotations__ must be set to a dict object");
-        return -1;
-    }
-    Py_XINCREF(value);
-    tmp = op->func_annotations;
-    op->func_annotations = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->func_annotations;
-    if (unlikely(!result)) {
-        result = PyDict_New();
-        if (unlikely(!result)) return NULL;
-        op->func_annotations = result;
+    result = PyObject_GetAttrString(module, class_name);
+    if (!result)
+        goto bad;
+    if (!PyType_Check(result)) {
+        PyErr_Format(PyExc_TypeError,
+            "%.200s.%.200s is not a type object",
+            module_name, class_name);
+        goto bad;
     }
-    Py_INCREF(result);
-    return result;
-}
-static PyGetSetDef __pyx_CyFunction_getsets[] = {
-    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
-    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
-    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
-    {(char *) "__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
-    {0, 0, 0, 0, 0}
-};
-static PyMemberDef __pyx_CyFunction_members[] = {
-    {(char *) "__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module), PY_WRITE_RESTRICTED, 0},
-    {0, 0, 0,  0, 0}
-};
-static PyObject *
-__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
-{
-#if PY_MAJOR_VERSION >= 3
-    Py_INCREF(m->func_qualname);
-    return m->func_qualname;
-#else
-    return PyString_FromString(m->func.m_ml->ml_name);
-#endif
-}
-static PyMethodDef __pyx_CyFunction_methods[] = {
-    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
-    {0, 0, 0, 0}
-};
-#if PY_VERSION_HEX < 0x030500A0
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
+#ifndef Py_LIMITED_API
+    basicsize = ((PyTypeObject *)result)->tp_basicsize;
 #else
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
+    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
+    if (!py_basicsize)
+        goto bad;
+    basicsize = PyLong_AsSsize_t(py_basicsize);
+    Py_DECREF(py_basicsize);
+    py_basicsize = 0;
+    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op, PyMethodDef *ml, int flags, PyObject* qualname,
-                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    if (unlikely(op == NULL))
-        return NULL;
-    op->flags = flags;
-    __Pyx_CyFunction_weakreflist(op) = NULL;
-    op->func.m_ml = ml;
-    op->func.m_self = (PyObject *) op;
-    Py_XINCREF(closure);
-    op->func_closure = closure;
-    Py_XINCREF(module);
-    op->func.m_module = module;
-    op->func_dict = NULL;
-    op->func_name = NULL;
-    Py_INCREF(qualname);
-    op->func_qualname = qualname;
-    op->func_doc = NULL;
-    op->func_classobj = NULL;
-    op->func_globals = globals;
-    Py_INCREF(op->func_globals);
-    Py_XINCREF(code);
-    op->func_code = code;
-    op->defaults_pyobjects = 0;
-    op->defaults_size = 0;
-    op->defaults = NULL;
-    op->defaults_tuple = NULL;
-    op->defaults_kwdict = NULL;
-    op->defaults_getter = NULL;
-    op->func_annotations = NULL;
-    return (PyObject *) op;
-}
-static int
-__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
-{
-    Py_CLEAR(m->func_closure);
-    Py_CLEAR(m->func.m_module);
-    Py_CLEAR(m->func_dict);
-    Py_CLEAR(m->func_name);
-    Py_CLEAR(m->func_qualname);
-    Py_CLEAR(m->func_doc);
-    Py_CLEAR(m->func_globals);
-    Py_CLEAR(m->func_code);
-    Py_CLEAR(m->func_classobj);
-    Py_CLEAR(m->defaults_tuple);
-    Py_CLEAR(m->defaults_kwdict);
-    Py_CLEAR(m->func_annotations);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_XDECREF(pydefaults[i]);
-        PyObject_Free(m->defaults);
-        m->defaults = NULL;
-    }
-    return 0;
-}
-static void __Pyx__CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    if (__Pyx_CyFunction_weakreflist(m) != NULL)
-        PyObject_ClearWeakRefs((PyObject *) m);
-    __Pyx_CyFunction_clear(m);
-    PyObject_GC_Del(m);
-}
-static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    PyObject_GC_UnTrack(m);
-    __Pyx__CyFunction_dealloc(m);
-}
-static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
-{
-    Py_VISIT(m->func_closure);
-    Py_VISIT(m->func.m_module);
-    Py_VISIT(m->func_dict);
-    Py_VISIT(m->func_name);
-    Py_VISIT(m->func_qualname);
-    Py_VISIT(m->func_doc);
-    Py_VISIT(m->func_globals);
-    Py_VISIT(m->func_code);
-    Py_VISIT(m->func_classobj);
-    Py_VISIT(m->defaults_tuple);
-    Py_VISIT(m->defaults_kwdict);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_VISIT(pydefaults[i]);
+    if ((size_t)basicsize < size) {
+        PyErr_Format(PyExc_ValueError,
+            "%.200s.%.200s size changed, may indicate binary incompatibility. "
+            "Expected %zd from C header, got %zd from PyObject",
+            module_name, class_name, size, basicsize);
+        goto bad;
     }
-    return 0;
-}
-static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
-{
-#if PY_MAJOR_VERSION < 3
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
-        Py_INCREF(func);
-        return func;
-    }
-    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
-        if (type == NULL)
-            type = (PyObject *)(Py_TYPE(obj));
-        return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
+    if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
+        PyErr_Format(PyExc_ValueError,
+            "%.200s.%.200s size changed, may indicate binary incompatibility. "
+            "Expected %zd from C header, got %zd from PyObject",
+            module_name, class_name, size, basicsize);
+        goto bad;
     }
-    if (obj == Py_None)
-        obj = NULL;
-#endif
-    return __Pyx_PyMethod_New(func, obj, type);
-}
-static PyObject*
-__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
-{
-#if PY_MAJOR_VERSION >= 3
-    return PyUnicode_FromFormat("<cyfunction %U at %p>",
-                                op->func_qualname, (void *)op);
-#else
-    return PyString_FromFormat("<cyfunction %s at %p>",
-                               PyString_AsString(op->func_qualname), (void *)op);
-#endif
-}
-static PyObject * __Pyx_CyFunction_CallMethod(PyObject *func, PyObject *self, PyObject *arg, PyObject *kw) {
-    PyCFunctionObject* f = (PyCFunctionObject*)func;
-    PyCFunction meth = f->m_ml->ml_meth;
-    Py_ssize_t size;
-    switch (f->m_ml->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
-    case METH_VARARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0))
-            return (*meth)(self, arg);
-        break;
-    case METH_VARARGS | METH_KEYWORDS:
-        return (*(PyCFunctionWithKeywords)(void*)meth)(self, arg, kw);
-    case METH_NOARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 0))
-                return (*meth)(self, NULL);
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    case METH_O:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 1)) {
-                PyObject *result, *arg0;
-                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                arg0 = PyTuple_GET_ITEM(arg, 0);
-                #else
-                arg0 = PySequence_ITEM(arg, 0); if (unlikely(!arg0)) return NULL;
-                #endif
-                result = (*meth)(self, arg0);
-                #if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-                Py_DECREF(arg0);
-                #endif
-                return result;
-            }
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    default:
-        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
-                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
-                        "longer supported!");
-        return NULL;
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn && (size_t)basicsize > size) {
+        PyOS_snprintf(warning, sizeof(warning),
+            "%s.%s size changed, may indicate binary incompatibility. "
+            "Expected %zd from C header, got %zd from PyObject",
+            module_name, class_name, size, basicsize);
+        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
-    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
-                 f->m_ml->ml_name);
+    return (PyTypeObject *)result;
+bad:
+    Py_XDECREF(result);
     return NULL;
 }
-static CYTHON_INLINE PyObject *__Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    return __Pyx_CyFunction_CallMethod(func, ((PyCFunctionObject*)func)->m_self, arg, kw);
-}
-static PyObject *__Pyx_CyFunction_CallAsMethod(PyObject *func, PyObject *args, PyObject *kw) {
-    PyObject *result;
-    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *) func;
-    if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) && !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
-        Py_ssize_t argc;
-        PyObject *new_args;
-        PyObject *self;
-        argc = PyTuple_GET_SIZE(args);
-        new_args = PyTuple_GetSlice(args, 1, argc);
-        if (unlikely(!new_args))
-            return NULL;
-        self = PyTuple_GetItem(args, 0);
-        if (unlikely(!self)) {
-            Py_DECREF(new_args);
-#if PY_MAJOR_VERSION > 2
-            PyErr_Format(PyExc_TypeError,
-                         "unbound method %.200S() needs an argument",
-                         cyfunc->func_qualname);
-#else
-            PyErr_SetString(PyExc_TypeError,
-                            "unbound method needs an argument");
 #endif
-            return NULL;
-        }
-        result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
-        Py_DECREF(new_args);
-    } else {
-        result = __Pyx_CyFunction_Call(func, args, kw);
-    }
-    return result;
-}
-static PyTypeObject __pyx_CyFunctionType_type = {
-    PyVarObject_HEAD_INIT(0, 0)
-    "cython_function_or_method",
-    sizeof(__pyx_CyFunctionObject),
-    0,
-    (destructor) __Pyx_CyFunction_dealloc,
-    0,
-    0,
-    0,
-#if PY_MAJOR_VERSION < 3
-    0,
-#else
-    0,
-#endif
-    (reprfunc) __Pyx_CyFunction_repr,
-    0,
-    0,
-    0,
-    0,
-    __Pyx_CyFunction_CallAsMethod,
-    0,
-    0,
-    0,
-    0,
-    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
-    0,
-    (traverseproc) __Pyx_CyFunction_traverse,
-    (inquiry) __Pyx_CyFunction_clear,
-    0,
-#if PY_VERSION_HEX < 0x030500A0
-    offsetof(__pyx_CyFunctionObject, func_weakreflist),
-#else
-    offsetof(PyCFunctionObject, m_weakreflist),
-#endif
-    0,
-    0,
-    __pyx_CyFunction_methods,
-    __pyx_CyFunction_members,
-    __pyx_CyFunction_getsets,
-    0,
-    0,
-    __Pyx_CyFunction_descr_get,
-    0,
-    offsetof(__pyx_CyFunctionObject, func_dict),
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-#if PY_VERSION_HEX >= 0x030400a1
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-    0,
-#endif
-#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-    0,
-#endif
-};
-static int __pyx_CyFunction_init(void) {
-    __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
-    if (unlikely(__pyx_CyFunctionType == NULL)) {
-        return -1;
-    }
-    return 0;
-}
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults = PyObject_Malloc(size);
-    if (unlikely(!m->defaults))
-        return PyErr_NoMemory();
-    memset(m->defaults, 0, size);
-    m->defaults_pyobjects = pyobjects;
-    m->defaults_size = size;
-    return m->defaults;
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_tuple = tuple;
-    Py_INCREF(tuple);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_kwdict = dict;
-    Py_INCREF(dict);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->func_annotations = dict;
-    Py_INCREF(dict);
-}
 
-/* FusedFunction */
-static PyObject *
-__pyx_FusedFunction_New(PyMethodDef *ml, int flags,
-                        PyObject *qualname, PyObject *closure,
-                        PyObject *module, PyObject *globals,
-                        PyObject *code)
-{
-    PyObject *op = __Pyx_CyFunction_Init(
-        PyObject_GC_New(__pyx_CyFunctionObject, __pyx_FusedFunctionType),
-        ml, flags, qualname, closure, module, globals, code
-    );
-    if (likely(op)) {
-        __pyx_FusedFunctionObject *fusedfunc = (__pyx_FusedFunctionObject *) op;
-        fusedfunc->__signatures__ = NULL;
-        fusedfunc->type = NULL;
-        fusedfunc->self = NULL;
-        PyObject_GC_Track(op);
-    }
-    return op;
-}
-static void
-__pyx_FusedFunction_dealloc(__pyx_FusedFunctionObject *self)
-{
-    PyObject_GC_UnTrack(self);
-    Py_CLEAR(self->self);
-    Py_CLEAR(self->type);
-    Py_CLEAR(self->__signatures__);
-    __Pyx__CyFunction_dealloc((__pyx_CyFunctionObject *) self);
-}
-static int
-__pyx_FusedFunction_traverse(__pyx_FusedFunctionObject *self,
-                             visitproc visit,
-                             void *arg)
-{
-    Py_VISIT(self->self);
-    Py_VISIT(self->type);
-    Py_VISIT(self->__signatures__);
-    return __Pyx_CyFunction_traverse((__pyx_CyFunctionObject *) self, visit, arg);
-}
-static int
-__pyx_FusedFunction_clear(__pyx_FusedFunctionObject *self)
-{
-    Py_CLEAR(self->self);
-    Py_CLEAR(self->type);
-    Py_CLEAR(self->__signatures__);
-    return __Pyx_CyFunction_clear((__pyx_CyFunctionObject *) self);
-}
-static PyObject *
-__pyx_FusedFunction_descr_get(PyObject *self, PyObject *obj, PyObject *type)
-{
-    __pyx_FusedFunctionObject *func, *meth;
-    func = (__pyx_FusedFunctionObject *) self;
-    if (func->self || func->func.flags & __Pyx_CYFUNCTION_STATICMETHOD) {
-        Py_INCREF(self);
-        return self;
-    }
-    if (obj == Py_None)
-        obj = NULL;
-    meth = (__pyx_FusedFunctionObject *) __pyx_FusedFunction_New(
-                    ((PyCFunctionObject *) func)->m_ml,
-                    ((__pyx_CyFunctionObject *) func)->flags,
-                    ((__pyx_CyFunctionObject *) func)->func_qualname,
-                    ((__pyx_CyFunctionObject *) func)->func_closure,
-                    ((PyCFunctionObject *) func)->m_module,
-                    ((__pyx_CyFunctionObject *) func)->func_globals,
-                    ((__pyx_CyFunctionObject *) func)->func_code);
-    if (!meth)
-        return NULL;
-    if (func->func.defaults) {
-        PyObject **pydefaults;
-        int i;
-        if (!__Pyx_CyFunction_InitDefaults((PyObject*)meth,
-                                      func->func.defaults_size,
-                                      func->func.defaults_pyobjects)) {
-            Py_XDECREF((PyObject*)meth);
-            return NULL;
-        }
-        memcpy(meth->func.defaults, func->func.defaults, func->func.defaults_size);
-        pydefaults = __Pyx_CyFunction_Defaults(PyObject *, meth);
-        for (i = 0; i < meth->func.defaults_pyobjects; i++)
-            Py_XINCREF(pydefaults[i]);
-    }
-    Py_XINCREF(func->func.func_classobj);
-    meth->func.func_classobj = func->func.func_classobj;
-    Py_XINCREF(func->__signatures__);
-    meth->__signatures__ = func->__signatures__;
-    Py_XINCREF(type);
-    meth->type = type;
-    Py_XINCREF(func->func.defaults_tuple);
-    meth->func.defaults_tuple = func->func.defaults_tuple;
-    if (func->func.flags & __Pyx_CYFUNCTION_CLASSMETHOD)
-        obj = type;
-    Py_XINCREF(obj);
-    meth->self = obj;
-    return (PyObject *) meth;
-}
-static PyObject *
-_obj_to_str(PyObject *obj)
-{
-    if (PyType_Check(obj))
-        return PyObject_GetAttr(obj, __pyx_n_s_name_2);
-    else
-        return PyObject_Str(obj);
-}
-static PyObject *
-__pyx_FusedFunction_getitem(__pyx_FusedFunctionObject *self, PyObject *idx)
-{
-    PyObject *signature = NULL;
-    PyObject *unbound_result_func;
-    PyObject *result_func = NULL;
-    if (self->__signatures__ == NULL) {
-        PyErr_SetString(PyExc_TypeError, "Function is not fused");
-        return NULL;
-    }
-    if (PyTuple_Check(idx)) {
-        PyObject *list = PyList_New(0);
-        Py_ssize_t n = PyTuple_GET_SIZE(idx);
-        PyObject *sep = NULL;
-        int i;
-        if (unlikely(!list))
-            return NULL;
-        for (i = 0; i < n; i++) {
-            int ret;
-            PyObject *string;
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            PyObject *item = PyTuple_GET_ITEM(idx, i);
-#else
-            PyObject *item = PySequence_ITEM(idx, i);  if (unlikely(!item)) goto __pyx_err;
-#endif
-            string = _obj_to_str(item);
-#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-            Py_DECREF(item);
-#endif
-            if (unlikely(!string)) goto __pyx_err;
-            ret = PyList_Append(list, string);
-            Py_DECREF(string);
-            if (unlikely(ret < 0)) goto __pyx_err;
-        }
-        sep = PyUnicode_FromString("|");
-        if (likely(sep))
-            signature = PyUnicode_Join(sep, list);
-__pyx_err:
-;
-        Py_DECREF(list);
-        Py_XDECREF(sep);
-    } else {
-        signature = _obj_to_str(idx);
-    }
-    if (!signature)
-        return NULL;
-    unbound_result_func = PyObject_GetItem(self->__signatures__, signature);
-    if (unbound_result_func) {
-        if (self->self || self->type) {
-            __pyx_FusedFunctionObject *unbound = (__pyx_FusedFunctionObject *) unbound_result_func;
-            Py_CLEAR(unbound->func.func_classobj);
-            Py_XINCREF(self->func.func_classobj);
-            unbound->func.func_classobj = self->func.func_classobj;
-            result_func = __pyx_FusedFunction_descr_get(unbound_result_func,
-                                                        self->self, self->type);
-        } else {
-            result_func = unbound_result_func;
-            Py_INCREF(result_func);
-        }
-    }
-    Py_DECREF(signature);
-    Py_XDECREF(unbound_result_func);
-    return result_func;
-}
-static PyObject *
-__pyx_FusedFunction_callfunction(PyObject *func, PyObject *args, PyObject *kw)
-{
-     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *) func;
-    int static_specialized = (cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD &&
-                              !((__pyx_FusedFunctionObject *) func)->__signatures__);
-    if (cyfunc->flags & __Pyx_CYFUNCTION_CCLASS && !static_specialized) {
-        return __Pyx_CyFunction_CallAsMethod(func, args, kw);
-    } else {
-        return __Pyx_CyFunction_Call(func, args, kw);
-    }
-}
-static PyObject *
-__pyx_FusedFunction_call(PyObject *func, PyObject *args, PyObject *kw)
-{
-    __pyx_FusedFunctionObject *binding_func = (__pyx_FusedFunctionObject *) func;
-    Py_ssize_t argc = PyTuple_GET_SIZE(args);
-    PyObject *new_args = NULL;
-    __pyx_FusedFunctionObject *new_func = NULL;
-    PyObject *result = NULL;
-    PyObject *self = NULL;
-    int is_staticmethod = binding_func->func.flags & __Pyx_CYFUNCTION_STATICMETHOD;
-    int is_classmethod = binding_func->func.flags & __Pyx_CYFUNCTION_CLASSMETHOD;
-    if (binding_func->self) {
-        Py_ssize_t i;
-        new_args = PyTuple_New(argc + 1);
-        if (!new_args)
-            return NULL;
-        self = binding_func->self;
-#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-        Py_INCREF(self);
-#endif
-        Py_INCREF(self);
-        PyTuple_SET_ITEM(new_args, 0, self);
-        for (i = 0; i < argc; i++) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            PyObject *item = PyTuple_GET_ITEM(args, i);
-            Py_INCREF(item);
-#else
-            PyObject *item = PySequence_ITEM(args, i);  if (unlikely(!item)) goto bad;
-#endif
-            PyTuple_SET_ITEM(new_args, i + 1, item);
-        }
-        args = new_args;
-    } else if (binding_func->type) {
-        if (argc < 1) {
-            PyErr_SetString(PyExc_TypeError, "Need at least one argument, 0 given.");
-            return NULL;
-        }
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        self = PyTuple_GET_ITEM(args, 0);
+/* GetVTable */
+static void* __Pyx_GetVtable(PyObject *dict) {
+    void* ptr;
+    PyObject *ob = PyObject_GetItem(dict, __pyx_n_s_pyx_vtable);
+    if (!ob)
+        goto bad;
+#if PY_VERSION_HEX >= 0x02070000
+    ptr = PyCapsule_GetPointer(ob, 0);
 #else
-        self = PySequence_ITEM(args, 0);  if (unlikely(!self)) return NULL;
+    ptr = PyCObject_AsVoidPtr(ob);
 #endif
-    }
-    if (self && !is_classmethod && !is_staticmethod) {
-        int is_instance = PyObject_IsInstance(self, binding_func->type);
-        if (unlikely(!is_instance)) {
-            PyErr_Format(PyExc_TypeError,
-                         "First argument should be of type %.200s, got %.200s.",
-                         ((PyTypeObject *) binding_func->type)->tp_name,
-                         Py_TYPE(self)->tp_name);
-            goto bad;
-        } else if (unlikely(is_instance == -1)) {
-            goto bad;
-        }
-    }
-#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-    Py_XDECREF(self);
-    self = NULL;
-#endif
-    if (binding_func->__signatures__) {
-        PyObject *tup;
-        if (is_staticmethod && binding_func->func.flags & __Pyx_CYFUNCTION_CCLASS) {
-            tup = PyTuple_Pack(3, args,
-                               kw == NULL ? Py_None : kw,
-                               binding_func->func.defaults_tuple);
-            if (unlikely(!tup)) goto bad;
-            new_func = (__pyx_FusedFunctionObject *) __Pyx_CyFunction_CallMethod(
-                func, binding_func->__signatures__, tup, NULL);
-        } else {
-            tup = PyTuple_Pack(4, binding_func->__signatures__, args,
-                               kw == NULL ? Py_None : kw,
-                               binding_func->func.defaults_tuple);
-            if (unlikely(!tup)) goto bad;
-            new_func = (__pyx_FusedFunctionObject *) __pyx_FusedFunction_callfunction(func, tup, NULL);
-        }
-        Py_DECREF(tup);
-        if (unlikely(!new_func))
-            goto bad;
-        Py_XINCREF(binding_func->func.func_classobj);
-        Py_CLEAR(new_func->func.func_classobj);
-        new_func->func.func_classobj = binding_func->func.func_classobj;
-        func = (PyObject *) new_func;
-    }
-    result = __pyx_FusedFunction_callfunction(func, args, kw);
+    if (!ptr && !PyErr_Occurred())
+        PyErr_SetString(PyExc_RuntimeError, "invalid vtable found for imported type");
+    Py_DECREF(ob);
+    return ptr;
 bad:
-#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-    Py_XDECREF(self);
-#endif
-    Py_XDECREF(new_args);
-    Py_XDECREF((PyObject *) new_func);
-    return result;
-}
-static PyMemberDef __pyx_FusedFunction_members[] = {
-    {(char *) "__signatures__",
-     T_OBJECT,
-     offsetof(__pyx_FusedFunctionObject, __signatures__),
-     READONLY,
-     0},
-    {0, 0, 0, 0, 0},
-};
-static PyMappingMethods __pyx_FusedFunction_mapping_methods = {
-    0,
-    (binaryfunc) __pyx_FusedFunction_getitem,
-    0,
-};
-static PyTypeObject __pyx_FusedFunctionType_type = {
-    PyVarObject_HEAD_INIT(0, 0)
-    "fused_cython_function",
-    sizeof(__pyx_FusedFunctionObject),
-    0,
-    (destructor) __pyx_FusedFunction_dealloc,
-    0,
-    0,
-    0,
-#if PY_MAJOR_VERSION < 3
-    0,
-#else
-    0,
-#endif
-    0,
-    0,
-    0,
-    &__pyx_FusedFunction_mapping_methods,
-    0,
-    (ternaryfunc) __pyx_FusedFunction_call,
-    0,
-    0,
-    0,
-    0,
-    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC | Py_TPFLAGS_BASETYPE,
-    0,
-    (traverseproc) __pyx_FusedFunction_traverse,
-    (inquiry) __pyx_FusedFunction_clear,
-    0,
-    0,
-    0,
-    0,
-    0,
-    __pyx_FusedFunction_members,
-    __pyx_CyFunction_getsets,
-    &__pyx_CyFunctionType_type,
-    0,
-    __pyx_FusedFunction_descr_get,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-#if PY_VERSION_HEX >= 0x030400a1
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-    0,
-#endif
-#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-    0,
-#endif
-};
-static int __pyx_FusedFunction_init(void) {
-    __pyx_FusedFunctionType_type.tp_base = __pyx_CyFunctionType;
-    __pyx_FusedFunctionType = __Pyx_FetchCommonType(&__pyx_FusedFunctionType_type);
-    if (__pyx_FusedFunctionType == NULL) {
-        return -1;
-    }
-    return 0;
+    Py_XDECREF(ob);
+    return NULL;
 }
 
 /* CLineInTraceback */
 #ifndef CYTHON_CLINE_IN_TRACEBACK
 static int __Pyx_CLineForTraceback(CYTHON_UNUSED PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
@@ -23509,168 +22246,14 @@
     __Pyx_PyFrame_SetLineNumber(py_frame, py_line);
     PyTraceBack_Here(py_frame);
 bad:
     Py_XDECREF(py_code);
     Py_XDECREF(py_frame);
 }
 
-/* Declarations */
-#if CYTHON_CCOMPLEX
-  #ifdef __cplusplus
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return ::std::complex< double >(x, y);
-    }
-  #else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return x + y*(__pyx_t_double_complex)_Complex_I;
-    }
-  #endif
-#else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      __pyx_t_double_complex z;
-      z.real = x;
-      z.imag = y;
-      return z;
-    }
-#endif
-
-/* Arithmetic */
-#if CYTHON_CCOMPLEX
-#else
-    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-       return (a.real == b.real) && (a.imag == b.imag);
-    }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
-        z.real = a.real + b.real;
-        z.imag = a.imag + b.imag;
-        return z;
-    }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
-        z.real = a.real - b.real;
-        z.imag = a.imag - b.imag;
-        return z;
-    }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
-        z.real = a.real * b.real - a.imag * b.imag;
-        z.imag = a.real * b.imag + a.imag * b.real;
-        return z;
-    }
-    #if 1
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else if (fabs(b.real) >= fabs(b.imag)) {
-            if (b.real == 0 && b.imag == 0) {
-                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
-            } else {
-                double r = b.imag / b.real;
-                double s = (double)(1.0) / (b.real + b.imag * r);
-                return __pyx_t_double_complex_from_parts(
-                    (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
-            }
-        } else {
-            double r = b.real / b.imag;
-            double s = (double)(1.0) / (b.imag + b.real * r);
-            return __pyx_t_double_complex_from_parts(
-                (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
-        }
-    }
-    #else
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else {
-            double denom = b.real * b.real + b.imag * b.imag;
-            return __pyx_t_double_complex_from_parts(
-                (a.real * b.real + a.imag * b.imag) / denom,
-                (a.imag * b.real - a.real * b.imag) / denom);
-        }
-    }
-    #endif
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
-        z.real = -a.real;
-        z.imag = -a.imag;
-        return z;
-    }
-    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
-       return (a.real == 0) && (a.imag == 0);
-    }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
-        z.real =  a.real;
-        z.imag = -a.imag;
-        return z;
-    }
-    #if 1
-        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
-          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
-            return sqrt(z.real*z.real + z.imag*z.imag);
-          #else
-            return hypot(z.real, z.imag);
-          #endif
-        }
-        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-            __pyx_t_double_complex z;
-            double r, lnr, theta, z_r, z_theta;
-            if (b.imag == 0 && b.real == (int)b.real) {
-                if (b.real < 0) {
-                    double denom = a.real * a.real + a.imag * a.imag;
-                    a.real = a.real / denom;
-                    a.imag = -a.imag / denom;
-                    b.real = -b.real;
-                }
-                switch ((int)b.real) {
-                    case 0:
-                        z.real = 1;
-                        z.imag = 0;
-                        return z;
-                    case 1:
-                        return a;
-                    case 2:
-                        return __Pyx_c_prod_double(a, a);
-                    case 3:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, a);
-                    case 4:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, z);
-                }
-            }
-            if (a.imag == 0) {
-                if (a.real == 0) {
-                    return a;
-                } else if ((b.imag == 0) && (a.real >= 0)) {
-                    z.real = pow(a.real, b.real);
-                    z.imag = 0;
-                    return z;
-                } else if (a.real > 0) {
-                    r = a.real;
-                    theta = 0;
-                } else {
-                    r = -a.real;
-                    theta = atan2(0.0, -1.0);
-                }
-            } else {
-                r = __Pyx_c_abs_double(a);
-                theta = atan2(a.imag, a.real);
-            }
-            lnr = log(r);
-            z_r = exp(lnr * b.real - theta * b.imag);
-            z_theta = theta * b.real + lnr * b.imag;
-            z.real = z_r * cos(z_theta);
-            z.imag = z_r * sin(z_theta);
-            return z;
-        }
-    #endif
-#endif
-
 #if PY_MAJOR_VERSION < 3
 static int __Pyx_GetBuffer(PyObject *obj, Py_buffer *view, int flags) {
     if (PyObject_CheckBuffer(obj)) return PyObject_GetBuffer(obj, view, flags);
         if (__Pyx_TypeCheck(obj, __pyx_array_type)) return __pyx_array_getbuffer(obj, view, flags);
         if (__Pyx_TypeCheck(obj, __pyx_memoryview_type)) return __pyx_memoryview_getbuffer(obj, view, flags);
     PyErr_Format(PyExc_TypeError, "'%.200s' does not have the buffer interface", Py_TYPE(obj)->tp_name);
     return -1;
@@ -24492,327 +23075,197 @@
     retval = -1;
 no_fail:
     __Pyx_RefNannyFinishContext();
     return retval;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 3,
-                                                 &__Pyx_TypeInfo_double, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_d_dc___pyx_t_double_complex(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 3,
-                                                 &__Pyx_TypeInfo___pyx_t_double_complex, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_double__const__(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_double__const__, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
-    }
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 2,
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
                                                  &__Pyx_TypeInfo_double, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_int(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_int, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_dc___pyx_t_double_complex(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_FOLLOW), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, __Pyx_IS_C_CONTIG,
-                                                 (PyBUF_C_CONTIGUOUS | PyBUF_FORMAT) | writable_flag, 2,
-                                                 &__Pyx_TypeInfo___pyx_t_double_complex, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
 /* MemviewDtypeToObject */
-  static CYTHON_INLINE PyObject *__pyx_memview_get_double__const__(const char *itemp) {
-    return (PyObject *) PyFloat_FromDouble(*(double const  *) itemp);
+  static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp) {
+    return (PyObject *) PyFloat_FromDouble(*(double *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj) {
+    double value = __pyx_PyFloat_AsDouble(obj);
+    if ((value == (double)-1) && PyErr_Occurred())
+        return 0;
+    *(double *) itemp = value;
+    return 1;
 }
 
 /* Declarations */
   #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      return ::std::complex< float >(x, y);
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return ::std::complex< double >(x, y);
     }
   #else
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      return x + y*(__pyx_t_float_complex)_Complex_I;
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return x + y*(__pyx_t_double_complex)_Complex_I;
     }
   #endif
 #else
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      __pyx_t_double_complex z;
       z.real = x;
       z.imag = y;
       return z;
     }
 #endif
 
 /* Arithmetic */
   #if CYTHON_CCOMPLEX
 #else
-    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        return (a.real == b.real) && (a.imag == b.imag);
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real + b.real;
         z.imag = a.imag + b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real - b.real;
         z.imag = a.imag - b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real * b.real - a.imag * b.imag;
         z.imag = a.real * b.imag + a.imag * b.real;
         return z;
     }
     #if 1
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else if (fabsf(b.real) >= fabsf(b.imag)) {
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else if (fabs(b.real) >= fabs(b.imag)) {
             if (b.real == 0 && b.imag == 0) {
-                return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.imag);
+                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
             } else {
-                float r = b.imag / b.real;
-                float s = (float)(1.0) / (b.real + b.imag * r);
-                return __pyx_t_float_complex_from_parts(
+                double r = b.imag / b.real;
+                double s = (double)(1.0) / (b.real + b.imag * r);
+                return __pyx_t_double_complex_from_parts(
                     (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
             }
         } else {
-            float r = b.real / b.imag;
-            float s = (float)(1.0) / (b.imag + b.real * r);
-            return __pyx_t_float_complex_from_parts(
+            double r = b.real / b.imag;
+            double s = (double)(1.0) / (b.imag + b.real * r);
+            return __pyx_t_double_complex_from_parts(
                 (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
         }
     }
     #else
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
         } else {
-            float denom = b.real * b.real + b.imag * b.imag;
-            return __pyx_t_float_complex_from_parts(
+            double denom = b.real * b.real + b.imag * b.imag;
+            return __pyx_t_double_complex_from_parts(
                 (a.real * b.real + a.imag * b.imag) / denom,
                 (a.imag * b.real - a.real * b.imag) / denom);
         }
     }
     #endif
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex a) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
         z.real = -a.real;
         z.imag = -a.imag;
         return z;
     }
-    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex a) {
+    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
        return (a.real == 0) && (a.imag == 0);
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex a) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
         z.real =  a.real;
         z.imag = -a.imag;
         return z;
     }
     #if 1
-        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex z) {
+        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
           #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
-            return sqrtf(z.real*z.real + z.imag*z.imag);
+            return sqrt(z.real*z.real + z.imag*z.imag);
           #else
-            return hypotf(z.real, z.imag);
+            return hypot(z.real, z.imag);
           #endif
         }
-        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-            __pyx_t_float_complex z;
-            float r, lnr, theta, z_r, z_theta;
+        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+            __pyx_t_double_complex z;
+            double r, lnr, theta, z_r, z_theta;
             if (b.imag == 0 && b.real == (int)b.real) {
                 if (b.real < 0) {
-                    float denom = a.real * a.real + a.imag * a.imag;
+                    double denom = a.real * a.real + a.imag * a.imag;
                     a.real = a.real / denom;
                     a.imag = -a.imag / denom;
                     b.real = -b.real;
                 }
                 switch ((int)b.real) {
                     case 0:
                         z.real = 1;
                         z.imag = 0;
                         return z;
                     case 1:
                         return a;
                     case 2:
-                        return __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_double(a, a);
                     case 3:
-                        z = __Pyx_c_prod_float(a, a);
-                        return __Pyx_c_prod_float(z, a);
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, a);
                     case 4:
-                        z = __Pyx_c_prod_float(a, a);
-                        return __Pyx_c_prod_float(z, z);
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, z);
                 }
             }
             if (a.imag == 0) {
                 if (a.real == 0) {
                     return a;
                 } else if ((b.imag == 0) && (a.real >= 0)) {
-                    z.real = powf(a.real, b.real);
+                    z.real = pow(a.real, b.real);
                     z.imag = 0;
                     return z;
                 } else if (a.real > 0) {
                     r = a.real;
                     theta = 0;
                 } else {
                     r = -a.real;
-                    theta = atan2f(0.0, -1.0);
+                    theta = atan2(0.0, -1.0);
                 }
             } else {
-                r = __Pyx_c_abs_float(a);
-                theta = atan2f(a.imag, a.real);
+                r = __Pyx_c_abs_double(a);
+                theta = atan2(a.imag, a.real);
             }
-            lnr = logf(r);
-            z_r = expf(lnr * b.real - theta * b.imag);
+            lnr = log(r);
+            z_r = exp(lnr * b.real - theta * b.imag);
             z_theta = theta * b.real + lnr * b.imag;
-            z.real = z_r * cosf(z_theta);
-            z.imag = z_r * sinf(z_theta);
+            z.real = z_r * cos(z_theta);
+            z.imag = z_r * sin(z_theta);
             return z;
         }
     #endif
 #endif
 
 /* MemviewSliceCopyTemplate */
   static __Pyx_memviewslice
@@ -24877,14 +23330,36 @@
     __Pyx_XDECREF(shape_tuple);
     __Pyx_XDECREF(temp_int);
     __Pyx_XDECREF(array_obj);
     __Pyx_RefNannyFinishContext();
     return new_mvs;
 }
 
+/* CIntFromPyVerify */
+  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* CIntFromPy */
   static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const int neg_one = (int) -1, const_zero = (int) 0;
@@ -25073,85 +23548,14 @@
     return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(long) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(long) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(long) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(long),
-                                     little, !is_unsigned);
-    }
-}
-
-/* BytesContains */
-  static CYTHON_INLINE int __Pyx_BytesContains(PyObject* bytes, char character) {
-    const Py_ssize_t length = PyBytes_GET_SIZE(bytes);
-    char* char_start = PyBytes_AS_STRING(bytes);
-    return memchr(char_start, (unsigned char)character, (size_t)length) != NULL;
-}
-
-/* ImportNumPyArray */
-  static PyObject* __Pyx__ImportNumPyArray(void) {
-    PyObject *numpy_module, *ndarray_object = NULL;
-    numpy_module = __Pyx_Import(__pyx_n_s_numpy, NULL, 0);
-    if (likely(numpy_module)) {
-        ndarray_object = PyObject_GetAttrString(numpy_module, "ndarray");
-        Py_DECREF(numpy_module);
-    }
-    if (unlikely(!ndarray_object)) {
-        PyErr_Clear();
-    }
-    if (unlikely(!ndarray_object || !PyObject_TypeCheck(ndarray_object, &PyType_Type))) {
-        Py_XDECREF(ndarray_object);
-        Py_INCREF(Py_None);
-        ndarray_object = Py_None;
-    }
-    return ndarray_object;
-}
-static CYTHON_INLINE PyObject* __Pyx_ImportNumPyArrayTypeIfAvailable(void) {
-    if (unlikely(!__pyx_numpy_ndarray)) {
-        __pyx_numpy_ndarray = __Pyx__ImportNumPyArray();
-    }
-    Py_INCREF(__pyx_numpy_ndarray);
-    return __pyx_numpy_ndarray;
-}
-
 /* CIntFromPy */
   static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const long neg_one = (long) -1, const_zero = (long) 0;
@@ -25378,14 +23782,52 @@
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(int),
                                      little, !is_unsigned);
     }
 }
 
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(long) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(long) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(long) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(long),
+                                     little, !is_unsigned);
+    }
+}
+
 /* CIntFromPy */
   static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const char neg_one = (char) -1, const_zero = (char) 0;
@@ -25612,68 +24054,14 @@
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
 }
 
-/* FunctionImport */
-  #ifndef __PYX_HAVE_RT_ImportFunction
-#define __PYX_HAVE_RT_ImportFunction
-static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
-    PyObject *d = 0;
-    PyObject *cobj = 0;
-    union {
-        void (*fp)(void);
-        void *p;
-    } tmp;
-    d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
-    if (!d)
-        goto bad;
-    cobj = PyDict_GetItemString(d, funcname);
-    if (!cobj) {
-        PyErr_Format(PyExc_ImportError,
-            "%.200s does not export expected C function %.200s",
-                PyModule_GetName(module), funcname);
-        goto bad;
-    }
-#if PY_VERSION_HEX >= 0x02070000
-    if (!PyCapsule_IsValid(cobj, sig)) {
-        PyErr_Format(PyExc_TypeError,
-            "C function %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
-             PyModule_GetName(module), funcname, sig, PyCapsule_GetName(cobj));
-        goto bad;
-    }
-    tmp.p = PyCapsule_GetPointer(cobj, sig);
-#else
-    {const char *desc, *s1, *s2;
-    desc = (const char *)PyCObject_GetDesc(cobj);
-    if (!desc)
-        goto bad;
-    s1 = desc; s2 = sig;
-    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
-    if (*s1 != *s2) {
-        PyErr_Format(PyExc_TypeError,
-            "C function %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
-             PyModule_GetName(module), funcname, sig, desc);
-        goto bad;
-    }
-    tmp.p = PyCObject_AsVoidPtr(cobj);}
-#endif
-    *f = tmp.fp;
-    if (!(*f))
-        goto bad;
-    Py_DECREF(d);
-    return 0;
-bad:
-    Py_XDECREF(d);
-    return -1;
-}
-#endif
-
 /* InitStrings */
   static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
     while (t->p) {
         #if PY_MAJOR_VERSION < 3
         if (t->is_unicode) {
             *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
         } else if (t->intern) {
```

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/EOB_matches.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/EOB_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/parameters.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/parameters.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/phenom_matches.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/phenom_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py` & `pyseobnr-0.2.0/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/integrate_ode.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/integrate_ode.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,30 +10,29 @@
 from .rhs_aligned import get_rhs, augment_dynamics
 
 from jax.config import config
 from numba import jit
 
 config.update("jax_enable_x64", True)
 
-import pygsl.errno as errno
-import pygsl.odeiv2 as odeiv2
+import pygsl_lite.errno as errno
+import pygsl_lite.odeiv2 as odeiv2
 
-step = odeiv2.pygsl_odeiv2_step
-_control = odeiv2.pygsl_odeiv2_control
-evolve = odeiv2.pygsl_odeiv2_evolve
+step = odeiv2.pygsl_lite_odeiv2_step
+_control = odeiv2.pygsl_lite_odeiv2_control
+evolve = odeiv2.pygsl_lite_odeiv2_evolve
 
 
 class control_y_new(_control):
     def __init__(self, eps_abs, eps_rel):
         a_y = 1
         a_dydt = 1
         _control.__init__(self, eps_abs, eps_rel, a_y, a_dydt, None)
 
 
-
 @jit(nopython=True)
 def h_max(r):
     return 1
 
 
 def ODE_system_RHS_opt(t: float, z: np.ndarray, args) -> np.ndarray:
     """Return the dynamics equations for aligned-spin systems
@@ -66,15 +65,15 @@
     atol=1e-12,
     backend="solve_ivp",
     params=None,
     step_back=100,
     max_step=0.1,
     min_step=1.0e-9,
     y_init=None,
-    r_stop = None
+    r_stop=None,
 ):
     """
     Main function to integrate the dynamics
     The RHS of the equations are given in Eq(2) of arXiv:2112.06952.
     See rhs_aligned.pyx for more details.
     Uses GSL Dormand-Prince 8th order integrator.
     Args:
@@ -146,16 +145,16 @@
         ts.append(t)
 
         # Comute the RHS after the step is done
 
         r = y[0]
 
         # Check if the proposed step is larger than the maximum timestep
-        #h_mx = h_max(r)
-        #h = h / h_mx
+        # h_mx = h_max(r)
+        # h = h / h_mx
 
         # Handle termination conditions
         if r <= 6:
             deriv = ODE_system_RHS_opt(t, y, [H, RR, chi_1, chi_2, m_1, m_2, params])
             drdt = deriv[0]
             omega = deriv[1]
             dprdt = deriv[2]
@@ -198,48 +197,48 @@
     # Gaurd against the case where when using PA dynamics,
     # there is less than step_back time between the start
     # of the ODE integration and the end of the dynamics
     # In that case make the fine dynamics be _all_ dynamics
     # except the 1st element
     if t_desired < ts[1]:
         idx_close = 1
-        step_back = ts[-1]-ts[idx_close]
+        step_back = ts[-1] - ts[idx_close]
     dyn_coarse = np.c_[ts[:idx_close], dyn[:idx_close]]
     dyn_fine = np.c_[ts[idx_close:], dyn[idx_close:]]
-    '''
+    """
     print(f"t_desired={t_desired}")
     print(f"len(dyn_coarse)={len(dyn_coarse)}")
     print(f"len(dyn_fine)={len(dyn_fine)}")
     print(f"End time: {ts[-1]}")
     print(f"idx_close:{idx_close}, t[idx_close]={ts[idx_close]}")
-    '''
+    """
     dyn_coarse = augment_dynamics(dyn_coarse, chi_1, chi_2, m_1, m_2, H)
     dyn_fine = augment_dynamics(dyn_fine, chi_1, chi_2, m_1, m_2, H)
     t_peak = None
     if peak_omega:
         intrp = CubicSpline(dyn_fine[:, 0], dyn_fine[:, -2])
         left = dyn_fine[0, 0]
         right = dyn_fine[-1, 0]
         t_peak = iterative_refinement(intrp.derivative(), [left, right])
 
     if peak_pr:
         intrp = CubicSpline(dyn_fine[:, 0], dyn_fine[:, 3])
         left = dyn_fine[-1, 0] - 10
         right = dyn_fine[-1, 0]
-        t_peak = iterative_refinement(intrp.derivative(), [left, right], pr = True)
+        t_peak = iterative_refinement(intrp.derivative(), [left, right], pr=True)
 
     dyn_fine = interpolate_dynamics(
         dyn_fine[:, :-3], peak_omega=t_peak, step_back=step_back
     )
     dyn_fine = augment_dynamics(dyn_fine, chi_1, chi_2, m_1, m_2, H)
 
     return dyn_coarse, dyn_fine
 
 
-def iterative_refinement(f, interval, levels=2, dt_initial=0.1, pr = False):
+def iterative_refinement(f, interval, levels=2, dt_initial=0.1, pr=False):
     """
     Attempts to find the peak of Omega/pr iteratively.
     Needed to ensure accurate attachment when the attachment point is the last point of the dynamics.
 
     Args:
         f (PPoly): derivative of the splined dynamics
         interval (list): interval where to look for the peak
@@ -250,15 +249,15 @@
     Returns:
         np.array: interpolated dynamics array
 
     """
     left = interval[0]
     right = interval[1]
     for n in range(1, levels + 1):
-        dt = dt_initial / (10 ** n)
+        dt = dt_initial / (10**n)
         t_fine = np.arange(interval[0], interval[1], dt)
         deriv = np.abs(f(t_fine))
 
         mins = argrelmin(deriv, order=3)[0]
         if len(mins) > 0:
             result = t_fine[mins[0]]
 
@@ -288,15 +287,15 @@
 
     """
 
     res = []
     n = len(dyn_fine)
 
     if peak_omega:
-        start = max(peak_omega - step_back,dyn_fine[0,0])
+        start = max(peak_omega - step_back, dyn_fine[0, 0])
         t_new = np.arange(start, peak_omega, dt)
 
     else:
         t_new = np.arange(dyn_fine[0, 0], dyn_fine[-1, 0], dt)
 
     for i in range(1, dyn_fine.shape[1]):
         intrp = CubicSpline(dyn_fine[:, 0], dyn_fine[:, i])
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/integrate_ode_prec.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/integrate_ode_prec.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,54 +1,62 @@
 """
 Contains functions associated with evolving the equations of motion.
 """
 
 from typing import Callable
 
 import numpy as np
-import pygsl.errno as errno
-import pygsl.odeiv2 as odeiv2
+import pygsl_lite.errno as errno
+import pygsl_lite.odeiv2 as odeiv2
 from numba import *
 from numba import jit, types
 
 from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit
 from ..hamiltonian import Hamiltonian
 from ..utils.math_ops_opt import *
 from .initial_conditions_aligned_precessing import computeIC_augm
-from .pn_evolution_opt import rhs_wrapper,compute_omega_orb,compute_quasiprecessing_PNdynamics_opt,build_splines_PN
+from .pn_evolution_opt import (
+    rhs_wrapper,
+    compute_omega_orb,
+    compute_quasiprecessing_PNdynamics_opt,
+    build_splines_PN,
+)
 from .integrate_ode import interpolate_dynamics, iterative_refinement
 from ..utils.containers import EOBParams
 from ..utils.math_ops_opt import my_norm
+
 # Test cythonization of PN equations
 
 from scipy.interpolate import CubicSpline
 from scipy.signal import argrelmin
 
 
-step = odeiv2.pygsl_odeiv2_step
-_control = odeiv2.pygsl_odeiv2_control
-evolve = odeiv2.pygsl_odeiv2_evolve
+step = odeiv2.pygsl_lite_odeiv2_step
+_control = odeiv2.pygsl_lite_odeiv2_control
+evolve = odeiv2.pygsl_lite_odeiv2_evolve
+
 
 class control_y_new(_control):
     def __init__(self, eps_abs, eps_rel):
         a_y = 1
         a_dydt = 1
         _control.__init__(self, eps_abs, eps_rel, a_y, a_dydt, None)
 
+
 # Function to terminate the EOB evolution
 def check_terminal(
     r: float,
     omega: float,
     drdt: float,
     dprdt: float,
     omega_circ: float,
     omega_previous: float,
     r_previous: float,
     omegaPN_f: float,
-    )->int :
+) -> int:
     """
     Check termination condition of the EOB evolution.
 
     Args:
         r (float): Orbital separation
         omega (float): Orbital frequency
         drdt (float): Time derivative of r
@@ -59,69 +67,69 @@
         omegaPN_f (float): Final orbital frequency reached in the spin-precessing PN evolution
 
     Returns:
         (int): If >0 terminates EOB dynamics
     """
 
     if r <= 1.4:
-        #print(f"r = {r} < 1.4, omega = {omega}")
+        # print(f"r = {r} < 1.4, omega = {omega}")
         return 1
 
     if np.isnan(omega) or np.isnan(drdt) or np.isnan(dprdt) or np.isnan(omega_circ):
-        #print(f"nan omega: r = {r}, omega = {omega}")
+        # print(f"nan omega: r = {r}, omega = {omega}")
         return 2
 
     if omega < omega_previous:
-        #print(f"r = {r}, omega = {omega}, omega_previous = {omega_previous}")
+        # print(f"r = {r}, omega = {omega}, omega_previous = {omega_previous}")
         return 3
 
     if r < 3:
 
-        if drdt >0:
-            #print(f"drdt>0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
+        if drdt > 0:
+            # print(f"drdt>0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
             return 5
 
-        if dprdt >0:
-            #print(f"dprdt >0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
+        if dprdt > 0:
+            # print(f"dprdt >0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
             return 6
 
         if omega_circ > 1:
-            #print(f"omega_circ >1 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
+            # print(f"omega_circ >1 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
             return 7
 
         if r > r_previous:
-            #print(f"r> r_previous : r = {r}, omega = {omega}, omega_previous = {omega_previous}, r_previous = {r_previous}")
+            # print(f"r> r_previous : r = {r}, omega = {omega}, omega_previous = {omega_previous}, r_previous = {r_previous}")
             return 8
 
     if omega > omegaPN_f:
-        #print(f"omega> omegaPN_f : r = {r}, omega = {omega}, omegaPN_f = {omegaPN_f}")
+        # print(f"omega> omegaPN_f : r = {r}, omega = {omega}, omegaPN_f = {omegaPN_f}")
         return 9
 
     return 0
 
 
 def compute_dynamics_prec_opt(
     omega_ref: float,
     omega_start: float,
-    omegaPN_f:float,
+    omegaPN_f: float,
     H: Hamiltonian,
     RR: Callable,
     m_1: float,
     m_2: float,
     splines: dict,
     t_pn: np.array,
     dynamics_pn: np.array,
     params: EOBParams,
     rtol: float = 1e-12,
     atol: float = 1e-12,
-    step_back: float = 250.,
+    step_back: float = 250.0,
     y_init=None,
-    initial_conditions: str = 'adiabatic',
-    initial_conditions_postadiabatic_type: str = 'analytic',
-    ):
+    initial_conditions: str = "adiabatic",
+    initial_conditions_postadiabatic_type: str = "analytic",
+):
     """
     Function to perform a non-precessing EOB evolution with the spins modified
     at every timestep according to the values from the precessing-spin PN
     evolution.
 
     Args:
         omega_ref (float): Reference orbital frequency at which the spins are defined
@@ -146,15 +154,14 @@
     Returns:
         (tuple): Low and high sampling rate dynamics, unit Newtonian orbital angular momentum, assembled dynamics
                  and the index splitting the low and high sampling rate dynamics
     """
 
     # Step 3 : Evolve EOB dynamics
 
-
     # Step 3.1) Update spin parameters and calibration coeffs (only dSO) at the start of EOB integration
 
     X1 = params.p_params.X_1
     X2 = params.p_params.X_2
 
     tmp = splines["everything"](omega_start)
     chi1_LN_start = tmp[0]
@@ -175,15 +182,14 @@
 
     ap_start = chi1_LN_start * X1 + chi2_LN_start * X2
     am_start = chi1_LN_start * X1 - chi2_LN_start * X2
 
     dSO_start = dSO_poly_fit(params.p_params.nu, ap_start, am_start)
     H.calibration_coeffs["dSO"] = dSO_start
 
-
     # Step 3.2: compute the initial conditions - uses the aligned-spin ID
     if y_init is None:
         if initial_conditions == "adiabatic":
             r0, pphi0, pr0 = computeIC_augm(
                 omega_start,
                 H,
                 RR,
@@ -198,96 +204,107 @@
             from .initial_conditions_precessing_postadiabatic import compute_IC_PA
 
             r0, pphi0, pr0 = compute_IC_PA(
                 omega_ref,
                 omega_start,
                 H,
                 RR,
-                chi1_v_start, chi2_v_start,
-                m_1, m_2,
+                chi1_v_start,
+                chi2_v_start,
+                m_1,
+                m_2,
                 splines,
                 t_pn,
                 dynamics_pn,
                 params=params,
                 postadiabatic_type=initial_conditions_postadiabatic_type,
             )
         y0 = np.array([r0, 0.0, pr0, pphi0])
 
-
     else:
 
         y0 = y_init.copy()
         r0 = y0[0]
 
-
     # Step 3.3: now integrate the dynamics
     sys = odeiv2.system(rhs_wrapper, None, 4, [H, RR, m_1, m_2, params])
 
     T = odeiv2.step_rkf45
     s = step(T, 4)
     c = control_y_new(atol, rtol)
     e = evolve(4)
 
     t = 0
     t1 = 1.0e9
 
     y = y0
 
     if y_init is None:
-        h = 2 * np.pi / omega_start / 100.
+        h = 2 * np.pi / omega_start / 100.0
     else:
         h = 0.1
 
     # Use an agnostic and small initial step for the integrator
     h = 0.1
     res_gsl = []
     ts = []
     omegas = []
     augm_dyn = []
 
     # Convert to numpy array to get the correct value
-    augm_dyn.append([params.p_params.H_val, params.p_params.omega, params.p_params.omega_circ, params.p_params.chi_1, params.p_params.chi_2])
+    augm_dyn.append(
+        [
+            params.p_params.H_val,
+            params.p_params.omega,
+            params.p_params.omega_circ,
+            params.p_params.chi_1,
+            params.p_params.chi_2,
+        ]
+    )
     ts.append(0.0)
     res_gsl.append(y)
     omegas.append(params.p_params.omega)
 
-
     omega_previous = omega_start
     r_previous = r0
 
     X1 = params.p_params.X_1
     X2 = params.p_params.X_2
 
-
     peak_omega = False
     peak_pr = False
 
-
     while t < t1:
 
         # Take a step
         status, t, h, y = e.apply(c, s, sys, t, t1, h, y)
         if status != errno.GSL_SUCCESS:
             print("break status", status)
             break
         # Compute the error for the step controller
         e.get_yerr()
 
         r = y[0]
 
-
         if np.isnan(r):
-            #print(f"t = {t}, r = {r}, h = {h}")
+            # print(f"t = {t}, r = {r}, h = {h}")
             break
         else:
             # Append the last step
             res_gsl.append(y)
             ts.append(t)
-            augm_dyn.append([params.p_params.H_val, params.p_params.omega, params.p_params.omega_circ, params.p_params.chi_1, params.p_params.chi_2])
-
+            augm_dyn.append(
+                [
+                    params.p_params.H_val,
+                    params.p_params.omega,
+                    params.p_params.omega_circ,
+                    params.p_params.chi_1,
+                    params.p_params.chi_2,
+                ]
+            )
 
         # Handle termination conditions
         if r <= 6:
 
             deriv = rhs_wrapper(t, y, [H, RR, m_1, m_2, params])
             drdt = deriv[0]
             omega = deriv[1]
@@ -301,29 +318,30 @@
             else:
 
                 omegas.append(omega)
                 dprdt = deriv[2]
                 omega_circ = params.p_params.omega_circ
 
             # check termination conditions
-            termination = check_terminal(r, omega, drdt, dprdt, omega_circ, omega_previous, r_previous, omegaPN_f)
+            termination = check_terminal(
+                r, omega, drdt, dprdt, omega_circ, omega_previous, r_previous, omegaPN_f
+            )
             if termination:
                 if termination == 3:
                     peak_omega = True
                 if termination == 6:
                     peak_pr = True
                 break
 
             omega_previous = omega
 
         else:
             omega = compute_omega_orb(t, y, H, RR, m_1, m_2, params)
             omegas.append(omega)
 
-
         # Update spin parameters and calibration coeffs (only dSO)
         params.p_params.omega = omega
         omega_circ = params.p_params.omega_circ
 
         # Update spins according to the new value of orbital frequency
         tmp = splines["everything"](omega)
         chi1_LN = tmp[0]
@@ -332,168 +350,152 @@
         chi2_L = tmp[3]
         chi1_v = tmp[4:7]
         chi2_v = tmp[7:10]
         tmp_LN = tmp[10:13]
 
         params.p_params.chi1_v[:] = chi1_v
         params.p_params.chi2_v[:] = chi2_v
-        #params.p_params.lN[:] = tmp_LN#/my_norm(tmp_LN)
+        # params.p_params.lN[:] = tmp_LN#/my_norm(tmp_LN)
 
         ap = chi1_LN * X1 + chi2_LN * X2
         am = chi1_LN * X1 - chi2_LN * X2
 
         # Check for possible extrapolation in the spin values
-        if abs(ap)>1 or abs(am)>1:
-            #print(f"r = {r}, omega = {omega}, ap = {ap}, am = {am}")
+        if abs(ap) > 1 or abs(am) > 1:
+            # print(f"r = {r}, omega = {omega}, ap = {ap}, am = {am}")
             break
 
         dSO_new = dSO_poly_fit(params.p_params.nu, ap, am)
         H.calibration_coeffs["dSO"] = dSO_new
 
         params.p_params.chi_1 = chi1_LN
         params.p_params.chi_2 = chi2_LN
 
         params.p_params.chi1_L = chi1_L
         params.p_params.chi2_L = chi2_L
 
-
         # Remember to update the derived spin quantities which enter the flux
         params.p_params.update_spins(params.p_params.chi_1, params.p_params.chi_2)
 
-
     # Step 3.4: After the integration assemble quantities and apply a roll-off of the timestep
     #           to avoid abrupt changes in the splines
     ts = np.array(ts)
     dyn = np.array(res_gsl)
     omega_eob = np.array(omegas)
     augm_dyn = np.array(augm_dyn)
 
-    dyn = np.c_[dyn,augm_dyn]
+    dyn = np.c_[dyn, augm_dyn]
 
     # Step 3.5: Iterative procedure to find the peak of omega or pr to have a more robust model
     #           under perturbations
 
     ##################################################################
 
     # Estimate of the starting point of fine integration
     # Same refinement as in the aligned-spin model
     t_stop = ts[-1]
     if peak_omega:
         t_desired = t_stop - step_back - 50
     else:
         t_desired = t_stop - step_back
 
-
     idx_close = np.argmin(np.abs(ts - t_desired))
     t_fine = ts[idx_close:]
     dyn_fine = np.c_[t_fine, dyn[idx_close:]]
     omega_fine = omega_eob[idx_close:]
 
     t_peak = None
     if peak_omega:
         idx_max = np.argmax(omega_fine)
         omega_peak = omega_fine[idx_max]
         t_peak = t_fine[idx_max]
 
         if idx_max != len(omega_fine):
-            omega_idxm1 = omega_fine[idx_max-1]
-            t_idxm1 = t_fine[idx_max-1]
+            omega_idxm1 = omega_fine[idx_max - 1]
+            t_idxm1 = t_fine[idx_max - 1]
 
             omega_idx0 = omega_peak
             t_idx0 = t_fine[idx_max]
 
-            omega_idx1 = omega_fine[idx_max+1]
-            t_idx1 = t_fine[idx_max+1]
-
+            omega_idx1 = omega_fine[idx_max + 1]
+            t_idx1 = t_fine[idx_max + 1]
 
-            t_peak, omega_peak = parabolaExtrema(omega_idx0,
-                                                 omega_idxm1,
-                                                 omega_idx1,
-                                                 t_idx0,
-                                                 t_idxm1,
-                                                 t_idx1
+            t_peak, omega_peak = parabolaExtrema(
+                omega_idx0, omega_idxm1, omega_idx1, t_idx0, t_idxm1, t_idx1
             )
 
     if peak_pr:
         intrp = CubicSpline(t_fine, dyn_fine[:, 3])
         left = t_fine[-1] - 10
         right = t_fine[-1]
-        t_peak = iterative_refinement(intrp.derivative(), [left, right], pr = True)
+        t_peak = iterative_refinement(intrp.derivative(), [left, right], pr=True)
 
     t_roll, dyn_roll, omega_roll = ts, dyn, omega_eob
     res = np.c_[t_roll, dyn_roll, omega_roll]
 
     if peak_omega or peak_pr:
-        t_start = max(t_peak - step_back,dyn_fine[0,0])
+        t_start = max(t_peak - step_back, dyn_fine[0, 0])
         idx_fine_start = np.argmin(np.abs(t_roll - t_start))
 
         idx_close = idx_fine_start
 
         t_fine = t_roll[idx_close:]
         dyn_fine = np.c_[t_fine, dyn_roll[idx_close:]]
         omega_fine = omega_roll[idx_close:]
 
-
-    t_roll, dyn_roll, omega_roll, idx_close = transition_dynamics_v2(ts, dyn, omega_eob, idx_close)
+    t_roll, dyn_roll, omega_roll, idx_close = transition_dynamics_v2(
+        ts, dyn, omega_eob, idx_close
+    )
 
     t_fine = t_roll[idx_close:]
     dyn_fine = np.c_[t_fine, dyn_roll[idx_close:]]
     omega_fine = omega_roll[idx_close:]
 
     dynamics_low = np.c_[t_roll[:idx_close], dyn_roll[:idx_close]]
     omega_low = omega_roll[:idx_close]
 
-
     # Add LN to the array so that it is also interpolated onto the fine sampling rate dynamics
-    dyn_fine = interpolate_dynamics(
-        dyn_fine, peak_omega=t_peak, step_back=step_back
-    )
-
-
+    dyn_fine = interpolate_dynamics(dyn_fine, peak_omega=t_peak, step_back=step_back)
 
     # Remove points where omega starts decreasing as we need it
     # to be monotonically increasing as it is used for interpolation
 
-    omega_dyn = dyn_fine[:,6]
+    omega_dyn = dyn_fine[:, 6]
     om_diff = np.diff(omega_dyn)
-    idx_omdiff = np.where(om_diff<0)[0]
+    idx_omdiff = np.where(om_diff < 0)[0]
 
-    if idx_omdiff.size !=0:
+    if idx_omdiff.size != 0:
         idx_final = idx_omdiff[0]
-        dyn_fine = dyn_fine[:idx_final+1]
+        dyn_fine = dyn_fine[: idx_final + 1]
 
     # Define the dynamics
     dynamics_fine = dyn_fine
 
     # Full dynamics array
     dynamics = np.vstack((dynamics_low, dynamics_fine))
 
-
-
     # Return EOB dynamics, LN vectors,  PN stuff
-    return (
-        dynamics_low,
-        dynamics_fine,
-        dynamics,
-        idx_close
-    )
+    return (dynamics_low, dynamics_fine, dynamics, idx_close)
 
-def transition_dynamics_v2(ts: np.ndarray, dyn: np.ndarray, omega_eob: np.ndarray, idx_restart:int):
+
+def transition_dynamics_v2(
+    ts: np.ndarray, dyn: np.ndarray, omega_eob: np.ndarray, idx_restart: int
+):
     """
-       Function to transition from a point dyn1,t1final to a point (dyn2,tfinal2)
+    Function to transition from a point dyn1,t1final to a point (dyn2,tfinal2)
 
-       Args:
+    Args:
 
-            ts (np.ndarray): Time array
-            dyn (np.ndarray): Dynamics array  (r,phi,pr,pphi)
-            omega_eob (np.ndarray): Orbital frequency array
-            idx_restart (int): Index which separates the low sampling rate dynamics and the high sampling rate dynamics.
+         ts (np.ndarray): Time array
+         dyn (np.ndarray): Dynamics array  (r,phi,pr,pphi)
+         omega_eob (np.ndarray): Orbital frequency array
+         idx_restart (int): Index which separates the low sampling rate dynamics and the high sampling rate dynamics.
 
-       Returns:
-            (tuple): Time array, dynamics, orbital frequency and index splitting the low and high sampling rate dynamics
+    Returns:
+         (tuple): Time array, dynamics, orbital frequency and index splitting the low and high sampling rate dynamics
     """
 
     # If the closest point within step back is actually the last point, step back more
     dyn_low = dyn[:idx_restart, :]
     dyn_fine = dyn[idx_restart:, :]
 
     t_low = ts[:idx_restart]
@@ -531,44 +533,44 @@
         while idx_restart < window:
             window -= 5
 
         t_middle = ts[idx_restart - window : idx_restart + window]
         dyn_window = dyn[idx_restart - window : idx_restart + window]
 
         dyn_interp = CubicSpline(t_middle, dyn_window[:, :])
-        omega_interp = CubicSpline(t_middle, omega_eob[idx_restart - window : idx_restart + window])
+        omega_interp = CubicSpline(
+            t_middle, omega_eob[idx_restart - window : idx_restart + window]
+        )
 
         dyn_middle = dyn_interp(t_new)
         omega_middle = omega_interp(t_new)
 
         # Separate low and high SR omega
         omega_low = omega_eob[:idx_restart]
         omega_fine = omega_eob[idx_restart:]
 
-        time = np.concatenate((t_low,t_new[:-1],t_fine))
-        dynamics = np.vstack((dyn_low, dyn_middle[:-1,:], dyn_fine))
-        omega = np.concatenate((omega_low,omega_middle[:-1],omega_fine))
-
-        idx_restart_v1 =  len(omega_low)+len(omega_middle)-1 #idx_restart -1  + window_length
+        time = np.concatenate((t_low, t_new[:-1], t_fine))
+        dynamics = np.vstack((dyn_low, dyn_middle[:-1, :], dyn_fine))
+        omega = np.concatenate((omega_low, omega_middle[:-1], omega_fine))
+
+        idx_restart_v1 = (
+            len(omega_low) + len(omega_middle) - 1
+        )  # idx_restart -1  + window_length
     else:
 
         dynamics = dyn
         time = ts
         omega = omega_eob
         idx_restart_v1 = idx_restart
 
     return time, dynamics, omega, idx_restart_v1
 
 
-def parabolaExtrema(ff0:float,
-                    ffm1:float,
-                    ff1:float,
-                    tt0:float,
-                    ttm1:float,
-                    tt1:float
+def parabolaExtrema(
+    ff0: float, ffm1: float, ff1: float, tt0: float, ttm1: float, tt1: float
 ):
     """
     Compute the extremum of a parabola from 3 points (idx-1, idx, idx+1).
 
     Args:
         ff0 (float): value of the function at the index idx
         ffm1 (float): value of the function at the index idx-1
@@ -577,26 +579,34 @@
         ttm1 (float): value of the time array at the index idx-1
         tt1 (float): value of the time array at the index idx+1
 
     Returns:
         tuple: time of the extremum, and value of the function at the extremum
     """
 
-    aa = (ffm1*(tt0 - tt1) + ff0*(tt1 - ttm1) + ff1*(-tt0 + ttm1))/((tt0 - tt1)*(tt0 - ttm1)*(tt1 - ttm1))
-    bb = (ffm1*(-tt0*tt0 + tt1*tt1) + ff1*(tt0*tt0  -ttm1*ttm1) + ff0*(-tt1*tt1 + ttm1*ttm1))/((tt0 - tt1)*(tt0 - ttm1)*(tt1 - ttm1))
-    cc = (ffm1*tt0*(tt0 - tt1)*tt1 + ff0*tt1*(tt1 - ttm1)*ttm1 + ff1*tt0*ttm1*(-tt0 + ttm1))/((tt0 - tt1)*(tt0 - ttm1)*(tt1 - ttm1))
-
+    aa = (ffm1 * (tt0 - tt1) + ff0 * (tt1 - ttm1) + ff1 * (-tt0 + ttm1)) / (
+        (tt0 - tt1) * (tt0 - ttm1) * (tt1 - ttm1)
+    )
+    bb = (
+        ffm1 * (-tt0 * tt0 + tt1 * tt1)
+        + ff1 * (tt0 * tt0 - ttm1 * ttm1)
+        + ff0 * (-tt1 * tt1 + ttm1 * ttm1)
+    ) / ((tt0 - tt1) * (tt0 - ttm1) * (tt1 - ttm1))
+    cc = (
+        ffm1 * tt0 * (tt0 - tt1) * tt1
+        + ff0 * tt1 * (tt1 - ttm1) * ttm1
+        + ff1 * tt0 * ttm1 * (-tt0 + ttm1)
+    ) / ((tt0 - tt1) * (tt0 - ttm1) * (tt1 - ttm1))
 
-    textremum = -bb/(2.*aa)
-    ff_extremum = aa*textremum*textremum + bb*textremum + cc
+    textremum = -bb / (2.0 * aa)
+    ff_extremum = aa * textremum * textremum + bb * textremum + cc
 
     return textremum, ff_extremum
 
 
-
 def compute_dynamics_quasiprecessing(
     omega_ref: float,
     omega_start: float,
     H: Hamiltonian,
     RR: Callable,
     m_1: float,
     m_2: float,
@@ -639,39 +649,33 @@
 
     Returns:
         tuple: Aligned-spin EOB dynamics, PN time, PN dynamics, PN splines
     """
 
     # Step 1: Compute PN dynamics
 
-    if initial_conditions =="postadiabatic":
+    if initial_conditions == "postadiabatic":
 
         combined_t, combined_y = compute_quasiprecessing_PNdynamics_opt(
-            omega_ref, 0.9*omega_start, m_1, m_2, chi_1, chi_2
+            omega_ref, 0.9 * omega_start, m_1, m_2, chi_1, chi_2
         )
     else:
 
         combined_t, combined_y = compute_quasiprecessing_PNdynamics_opt(
             omega_ref, omega_start, m_1, m_2, chi_1, chi_2
         )
     # Compute last value of the orbital frequency from the PN evolution (to be used for
     # the termination conditions of the non-precessing evolution)
     omegaPN_f = combined_y[:, -1][-1]
 
     # Step 2: Interpolate PN dynamics
     splines = build_splines_PN(combined_t, combined_y, m_1, m_2, omega_start)
 
     # Step 3: Evolve the non-precessing EOB evolution equations
-    (
-
-        dynamics_low,
-        dynamics_fine,
-        dynamics,
-        idx_restart
-    ) = compute_dynamics_prec_opt(
+    (dynamics_low, dynamics_fine, dynamics, idx_restart) = compute_dynamics_prec_opt(
         omega_ref,
         omega_start,
         omegaPN_f,
         H,
         RR,
         m_1,
         m_2,
@@ -690,9 +694,9 @@
     return (
         dynamics_low,
         dynamics_fine,
         combined_t,
         combined_y,
         splines,
         dynamics,
-        idx_restart
+        idx_restart,
     )
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/pn_evolution_opt.py` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/pn_evolution_opt.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C.c` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C.pyx"
         ]
     },
@@ -29,16 +29,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -223,15 +223,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -262,15 +262,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -2423,20 +2423,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
@@ -2798,15 +2806,14 @@
 static const char __pyx_k_dr_dt[] = "dr_dt";
 static const char __pyx_k_errno[] = "errno";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_omega[] = "omega";
 static const char __pyx_k_order[] = "order";
-static const char __pyx_k_pygsl[] = "pygsl";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_roots[] = "roots";
 static const char __pyx_k_scipy[] = "scipy";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_dH_dpr[] = "dH_dpr";
@@ -2861,14 +2868,15 @@
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_integrate[] = "integrate";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_step_back[] = "step_back";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
+static const char __pyx_k_pygsl_lite[] = "pygsl_lite";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_y_x_interp[] = "y_x_interp";
 static const char __pyx_k_CubicSpline[] = "CubicSpline";
 static const char __pyx_k_GSL_SUCCESS[] = "GSL_SUCCESS";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
@@ -3070,15 +3078,15 @@
 static PyObject *__pyx_n_s_pphi_eqn;
 static PyObject *__pyx_n_s_pphi_eqn_wrapper;
 static PyObject *__pyx_n_s_pphi_sol;
 static PyObject *__pyx_n_s_pr;
 static PyObject *__pyx_n_s_pr_eqn;
 static PyObject *__pyx_n_s_pr_eqn_wrapper;
 static PyObject *__pyx_n_s_pr_sol;
-static PyObject *__pyx_n_s_pygsl;
+static PyObject *__pyx_n_s_pygsl_lite;
 static PyObject *__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba;
 static PyObject *__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
@@ -28531,15 +28539,15 @@
   {&__pyx_n_s_pphi_eqn, __pyx_k_pphi_eqn, sizeof(__pyx_k_pphi_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pphi_eqn_wrapper, __pyx_k_pphi_eqn_wrapper, sizeof(__pyx_k_pphi_eqn_wrapper), 0, 0, 1, 1},
   {&__pyx_n_s_pphi_sol, __pyx_k_pphi_sol, sizeof(__pyx_k_pphi_sol), 0, 0, 1, 1},
   {&__pyx_n_s_pr, __pyx_k_pr, sizeof(__pyx_k_pr), 0, 0, 1, 1},
   {&__pyx_n_s_pr_eqn, __pyx_k_pr_eqn, sizeof(__pyx_k_pr_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pr_eqn_wrapper, __pyx_k_pr_eqn_wrapper, sizeof(__pyx_k_pr_eqn_wrapper), 0, 0, 1, 1},
   {&__pyx_n_s_pr_sol, __pyx_k_pr_sol, sizeof(__pyx_k_pr_sol), 0, 0, 1, 1},
-  {&__pyx_n_s_pygsl, __pyx_k_pygsl, sizeof(__pyx_k_pygsl), 0, 0, 1, 1},
+  {&__pyx_n_s_pygsl_lite, __pyx_k_pygsl_lite, sizeof(__pyx_k_pygsl_lite), 0, 0, 1, 1},
   {&__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_k_pyseobnr_eob_dynamics_postadiaba, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba), 0, 0, 1, 0},
   {&__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_k_pyseobnr_eob_dynamics_postadiaba_2, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba_2), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
@@ -29237,38 +29245,46 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 3, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(3, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 11, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -29563,42 +29579,42 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_computeIC, __pyx_t_2) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":16
  * 
  * 
- * from pygsl import  roots, errno             # <<<<<<<<<<<<<<
+ * from pygsl_lite import  roots, errno             # <<<<<<<<<<<<<<
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  */
   __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_s_roots);
   __Pyx_GIVEREF(__pyx_n_s_roots);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_roots);
   __Pyx_INCREF(__pyx_n_s_errno);
   __Pyx_GIVEREF(__pyx_n_s_errno);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_errno);
-  __pyx_t_2 = __Pyx_Import(__pyx_n_s_pygsl, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_pygsl_lite, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_roots); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_roots, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_errno); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_errno, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":17
  * 
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize             # <<<<<<<<<<<<<<
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  * from scipy import integrate
  */
   __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_n_s_optimize);
@@ -29610,15 +29626,15 @@
   __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_optimize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_optimize, __pyx_t_2) < 0) __PYX_ERR(0, 17, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":18
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline             # <<<<<<<<<<<<<<
  * from scipy import integrate
  * 
  */
   __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
@@ -32974,28 +32990,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -34045,44 +34061,62 @@
     return ret;
 }
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C.pyx`

 * *Files 0% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 from typing import Dict
 import numpy as np
 from libc.math cimport log, sqrt, exp, abs,fabs, tgamma,sin,cos, tanh, sinh, asinh
 
 from .initial_conditions_aligned_opt import computeIC_opt as computeIC
 
 
-from pygsl import  roots, errno
+from pygsl_lite import  roots, errno
 from scipy import optimize
 from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
 from scipy import integrate
 
 from lalinference.imrtgr import nrutils
 
 from .integrate_ode import compute_dynamics_opt as compute_dynamics
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_fast.c` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_fast.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C_fast",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx"
         ]
     },
@@ -29,16 +29,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -223,15 +223,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -262,15 +262,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -2371,20 +2371,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* FetchCommonType.proto */
 static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
@@ -2783,15 +2791,14 @@
 static const char __pyx_k_chi_2[] = "chi_2";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_errno[] = "errno";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_order[] = "order";
-static const char __pyx_k_pygsl[] = "pygsl";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_roots[] = "roots";
 static const char __pyx_k_scipy[] = "scipy";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_dpr_dr[] = "dpr_dr";
@@ -2839,14 +2846,15 @@
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_solve_ivp[] = "solve_ivp";
 static const char __pyx_k_step_back[] = "step_back";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_compute_pr[] = "compute_pr";
+static const char __pyx_k_pygsl_lite[] = "pygsl_lite";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_CubicSpline[] = "CubicSpline";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_compute_pphi[] = "compute_pphi";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
@@ -3008,15 +3016,15 @@
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_pphi;
 static PyObject *__pyx_n_s_pphi_eqn;
 static PyObject *__pyx_n_s_pphi_sol;
 static PyObject *__pyx_n_s_pr;
 static PyObject *__pyx_n_s_pr_eqn;
 static PyObject *__pyx_n_s_pr_sol;
-static PyObject *__pyx_n_s_pygsl;
+static PyObject *__pyx_n_s_pygsl_lite;
 static PyObject *__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba;
 static PyObject *__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
@@ -23884,15 +23892,15 @@
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_pphi, __pyx_k_pphi, sizeof(__pyx_k_pphi), 0, 0, 1, 1},
   {&__pyx_n_s_pphi_eqn, __pyx_k_pphi_eqn, sizeof(__pyx_k_pphi_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pphi_sol, __pyx_k_pphi_sol, sizeof(__pyx_k_pphi_sol), 0, 0, 1, 1},
   {&__pyx_n_s_pr, __pyx_k_pr, sizeof(__pyx_k_pr), 0, 0, 1, 1},
   {&__pyx_n_s_pr_eqn, __pyx_k_pr_eqn, sizeof(__pyx_k_pr_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pr_sol, __pyx_k_pr_sol, sizeof(__pyx_k_pr_sol), 0, 0, 1, 1},
-  {&__pyx_n_s_pygsl, __pyx_k_pygsl, sizeof(__pyx_k_pygsl), 0, 0, 1, 1},
+  {&__pyx_n_s_pygsl_lite, __pyx_k_pygsl_lite, sizeof(__pyx_k_pygsl_lite), 0, 0, 1, 1},
   {&__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_k_pyseobnr_eob_dynamics_postadiaba, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba), 0, 0, 1, 0},
   {&__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_k_pyseobnr_eob_dynamics_postadiaba_2, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba_2), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
@@ -24465,38 +24473,46 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 3, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(3, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 11, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -24824,43 +24840,43 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_computeIC, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":15
  * 
  * 
- * from pygsl import  roots, errno             # <<<<<<<<<<<<<<
+ * from pygsl_lite import  roots, errno             # <<<<<<<<<<<<<<
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  */
   __Pyx_TraceLine(15,0,__PYX_ERR(0, 15, __pyx_L1_error))
   __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_n_s_roots);
   __Pyx_GIVEREF(__pyx_n_s_roots);
   PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_roots);
   __Pyx_INCREF(__pyx_n_s_errno);
   __Pyx_GIVEREF(__pyx_n_s_errno);
   PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_errno);
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_pygsl, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_pygsl_lite, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_roots); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_roots, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_errno); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_errno, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":16
  * 
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize             # <<<<<<<<<<<<<<
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  * from scipy import integrate
  */
   __Pyx_TraceLine(16,0,__PYX_ERR(0, 16, __pyx_L1_error))
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
@@ -24873,15 +24889,15 @@
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_optimize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_optimize, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":17
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline             # <<<<<<<<<<<<<<
  * from scipy import integrate
  * 
  */
   __Pyx_TraceLine(17,0,__PYX_ERR(0, 17, __pyx_L1_error))
   __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)
@@ -26431,28 +26447,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -27967,44 +27983,62 @@
     return ret;
 }
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 from typing import Dict
 import numpy as np
 #import findiff
 from scipy.integrate import solve_ivp, ode
 from .initial_conditions_aligned_opt import computeIC_opt as computeIC
 
 
-from pygsl import  roots, errno
+from pygsl_lite import  roots, errno
 from scipy import optimize
 from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
 from scipy import integrate
 
 from lalinference.imrtgr import nrutils
 
 from .integrate_ode import compute_dynamics_opt as compute_dynamics
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_prec.c` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_prec.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C_prec",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx"
         ]
     },
@@ -29,16 +29,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -223,15 +223,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -262,15 +262,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -2419,20 +2419,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
@@ -2793,15 +2801,14 @@
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_intrp[] = "intrp";
 static const char __pyx_k_lN_pn[] = "lN_pn";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_omega[] = "omega";
 static const char __pyx_k_order[] = "order";
 static const char __pyx_k_print[] = "print";
-static const char __pyx_k_pygsl[] = "pygsl";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_roots[] = "roots";
 static const char __pyx_k_scipy[] = "scipy";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_arccos[] = "arccos";
@@ -2866,14 +2873,15 @@
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_step_back[] = "step_back";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_derivative[] = "derivative";
 static const char __pyx_k_everything[] = "everything";
+static const char __pyx_k_pygsl_lite[] = "pygsl_lite";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_quaternion[] = "quaternion";
 static const char __pyx_k_CubicSpline[] = "CubicSpline";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_dynamics_pn[] = "dynamics_pn";
@@ -3104,15 +3112,15 @@
 static PyObject *__pyx_n_s_pphi_eqn;
 static PyObject *__pyx_n_s_pphi_sol;
 static PyObject *__pyx_n_s_pr;
 static PyObject *__pyx_n_s_pr_eqn;
 static PyObject *__pyx_n_s_pr_sol;
 static PyObject *__pyx_n_s_print;
 static PyObject *__pyx_kp_u_problem_PA_dynamics_is_extrapola;
-static PyObject *__pyx_n_s_pygsl;
+static PyObject *__pyx_n_s_pygsl_lite;
 static PyObject *__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba;
 static PyObject *__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2;
 static PyObject *__pyx_n_s_pyseobnr_eob_utils_math_ops_opt;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
@@ -34988,15 +34996,15 @@
   {&__pyx_n_s_pphi_eqn, __pyx_k_pphi_eqn, sizeof(__pyx_k_pphi_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pphi_sol, __pyx_k_pphi_sol, sizeof(__pyx_k_pphi_sol), 0, 0, 1, 1},
   {&__pyx_n_s_pr, __pyx_k_pr, sizeof(__pyx_k_pr), 0, 0, 1, 1},
   {&__pyx_n_s_pr_eqn, __pyx_k_pr_eqn, sizeof(__pyx_k_pr_eqn), 0, 0, 1, 1},
   {&__pyx_n_s_pr_sol, __pyx_k_pr_sol, sizeof(__pyx_k_pr_sol), 0, 0, 1, 1},
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
   {&__pyx_kp_u_problem_PA_dynamics_is_extrapola, __pyx_k_problem_PA_dynamics_is_extrapola, sizeof(__pyx_k_problem_PA_dynamics_is_extrapola), 0, 1, 0, 0},
-  {&__pyx_n_s_pygsl, __pyx_k_pygsl, sizeof(__pyx_k_pygsl), 0, 0, 1, 1},
+  {&__pyx_n_s_pygsl_lite, __pyx_k_pygsl_lite, sizeof(__pyx_k_pygsl_lite), 0, 0, 1, 1},
   {&__pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_k_pyseobnr_eob_dynamics_postadiaba, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba), 0, 0, 1, 0},
   {&__pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_k_pyseobnr_eob_dynamics_postadiaba_2, sizeof(__pyx_k_pyseobnr_eob_dynamics_postadiaba_2), 0, 0, 1, 1},
   {&__pyx_n_s_pyseobnr_eob_utils_math_ops_opt, __pyx_k_pyseobnr_eob_utils_math_ops_opt, sizeof(__pyx_k_pyseobnr_eob_utils_math_ops_opt), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
@@ -35650,38 +35658,46 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(3, 4, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(3, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 11, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -35974,15 +35990,15 @@
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx":13
  * 
  * from .initial_conditions_aligned_opt import computeIC_opt as computeIC
  * from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit             # <<<<<<<<<<<<<<
  * 
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  */
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_s_dSO);
   __Pyx_GIVEREF(__pyx_n_s_dSO);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_dSO);
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_fits_fits_Hamiltonian, __pyx_t_1, 2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)
@@ -35993,42 +36009,42 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_dSO_poly_fit, __pyx_t_1) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx":15
  * from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit
  * 
- * from pygsl import  roots, errno             # <<<<<<<<<<<<<<
+ * from pygsl_lite import  roots, errno             # <<<<<<<<<<<<<<
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  */
   __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_n_s_roots);
   __Pyx_GIVEREF(__pyx_n_s_roots);
   PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_roots);
   __Pyx_INCREF(__pyx_n_s_errno);
   __Pyx_GIVEREF(__pyx_n_s_errno);
   PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_errno);
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_pygsl, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_pygsl_lite, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_roots); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_roots, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_errno); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_errno, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx":16
  * 
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize             # <<<<<<<<<<<<<<
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
  * from scipy import integrate
  */
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_s_optimize);
@@ -36040,15 +36056,15 @@
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_optimize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_optimize, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx":17
- * from pygsl import  roots, errno
+ * from pygsl_lite import  roots, errno
  * from scipy import optimize
  * from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline             # <<<<<<<<<<<<<<
  * from scipy import integrate
  * 
  */
   __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -38005,28 +38021,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -39038,44 +39054,62 @@
     return ret;
 }
 
 /* TypeImport */
     #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx`

 * *Files 0% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 import numpy as np
 import  quaternion
 from libc.math cimport log, sqrt, exp, abs,fabs, tgamma,sin,cos, tanh, sinh, asinh
 
 from .initial_conditions_aligned_opt import computeIC_opt as computeIC
 from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit
 
-from pygsl import  roots, errno
+from pygsl_lite import  roots, errno
 from scipy import optimize
 from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
 from scipy import integrate
 
 from lalinference.imrtgr import nrutils
 
 from pyseobnr.eob.utils.containers cimport EOBParams
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_aligned.c` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_aligned.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,33 +1,33 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "define_macros": [
             [
                 "CYTHON_TRACE",
                 "1"
             ]
         ],
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include"
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.dynamics.rhs_aligned",
         "sources": [
             "pyseobnr/eob/dynamics/rhs_aligned.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.dynamics.rhs_aligned"
@@ -39,16 +39,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -233,15 +233,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -272,15 +272,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -1129,195 +1129,195 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":689
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":696
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":703
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":713
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":717
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":721
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":724
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1370,42 +1370,42 @@
  *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":728
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":732
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2489,20 +2489,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* FetchCommonType.proto */
 static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
@@ -4177,15 +4185,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_dynamics, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -4196,30 +4204,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew1", __pyx_f[1], 734, 0, __PYX_ERR(1, 734, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_TraceLine(735,0,__PYX_ERR(1, 735, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -4231,15 +4239,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -4250,30 +4258,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew2", __pyx_f[1], 737, 0, __PYX_ERR(1, 737, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_TraceLine(738,0,__PYX_ERR(1, 738, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -4285,15 +4293,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -4304,30 +4312,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew3", __pyx_f[1], 740, 0, __PYX_ERR(1, 740, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_TraceLine(741,0,__PYX_ERR(1, 741, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -4339,15 +4347,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -4358,30 +4366,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew4", __pyx_f[1], 743, 0, __PYX_ERR(1, 743, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_TraceLine(744,0,__PYX_ERR(1, 744, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -4393,15 +4401,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -4412,30 +4420,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew5", __pyx_f[1], 746, 0, __PYX_ERR(1, 746, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_TraceLine(747,0,__PYX_ERR(1, 747, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -4447,15 +4455,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -4466,63 +4474,63 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
   __Pyx_TraceCall("PyDataType_SHAPE", __pyx_f[1], 749, 0, __PYX_ERR(1, 749, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __Pyx_TraceLine(750,0,__PYX_ERR(1, 750, __pyx_L1_error))
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_TraceLine(751,0,__PYX_ERR(1, 751, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":753
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(753,0,__PYX_ERR(1, 753, __pyx_L1_error))
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -4533,15 +4541,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -4550,35 +4558,35 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("set_array_base", 0);
   __Pyx_TraceCall("set_array_base", __pyx_f[1], 928, 0, __PYX_ERR(1, 928, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   __Pyx_TraceLine(929,0,__PYX_ERR(1, 929, __pyx_L1_error))
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __Pyx_TraceLine(930,0,__PYX_ERR(1, 930, __pyx_L1_error))
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -4587,15 +4595,15 @@
   __pyx_L1_error:;
   __Pyx_WriteUnraisable("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -4607,70 +4615,70 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_array_base", 0);
   __Pyx_TraceCall("get_array_base", __pyx_f[1], 932, 0, __PYX_ERR(1, 932, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __Pyx_TraceLine(933,0,__PYX_ERR(1, 933, __pyx_L1_error))
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __Pyx_TraceLine(934,0,__PYX_ERR(1, 934, __pyx_L1_error))
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_TraceLine(935,0,__PYX_ERR(1, 935, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":936
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_TraceLine(936,0,__PYX_ERR(1, 936, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -4681,15 +4689,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -4707,15 +4715,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
   __Pyx_TraceCall("import_array", __pyx_f[1], 940, 0, __PYX_ERR(1, 940, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   __Pyx_TraceLine(941,0,__PYX_ERR(1, 941, __pyx_L1_error))
@@ -4724,39 +4732,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __Pyx_TraceLine(942,0,__PYX_ERR(1, 942, __pyx_L3_error))
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 942, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":943
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __Pyx_TraceLine(943,0,__PYX_ERR(1, 943, __pyx_L5_except_error))
@@ -4764,15 +4772,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __Pyx_TraceLine(944,0,__PYX_ERR(1, 944, __pyx_L5_except_error))
@@ -4781,30 +4789,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -4820,15 +4828,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4846,15 +4854,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
   __Pyx_TraceCall("import_umath", __pyx_f[1], 946, 0, __PYX_ERR(1, 946, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(947,0,__PYX_ERR(1, 947, __pyx_L1_error))
@@ -4863,39 +4871,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(948,0,__PYX_ERR(1, 948, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 948, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":949
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(949,0,__PYX_ERR(1, 949, __pyx_L5_except_error))
@@ -4903,15 +4911,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __Pyx_TraceLine(950,0,__PYX_ERR(1, 950, __pyx_L5_except_error))
@@ -4920,30 +4928,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4959,15 +4967,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4985,15 +4993,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
   __Pyx_TraceCall("import_ufunc", __pyx_f[1], 952, 0, __PYX_ERR(1, 952, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(953,0,__PYX_ERR(1, 953, __pyx_L1_error))
@@ -5002,39 +5010,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(954,0,__PYX_ERR(1, 954, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 954, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":955
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(955,0,__PYX_ERR(1, 955, __pyx_L5_except_error))
@@ -5042,15 +5050,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":956
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __Pyx_TraceLine(956,0,__PYX_ERR(1, 956, __pyx_L5_except_error))
@@ -5059,30 +5067,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -5098,15 +5106,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -5116,26 +5124,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
   __Pyx_TraceCall("is_timedelta64_object", __pyx_f[1], 966, 0, __PYX_ERR(1, 966, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":978
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(978,0,__PYX_ERR(1, 978, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -5145,15 +5153,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -5163,26 +5171,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
   __Pyx_TraceCall("is_datetime64_object", __pyx_f[1], 981, 0, __PYX_ERR(1, 981, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":993
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(993,0,__PYX_ERR(1, 993, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -5192,15 +5200,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -5208,26 +5216,26 @@
   npy_datetime __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_value", __pyx_f[1], 996, 1, __PYX_ERR(1, 996, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1003,1,__PYX_ERR(1, 1003, __pyx_L1_error))
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -5236,15 +5244,15 @@
   __Pyx_WriteUnraisable("numpy.get_datetime64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -5252,26 +5260,26 @@
   npy_timedelta __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_timedelta64_value", __pyx_f[1], 1006, 1, __PYX_ERR(1, 1006, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1010,1,__PYX_ERR(1, 1010, __pyx_L1_error))
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -5280,15 +5288,15 @@
   __Pyx_WriteUnraisable("numpy.get_timedelta64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -5296,24 +5304,24 @@
   NPY_DATETIMEUNIT __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_unit", __pyx_f[1], 1013, 1, __PYX_ERR(1, 1013, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __Pyx_TraceLine(1017,1,__PYX_ERR(1, 1017, __pyx_L1_error))
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -20870,26 +20878,26 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__3);
   __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(1, 950, __pyx_L1_error)
@@ -21308,83 +21316,106 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 11, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(5, 3, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(5, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(1, 199, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(1, 222, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(1, 226, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(1, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_generic) __PYX_ERR(1, 770, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_number) __PYX_ERR(1, 772, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_integer) __PYX_ERR(1, 774, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(1, 776, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(1, 778, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(1, 780, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_floating) __PYX_ERR(1, 782, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(1, 784, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(1, 786, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_character) __PYX_ERR(1, 788, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(1, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
@@ -21670,165 +21701,165 @@
  */
   __Pyx_TraceLine(1,0,__PYX_ERR(0, 1, __pyx_L1_error))
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
   __Pyx_TraceLine(734,0,__PYX_ERR(1, 734, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
   __Pyx_TraceLine(737,0,__PYX_ERR(1, 737, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
   __Pyx_TraceLine(740,0,__PYX_ERR(1, 740, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
   __Pyx_TraceLine(743,0,__PYX_ERR(1, 743, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
   __Pyx_TraceLine(746,0,__PYX_ERR(1, 746, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
   __Pyx_TraceLine(749,0,__PYX_ERR(1, 749, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
   __Pyx_TraceLine(928,0,__PYX_ERR(1, 928, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
   __Pyx_TraceLine(932,0,__PYX_ERR(1, 932, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
   __Pyx_TraceLine(940,0,__PYX_ERR(1, 940, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(946,0,__PYX_ERR(1, 946, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(952,0,__PYX_ERR(1, 952, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
   __Pyx_TraceLine(966,0,__PYX_ERR(1, 966, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
   __Pyx_TraceLine(981,0,__PYX_ERR(1, 981, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
   __Pyx_TraceLine(996,0,__PYX_ERR(1, 996, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
   __Pyx_TraceLine(1006,0,__PYX_ERR(1, 1006, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
   __Pyx_TraceLine(1013,0,__PYX_ERR(1, 1013, __pyx_L1_error))
@@ -23803,28 +23834,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -24625,44 +24656,62 @@
     return ret;
 }
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_aligned.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_aligned.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_precessing.c` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_precessing.c`

 * *Files 2% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/npy_math.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/npy_math.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include"
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.dynamics.rhs_precessing",
         "sources": [
             "pyseobnr/eob/dynamics/rhs_precessing.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.dynamics.rhs_precessing"
@@ -34,16 +34,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -228,15 +228,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -267,15 +267,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -1125,195 +1125,195 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":689
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":696
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":703
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":713
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":717
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":721
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":724
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1375,42 +1375,42 @@
  *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":728
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":732
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2485,20 +2485,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
@@ -3609,15 +3617,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_z, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -3628,30 +3636,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew1", __pyx_f[1], 734, 0, __PYX_ERR(1, 734, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_TraceLine(735,0,__PYX_ERR(1, 735, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -3663,15 +3671,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -3682,30 +3690,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew2", __pyx_f[1], 737, 0, __PYX_ERR(1, 737, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_TraceLine(738,0,__PYX_ERR(1, 738, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -3717,15 +3725,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -3736,30 +3744,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew3", __pyx_f[1], 740, 0, __PYX_ERR(1, 740, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_TraceLine(741,0,__PYX_ERR(1, 741, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -3771,15 +3779,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3790,30 +3798,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew4", __pyx_f[1], 743, 0, __PYX_ERR(1, 743, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_TraceLine(744,0,__PYX_ERR(1, 744, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3825,15 +3833,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3844,30 +3852,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew5", __pyx_f[1], 746, 0, __PYX_ERR(1, 746, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_TraceLine(747,0,__PYX_ERR(1, 747, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3879,15 +3887,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -3898,63 +3906,63 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
   __Pyx_TraceCall("PyDataType_SHAPE", __pyx_f[1], 749, 0, __PYX_ERR(1, 749, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __Pyx_TraceLine(750,0,__PYX_ERR(1, 750, __pyx_L1_error))
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_TraceLine(751,0,__PYX_ERR(1, 751, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":753
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(753,0,__PYX_ERR(1, 753, __pyx_L1_error))
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -3965,15 +3973,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -3982,35 +3990,35 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("set_array_base", 0);
   __Pyx_TraceCall("set_array_base", __pyx_f[1], 928, 0, __PYX_ERR(1, 928, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   __Pyx_TraceLine(929,0,__PYX_ERR(1, 929, __pyx_L1_error))
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __Pyx_TraceLine(930,0,__PYX_ERR(1, 930, __pyx_L1_error))
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -4019,15 +4027,15 @@
   __pyx_L1_error:;
   __Pyx_WriteUnraisable("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -4039,70 +4047,70 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_array_base", 0);
   __Pyx_TraceCall("get_array_base", __pyx_f[1], 932, 0, __PYX_ERR(1, 932, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __Pyx_TraceLine(933,0,__PYX_ERR(1, 933, __pyx_L1_error))
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __Pyx_TraceLine(934,0,__PYX_ERR(1, 934, __pyx_L1_error))
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_TraceLine(935,0,__PYX_ERR(1, 935, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":936
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_TraceLine(936,0,__PYX_ERR(1, 936, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -4113,15 +4121,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -4139,15 +4147,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
   __Pyx_TraceCall("import_array", __pyx_f[1], 940, 0, __PYX_ERR(1, 940, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   __Pyx_TraceLine(941,0,__PYX_ERR(1, 941, __pyx_L1_error))
@@ -4156,39 +4164,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __Pyx_TraceLine(942,0,__PYX_ERR(1, 942, __pyx_L3_error))
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 942, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":943
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __Pyx_TraceLine(943,0,__PYX_ERR(1, 943, __pyx_L5_except_error))
@@ -4196,15 +4204,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __Pyx_TraceLine(944,0,__PYX_ERR(1, 944, __pyx_L5_except_error))
@@ -4213,30 +4221,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -4252,15 +4260,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4278,15 +4286,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
   __Pyx_TraceCall("import_umath", __pyx_f[1], 946, 0, __PYX_ERR(1, 946, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(947,0,__PYX_ERR(1, 947, __pyx_L1_error))
@@ -4295,39 +4303,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(948,0,__PYX_ERR(1, 948, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 948, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":949
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(949,0,__PYX_ERR(1, 949, __pyx_L5_except_error))
@@ -4335,15 +4343,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __Pyx_TraceLine(950,0,__PYX_ERR(1, 950, __pyx_L5_except_error))
@@ -4352,30 +4360,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4391,15 +4399,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4417,15 +4425,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
   __Pyx_TraceCall("import_ufunc", __pyx_f[1], 952, 0, __PYX_ERR(1, 952, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(953,0,__PYX_ERR(1, 953, __pyx_L1_error))
@@ -4434,39 +4442,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(954,0,__PYX_ERR(1, 954, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 954, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":955
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(955,0,__PYX_ERR(1, 955, __pyx_L5_except_error))
@@ -4474,15 +4482,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":956
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __Pyx_TraceLine(956,0,__PYX_ERR(1, 956, __pyx_L5_except_error))
@@ -4491,30 +4499,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -4530,15 +4538,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -4548,26 +4556,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
   __Pyx_TraceCall("is_timedelta64_object", __pyx_f[1], 966, 0, __PYX_ERR(1, 966, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":978
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(978,0,__PYX_ERR(1, 978, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -4577,15 +4585,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -4595,26 +4603,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
   __Pyx_TraceCall("is_datetime64_object", __pyx_f[1], 981, 0, __PYX_ERR(1, 981, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":993
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(993,0,__PYX_ERR(1, 993, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -4624,15 +4632,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -4640,26 +4648,26 @@
   npy_datetime __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_value", __pyx_f[1], 996, 1, __PYX_ERR(1, 996, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1003,1,__PYX_ERR(1, 1003, __pyx_L1_error))
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -4668,15 +4676,15 @@
   __Pyx_WriteUnraisable("numpy.get_datetime64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -4684,26 +4692,26 @@
   npy_timedelta __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_timedelta64_value", __pyx_f[1], 1006, 1, __PYX_ERR(1, 1006, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1010,1,__PYX_ERR(1, 1010, __pyx_L1_error))
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -4712,15 +4720,15 @@
   __Pyx_WriteUnraisable("numpy.get_timedelta64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -4728,24 +4736,24 @@
   NPY_DATETIMEUNIT __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_unit", __pyx_f[1], 1013, 1, __PYX_ERR(1, 1013, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __Pyx_TraceLine(1017,1,__PYX_ERR(1, 1017, __pyx_L1_error))
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -20285,26 +20293,26 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple_)) __PYX_ERR(1, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple_);
   __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 950, __pyx_L1_error)
@@ -20705,83 +20713,106 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 11, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(5, 4, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(5, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(1, 199, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(1, 222, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(1, 226, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(1, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_generic) __PYX_ERR(1, 770, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_number) __PYX_ERR(1, 772, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_integer) __PYX_ERR(1, 774, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(1, 776, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(1, 778, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(1, 780, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_floating) __PYX_ERR(1, 782, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(1, 784, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(1, 786, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_character) __PYX_ERR(1, 788, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(1, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
@@ -21088,165 +21119,165 @@
  */
   __Pyx_TraceLine(1,0,__PYX_ERR(0, 1, __pyx_L1_error))
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
   __Pyx_TraceLine(734,0,__PYX_ERR(1, 734, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
   __Pyx_TraceLine(737,0,__PYX_ERR(1, 737, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
   __Pyx_TraceLine(740,0,__PYX_ERR(1, 740, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
   __Pyx_TraceLine(743,0,__PYX_ERR(1, 743, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
   __Pyx_TraceLine(746,0,__PYX_ERR(1, 746, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
   __Pyx_TraceLine(749,0,__PYX_ERR(1, 749, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
   __Pyx_TraceLine(928,0,__PYX_ERR(1, 928, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
   __Pyx_TraceLine(932,0,__PYX_ERR(1, 932, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
   __Pyx_TraceLine(940,0,__PYX_ERR(1, 940, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(946,0,__PYX_ERR(1, 946, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(952,0,__PYX_ERR(1, 952, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
   __Pyx_TraceLine(966,0,__PYX_ERR(1, 966, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
   __Pyx_TraceLine(981,0,__PYX_ERR(1, 981, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
   __Pyx_TraceLine(996,0,__PYX_ERR(1, 996, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
   __Pyx_TraceLine(1006,0,__PYX_ERR(1, 1006, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
   __Pyx_TraceLine(1013,0,__PYX_ERR(1, 1013, __pyx_L1_error))
@@ -22687,28 +22718,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -23917,44 +23948,62 @@
     return ret;
 }
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/dynamics/rhs_precessing.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/dynamics/rhs_precessing.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/fits/EOB_fits.py` & `pyseobnr-0.2.0/pyseobnr/eob/fits/EOB_fits.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/fits/GSF_fits.py` & `pyseobnr-0.2.0/pyseobnr/eob/fits/GSF_fits.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/fits/IV_fits.py` & `pyseobnr-0.2.0/pyseobnr/eob/fits/IV_fits.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/fits/MR_fits.py` & `pyseobnr-0.2.0/pyseobnr/eob/fits/MR_fits.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/fits/fits_Hamiltonian.py` & `pyseobnr-0.2.0/pyseobnr/eob/fits/fits_Hamiltonian.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,27 +1,27 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.hamiltonian.Ham_AvgS2precess_simple_cython_PA_AD",
         "sources": [
             "pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx"
         ]
     },
@@ -34,16 +34,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -228,15 +228,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -267,15 +267,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -1123,195 +1123,195 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":689
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":696
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":703
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":713
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":717
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":721
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":724
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1349,42 +1349,42 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":728
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":732
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2443,20 +2443,28 @@
 #else
 #define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
 #endif
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* SetVTable.proto */
 static int __Pyx_SetVtable(PyObject *dict, void *vtable);
@@ -26307,15 +26315,15 @@
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -26326,30 +26334,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew1", __pyx_f[2], 734, 0, __PYX_ERR(2, 734, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_TraceLine(735,0,__PYX_ERR(2, 735, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -26361,15 +26369,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -26380,30 +26388,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew2", __pyx_f[2], 737, 0, __PYX_ERR(2, 737, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_TraceLine(738,0,__PYX_ERR(2, 738, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -26415,15 +26423,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -26434,30 +26442,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew3", __pyx_f[2], 740, 0, __PYX_ERR(2, 740, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_TraceLine(741,0,__PYX_ERR(2, 741, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -26469,15 +26477,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -26488,30 +26496,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew4", __pyx_f[2], 743, 0, __PYX_ERR(2, 743, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_TraceLine(744,0,__PYX_ERR(2, 744, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -26523,15 +26531,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -26542,30 +26550,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew5", __pyx_f[2], 746, 0, __PYX_ERR(2, 746, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_TraceLine(747,0,__PYX_ERR(2, 747, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -26577,15 +26585,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -26596,63 +26604,63 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
   __Pyx_TraceCall("PyDataType_SHAPE", __pyx_f[2], 749, 0, __PYX_ERR(2, 749, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __Pyx_TraceLine(750,0,__PYX_ERR(2, 750, __pyx_L1_error))
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_TraceLine(751,0,__PYX_ERR(2, 751, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":753
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(753,0,__PYX_ERR(2, 753, __pyx_L1_error))
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -26663,15 +26671,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -26680,35 +26688,35 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("set_array_base", 0);
   __Pyx_TraceCall("set_array_base", __pyx_f[2], 928, 0, __PYX_ERR(2, 928, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   __Pyx_TraceLine(929,0,__PYX_ERR(2, 929, __pyx_L1_error))
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __Pyx_TraceLine(930,0,__PYX_ERR(2, 930, __pyx_L1_error))
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -26717,15 +26725,15 @@
   __pyx_L1_error:;
   __Pyx_WriteUnraisable("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -26737,70 +26745,70 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_array_base", 0);
   __Pyx_TraceCall("get_array_base", __pyx_f[2], 932, 0, __PYX_ERR(2, 932, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __Pyx_TraceLine(933,0,__PYX_ERR(2, 933, __pyx_L1_error))
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __Pyx_TraceLine(934,0,__PYX_ERR(2, 934, __pyx_L1_error))
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_TraceLine(935,0,__PYX_ERR(2, 935, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":936
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_TraceLine(936,0,__PYX_ERR(2, 936, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -26811,15 +26819,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -26837,15 +26845,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
   __Pyx_TraceCall("import_array", __pyx_f[2], 940, 0, __PYX_ERR(2, 940, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   __Pyx_TraceLine(941,0,__PYX_ERR(2, 941, __pyx_L1_error))
@@ -26854,39 +26862,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __Pyx_TraceLine(942,0,__PYX_ERR(2, 942, __pyx_L3_error))
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 942, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":943
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __Pyx_TraceLine(943,0,__PYX_ERR(2, 943, __pyx_L5_except_error))
@@ -26894,15 +26902,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __Pyx_TraceLine(944,0,__PYX_ERR(2, 944, __pyx_L5_except_error))
@@ -26911,30 +26919,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -26950,15 +26958,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -26976,15 +26984,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
   __Pyx_TraceCall("import_umath", __pyx_f[2], 946, 0, __PYX_ERR(2, 946, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(947,0,__PYX_ERR(2, 947, __pyx_L1_error))
@@ -26993,39 +27001,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(948,0,__PYX_ERR(2, 948, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 948, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":949
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(949,0,__PYX_ERR(2, 949, __pyx_L5_except_error))
@@ -27033,15 +27041,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __Pyx_TraceLine(950,0,__PYX_ERR(2, 950, __pyx_L5_except_error))
@@ -27050,30 +27058,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -27089,15 +27097,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -27115,15 +27123,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
   __Pyx_TraceCall("import_ufunc", __pyx_f[2], 952, 0, __PYX_ERR(2, 952, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(953,0,__PYX_ERR(2, 953, __pyx_L1_error))
@@ -27132,39 +27140,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(954,0,__PYX_ERR(2, 954, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 954, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":955
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(955,0,__PYX_ERR(2, 955, __pyx_L5_except_error))
@@ -27172,15 +27180,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":956
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __Pyx_TraceLine(956,0,__PYX_ERR(2, 956, __pyx_L5_except_error))
@@ -27189,30 +27197,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -27228,15 +27236,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -27246,26 +27254,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
   __Pyx_TraceCall("is_timedelta64_object", __pyx_f[2], 966, 0, __PYX_ERR(2, 966, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":978
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(978,0,__PYX_ERR(2, 978, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -27275,15 +27283,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -27293,26 +27301,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
   __Pyx_TraceCall("is_datetime64_object", __pyx_f[2], 981, 0, __PYX_ERR(2, 981, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":993
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(993,0,__PYX_ERR(2, 993, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -27322,15 +27330,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -27338,26 +27346,26 @@
   npy_datetime __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_value", __pyx_f[2], 996, 1, __PYX_ERR(2, 996, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1003,1,__PYX_ERR(2, 1003, __pyx_L1_error))
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -27366,15 +27374,15 @@
   __Pyx_WriteUnraisable("numpy.get_datetime64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -27382,26 +27390,26 @@
   npy_timedelta __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_timedelta64_value", __pyx_f[2], 1006, 1, __PYX_ERR(2, 1006, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1010,1,__PYX_ERR(2, 1010, __pyx_L1_error))
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -27410,15 +27418,15 @@
   __Pyx_WriteUnraisable("numpy.get_timedelta64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -27426,24 +27434,24 @@
   NPY_DATETIMEUNIT __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_unit", __pyx_f[2], 1013, 1, __PYX_ERR(2, 1013, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __Pyx_TraceLine(1017,1,__PYX_ERR(2, 1017, __pyx_L1_error))
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -42585,26 +42593,26 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__3);
   __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(2, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__4);
   __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(2, 950, __pyx_L1_error)
@@ -42934,15 +42942,16 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base = *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD__call;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD_grad;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD_hessian;
@@ -43030,66 +43039,86 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 199, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 222, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 226, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 770, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 772, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 774, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 776, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 778, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 780, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 782, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 784, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 786, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 788, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
@@ -43406,165 +43435,165 @@
  */
   __Pyx_TraceLine(2,0,__PYX_ERR(1, 2, __pyx_L1_error))
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
   __Pyx_TraceLine(734,0,__PYX_ERR(2, 734, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
   __Pyx_TraceLine(737,0,__PYX_ERR(2, 737, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
   __Pyx_TraceLine(740,0,__PYX_ERR(2, 740, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
   __Pyx_TraceLine(743,0,__PYX_ERR(2, 743, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
   __Pyx_TraceLine(746,0,__PYX_ERR(2, 746, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
   __Pyx_TraceLine(749,0,__PYX_ERR(2, 749, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
   __Pyx_TraceLine(928,0,__PYX_ERR(2, 928, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
   __Pyx_TraceLine(932,0,__PYX_ERR(2, 932, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
   __Pyx_TraceLine(940,0,__PYX_ERR(2, 940, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(946,0,__PYX_ERR(2, 946, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(952,0,__PYX_ERR(2, 952, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
   __Pyx_TraceLine(966,0,__PYX_ERR(2, 966, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
   __Pyx_TraceLine(981,0,__PYX_ERR(2, 981, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
   __Pyx_TraceLine(996,0,__PYX_ERR(2, 996, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
   __Pyx_TraceLine(1006,0,__PYX_ERR(2, 1006, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
   __Pyx_TraceLine(1013,0,__PYX_ERR(2, 1013, __pyx_L1_error))
@@ -45303,28 +45332,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -46139,44 +46168,62 @@
 }
 #endif
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c`

 * *Files 2% similar despite different names*

```diff
@@ -1,33 +1,33 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "define_macros": [
             [
                 "CYTHON_TRACE",
                 "1"
             ]
         ],
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include"
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.hamiltonian.Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C",
         "sources": [
             "pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.hamiltonian.Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C"
@@ -39,16 +39,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -233,15 +233,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -272,15 +272,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -1128,195 +1128,195 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":689
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":696
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":703
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":713
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":717
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":721
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":724
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1354,42 +1354,42 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":728
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":732
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2475,20 +2475,28 @@
 #else
 #define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
 #endif
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* SetVTable.proto */
 static int __Pyx_SetVtable(PyObject *dict, void *vtable);
@@ -22983,15 +22991,15 @@
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -23002,30 +23010,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew1", __pyx_f[2], 734, 0, __PYX_ERR(2, 734, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_TraceLine(735,0,__PYX_ERR(2, 735, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -23037,15 +23045,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -23056,30 +23064,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew2", __pyx_f[2], 737, 0, __PYX_ERR(2, 737, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_TraceLine(738,0,__PYX_ERR(2, 738, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -23091,15 +23099,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -23110,30 +23118,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew3", __pyx_f[2], 740, 0, __PYX_ERR(2, 740, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_TraceLine(741,0,__PYX_ERR(2, 741, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -23145,15 +23153,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -23164,30 +23172,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew4", __pyx_f[2], 743, 0, __PYX_ERR(2, 743, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_TraceLine(744,0,__PYX_ERR(2, 744, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -23199,15 +23207,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -23218,30 +23226,30 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
   __Pyx_TraceCall("PyArray_MultiIterNew5", __pyx_f[2], 746, 0, __PYX_ERR(2, 746, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_TraceLine(747,0,__PYX_ERR(2, 747, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -23253,15 +23261,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -23272,63 +23280,63 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
   __Pyx_TraceCall("PyDataType_SHAPE", __pyx_f[2], 749, 0, __PYX_ERR(2, 749, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __Pyx_TraceLine(750,0,__PYX_ERR(2, 750, __pyx_L1_error))
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_TraceLine(751,0,__PYX_ERR(2, 751, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":753
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(753,0,__PYX_ERR(2, 753, __pyx_L1_error))
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
@@ -23339,15 +23347,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -23356,35 +23364,35 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("set_array_base", 0);
   __Pyx_TraceCall("set_array_base", __pyx_f[2], 928, 0, __PYX_ERR(2, 928, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   __Pyx_TraceLine(929,0,__PYX_ERR(2, 929, __pyx_L1_error))
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __Pyx_TraceLine(930,0,__PYX_ERR(2, 930, __pyx_L1_error))
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
@@ -23393,15 +23401,15 @@
   __pyx_L1_error:;
   __Pyx_WriteUnraisable("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -23413,70 +23421,70 @@
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_array_base", 0);
   __Pyx_TraceCall("get_array_base", __pyx_f[2], 932, 0, __PYX_ERR(2, 932, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __Pyx_TraceLine(933,0,__PYX_ERR(2, 933, __pyx_L1_error))
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __Pyx_TraceLine(934,0,__PYX_ERR(2, 934, __pyx_L1_error))
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_TraceLine(935,0,__PYX_ERR(2, 935, __pyx_L1_error))
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":936
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_TraceLine(936,0,__PYX_ERR(2, 936, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
@@ -23487,15 +23495,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -23513,15 +23521,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
   __Pyx_TraceCall("import_array", __pyx_f[2], 940, 0, __PYX_ERR(2, 940, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   __Pyx_TraceLine(941,0,__PYX_ERR(2, 941, __pyx_L1_error))
@@ -23530,39 +23538,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __Pyx_TraceLine(942,0,__PYX_ERR(2, 942, __pyx_L3_error))
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 942, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":943
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __Pyx_TraceLine(943,0,__PYX_ERR(2, 943, __pyx_L5_except_error))
@@ -23570,15 +23578,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __Pyx_TraceLine(944,0,__PYX_ERR(2, 944, __pyx_L5_except_error))
@@ -23587,30 +23595,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -23626,15 +23634,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -23652,15 +23660,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
   __Pyx_TraceCall("import_umath", __pyx_f[2], 946, 0, __PYX_ERR(2, 946, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(947,0,__PYX_ERR(2, 947, __pyx_L1_error))
@@ -23669,39 +23677,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(948,0,__PYX_ERR(2, 948, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 948, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":949
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(949,0,__PYX_ERR(2, 949, __pyx_L5_except_error))
@@ -23709,15 +23717,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __Pyx_TraceLine(950,0,__PYX_ERR(2, 950, __pyx_L5_except_error))
@@ -23726,30 +23734,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -23765,15 +23773,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -23791,15 +23799,15 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
   __Pyx_TraceCall("import_ufunc", __pyx_f[2], 952, 0, __PYX_ERR(2, 952, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   __Pyx_TraceLine(953,0,__PYX_ERR(2, 953, __pyx_L1_error))
@@ -23808,39 +23816,39 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __Pyx_TraceLine(954,0,__PYX_ERR(2, 954, __pyx_L3_error))
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 954, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":955
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __Pyx_TraceLine(955,0,__PYX_ERR(2, 955, __pyx_L5_except_error))
@@ -23848,15 +23856,15 @@
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":956
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __Pyx_TraceLine(956,0,__PYX_ERR(2, 956, __pyx_L5_except_error))
@@ -23865,30 +23873,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -23904,15 +23912,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -23922,26 +23930,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
   __Pyx_TraceCall("is_timedelta64_object", __pyx_f[2], 966, 0, __PYX_ERR(2, 966, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":978
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(978,0,__PYX_ERR(2, 978, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
@@ -23951,15 +23959,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -23969,26 +23977,26 @@
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
   __Pyx_TraceCall("is_datetime64_object", __pyx_f[2], 981, 0, __PYX_ERR(2, 981, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":993
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(993,0,__PYX_ERR(2, 993, __pyx_L1_error))
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
@@ -23998,15 +24006,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -24014,26 +24022,26 @@
   npy_datetime __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_value", __pyx_f[2], 996, 1, __PYX_ERR(2, 996, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1003,1,__PYX_ERR(2, 1003, __pyx_L1_error))
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
@@ -24042,15 +24050,15 @@
   __Pyx_WriteUnraisable("numpy.get_datetime64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -24058,26 +24066,26 @@
   npy_timedelta __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_timedelta64_value", __pyx_f[2], 1006, 1, __PYX_ERR(2, 1006, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(1010,1,__PYX_ERR(2, 1010, __pyx_L1_error))
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
@@ -24086,15 +24094,15 @@
   __Pyx_WriteUnraisable("numpy.get_timedelta64_value", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 1);
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -24102,24 +24110,24 @@
   NPY_DATETIMEUNIT __pyx_r;
   __Pyx_TraceDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceCall("get_datetime64_unit", __pyx_f[2], 1013, 1, __PYX_ERR(2, 1013, __pyx_L1_error));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __Pyx_TraceLine(1017,1,__PYX_ERR(2, 1017, __pyx_L1_error))
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -39519,26 +39527,26 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__12);
   __Pyx_GIVEREF(__pyx_tuple__12);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(2, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__13);
   __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(2, 950, __pyx_L1_error)
@@ -39973,15 +39981,16 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base = *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C__call__pyx_wrap_1;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_grad;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_hessian;
@@ -40070,66 +40079,86 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 199, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 222, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 226, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 770, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 772, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 774, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 776, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 778, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 780, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 782, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 784, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 786, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 788, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
@@ -40513,165 +40542,165 @@
  */
   __Pyx_TraceLine(2,0,__PYX_ERR(1, 2, __pyx_L1_error))
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
   __Pyx_TraceLine(734,0,__PYX_ERR(2, 734, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
   __Pyx_TraceLine(737,0,__PYX_ERR(2, 737, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
   __Pyx_TraceLine(740,0,__PYX_ERR(2, 740, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
   __Pyx_TraceLine(743,0,__PYX_ERR(2, 743, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
   __Pyx_TraceLine(746,0,__PYX_ERR(2, 746, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
   __Pyx_TraceLine(749,0,__PYX_ERR(2, 749, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
   __Pyx_TraceLine(928,0,__PYX_ERR(2, 928, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
   __Pyx_TraceLine(932,0,__PYX_ERR(2, 932, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
   __Pyx_TraceLine(940,0,__PYX_ERR(2, 940, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(946,0,__PYX_ERR(2, 946, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
   __Pyx_TraceLine(952,0,__PYX_ERR(2, 952, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
   __Pyx_TraceLine(966,0,__PYX_ERR(2, 966, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
   __Pyx_TraceLine(981,0,__PYX_ERR(2, 981, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
   __Pyx_TraceLine(996,0,__PYX_ERR(2, 996, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
   __Pyx_TraceLine(1006,0,__PYX_ERR(2, 1006, __pyx_L1_error))
 
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
   __Pyx_TraceLine(1013,0,__PYX_ERR(2, 1013, __pyx_L1_error))
@@ -42430,28 +42459,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -43266,44 +43295,62 @@
 }
 #endif
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.c` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c`

 * *Files 3% similar despite different names*

```diff
@@ -8,22 +8,23 @@
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-e9bsn5qv/lib/python3.9/site-packages/numpy/core/include"
+            "/local/tmp/sossokine/build-env-e9bsn5qv/lib/python3.9/site-packages/numpy/core/include",
+            "pyseobnr/eob/hamiltonian"
         ],
-        "name": "pyseobnr.eob.hamiltonian.Hamiltonian_C",
+        "name": "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C",
         "sources": [
-            "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx"
+            "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx"
         ]
     },
-    "module_name": "pyseobnr.eob.hamiltonian.Hamiltonian_C"
+    "module_name": "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
@@ -757,16 +758,16 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__pyseobnr__eob__hamiltonian__Hamiltonian_C
-#define __PYX_HAVE_API__pyseobnr__eob__hamiltonian__Hamiltonian_C
+#define __PYX_HAVE__pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C
+#define __PYX_HAVE_API__pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C
 /* Early includes */
 #include "eob_parameters.h"
 #include "pythread.h"
 #include <string.h>
 #include <stdlib.h>
 #include <stdio.h>
 #include "pystate.h"
@@ -998,16 +999,16 @@
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 
 static const char *__pyx_f[] = {
   "stringsource",
-  "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx",
-  "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd",
+  "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx",
+  "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd",
   "pyseobnr/eob/utils/containers.pxd",
 };
 /* MemviewSliceStruct.proto */
 struct __pyx_memoryview_obj;
 typedef struct {
   struct __pyx_memoryview_obj *memview;
   char *data;
@@ -1125,15 +1126,15 @@
 
 /*--- Type declarations ---*/
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams;
-struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
 /* "pyseobnr/eob/utils/containers.pxd":8
  * 
@@ -1241,24 +1242,24 @@
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
   PyObject *mode_array;
   int aligned;
 };
 
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd":3
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd":4
  * cimport cython
  * from pyseobnr.eob.utils.containers cimport EOBParams
- * cdef class Hamiltonian_C:             # <<<<<<<<<<<<<<
+ * cdef class Hamiltonian_v5PHM_C:             # <<<<<<<<<<<<<<
  *     cdef public EOBParams EOBpars
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
  */
-struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
+struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C {
   PyObject_HEAD
-  struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtab;
+  struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtab;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
 };
 
 
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
@@ -1348,32 +1349,32 @@
 struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
   PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
   PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":4
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":4
  * from pyseobnr.eob.utils.containers cimport EOBParams
  * 
- * cdef class Hamiltonian_C:             # <<<<<<<<<<<<<<
+ * cdef class Hamiltonian_v5PHM_C:             # <<<<<<<<<<<<<<
  *     def __cinit__(self,EOBParams):
  *         pass
  */
 
-struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
-  PyObject *(*_call)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*grad)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*hessian)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  double (*csi)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*auxderivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
+struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C {
+  PyObject *(*_call)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*grad)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*hessian)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  double (*csi)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
+  PyObject *(*aux_derivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
 };
-static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 
 
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
@@ -2122,21 +2123,21 @@
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
 static PyObject *__pyx_memoryview_is_slice(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_obj); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assignment(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_dst, PyObject *__pyx_v_src); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assign_scalar(struct __pyx_memoryview_obj *__pyx_v_self, struct __pyx_memoryview_obj *__pyx_v_dst, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_setitem_indexed(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_convert_item_to_object(struct __pyx_memoryview_obj *__pyx_v_self, char *__pyx_v_itemp); /* proto*/
@@ -2151,16 +2152,16 @@
 /* Module declarations from 'pyseobnr.eob.utils.containers' */
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = 0;
 
-/* Module declarations from 'pyseobnr.eob.hamiltonian.Hamiltonian_C' */
-static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = 0;
+/* Module declarations from 'pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C' */
+static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
 static PyTypeObject *__pyx_memoryviewslice_type = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
@@ -2198,19 +2199,19 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-#define __Pyx_MODULE_NAME "pyseobnr.eob.hamiltonian.Hamiltonian_C"
-extern int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C;
-int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C = 0;
+#define __Pyx_MODULE_NAME "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"
+extern int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C;
+int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C = 0;
 
-/* Implementation of 'pyseobnr.eob.hamiltonian.Hamiltonian_C' */
+/* Implementation of 'pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C' */
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
@@ -2244,14 +2245,18 @@
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_omega[] = "omega";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
+static const char __pyx_k_chi1_v[] = "chi1_v";
+static const char __pyx_k_chi2_v[] = "chi2_v";
+static const char __pyx_k_chiL_1[] = "chiL_1";
+static const char __pyx_k_chiL_2[] = "chiL_2";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
@@ -2264,37 +2269,37 @@
 static const char __pyx_k_dynamics[] = "dynamics";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_EOBParams[] = "EOBParams";
 static const char __pyx_k_TypeError[] = "TypeError";
-static const char __pyx_k_auxderivs[] = "auxderivs";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
+static const char __pyx_k_aux_derivs[] = "aux_derivs";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_stringsource[] = "stringsource";
-static const char __pyx_k_Hamiltonian_C[] = "Hamiltonian_C";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
+static const char __pyx_k_Hamiltonian_v5PHM_C[] = "Hamiltonian_v5PHM_C";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
@@ -2319,15 +2324,15 @@
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
 static PyObject *__pyx_n_s_EOBParams;
 static PyObject *__pyx_n_s_Ellipsis;
 static PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
-static PyObject *__pyx_n_s_Hamiltonian_C;
+static PyObject *__pyx_n_s_Hamiltonian_v5PHM_C;
 static PyObject *__pyx_kp_s_Incompatible_checksums_0x_x_vs_0;
 static PyObject *__pyx_n_s_IndexError;
 static PyObject *__pyx_kp_s_Indirect_dimensions_not_supporte;
 static PyObject *__pyx_kp_s_Invalid_mode_expected_c_or_fortr;
 static PyObject *__pyx_kp_s_Invalid_shape_in_axis_d_d;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_kp_s_MemoryView_of_r_at_0x_x;
@@ -2336,19 +2341,23 @@
 static PyObject *__pyx_kp_s_Out_of_bounds_on_buffer_access_a;
 static PyObject *__pyx_n_s_PickleError;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
 static PyObject *__pyx_n_s_allocate_buffer;
-static PyObject *__pyx_n_s_auxderivs;
+static PyObject *__pyx_n_s_aux_derivs;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_u_c;
 static PyObject *__pyx_n_s_call;
+static PyObject *__pyx_n_s_chi1_v;
+static PyObject *__pyx_n_s_chi2_v;
+static PyObject *__pyx_n_s_chiL_1;
+static PyObject *__pyx_n_s_chiL_2;
 static PyObject *__pyx_n_s_chi_1;
 static PyObject *__pyx_n_s_chi_2;
 static PyObject *__pyx_n_s_class;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
 static PyObject *__pyx_n_s_csi;
@@ -2411,27 +2420,27 @@
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_struct;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_unpack;
 static PyObject *__pyx_n_s_update;
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -2466,15 +2475,15 @@
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_112105877;
@@ -2507,25 +2516,25 @@
 static PyObject *__pyx_tuple__24;
 static PyObject *__pyx_tuple__25;
 static PyObject *__pyx_tuple__26;
 static PyObject *__pyx_tuple__27;
 static PyObject *__pyx_codeobj__28;
 /* Late includes */
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":5
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":5
  * 
- * cdef class Hamiltonian_C:
+ * cdef class Hamiltonian_v5PHM_C:
  *     def __cinit__(self,EOBParams):             # <<<<<<<<<<<<<<
  *         pass
  * 
  */
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_EOBParams = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
@@ -2557,60 +2566,64 @@
     }
     __pyx_v_EOBParams = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
   __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 5, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_EOBParams);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_EOBParams);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams) {
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":9
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":9
  * 
  * 
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_call", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -2618,100 +2631,130 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_call); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call)) {
         __Pyx_XDECREF(__pyx_r);
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 9, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 9, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 9, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -2722,19 +2765,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":10
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":10
  * 
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -2744,53 +2787,69 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":9
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":9
  * 
  * 
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_call (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -2807,130 +2866,170 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 1); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 1); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 2); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 2); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 3); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 3); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 4); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 4); __PYX_ERR(1, 9, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, 5); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 5); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 6); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 7); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 8); __PYX_ERR(1, 9, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 9); __PYX_ERR(1, 9, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_call") < 0)) __PYX_ERR(1, 9, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_call", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 9, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 9, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_call", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":11
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":11
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("grad", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -2938,100 +3037,130 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_grad); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad)) {
         __Pyx_XDECREF(__pyx_r);
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 11, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 11, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 11, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 11, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -3042,19 +3171,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":12
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":12
  *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -3064,53 +3193,69 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":11
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":11
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("grad (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3127,130 +3272,170 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 1); __PYX_ERR(1, 11, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 1); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 2); __PYX_ERR(1, 11, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 2); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 3); __PYX_ERR(1, 11, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 3); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 4); __PYX_ERR(1, 11, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 4); __PYX_ERR(1, 11, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, 5); __PYX_ERR(1, 11, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 5); __PYX_ERR(1, 11, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 6); __PYX_ERR(1, 11, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 7); __PYX_ERR(1, 11, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 8); __PYX_ERR(1, 11, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 9); __PYX_ERR(1, 11, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "grad") < 0)) __PYX_ERR(1, 11, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("grad", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 11, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 11, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("grad", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":13
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":13
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("hessian", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -3258,100 +3443,130 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_hessian); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian)) {
         __Pyx_XDECREF(__pyx_r);
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 13, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 13, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 13, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -3362,19 +3577,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":14
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":14
  *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -3384,53 +3599,69 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":13
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":13
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("hessian (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3447,131 +3678,171 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 1); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 1); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 2); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 2); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 3); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 3); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 4); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 4); __PYX_ERR(1, 13, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, 5); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 5); __PYX_ERR(1, 13, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 6); __PYX_ERR(1, 13, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 7); __PYX_ERR(1, 13, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 8); __PYX_ERR(1, 13, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 9); __PYX_ERR(1, 13, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hessian") < 0)) __PYX_ERR(1, 13, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("hessian", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 13, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 13, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("hessian", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":15
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":15
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   double __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
-  double __pyx_t_13;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
+  double __pyx_t_17;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("csi", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -3579,102 +3850,132 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_csi); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi)) {
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 15, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __pyx_t_17 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_17 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_r = __pyx_t_13;
+        __pyx_r = __pyx_t_17;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
       if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
@@ -3683,19 +3984,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":16
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":16
  *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -3705,52 +4006,68 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":15
- *     cpdef hessian(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":15
+ *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("csi (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3767,130 +4084,170 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 1); __PYX_ERR(1, 15, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 1); __PYX_ERR(1, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 2); __PYX_ERR(1, 15, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 2); __PYX_ERR(1, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 3); __PYX_ERR(1, 15, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 3); __PYX_ERR(1, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 4); __PYX_ERR(1, 15, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 4); __PYX_ERR(1, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, 5); __PYX_ERR(1, 15, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 5); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 6); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 7); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 8); __PYX_ERR(1, 15, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 9); __PYX_ERR(1, 15, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "csi") < 0)) __PYX_ERR(1, 15, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("csi", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 15, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 15, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("csi", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":17
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":17
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("dynamics", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -3898,100 +4255,130 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_dynamics); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics)) {
         __Pyx_XDECREF(__pyx_r);
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 17, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 17, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 17, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -4002,19 +4389,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":18
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":18
  *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -4024,53 +4411,69 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":17
- *     cpdef double csi(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":17
+ *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("dynamics (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4087,131 +4490,171 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 1); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 1); __PYX_ERR(1, 17, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 2); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 2); __PYX_ERR(1, 17, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 3); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 3); __PYX_ERR(1, 17, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 4); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 4); __PYX_ERR(1, 17, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, 5); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 5); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 6); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 7); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 8); __PYX_ERR(1, 17, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 9); __PYX_ERR(1, 17, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dynamics") < 0)) __PYX_ERR(1, 17, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("dynamics", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 17, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 17, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("dynamics", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":19
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":19
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   double __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
-  double __pyx_t_13;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
+  double __pyx_t_17;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("omega", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
@@ -4219,102 +4662,132 @@
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
       __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega)) {
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 19, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 19, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __pyx_t_17 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_17 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_r = __pyx_t_13;
+        __pyx_r = __pyx_t_17;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
       if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
@@ -4323,19 +4796,19 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":20
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":20
  *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
  */
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -4345,52 +4818,68 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":19
- *     cpdef  dynamics(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":19
+ *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("omega (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4407,230 +4896,300 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 1); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 1); __PYX_ERR(1, 19, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 2); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 2); __PYX_ERR(1, 19, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 3); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 3); __PYX_ERR(1, 19, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 4); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 4); __PYX_ERR(1, 19, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, 5); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 5); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 6); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 7); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 8); __PYX_ERR(1, 19, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 9); __PYX_ERR(1, 19, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "omega") < 0)) __PYX_ERR(1, 19, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("omega", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 19, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 19, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("omega", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":21
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":21
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
-  int __pyx_t_11;
+  PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  int __pyx_t_15;
+  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("auxderivs", 0);
+  __Pyx_RefNannySetupContext("aux_derivs", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_auxderivs); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_aux_derivs); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs)) {
         __Pyx_XDECREF(__pyx_r);
         if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
         __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
         __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 21, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
+        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 21, __pyx_L1_error)
+        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
+        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 21, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 21, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
-        __pyx_t_11 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_10)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_10);
+        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
+        __pyx_t_15 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+          if (likely(__pyx_t_14)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+            __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
-            __pyx_t_11 = 1;
+            __Pyx_DECREF_SET(__pyx_t_13, function);
+            __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (PyFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
-          PyObject *__pyx_temp[7] = {__pyx_t_10, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
+          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_12 = PyTuple_New(6+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (__pyx_t_10) {
-            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          if (__pyx_t_14) {
+            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_6);
+          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_11, __pyx_t_8);
+          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
+          __Pyx_GIVEREF(__pyx_t_9);
+          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_10);
+          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_11);
+          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
+          __pyx_t_9 = 0;
+          __pyx_t_10 = 0;
+          __pyx_t_11 = 0;
+          __pyx_t_12 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         }
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -4641,17 +5200,17 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":22
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":22
  *         pass
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass             # <<<<<<<<<<<<<<
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -4661,52 +5220,68 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_16);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":21
- *     cpdef double omega(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":21
+ *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
  *         pass
- *     cpdef auxderivs(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2):             # <<<<<<<<<<<<<<
+ *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
  *         pass
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
+  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_m_1;
   double __pyx_v_m_2;
+  double __pyx_v_chi_1;
+  double __pyx_v_chi_2;
+  double __pyx_v_chiL_1;
+  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("auxderivs (wrapper)", 0);
+  __Pyx_RefNannySetupContext("aux_derivs (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_m_1,&__pyx_n_s_m_2,0};
-    PyObject* values[6] = {0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4723,128 +5298,164 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 1); __PYX_ERR(1, 21, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 1); __PYX_ERR(1, 21, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 2); __PYX_ERR(1, 21, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 2); __PYX_ERR(1, 21, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 3); __PYX_ERR(1, 21, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 3); __PYX_ERR(1, 21, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 4); __PYX_ERR(1, 21, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 4); __PYX_ERR(1, 21, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, 5); __PYX_ERR(1, 21, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 5); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 6); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 7); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 8); __PYX_ERR(1, 21, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 9); __PYX_ERR(1, 21, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "auxderivs") < 0)) __PYX_ERR(1, 21, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "aux_derivs") < 0)) __PYX_ERR(1, 21, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
     }
     __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
     __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
     __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
     __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
+    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("auxderivs", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 21, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 21, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_14auxderivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("auxderivs", 0);
+  __Pyx_RefNannySetupContext("aux_derivs", 0);
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
+  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.auxderivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd":4
+/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd":5
  * from pyseobnr.eob.utils.containers cimport EOBParams
- * cdef class Hamiltonian_C:
+ * cdef class Hamiltonian_v5PHM_C:
  *     cdef public EOBParams EOBpars             # <<<<<<<<<<<<<<
- *     cpdef _call(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
- *     cpdef grad(self, double[:]q,double[:]p,double chi_1,double chi_2,double m_1,double m_2)
+ *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
+ *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(PyObject *__pyx_v_self); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(PyObject *__pyx_v_self) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->EOBpars));
   __pyx_r = ((PyObject *)__pyx_v_self->EOBpars);
   goto __pyx_L0;
@@ -4853,69 +5464,69 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), ((PyObject *)__pyx_v_value));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, PyObject *__pyx_v_value) {
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
-  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams))))) __PYX_ERR(2, 4, __pyx_L1_error)
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams))))) __PYX_ERR(2, 5, __pyx_L1_error)
   __pyx_t_1 = __pyx_v_value;
   __Pyx_INCREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->EOBpars);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
   __pyx_v_self->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.EOBpars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.EOBpars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(PyObject *__pyx_v_self); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(PyObject *__pyx_v_self) {
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(PyObject *__pyx_v_self) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__del__", 0);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   __Pyx_GOTREF(__pyx_v_self->EOBpars);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
@@ -4930,27 +5541,27 @@
 /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
@@ -4972,42 +5583,42 @@
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "(tree fragment)":3
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
@@ -5029,15 +5640,15 @@
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "View.MemoryView":123
@@ -18076,102 +18687,102 @@
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 
-static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyTypeObject *t, PyObject *a, PyObject *k) {
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p;
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
   } else {
     o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
   }
   if (unlikely(!o)) return 0;
-  p = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o);
-  p->__pyx_vtab = __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o);
+  p->__pyx_vtab = __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
   p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
-  if (unlikely(__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_1__cinit__(o, a, k) < 0)) goto bad;
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(o, a, k) < 0)) goto bad;
   return o;
   bad:
   Py_DECREF(o); o = 0;
   return NULL;
 }
 
-static void __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o) {
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+static void __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
   #if CYTHON_USE_TP_FINALIZE
   if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
     if (PyObject_CallFinalizerFromDealloc(o)) return;
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->EOBpars);
   (*Py_TYPE(o)->tp_free)(o);
 }
 
-static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
   if (p->EOBpars) {
     e = (*v)(((PyObject *)p->EOBpars), a); if (e) return e;
   }
   return 0;
 }
 
-static int __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C(PyObject *o) {
+static int __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o) {
   PyObject* tmp;
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)o;
+  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
   tmp = ((PyObject*)p->EOBpars);
   p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   return 0;
 }
 
-static PyObject *__pyx_getprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars(PyObject *o, CYTHON_UNUSED void *x) {
-  return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_1__get__(o);
+static PyObject *__pyx_getprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(o);
 }
 
-static int __pyx_setprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+static int __pyx_setprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
   if (v) {
-    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_3__set__(o, v);
+    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(o, v);
   }
   else {
-    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7EOBpars_5__del__(o);
+    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(o);
   }
 }
 
-static PyMethodDef __pyx_methods_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C[] = {
-  {"_call", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_3_call, METH_VARARGS|METH_KEYWORDS, 0},
-  {"grad", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_5grad, METH_VARARGS|METH_KEYWORDS, 0},
-  {"hessian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_7hessian, METH_VARARGS|METH_KEYWORDS, 0},
-  {"csi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_9csi, METH_VARARGS|METH_KEYWORDS, 0},
-  {"dynamics", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_11dynamics, METH_VARARGS|METH_KEYWORDS, 0},
-  {"omega", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_13omega, METH_VARARGS|METH_KEYWORDS, 0},
-  {"auxderivs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_15auxderivs, METH_VARARGS|METH_KEYWORDS, 0},
-  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_17__reduce_cython__, METH_NOARGS, 0},
-  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_19__setstate_cython__, METH_O, 0},
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C[] = {
+  {"_call", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call, METH_VARARGS|METH_KEYWORDS, 0},
+  {"grad", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad, METH_VARARGS|METH_KEYWORDS, 0},
+  {"hessian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian, METH_VARARGS|METH_KEYWORDS, 0},
+  {"csi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi, METH_VARARGS|METH_KEYWORDS, 0},
+  {"dynamics", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics, METH_VARARGS|METH_KEYWORDS, 0},
+  {"omega", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega, METH_VARARGS|METH_KEYWORDS, 0},
+  {"aux_derivs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs, METH_VARARGS|METH_KEYWORDS, 0},
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
-static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C[] = {
-  {(char *)"EOBpars", __pyx_getprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars, __pyx_setprop_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_EOBpars, (char *)0, 0},
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C[] = {
+  {(char *)"EOBpars", __pyx_getprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars, __pyx_setprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars, (char *)0, 0},
   {0, 0, 0, 0, 0}
 };
 
-static PyTypeObject __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = {
+static PyTypeObject __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_C.Hamiltonian_C", /*tp_name*/
-  sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), /*tp_basicsize*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_dealloc*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -18190,31 +18801,31 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_traverse*/
-  __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_clear*/
+  __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_traverse*/
+  __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
-  __pyx_methods_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_methods*/
+  __pyx_methods_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_methods*/
   0, /*tp_members*/
-  __pyx_getsets_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_getset*/
+  __pyx_getsets_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, /*tp_new*/
+  __pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -18352,15 +18963,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_C.array", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18474,15 +19085,15 @@
   {"__reduce_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_1__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_3__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_C.Enum", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18738,15 +19349,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_C.memoryview", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18879,15 +19490,15 @@
 static struct PyGetSetDef __pyx_getsets__memoryviewslice[] = {
   {(char *)"base", __pyx_getprop___pyx_memoryviewslice_base, 0, (char *)0, 0},
   {0, 0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_C._memoryviewslice", /*tp_name*/
+  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C._memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -18964,25 +19575,25 @@
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_Hamiltonian_C(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_Hamiltonian_v5PHM_C(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_Hamiltonian_C},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_Hamiltonian_v5PHM_C},
   {0, NULL}
 };
 #endif
 
 static struct PyModuleDef __pyx_moduledef = {
     PyModuleDef_HEAD_INIT,
-    "Hamiltonian_C",
+    "Hamiltonian_v5PHM_C",
     0, /* m_doc */
   #if CYTHON_PEP489_MULTI_PHASE_INIT
     0, /* m_size */
   #else
     -1, /* m_size */
   #endif
     __pyx_methods /* m_methods */,
@@ -19012,15 +19623,15 @@
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
   {&__pyx_n_s_EOBParams, __pyx_k_EOBParams, sizeof(__pyx_k_EOBParams), 0, 0, 1, 1},
   {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
   {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
-  {&__pyx_n_s_Hamiltonian_C, __pyx_k_Hamiltonian_C, sizeof(__pyx_k_Hamiltonian_C), 0, 0, 1, 1},
+  {&__pyx_n_s_Hamiltonian_v5PHM_C, __pyx_k_Hamiltonian_v5PHM_C, sizeof(__pyx_k_Hamiltonian_v5PHM_C), 0, 0, 1, 1},
   {&__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_k_Incompatible_checksums_0x_x_vs_0, sizeof(__pyx_k_Incompatible_checksums_0x_x_vs_0), 0, 0, 1, 0},
   {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
   {&__pyx_kp_s_Indirect_dimensions_not_supporte, __pyx_k_Indirect_dimensions_not_supporte, sizeof(__pyx_k_Indirect_dimensions_not_supporte), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_k_Invalid_mode_expected_c_or_fortr, sizeof(__pyx_k_Invalid_mode_expected_c_or_fortr), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_k_Invalid_shape_in_axis_d_d, sizeof(__pyx_k_Invalid_shape_in_axis_d_d), 0, 0, 1, 0},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_k_MemoryView_of_r_at_0x_x, sizeof(__pyx_k_MemoryView_of_r_at_0x_x), 0, 0, 1, 0},
@@ -19029,19 +19640,23 @@
   {&__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_k_Out_of_bounds_on_buffer_access_a, sizeof(__pyx_k_Out_of_bounds_on_buffer_access_a), 0, 0, 1, 0},
   {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
-  {&__pyx_n_s_auxderivs, __pyx_k_auxderivs, sizeof(__pyx_k_auxderivs), 0, 0, 1, 1},
+  {&__pyx_n_s_aux_derivs, __pyx_k_aux_derivs, sizeof(__pyx_k_aux_derivs), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
   {&__pyx_n_s_call, __pyx_k_call, sizeof(__pyx_k_call), 0, 0, 1, 1},
+  {&__pyx_n_s_chi1_v, __pyx_k_chi1_v, sizeof(__pyx_k_chi1_v), 0, 0, 1, 1},
+  {&__pyx_n_s_chi2_v, __pyx_k_chi2_v, sizeof(__pyx_k_chi2_v), 0, 0, 1, 1},
+  {&__pyx_n_s_chiL_1, __pyx_k_chiL_1, sizeof(__pyx_k_chiL_1), 0, 0, 1, 1},
+  {&__pyx_n_s_chiL_2, __pyx_k_chiL_2, sizeof(__pyx_k_chiL_2), 0, 0, 1, 1},
   {&__pyx_n_s_chi_1, __pyx_k_chi_1, sizeof(__pyx_k_chi_1), 0, 0, 1, 1},
   {&__pyx_n_s_chi_2, __pyx_k_chi_2, sizeof(__pyx_k_chi_2), 0, 0, 1, 1},
   {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
   {&__pyx_n_s_csi, __pyx_k_csi, sizeof(__pyx_k_csi), 0, 0, 1, 1},
@@ -19466,33 +20081,33 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C__call;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_grad;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_hessian;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.csi = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_csi;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_dynamics;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.omega = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_omega;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.auxderivs = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_13Hamiltonian_C_auxderivs;
-  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.csi = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.omega = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega;
+  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.aux_derivs = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_print = 0;
+  __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_dictoffset && __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_dictoffset && __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C.tp_dict, __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Hamiltonian_C, (PyObject *)&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = &__pyx_type_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+  if (__Pyx_SetVtable(__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_dict, __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Hamiltonian_v5PHM_C, (PyObject *)&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = &__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
   if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
@@ -19608,19 +20223,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC initHamiltonian_C(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC initHamiltonian_C(void)
+__Pyx_PyMODINIT_FUNC initHamiltonian_v5PHM_C(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initHamiltonian_v5PHM_C(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void)
+__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -19679,43 +20294,43 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_Hamiltonian_C(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_Hamiltonian_v5PHM_C(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   static PyThread_type_lock __pyx_t_2[8];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'Hamiltonian_C' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'Hamiltonian_v5PHM_C' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   #if CYTHON_REFNANNY
 __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_C(void)", 0);
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void)", 0);
   if (__Pyx_check_binary_version() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(1, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(1, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -19744,15 +20359,15 @@
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("Hamiltonian_C", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("Hamiltonian_v5PHM_C", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
   if (unlikely(!__pyx_m)) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
   __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(1, 1, __pyx_L1_error)
   Py_INCREF(__pyx_d);
@@ -19762,22 +20377,22 @@
   Py_INCREF(__pyx_cython_runtime);
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_C) {
+  if (__pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(1, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_C")) {
-      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_C", __pyx_m) < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C")) {
+      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", __pyx_m) < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -19790,15 +20405,15 @@
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   #endif
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx":1
+  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":1
  * cimport cython             # <<<<<<<<<<<<<<
  * from pyseobnr.eob.utils.containers cimport EOBParams
  * 
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -19960,19 +20575,19 @@
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init pyseobnr.eob.hamiltonian.Hamiltonian_C", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init pyseobnr.eob.hamiltonian.Hamiltonian_C");
+    PyErr_SetString(PyExc_ImportError, "init pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c` & `pyseobnr-0.2.0/pyseobnr/eob/utils/containers.c`

 * *Files 19% similar despite different names*

```diff
@@ -1,44 +1,44 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
-        "extra_compile_args": [
-            "-O3"
-        ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-e9bsn5qv/lib/python3.9/site-packages/numpy/core/include",
-            "pyseobnr/eob/hamiltonian"
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include"
         ],
-        "name": "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C",
+        "name": "pyseobnr.eob.utils.containers",
         "sources": [
-            "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx"
+            "pyseobnr/eob/utils/containers.pyx"
         ]
     },
-    "module_name": "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"
+    "module_name": "pyseobnr.eob.utils.containers"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -223,15 +223,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -262,15 +262,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -758,22 +758,30 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C
-#define __PYX_HAVE_API__pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C
+#define __PYX_HAVE__pyseobnr__eob__utils__containers
+#define __PYX_HAVE_API__pyseobnr__eob__utils__containers
 /* Early includes */
 #include "eob_parameters.h"
-#include "pythread.h"
 #include <string.h>
-#include <stdlib.h>
 #include <stdio.h>
+#include "numpy/arrayobject.h"
+#include "numpy/ndarrayobject.h"
+#include "numpy/ndarraytypes.h"
+#include "numpy/arrayscalars.h"
+#include "numpy/ufuncobject.h"
+
+    /* NumPy API declarations from "numpy/__init__.pxd" */
+    
+#include "pythread.h"
+#include <stdlib.h>
 #include "pystate.h"
 #ifdef _OPENMP
 #include <omp.h>
 #endif /* _OPENMP */
 
 #if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
 #define CYTHON_WITHOUT_ASSERTIONS
@@ -999,17 +1007,18 @@
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 
 static const char *__pyx_f[] = {
   "stringsource",
-  "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx",
-  "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd",
+  "pyseobnr/eob/utils/containers.pyx",
   "pyseobnr/eob/utils/containers.pxd",
+  "__init__.pxd",
+  "type.pxd",
 };
 /* MemviewSliceStruct.proto */
 struct __pyx_memoryview_obj;
 typedef struct {
   struct __pyx_memoryview_obj *memview;
   char *data;
   Py_ssize_t shape[8];
@@ -1107,39 +1116,275 @@
   int is_complex;
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
+ * # in Cython to enable them only on the right systems.
+ * 
+ * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_int16      int16_t
+ * ctypedef npy_int32      int32_t
+ */
+typedef npy_int8 __pyx_t_5numpy_int8_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
+ * 
+ * ctypedef npy_int8       int8_t
+ * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_int32      int32_t
+ * ctypedef npy_int64      int64_t
+ */
+typedef npy_int16 __pyx_t_5numpy_int16_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
+ * ctypedef npy_int8       int8_t
+ * ctypedef npy_int16      int16_t
+ * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_int64      int64_t
+ * #ctypedef npy_int96      int96_t
+ */
+typedef npy_int32 __pyx_t_5numpy_int32_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
+ * ctypedef npy_int16      int16_t
+ * ctypedef npy_int32      int32_t
+ * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
+ * #ctypedef npy_int96      int96_t
+ * #ctypedef npy_int128     int128_t
+ */
+typedef npy_int64 __pyx_t_5numpy_int64_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
+ * #ctypedef npy_int128     int128_t
+ * 
+ * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_uint16     uint16_t
+ * ctypedef npy_uint32     uint32_t
+ */
+typedef npy_uint8 __pyx_t_5numpy_uint8_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
+ * 
+ * ctypedef npy_uint8      uint8_t
+ * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_uint32     uint32_t
+ * ctypedef npy_uint64     uint64_t
+ */
+typedef npy_uint16 __pyx_t_5numpy_uint16_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
+ * ctypedef npy_uint8      uint8_t
+ * ctypedef npy_uint16     uint16_t
+ * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_uint64     uint64_t
+ * #ctypedef npy_uint96     uint96_t
+ */
+typedef npy_uint32 __pyx_t_5numpy_uint32_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
+ * ctypedef npy_uint16     uint16_t
+ * ctypedef npy_uint32     uint32_t
+ * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
+ * #ctypedef npy_uint96     uint96_t
+ * #ctypedef npy_uint128    uint128_t
+ */
+typedef npy_uint64 __pyx_t_5numpy_uint64_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
+ * #ctypedef npy_uint128    uint128_t
+ * 
+ * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_float64    float64_t
+ * #ctypedef npy_float80    float80_t
+ */
+typedef npy_float32 __pyx_t_5numpy_float32_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
+ * 
+ * ctypedef npy_float32    float32_t
+ * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
+ * #ctypedef npy_float80    float80_t
+ * #ctypedef npy_float128   float128_t
+ */
+typedef npy_float64 __pyx_t_5numpy_float64_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
+ * # The int types are mapped a bit surprising --
+ * # numpy.int corresponds to 'l' and numpy.long to 'q'
+ * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_longlong   long_t
+ * ctypedef npy_longlong   longlong_t
+ */
+typedef npy_long __pyx_t_5numpy_int_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
+ * # numpy.int corresponds to 'l' and numpy.long to 'q'
+ * ctypedef npy_long       int_t
+ * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_longlong   longlong_t
+ * 
+ */
+typedef npy_longlong __pyx_t_5numpy_long_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
+ * ctypedef npy_long       int_t
+ * ctypedef npy_longlong   long_t
+ * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_ulong      uint_t
+ */
+typedef npy_longlong __pyx_t_5numpy_longlong_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
+ * ctypedef npy_longlong   longlong_t
+ * 
+ * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_ulonglong  ulong_t
+ * ctypedef npy_ulonglong  ulonglong_t
+ */
+typedef npy_ulong __pyx_t_5numpy_uint_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
+ * 
+ * ctypedef npy_ulong      uint_t
+ * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_ulonglong  ulonglong_t
+ * 
+ */
+typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
+ * ctypedef npy_ulong      uint_t
+ * ctypedef npy_ulonglong  ulong_t
+ * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_intp       intp_t
+ */
+typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
+ * ctypedef npy_ulonglong  ulonglong_t
+ * 
+ * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_uintp      uintp_t
+ * 
+ */
+typedef npy_intp __pyx_t_5numpy_intp_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
+ * 
+ * ctypedef npy_intp       intp_t
+ * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_double     float_t
+ */
+typedef npy_uintp __pyx_t_5numpy_uintp_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
+ * ctypedef npy_uintp      uintp_t
+ * 
+ * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_double     double_t
+ * ctypedef npy_longdouble longdouble_t
+ */
+typedef npy_double __pyx_t_5numpy_float_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
+ * 
+ * ctypedef npy_double     float_t
+ * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_longdouble longdouble_t
+ * 
+ */
+typedef npy_double __pyx_t_5numpy_double_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
+ * ctypedef npy_double     float_t
+ * ctypedef npy_double     double_t
+ * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_cfloat      cfloat_t
+ */
+typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< double > __pyx_t_double_complex;
   #else
     typedef double _Complex __pyx_t_double_complex;
   #endif
 #else
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
+/* Declarations.proto */
+#if CYTHON_CCOMPLEX
+  #ifdef __cplusplus
+    typedef ::std::complex< float > __pyx_t_float_complex;
+  #else
+    typedef float _Complex __pyx_t_float_complex;
+  #endif
+#else
+    typedef struct { float real, imag; } __pyx_t_float_complex;
+#endif
+static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);
+
 
 /*--- Type declarations ---*/
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams;
-struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
+ * ctypedef npy_longdouble longdouble_t
+ * 
+ * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_cdouble     cdouble_t
+ * ctypedef npy_clongdouble clongdouble_t
+ */
+typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
+ * 
+ * ctypedef npy_cfloat      cfloat_t
+ * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_clongdouble clongdouble_t
+ * 
+ */
+typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
+ * ctypedef npy_cfloat      cfloat_t
+ * ctypedef npy_cdouble     cdouble_t
+ * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_cdouble     complex_t
+ */
+typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
+ * ctypedef npy_clongdouble clongdouble_t
+ * 
+ * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew1(a):
+ */
+typedef npy_cdouble __pyx_t_5numpy_complex_t;
+
 /* "pyseobnr/eob/utils/containers.pxd":8
  * 
  * 
  * cdef class PhysicalParams:             # <<<<<<<<<<<<<<
  *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
  *     cdef public double chi1_L, chi2_L,a1,a2, H_val
  */
@@ -1242,28 +1487,14 @@
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
   PyObject *mode_array;
   int aligned;
 };
 
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd":4
- * cimport cython
- * from pyseobnr.eob.utils.containers cimport EOBParams
- * cdef class Hamiltonian_v5PHM_C:             # <<<<<<<<<<<<<<
- *     cdef public EOBParams EOBpars
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
- */
-struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C {
-  PyObject_HEAD
-  struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtab;
-  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
-};
-
-
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1334,49 +1565,29 @@
   PyObject *from_object;
   PyObject *(*to_object_func)(char *);
   int (*to_dtype_func)(char *, PyObject *);
 };
 
 
 
-/* "pyseobnr/eob/utils/containers.pxd":8
- * 
+/* "pyseobnr/eob/utils/containers.pyx":6
+ * import numpy as np
  * 
  * cdef class PhysicalParams:             # <<<<<<<<<<<<<<
- *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
- *     cdef public double chi1_L, chi2_L,a1,a2, H_val
+ *     @cython.cdivision(True)
+ *     @cython.embedsignature(True)
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
   PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
   PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":4
- * from pyseobnr.eob.utils.containers cimport EOBParams
- * 
- * cdef class Hamiltonian_v5PHM_C:             # <<<<<<<<<<<<<<
- *     def __cinit__(self,EOBParams):
- *         pass
- */
-
-struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C {
-  PyObject *(*_call)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*grad)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*hessian)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  double (*csi)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-  PyObject *(*aux_derivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
-};
-static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
-
-
 /* "View.MemoryView":106
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1502,14 +1713,57 @@
     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
     const char* function_name);
 
 /* RaiseArgTupleInvalid.proto */
 static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
     Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
+/* ArgTypeTest.proto */
+#define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
+    ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
+        __Pyx__ArgTypeTest(obj, type, name, exact))
+static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
+
+/* DictGetItem.proto */
+#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
+#define __Pyx_PyObject_Dict_GetItem(obj, name)\
+    (likely(PyDict_CheckExact(obj)) ?\
+     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
+#else
+#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
+#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
+#endif
+
+/* MemviewSliceInit.proto */
+#define __Pyx_BUF_MAX_NDIMS %(BUF_MAX_NDIMS)d
+#define __Pyx_MEMVIEW_DIRECT   1
+#define __Pyx_MEMVIEW_PTR      2
+#define __Pyx_MEMVIEW_FULL     4
+#define __Pyx_MEMVIEW_CONTIG   8
+#define __Pyx_MEMVIEW_STRIDED  16
+#define __Pyx_MEMVIEW_FOLLOW   32
+#define __Pyx_IS_C_CONTIG 1
+#define __Pyx_IS_F_CONTIG 2
+static int __Pyx_init_memviewslice(
+                struct __pyx_memoryview_obj *memview,
+                int ndim,
+                __Pyx_memviewslice *memviewslice,
+                int memview_is_new_reference);
+static CYTHON_INLINE int __pyx_add_acquisition_count_locked(
+    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
+static CYTHON_INLINE int __pyx_sub_acquisition_count_locked(
+    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
+#define __pyx_get_slice_count_pointer(memview) (memview->acquisition_count_aligned_p)
+#define __pyx_get_slice_count(memview) (*__pyx_get_slice_count_pointer(memview))
+#define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
+#define __PYX_XDEC_MEMVIEW(slice, have_gil) __Pyx_XDEC_MEMVIEW(slice, have_gil, __LINE__)
+static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
+static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *, int, int);
+
 /* PyDictVersioning.proto */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 #define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
 #define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
     (version_var) = __PYX_GET_DICT_VERSION(dict);\
     (cache_var) = (value);
@@ -1528,17 +1782,14 @@
 static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version);
 #else
 #define __PYX_GET_DICT_VERSION(dict)  (0)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
 #define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
 #endif
 
-/* None.proto */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);
-
 /* PyFunctionFastCall.proto */
 #if CYTHON_FAST_PYCALL
 #define __Pyx_PyFunction_FastCall(func, args, nargs)\
     __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
 #if 1 || PY_VERSION_HEX < 0x030600B1
 static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, Py_ssize_t nargs, PyObject *kwargs);
 #else
@@ -1576,40 +1827,14 @@
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
 #endif
 
-/* MemviewSliceInit.proto */
-#define __Pyx_BUF_MAX_NDIMS %(BUF_MAX_NDIMS)d
-#define __Pyx_MEMVIEW_DIRECT   1
-#define __Pyx_MEMVIEW_PTR      2
-#define __Pyx_MEMVIEW_FULL     4
-#define __Pyx_MEMVIEW_CONTIG   8
-#define __Pyx_MEMVIEW_STRIDED  16
-#define __Pyx_MEMVIEW_FOLLOW   32
-#define __Pyx_IS_C_CONTIG 1
-#define __Pyx_IS_F_CONTIG 2
-static int __Pyx_init_memviewslice(
-                struct __pyx_memoryview_obj *memview,
-                int ndim,
-                __Pyx_memviewslice *memviewslice,
-                int memview_is_new_reference);
-static CYTHON_INLINE int __pyx_add_acquisition_count_locked(
-    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
-static CYTHON_INLINE int __pyx_sub_acquisition_count_locked(
-    __pyx_atomic_int *acquisition_count, PyThread_type_lock lock);
-#define __pyx_get_slice_count_pointer(memview) (memview->acquisition_count_aligned_p)
-#define __pyx_get_slice_count(memview) (*__pyx_get_slice_count_pointer(memview))
-#define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
-#define __PYX_XDEC_MEMVIEW(slice, have_gil) __Pyx_XDEC_MEMVIEW(slice, have_gil, __LINE__)
-static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
-static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *, int, int);
-
 /* PyThreadStateGet.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
 #define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
 #define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
 #else
 #define __Pyx_PyThreadState_declare
@@ -1638,42 +1863,94 @@
 #define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
 #define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
 #define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
 #define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
 #define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
 #endif
 
-/* WriteUnraisableException.proto */
-static void __Pyx_WriteUnraisable(const char *name, int clineno,
-                                  int lineno, const char *filename,
-                                  int full_traceback, int nogil);
-
-/* ExtTypeTest.proto */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
-
 /* RaiseException.proto */
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
 
-/* ArgTypeTest.proto */
-#define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
-    ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
-        __Pyx__ArgTypeTest(obj, type, name, exact))
-static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
+/* GetModuleGlobalName.proto */
+#if CYTHON_USE_DICT_VERSIONS
+#define __Pyx_GetModuleGlobalName(var, name)  do {\
+    static PY_UINT64_T __pyx_dict_version = 0;\
+    static PyObject *__pyx_dict_cached_value = NULL;\
+    (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
+        (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
+        __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
+} while(0)
+#define __Pyx_GetModuleGlobalNameUncached(var, name)  do {\
+    PY_UINT64_T __pyx_dict_version;\
+    PyObject *__pyx_dict_cached_value;\
+    (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
+} while(0)
+static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
+#else
+#define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
+#define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
+static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
+#endif
 
-/* PyObjectCall2Args.proto */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
+/* KeywordStringCheck.proto */
+static int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
+/* PyObjectCallNoArg.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
+#else
+#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
+#endif
+
+/* ExtTypeTest.proto */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+
+/* GetTopmostException.proto */
+#if CYTHON_USE_EXC_INFO_STACK
+static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
+#endif
+
+/* SaveResetException.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
+#else
+#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
+#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
+#endif
+
+/* PyErrExceptionMatches.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyErr_ExceptionMatches(err) __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
+static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err);
+#else
+#define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
+#endif
+
+/* GetException.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
+static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#else
+static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
+#endif
+
+/* PyObjectCall2Args.proto */
+static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
+
 /* IncludeStringH.proto */
 #include <string.h>
 
 /* BytesEquals.proto */
 static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);
 
 /* UnicodeEquals.proto */
@@ -1743,79 +2020,26 @@
 
 /* decode_c_string.proto */
 static CYTHON_INLINE PyObject* __Pyx_decode_c_string(
          const char* cstring, Py_ssize_t start, Py_ssize_t stop,
          const char* encoding, const char* errors,
          PyObject* (*decode_func)(const char *s, Py_ssize_t size, const char *errors));
 
-/* PyErrExceptionMatches.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyErr_ExceptionMatches(err) __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
-static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err);
-#else
-#define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
-#endif
-
 /* GetAttr3.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *, PyObject *, PyObject *);
 
-/* GetModuleGlobalName.proto */
-#if CYTHON_USE_DICT_VERSIONS
-#define __Pyx_GetModuleGlobalName(var, name)  do {\
-    static PY_UINT64_T __pyx_dict_version = 0;\
-    static PyObject *__pyx_dict_cached_value = NULL;\
-    (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
-        (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
-        __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-} while(0)
-#define __Pyx_GetModuleGlobalNameUncached(var, name)  do {\
-    PY_UINT64_T __pyx_dict_version;\
-    PyObject *__pyx_dict_cached_value;\
-    (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-} while(0)
-static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
-#else
-#define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
-#define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
-static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
-#endif
-
 /* RaiseTooManyValuesToUnpack.proto */
 static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);
 
 /* RaiseNeedMoreValuesToUnpack.proto */
 static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);
 
 /* RaiseNoneIterError.proto */
 static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);
 
-/* GetTopmostException.proto */
-#if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
-#endif
-
-/* SaveResetException.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
-#else
-#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
-#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
-#endif
-
-/* GetException.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
-static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#else
-static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
-#endif
-
 /* SwapException.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_ExceptionSwap(type, value, tb)  __Pyx__ExceptionSwap(__pyx_tstate, type, value, tb)
 static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
 #else
 static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb);
 #endif
@@ -1888,14 +2112,17 @@
     }
     return PyList_Append(list, x);
 }
 #else
 #define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
 #endif
 
+/* None.proto */
+static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);
+
 /* DivInt[long].proto */
 static CYTHON_INLINE long __Pyx_div_long(long, long);
 
 /* PySequenceContains.proto */
 static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
     int result = PySequence_Contains(seq, item);
     return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
@@ -1929,25 +2156,30 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
-/* GetVTable.proto */
-static void* __Pyx_GetVtable(PyObject *dict);
-
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
 #define __Pyx_CLineForTraceback(tstate, c_line)  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
 #else
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
 #endif
 
@@ -2000,44 +2232,14 @@
 static int __pyx_slices_overlap(__Pyx_memviewslice *slice1,
                                 __Pyx_memviewslice *slice2,
                                 int ndim, size_t itemsize);
 
 /* Capsule.proto */
 static CYTHON_INLINE PyObject *__pyx_capsule_create(void *p, const char *sig);
 
-/* IsLittleEndian.proto */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
-
-/* BufferFormatCheck.proto */
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type);
-
-/* TypeInfoCompare.proto */
-static int __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b);
-
-/* MemviewSliceValidateAndInit.proto */
-static int __Pyx_ValidateAndInit_memviewslice(
-                int *axes_specs,
-                int c_or_f_flag,
-                int buf_flags,
-                int ndim,
-                __Pyx_TypeInfo *dtype,
-                __Pyx_BufFmt_StackElem stack[],
-                __Pyx_memviewslice *memviewslice,
-                PyObject *original_obj);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
-
-/* MemviewDtypeToObject.proto */
-static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
-static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
-
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
   #else
     #define __Pyx_CREAL(z) (__real__(z))
@@ -2090,54 +2292,141 @@
     static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
     #if 1
         static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
         static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
     #endif
 #endif
 
+/* IsLittleEndian.proto */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
+
+/* BufferFormatCheck.proto */
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type);
+
+/* TypeInfoCompare.proto */
+static int __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b);
+
+/* MemviewSliceValidateAndInit.proto */
+static int __Pyx_ValidateAndInit_memviewslice(
+                int *axes_specs,
+                int c_or_f_flag,
+                int buf_flags,
+                int ndim,
+                __Pyx_TypeInfo *dtype,
+                __Pyx_BufFmt_StackElem stack[],
+                __Pyx_memviewslice *memviewslice,
+                PyObject *original_obj);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
+
+/* MemviewDtypeToObject.proto */
+static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
+static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
+
+/* GCCDiagnostics.proto */
+#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
+#define __Pyx_HAS_GCC_DIAGNOSTIC
+#endif
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_double(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(PyObject *, int writable_flag);
+
+/* ToPy.proto */
+#define __pyx_PyComplex_FromComplex(z)\
+        PyComplex_FromDoubles((double)__Pyx_CREAL(z),\
+                              (double)__Pyx_CIMAG(z))
+
+/* FromPy.proto */
+static __pyx_t_double_complex __Pyx_PyComplex_As___pyx_t_double_complex(PyObject*);
+
+/* MemviewDtypeToObject.proto */
+static CYTHON_INLINE PyObject *__pyx_memview_get___pyx_t_double_complex(const char *itemp);
+static CYTHON_INLINE int __pyx_memview_set___pyx_t_double_complex(const char *itemp, PyObject *obj);
+
+/* Arithmetic.proto */
+#if CYTHON_CCOMPLEX
+    #define __Pyx_c_eq_float(a, b)   ((a)==(b))
+    #define __Pyx_c_sum_float(a, b)  ((a)+(b))
+    #define __Pyx_c_diff_float(a, b) ((a)-(b))
+    #define __Pyx_c_prod_float(a, b) ((a)*(b))
+    #define __Pyx_c_quot_float(a, b) ((a)/(b))
+    #define __Pyx_c_neg_float(a)     (-(a))
+  #ifdef __cplusplus
+    #define __Pyx_c_is_zero_float(z) ((z)==(float)0)
+    #define __Pyx_c_conj_float(z)    (::std::conj(z))
+    #if 1
+        #define __Pyx_c_abs_float(z)     (::std::abs(z))
+        #define __Pyx_c_pow_float(a, b)  (::std::pow(a, b))
+    #endif
+  #else
+    #define __Pyx_c_is_zero_float(z) ((z)==0)
+    #define __Pyx_c_conj_float(z)    (conjf(z))
+    #if 1
+        #define __Pyx_c_abs_float(z)     (cabsf(z))
+        #define __Pyx_c_pow_float(a, b)  (cpowf(a, b))
+    #endif
+ #endif
+#else
+    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex);
+    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex);
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex);
+    #if 1
+        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex);
+        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex, __pyx_t_float_complex);
+    #endif
+#endif
+
 /* MemviewSliceCopyTemplate.proto */
 static __Pyx_memviewslice
 __pyx_memoryview_copy_new_contig(const __Pyx_memviewslice *from_mvs,
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
-/* GCCDiagnostics.proto */
-#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
-#define __Pyx_HAS_GCC_DIAGNOSTIC
-#endif
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
+
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
-
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
-
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_update_spins(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, double __pyx_v_chi_1, double __pyx_v_chi_2, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams__compute_derived_quants(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto*/
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
 static PyObject *__pyx_memoryview_is_slice(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_obj); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assignment(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_dst, PyObject *__pyx_v_src); /* proto*/
 static PyObject *__pyx_memoryview_setitem_slice_assign_scalar(struct __pyx_memoryview_obj *__pyx_v_self, struct __pyx_memoryview_obj *__pyx_v_dst, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_setitem_indexed(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index, PyObject *__pyx_v_value); /* proto*/
 static PyObject *__pyx_memoryview_convert_item_to_object(struct __pyx_memoryview_obj *__pyx_v_self, char *__pyx_v_itemp); /* proto*/
@@ -2145,23 +2434,58 @@
 static PyObject *__pyx_memoryviewslice_convert_item_to_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp); /* proto*/
 static PyObject *__pyx_memoryviewslice_assign_item_from_object(struct __pyx_memoryviewslice_obj *__pyx_v_self, char *__pyx_v_itemp, PyObject *__pyx_v_value); /* proto*/
 
 /* Module declarations from 'cython.view' */
 
 /* Module declarations from 'cython' */
 
+/* Module declarations from 'cpython.buffer' */
+
+/* Module declarations from 'libc.string' */
+
+/* Module declarations from 'libc.stdio' */
+
+/* Module declarations from '__builtin__' */
+
+/* Module declarations from 'cpython.type' */
+static PyTypeObject *__pyx_ptype_7cpython_4type_type = 0;
+
+/* Module declarations from 'cpython' */
+
+/* Module declarations from 'cpython.object' */
+
+/* Module declarations from 'cpython.ref' */
+
+/* Module declarations from 'cpython.mem' */
+
+/* Module declarations from 'numpy' */
+
+/* Module declarations from 'numpy' */
+static PyTypeObject *__pyx_ptype_5numpy_dtype = 0;
+static PyTypeObject *__pyx_ptype_5numpy_flatiter = 0;
+static PyTypeObject *__pyx_ptype_5numpy_broadcast = 0;
+static PyTypeObject *__pyx_ptype_5numpy_ndarray = 0;
+static PyTypeObject *__pyx_ptype_5numpy_generic = 0;
+static PyTypeObject *__pyx_ptype_5numpy_number = 0;
+static PyTypeObject *__pyx_ptype_5numpy_integer = 0;
+static PyTypeObject *__pyx_ptype_5numpy_signedinteger = 0;
+static PyTypeObject *__pyx_ptype_5numpy_unsignedinteger = 0;
+static PyTypeObject *__pyx_ptype_5numpy_inexact = 0;
+static PyTypeObject *__pyx_ptype_5numpy_floating = 0;
+static PyTypeObject *__pyx_ptype_5numpy_complexfloating = 0;
+static PyTypeObject *__pyx_ptype_5numpy_flexible = 0;
+static PyTypeObject *__pyx_ptype_5numpy_character = 0;
+static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
+
 /* Module declarations from 'pyseobnr.eob.utils.containers' */
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = 0;
 static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = 0;
-
-/* Module declarations from 'pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C' */
-static PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
 static PyTypeObject *__pyx_memoryviewslice_type = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
@@ -2199,248 +2523,391 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-#define __Pyx_MODULE_NAME "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"
-extern int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C;
-int __pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C = 0;
+static __Pyx_TypeInfo __Pyx_TypeInfo___pyx_t_double_complex = { "double complex", NULL, sizeof(__pyx_t_double_complex), { 0 }, 0, 'C', 0, 0 };
+#define __Pyx_MODULE_NAME "pyseobnr.eob.utils.containers"
+extern int __pyx_module_is_main_pyseobnr__eob__utils__containers;
+int __pyx_module_is_main_pyseobnr__eob__utils__containers = 0;
 
-/* Implementation of 'pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C' */
+/* Implementation of 'pyseobnr.eob.utils.containers' */
 static PyObject *__pyx_builtin_TypeError;
+static PyObject *__pyx_builtin_ImportError;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static const char __pyx_k_O[] = "O";
 static const char __pyx_k_c[] = "c";
-static const char __pyx_k_p[] = "p";
-static const char __pyx_k_q[] = "q";
+static const char __pyx_k_a1[] = "a1";
+static const char __pyx_k_a2[] = "a2";
+static const char __pyx_k_dc[] = "dc";
 static const char __pyx_k_id[] = "id";
-static const char __pyx_k_csi[] = "csi";
+static const char __pyx_k_lN[] = "lN";
+static const char __pyx_k_np[] = "np";
 static const char __pyx_k_m_1[] = "m_1";
 static const char __pyx_k_m_2[] = "m_2";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_base[] = "base";
-static const char __pyx_k_call[] = "_call";
 static const char __pyx_k_dict[] = "__dict__";
-static const char __pyx_k_grad[] = "grad";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_ndim[] = "ndim";
 static const char __pyx_k_pack[] = "pack";
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_ASCII[] = "ASCII";
+static const char __pyx_k_H_val[] = "H_val";
 static const char __pyx_k_chi_1[] = "chi_1";
 static const char __pyx_k_chi_2[] = "chi_2";
 static const char __pyx_k_class[] = "__class__";
+static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
+static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_omega[] = "omega";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
+static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_chi1_v[] = "chi1_v";
 static const char __pyx_k_chi2_v[] = "chi2_v";
-static const char __pyx_k_chiL_1[] = "chiL_1";
-static const char __pyx_k_chiL_2[] = "chiL_2";
+static const char __pyx_k_coeffs[] = "coeffs";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
+static const char __pyx_k_aligned[] = "aligned";
+static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_fortran[] = "fortran";
-static const char __pyx_k_hessian[] = "hessian";
 static const char __pyx_k_memview[] = "memview";
+static const char __pyx_k_Dynamics[] = "Dynamics";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
-static const char __pyx_k_dynamics[] = "dynamics";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_EOBParams[] = "EOBParams";
 static const char __pyx_k_TypeError[] = "TypeError";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
+static const char __pyx_k_FluxParams[] = "FluxParams";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
-static const char __pyx_k_aux_derivs[] = "aux_derivs";
+static const char __pyx_k_complex128[] = "complex128";
+static const char __pyx_k_mode_array[] = "mode_array";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
+static const char __pyx_k_CalibCoeffs[] = "CalibCoeffs";
+static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_stringsource[] = "stringsource";
+static const char __pyx_k_update_spins[] = "update_spins";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
+static const char __pyx_k_special_modes[] = "special_modes";
+static const char __pyx_k_PhysicalParams[] = "PhysicalParams";
+static const char __pyx_k_extra_PN_terms[] = "extra_PN_terms";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
+static const char __pyx_k_physical_params[] = "physical_params";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
-static const char __pyx_k_Hamiltonian_v5PHM_C[] = "Hamiltonian_v5PHM_C";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
+static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got %s";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis %d)";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
+static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_kp_s_Buffer_view_does_not_expose_stri;
+static PyObject *__pyx_n_s_CalibCoeffs;
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
+static PyObject *__pyx_n_s_Dynamics;
 static PyObject *__pyx_n_s_EOBParams;
 static PyObject *__pyx_n_s_Ellipsis;
 static PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
-static PyObject *__pyx_n_s_Hamiltonian_v5PHM_C;
+static PyObject *__pyx_n_s_FluxParams;
+static PyObject *__pyx_n_u_H_val;
+static PyObject *__pyx_n_s_ImportError;
 static PyObject *__pyx_kp_s_Incompatible_checksums_0x_x_vs_0;
 static PyObject *__pyx_n_s_IndexError;
 static PyObject *__pyx_kp_s_Indirect_dimensions_not_supporte;
 static PyObject *__pyx_kp_s_Invalid_mode_expected_c_or_fortr;
 static PyObject *__pyx_kp_s_Invalid_shape_in_axis_d_d;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_kp_s_MemoryView_of_r_at_0x_x;
 static PyObject *__pyx_kp_s_MemoryView_of_r_object;
 static PyObject *__pyx_n_b_O;
 static PyObject *__pyx_kp_s_Out_of_bounds_on_buffer_access_a;
+static PyObject *__pyx_n_s_PhysicalParams;
 static PyObject *__pyx_n_s_PickleError;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
+static PyObject *__pyx_n_u_a1;
+static PyObject *__pyx_n_u_a2;
+static PyObject *__pyx_n_s_aligned;
 static PyObject *__pyx_n_s_allocate_buffer;
-static PyObject *__pyx_n_s_aux_derivs;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_u_c;
-static PyObject *__pyx_n_s_call;
-static PyObject *__pyx_n_s_chi1_v;
-static PyObject *__pyx_n_s_chi2_v;
-static PyObject *__pyx_n_s_chiL_1;
-static PyObject *__pyx_n_s_chiL_2;
+static PyObject *__pyx_n_u_chi1_v;
+static PyObject *__pyx_n_u_chi2_v;
 static PyObject *__pyx_n_s_chi_1;
+static PyObject *__pyx_n_u_chi_1;
 static PyObject *__pyx_n_s_chi_2;
+static PyObject *__pyx_n_u_chi_2;
 static PyObject *__pyx_n_s_class;
 static PyObject *__pyx_n_s_cline_in_traceback;
+static PyObject *__pyx_n_s_coeffs;
+static PyObject *__pyx_n_s_complex128;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
-static PyObject *__pyx_n_s_csi;
+static PyObject *__pyx_n_s_dc;
 static PyObject *__pyx_n_s_dict;
+static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_dtype_is_object;
-static PyObject *__pyx_n_s_dynamics;
 static PyObject *__pyx_n_s_encode;
 static PyObject *__pyx_n_s_enumerate;
 static PyObject *__pyx_n_s_error;
+static PyObject *__pyx_n_s_extra_PN_terms;
 static PyObject *__pyx_n_s_flags;
+static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_fortran;
 static PyObject *__pyx_n_u_fortran;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_kp_s_got_differing_extents_in_dimensi;
-static PyObject *__pyx_n_s_grad;
-static PyObject *__pyx_n_s_hessian;
 static PyObject *__pyx_n_s_id;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
-static PyObject *__pyx_n_s_m_1;
-static PyObject *__pyx_n_s_m_2;
+static PyObject *__pyx_n_u_lN;
+static PyObject *__pyx_n_u_m_1;
+static PyObject *__pyx_n_u_m_2;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_memview;
 static PyObject *__pyx_n_s_mode;
+static PyObject *__pyx_n_s_mode_array;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_name_2;
 static PyObject *__pyx_n_s_ndim;
 static PyObject *__pyx_n_s_new;
 static PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
+static PyObject *__pyx_n_s_np;
+static PyObject *__pyx_n_s_numpy;
+static PyObject *__pyx_kp_u_numpy_core_multiarray_failed_to;
+static PyObject *__pyx_kp_u_numpy_core_umath_failed_to_impor;
 static PyObject *__pyx_n_s_obj;
-static PyObject *__pyx_n_s_omega;
-static PyObject *__pyx_n_s_p;
+static PyObject *__pyx_n_u_omega;
 static PyObject *__pyx_n_s_pack;
+static PyObject *__pyx_n_s_physical_params;
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
 static PyObject *__pyx_n_s_pyx_type;
 static PyObject *__pyx_n_s_pyx_unpickle_Enum;
 static PyObject *__pyx_n_s_pyx_vtable;
-static PyObject *__pyx_n_s_q;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_reduce;
 static PyObject *__pyx_n_s_reduce_cython;
 static PyObject *__pyx_n_s_reduce_ex;
 static PyObject *__pyx_n_s_setstate;
 static PyObject *__pyx_n_s_setstate_cython;
 static PyObject *__pyx_n_s_shape;
 static PyObject *__pyx_n_s_size;
+static PyObject *__pyx_n_s_special_modes;
 static PyObject *__pyx_n_s_start;
 static PyObject *__pyx_n_s_step;
 static PyObject *__pyx_n_s_stop;
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_struct;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_unpack;
 static PyObject *__pyx_n_s_update;
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static PyObject *__pyx_n_s_update_spins;
+static PyObject *__pyx_n_s_zeros;
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_dc); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2update_spins(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, double __pyx_v_chi_1, double __pyx_v_chi_2); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_dc); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2__getitem__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_4__setitem__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_x, double __pyx_v_y); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_special_modes, PyObject *__pyx_v_extra_PN_terms); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams___init__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_physical_params, CYTHON_UNUSED PyObject *__pyx_v_coeffs, CYTHON_UNUSED PyObject *__pyx_v_aligned, CYTHON_UNUSED PyObject *__pyx_v_extra_PN_terms, CYTHON_UNUSED PyObject *__pyx_v_mode_array, CYTHON_UNUSED PyObject *__pyx_v_special_modes); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_2__cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_physical_params, CYTHON_UNUSED PyObject *__pyx_v_coeffs, PyObject *__pyx_v_aligned, PyObject *__pyx_v_extra_PN_terms, PyObject *__pyx_v_mode_array, PyObject *__pyx_v_special_modes); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -2475,286 +2942,543 @@
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_PhysicalParams(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_Dynamics(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_FluxParams(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_EOBParams(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
+static PyObject *__pyx_int_2;
+static PyObject *__pyx_int_3;
+static PyObject *__pyx_int_4;
+static PyObject *__pyx_int_5;
 static PyObject *__pyx_int_112105877;
 static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
+static PyObject *__pyx_k__10;
+static PyObject *__pyx_k__11;
+static PyObject *__pyx_k__12;
+static PyObject *__pyx_k__13;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
-static PyObject *__pyx_slice__17;
-static PyObject *__pyx_tuple__10;
-static PyObject *__pyx_tuple__11;
-static PyObject *__pyx_tuple__12;
-static PyObject *__pyx_tuple__13;
+static PyObject *__pyx_slice__32;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
+static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
 static PyObject *__pyx_tuple__25;
 static PyObject *__pyx_tuple__26;
 static PyObject *__pyx_tuple__27;
-static PyObject *__pyx_codeobj__28;
+static PyObject *__pyx_tuple__28;
+static PyObject *__pyx_tuple__29;
+static PyObject *__pyx_tuple__30;
+static PyObject *__pyx_tuple__31;
+static PyObject *__pyx_tuple__33;
+static PyObject *__pyx_tuple__34;
+static PyObject *__pyx_tuple__35;
+static PyObject *__pyx_tuple__36;
+static PyObject *__pyx_tuple__37;
+static PyObject *__pyx_tuple__38;
+static PyObject *__pyx_tuple__39;
+static PyObject *__pyx_tuple__40;
+static PyObject *__pyx_tuple__41;
+static PyObject *__pyx_tuple__42;
+static PyObject *__pyx_tuple__43;
+static PyObject *__pyx_tuple__44;
+static PyObject *__pyx_tuple__45;
+static PyObject *__pyx_tuple__46;
+static PyObject *__pyx_tuple__47;
+static PyObject *__pyx_tuple__48;
+static PyObject *__pyx_tuple__49;
+static PyObject *__pyx_codeobj__50;
 /* Late includes */
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":5
- * 
- * cdef class Hamiltonian_v5PHM_C:
- *     def __cinit__(self,EOBParams):             # <<<<<<<<<<<<<<
- *         pass
- * 
+/* "pyseobnr/eob/utils/containers.pyx":9
+ *     @cython.cdivision(True)
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,dict dc):             # <<<<<<<<<<<<<<
+ *         self.m_1 = dc["m_1"]
+ *         self.m_2 = dc["m_2"]
  */
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  CYTHON_UNUSED PyObject *__pyx_v_EOBParams = 0;
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_dc = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_EOBParams,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dc,0};
     PyObject* values[1] = {0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_EOBParams)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dc)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 5, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 9, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
-    __pyx_v_EOBParams = values[0];
+    __pyx_v_dc = ((PyObject*)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 5, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 9, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_EOBParams);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dc), (&PyDict_Type), 1, "dc", 1))) __PYX_ERR(1, 9, __pyx_L1_error)
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams___cinit__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), __pyx_v_dc);
 
   /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = -1;
+  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C___cinit__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_EOBParams) {
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_dc) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  double __pyx_t_2;
+  __Pyx_memviewslice __pyx_t_3 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
+  /* "pyseobnr/eob/utils/containers.pyx":10
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,dict dc):
+ *         self.m_1 = dc["m_1"]             # <<<<<<<<<<<<<<
+ *         self.m_2 = dc["m_2"]
+ *         self.M = self.m_1+self.m_2
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 10, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_m_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 10, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->m_1 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":11
+ *     def __cinit__(self,dict dc):
+ *         self.m_1 = dc["m_1"]
+ *         self.m_2 = dc["m_2"]             # <<<<<<<<<<<<<<
+ *         self.M = self.m_1+self.m_2
+ *         self.nu = self.m_1*self.m_2/(self.M)**2
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 11, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_m_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->m_2 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":12
+ *         self.m_1 = dc["m_1"]
+ *         self.m_2 = dc["m_2"]
+ *         self.M = self.m_1+self.m_2             # <<<<<<<<<<<<<<
+ *         self.nu = self.m_1*self.m_2/(self.M)**2
+ *         self.X_1 = self.m_1/self.M
+ */
+  __pyx_v_self->M = (__pyx_v_self->m_1 + __pyx_v_self->m_2);
+
+  /* "pyseobnr/eob/utils/containers.pyx":13
+ *         self.m_2 = dc["m_2"]
+ *         self.M = self.m_1+self.m_2
+ *         self.nu = self.m_1*self.m_2/(self.M)**2             # <<<<<<<<<<<<<<
+ *         self.X_1 = self.m_1/self.M
+ *         self.X_2 = self.m_2/self.M
+ */
+  __pyx_v_self->nu = ((__pyx_v_self->m_1 * __pyx_v_self->m_2) / pow(__pyx_v_self->M, 2.0));
+
+  /* "pyseobnr/eob/utils/containers.pyx":14
+ *         self.M = self.m_1+self.m_2
+ *         self.nu = self.m_1*self.m_2/(self.M)**2
+ *         self.X_1 = self.m_1/self.M             # <<<<<<<<<<<<<<
+ *         self.X_2 = self.m_2/self.M
+ *         self.delta = self.m_1 - self.m_2
+ */
+  __pyx_v_self->X_1 = (__pyx_v_self->m_1 / __pyx_v_self->M);
+
+  /* "pyseobnr/eob/utils/containers.pyx":15
+ *         self.nu = self.m_1*self.m_2/(self.M)**2
+ *         self.X_1 = self.m_1/self.M
+ *         self.X_2 = self.m_2/self.M             # <<<<<<<<<<<<<<
+ *         self.delta = self.m_1 - self.m_2
+ *         self.a1 =  dc["a1"]
+ */
+  __pyx_v_self->X_2 = (__pyx_v_self->m_2 / __pyx_v_self->M);
+
+  /* "pyseobnr/eob/utils/containers.pyx":16
+ *         self.X_1 = self.m_1/self.M
+ *         self.X_2 = self.m_2/self.M
+ *         self.delta = self.m_1 - self.m_2             # <<<<<<<<<<<<<<
+ *         self.a1 =  dc["a1"]
+ *         self.a2 =  dc["a2"]
+ */
+  __pyx_v_self->delta = (__pyx_v_self->m_1 - __pyx_v_self->m_2);
+
+  /* "pyseobnr/eob/utils/containers.pyx":17
+ *         self.X_2 = self.m_2/self.M
+ *         self.delta = self.m_1 - self.m_2
+ *         self.a1 =  dc["a1"]             # <<<<<<<<<<<<<<
+ *         self.a2 =  dc["a2"]
+ *         self.chi_1 = dc["chi_1"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 17, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_a1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->a1 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":18
+ *         self.delta = self.m_1 - self.m_2
+ *         self.a1 =  dc["a1"]
+ *         self.a2 =  dc["a2"]             # <<<<<<<<<<<<<<
+ *         self.chi_1 = dc["chi_1"]
+ *         self.chi_2 = dc["chi_2"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 18, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_a2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 18, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 18, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->a2 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":19
+ *         self.a1 =  dc["a1"]
+ *         self.a2 =  dc["a2"]
+ *         self.chi_1 = dc["chi_1"]             # <<<<<<<<<<<<<<
+ *         self.chi_2 = dc["chi_2"]
+ *         self.chi1_v = dc["chi1_v"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 19, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_chi_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->chi_1 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":20
+ *         self.a2 =  dc["a2"]
+ *         self.chi_1 = dc["chi_1"]
+ *         self.chi_2 = dc["chi_2"]             # <<<<<<<<<<<<<<
+ *         self.chi1_v = dc["chi1_v"]
+ *         self.chi2_v = dc["chi2_v"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 20, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_chi_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 20, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 20, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->chi_2 = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":21
+ *         self.chi_1 = dc["chi_1"]
+ *         self.chi_2 = dc["chi_2"]
+ *         self.chi1_v = dc["chi1_v"]             # <<<<<<<<<<<<<<
+ *         self.chi2_v = dc["chi2_v"]
+ *         self.lN = dc["lN"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 21, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_chi1_v); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 21, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->chi1_v, 0);
+  __pyx_v_self->chi1_v = __pyx_t_3;
+  __pyx_t_3.memview = NULL;
+  __pyx_t_3.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":22
+ *         self.chi_2 = dc["chi_2"]
+ *         self.chi1_v = dc["chi1_v"]
+ *         self.chi2_v = dc["chi2_v"]             # <<<<<<<<<<<<<<
+ *         self.lN = dc["lN"]
+ *         self.omega = dc["omega"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 22, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_chi2_v); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 22, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 22, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->chi2_v, 0);
+  __pyx_v_self->chi2_v = __pyx_t_3;
+  __pyx_t_3.memview = NULL;
+  __pyx_t_3.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":23
+ *         self.chi1_v = dc["chi1_v"]
+ *         self.chi2_v = dc["chi2_v"]
+ *         self.lN = dc["lN"]             # <<<<<<<<<<<<<<
+ *         self.omega = dc["omega"]
+ *         self.omega_circ = dc["omega"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 23, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_lN); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 23, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 23, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->lN, 0);
+  __pyx_v_self->lN = __pyx_t_3;
+  __pyx_t_3.memview = NULL;
+  __pyx_t_3.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":24
+ *         self.chi2_v = dc["chi2_v"]
+ *         self.lN = dc["lN"]
+ *         self.omega = dc["omega"]             # <<<<<<<<<<<<<<
+ *         self.omega_circ = dc["omega"]
+ *         self.H_val = dc["H_val"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 24, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 24, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 24, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->omega = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":25
+ *         self.lN = dc["lN"]
+ *         self.omega = dc["omega"]
+ *         self.omega_circ = dc["omega"]             # <<<<<<<<<<<<<<
+ *         self.H_val = dc["H_val"]
+ *         #self.omega_start = dc["omega_start"]
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 25, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 25, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 25, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->omega_circ = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":26
+ *         self.omega = dc["omega"]
+ *         self.omega_circ = dc["omega"]
+ *         self.H_val = dc["H_val"]             # <<<<<<<<<<<<<<
+ *         #self.omega_start = dc["omega_start"]
+ *         self._compute_derived_quants()
+ */
+  if (unlikely(__pyx_v_dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 26, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_dc, __pyx_n_u_H_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 26, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 26, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->H_val = __pyx_t_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":28
+ *         self.H_val = dc["H_val"]
+ *         #self.omega_start = dc["omega_start"]
+ *         self._compute_derived_quants()             # <<<<<<<<<<<<<<
+ * 
+ *     cpdef update_spins(self,double chi_1,double chi_2):
+ */
+  __pyx_t_1 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self->__pyx_vtab)->_compute_derived_quants(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 28, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":9
+ *     @cython.cdivision(True)
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,dict dc):             # <<<<<<<<<<<<<<
+ *         self.m_1 = dc["m_1"]
+ *         self.m_2 = dc["m_2"]
+ */
+
   /* function exit code */
   __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_3, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":9
+/* "pyseobnr/eob/utils/containers.pyx":30
+ *         self._compute_derived_quants()
  * 
- * 
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+ *     cpdef update_spins(self,double chi_1,double chi_2):             # <<<<<<<<<<<<<<
+ *         """
+ *         Update the aligned spins and the derived quantities
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3update_spins(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_update_spins(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, double __pyx_v_chi_1, double __pyx_v_chi_2, int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
+  int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("_call", 0);
+  __Pyx_RefNannySetupContext("update_spins", 0);
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_call); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_update_spins); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 30, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call)) {
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3update_spins)) {
         __Pyx_XDECREF(__pyx_r);
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 30, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 9, __pyx_L1_error)
+        __pyx_t_4 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 30, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 9, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
+        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
+        __pyx_t_7 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
+          if (likely(__pyx_t_6)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+            __Pyx_INCREF(__pyx_t_6);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
+            __Pyx_DECREF_SET(__pyx_t_5, function);
+            __pyx_t_7 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
+        if (PyFunction_Check(__pyx_t_5)) {
+          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 30, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 30, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 9, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
+          __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 30, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_8);
+          if (__pyx_t_6) {
+            __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
+          PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 9, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 30, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -2765,1715 +3489,5489 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":10
+  /* "pyseobnr/eob/utils/containers.pyx":34
+ *         Update the aligned spins and the derived quantities
+ *         """
+ *         self.chi_1 = chi_1             # <<<<<<<<<<<<<<
+ *         self.chi_2 = chi_2
+ *         self._compute_derived_quants()
+ */
+  __pyx_v_self->chi_1 = __pyx_v_chi_1;
+
+  /* "pyseobnr/eob/utils/containers.pyx":35
+ *         """
+ *         self.chi_1 = chi_1
+ *         self.chi_2 = chi_2             # <<<<<<<<<<<<<<
+ *         self._compute_derived_quants()
  * 
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
+ */
+  __pyx_v_self->chi_2 = __pyx_v_chi_2;
+
+  /* "pyseobnr/eob/utils/containers.pyx":36
+ *         self.chi_1 = chi_1
+ *         self.chi_2 = chi_2
+ *         self._compute_derived_quants()             # <<<<<<<<<<<<<<
+ * 
+ *     @cython.cdivision(True)
+ */
+  __pyx_t_1 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self->__pyx_vtab)->_compute_derived_quants(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 36, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":30
+ *         self._compute_derived_quants()
+ * 
+ *     cpdef update_spins(self,double chi_1,double chi_2):             # <<<<<<<<<<<<<<
+ *         """
+ *         Update the aligned spins and the derived quantities
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.update_spins", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":9
- * 
- * 
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- */
-
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3update_spins(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2update_spins[] = "\n        Update the aligned spins and the derived quantities\n        ";
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3update_spins(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   double __pyx_v_chi_1;
   double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_call (wrapper)", 0);
+  __Pyx_RefNannySetupContext("update_spins (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,0};
+    PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
-        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-        CYTHON_FALLTHROUGH;
-        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 1); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 2); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 3); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 4); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 5); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 6); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 7); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 8); __PYX_ERR(1, 9, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, 9); __PYX_ERR(1, 9, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_spins", 1, 2, 2, 1); __PYX_ERR(1, 30, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_call") < 0)) __PYX_ERR(1, 9, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_spins") < 0)) __PYX_ERR(1, 30, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 9, __pyx_L3_error)
+    }
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 30, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 30, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_call", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 9, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update_spins", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 30, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.update_spins", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2update_spins(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), __pyx_v_chi_1, __pyx_v_chi_2);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_2_call(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2update_spins(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, double __pyx_v_chi_1, double __pyx_v_chi_2) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("_call", 0);
+  __Pyx_RefNannySetupContext("update_spins", 0);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 9, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 9, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 9, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 9, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_update_spins(__pyx_v_self, __pyx_v_chi_1, __pyx_v_chi_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C._call", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.update_spins", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":11
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* "pyseobnr/eob/utils/containers.pyx":39
+ * 
+ *     @cython.cdivision(True)
+ *     cdef _compute_derived_quants(self):             # <<<<<<<<<<<<<<
+ *         """
+ *         Compute auxiliary spin quantities
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
+static PyObject *__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams__compute_derived_quants(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("_compute_derived_quants", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":44
+ *         """
+ *         # Symmetric and anti-symmetric spins
+ *         self.chi_S = (self.chi_1+self.chi_2)/2             # <<<<<<<<<<<<<<
+ *         self.chi_A = (self.chi_1-self.chi_2)/2
+ *         # Test-particle spin
+ */
+  __pyx_v_self->chi_S = ((__pyx_v_self->chi_1 + __pyx_v_self->chi_2) / 2.0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":45
+ *         # Symmetric and anti-symmetric spins
+ *         self.chi_S = (self.chi_1+self.chi_2)/2
+ *         self.chi_A = (self.chi_1-self.chi_2)/2             # <<<<<<<<<<<<<<
+ *         # Test-particle spin
+ *         self.a = (1 - 2 * self.nu) * self.chi_S + (self.m_1 - self.m_2) / (
+ */
+  __pyx_v_self->chi_A = ((__pyx_v_self->chi_1 - __pyx_v_self->chi_2) / 2.0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":47
+ *         self.chi_A = (self.chi_1-self.chi_2)/2
+ *         # Test-particle spin
+ *         self.a = (1 - 2 * self.nu) * self.chi_S + (self.m_1 - self.m_2) / (             # <<<<<<<<<<<<<<
+ *             self.m_1 + self.m_2) * self.chi_A
+ *         # a_{+,-}
+ */
+  __pyx_v_self->a = (((1.0 - (2.0 * __pyx_v_self->nu)) * __pyx_v_self->chi_S) + (((__pyx_v_self->m_1 - __pyx_v_self->m_2) / (__pyx_v_self->m_1 + __pyx_v_self->m_2)) * __pyx_v_self->chi_A));
+
+  /* "pyseobnr/eob/utils/containers.pyx":50
+ *             self.m_1 + self.m_2) * self.chi_A
+ *         # a_{+,-}
+ *         self.ap = self.X_1*self.chi_1+self.X_2*self.chi_2             # <<<<<<<<<<<<<<
+ *         self.am = self.X_1*self.chi_1-self.X_2*self.chi_2
+ * 
+ */
+  __pyx_v_self->ap = ((__pyx_v_self->X_1 * __pyx_v_self->chi_1) + (__pyx_v_self->X_2 * __pyx_v_self->chi_2));
+
+  /* "pyseobnr/eob/utils/containers.pyx":51
+ *         # a_{+,-}
+ *         self.ap = self.X_1*self.chi_1+self.X_2*self.chi_2
+ *         self.am = self.X_1*self.chi_1-self.X_2*self.chi_2             # <<<<<<<<<<<<<<
+ * 
+ * cdef class CalibCoeffs():
+ */
+  __pyx_v_self->am = ((__pyx_v_self->X_1 * __pyx_v_self->chi_1) - (__pyx_v_self->X_2 * __pyx_v_self->chi_2));
+
+  /* "pyseobnr/eob/utils/containers.pyx":39
+ * 
+ *     @cython.cdivision(True)
+ *     cdef _compute_derived_quants(self):             # <<<<<<<<<<<<<<
+ *         """
+ *         Compute auxiliary spin quantities
+ */
+
+  /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":9
+ * 
+ * cdef class PhysicalParams:
+ *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am             # <<<<<<<<<<<<<<
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val
+ *     cdef public double[:] chi1_v
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("grad", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_grad); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad)) {
-        __Pyx_XDECREF(__pyx_r);
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 11, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 11, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_r = __pyx_t_2;
-        __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
-  }
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->m_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":12
- *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.m_1.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->m_1 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.m_1.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->m_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.m_2.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->m_2 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.m_2.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->nu); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.nu.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->nu = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.nu.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->M); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.M.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->M = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.M.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->X_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.X_1.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->X_1 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.X_1.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->X_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.X_2.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->X_2 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.X_2.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->delta); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.delta.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->delta = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.delta.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_1.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->chi_1 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_1.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_2.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->chi_2 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_2.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi_S); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_S.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->chi_S = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_S.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi_A); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_A.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->chi_A = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi_A.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->a); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->a = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ap); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.ap.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->ap = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.ap.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->am); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.am.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_v_self->am = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.am.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":10
+ * cdef class PhysicalParams:
+ *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val             # <<<<<<<<<<<<<<
+ *     cdef public double[:] chi1_v
+ *     cdef public double[:] chi2_v
  */
 
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
   /* function exit code */
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi1_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
+
+  /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi1_L.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 10, __pyx_L1_error)
+  __pyx_v_self->chi1_L = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi1_L.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->chi2_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi2_L.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 10, __pyx_L1_error)
+  __pyx_v_self->chi2_L = __pyx_t_1;
+
+  /* function exit code */
   __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi2_L.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->a1); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a1.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":11
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 10, __pyx_L1_error)
+  __pyx_v_self->a1 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a1.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->a2); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a2.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 10, __pyx_L1_error)
+  __pyx_v_self->a2 = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.a2.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->H_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 10, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.H_val.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 10, __pyx_L1_error)
+  __pyx_v_self->H_val = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.H_val.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":11
+ *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val
+ *     cdef public double[:] chi1_v             # <<<<<<<<<<<<<<
+ *     cdef public double[:] chi2_v
+ *     cdef public double[:] lN
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->chi1_v.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 11, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 11, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi1_v.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 11, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->chi1_v, 0);
+  __pyx_v_self->chi1_v = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi1_v.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":12
+ *     cdef public double chi1_L, chi2_L,a1,a2, H_val
+ *     cdef public double[:] chi1_v
+ *     cdef public double[:] chi2_v             # <<<<<<<<<<<<<<
+ *     cdef public double[:] lN
+ *     cdef public double omega,omega_circ #,omega_start
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->chi2_v.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 12, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 12, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi2_v.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 12, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->chi2_v, 0);
+  __pyx_v_self->chi2_v = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.chi2_v.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":13
+ *     cdef public double[:] chi1_v
+ *     cdef public double[:] chi2_v
+ *     cdef public double[:] lN             # <<<<<<<<<<<<<<
+ *     cdef public double omega,omega_circ #,omega_start
+ *     cpdef update_spins(self,double chi_1,double chi_2)
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->lN.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 13, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->lN, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 13, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.lN.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 13, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->lN, 0);
+  __pyx_v_self->lN = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.lN.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":14
+ *     cdef public double[:] chi2_v
+ *     cdef public double[:] lN
+ *     cdef public double omega,omega_circ #,omega_start             # <<<<<<<<<<<<<<
+ *     cpdef update_spins(self,double chi_1,double chi_2)
+ *     cdef _compute_derived_quants(self)
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 14, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.omega.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 14, __pyx_L1_error)
+  __pyx_v_self->omega = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.omega.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->omega_circ); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 14, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.omega_circ.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  double __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(2, 14, __pyx_L1_error)
+  __pyx_v_self->omega_circ = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.omega_circ.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_4__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 2, __pyx_L1_error)
+
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_7__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_7__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("grad (wrapper)", 0);
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 4, __pyx_L1_error)
+
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.PhysicalParams.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pyx":54
+ * 
+ * cdef class CalibCoeffs():
+ *     def __cinit__(self,dc):             # <<<<<<<<<<<<<<
+ *         self.dc = dc
+ * 
+ */
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_dc = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dc,0};
+    PyObject* values[1] = {0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
-        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-        CYTHON_FALLTHROUGH;
-        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dc)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 1); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 2); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 3); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 4); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 5); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 6); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 7); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 8); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, 9); __PYX_ERR(1, 11, __pyx_L3_error)
-        }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "grad") < 0)) __PYX_ERR(1, 11, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 54, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 11, __pyx_L3_error)
+    }
+    __pyx_v_dc = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("grad", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 11, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 54, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
-  return NULL;
+  return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs___cinit__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self), __pyx_v_dc);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_dc) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":55
+ * cdef class CalibCoeffs():
+ *     def __cinit__(self,dc):
+ *         self.dc = dc             # <<<<<<<<<<<<<<
+ * 
+ *     def __getitem__(self,str x):
+ */
+  if (!(likely(PyDict_CheckExact(__pyx_v_dc))||((__pyx_v_dc) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_v_dc)->tp_name), 0))) __PYX_ERR(1, 55, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_dc;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->dc);
+  __Pyx_DECREF(__pyx_v_self->dc);
+  __pyx_v_self->dc = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":54
+ * 
+ * cdef class CalibCoeffs():
+ *     def __cinit__(self,dc):             # <<<<<<<<<<<<<<
+ *         self.dc = dc
+ * 
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pyx":57
+ *         self.dc = dc
+ * 
+ *     def __getitem__(self,str x):             # <<<<<<<<<<<<<<
+ *         return self.dc[x]
+ *     def __setitem__(self,str x,double y):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_3__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_3__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__getitem__ (wrapper)", 0);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_x), (&PyUnicode_Type), 1, "x", 1))) __PYX_ERR(1, 57, __pyx_L1_error)
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2__getitem__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self), ((PyObject*)__pyx_v_x));
 
   /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = NULL;
+  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_4grad(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2__getitem__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_x) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("grad", 0);
+  __Pyx_RefNannySetupContext("__getitem__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":58
+ * 
+ *     def __getitem__(self,str x):
+ *         return self.dc[x]             # <<<<<<<<<<<<<<
+ *     def __setitem__(self,str x,double y):
+ *         self.dc[x] = y
+ */
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 11, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 11, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 11, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
+  if (unlikely(__pyx_v_self->dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 58, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_self->dc, __pyx_v_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
+  /* "pyseobnr/eob/utils/containers.pyx":57
+ *         self.dc = dc
+ * 
+ *     def __getitem__(self,str x):             # <<<<<<<<<<<<<<
+ *         return self.dc[x]
+ *     def __setitem__(self,str x,double y):
+ */
+
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.grad", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":13
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* "pyseobnr/eob/utils/containers.pyx":59
+ *     def __getitem__(self,str x):
+ *         return self.dc[x]
+ *     def __setitem__(self,str x,double y):             # <<<<<<<<<<<<<<
+ *         self.dc[x] = y
+ * 
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
-  PyObject *__pyx_r = NULL;
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_5__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_arg_y); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_5__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_arg_y) {
+  double __pyx_v_y;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__setitem__ (wrapper)", 0);
+  assert(__pyx_arg_y); {
+    __pyx_v_y = __pyx_PyFloat_AsDouble(__pyx_arg_y); if (unlikely((__pyx_v_y == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 59, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_x), (&PyUnicode_Type), 1, "x", 1))) __PYX_ERR(1, 59, __pyx_L1_error)
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_4__setitem__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self), ((PyObject*)__pyx_v_x), ((double)__pyx_v_y));
+
+  /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_4__setitem__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_x, double __pyx_v_y) {
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("hessian", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_hessian); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian)) {
-        __Pyx_XDECREF(__pyx_r);
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 13, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 13, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_r = __pyx_t_2;
-        __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
+  __Pyx_RefNannySetupContext("__setitem__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":60
+ *         return self.dc[x]
+ *     def __setitem__(self,str x,double y):
+ *         self.dc[x] = y             # <<<<<<<<<<<<<<
+ * 
+ * cdef class FluxParams:
+ */
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 60, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (unlikely(__pyx_v_self->dc == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
+    __PYX_ERR(1, 60, __pyx_L1_error)
   }
+  if (unlikely(PyDict_SetItem(__pyx_v_self->dc, __pyx_v_x, __pyx_t_1) < 0)) __PYX_ERR(1, 60, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":14
- *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
+  /* "pyseobnr/eob/utils/containers.pyx":59
+ *     def __getitem__(self,str x):
+ *         return self.dc[x]
+ *     def __setitem__(self,str x,double y):             # <<<<<<<<<<<<<<
+ *         self.dc[x] = y
+ * 
  */
 
   /* function exit code */
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = 0;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":24
+ * '''
+ * cdef class CalibCoeffs:
+ *     cdef public dict dc             # <<<<<<<<<<<<<<
+ * 
+ * cdef class Dynamics:
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_self->dc);
+  __pyx_r = __pyx_v_self->dc;
+  goto __pyx_L0;
+
+  /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":13
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(PyDict_CheckExact(__pyx_v_value))||((__pyx_v_value) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_v_value)->tp_name), 0))) __PYX_ERR(2, 24, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->dc);
+  __Pyx_DECREF(__pyx_v_self->dc);
+  __pyx_v_self->dc = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.dc.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->dc);
+  __Pyx_DECREF(__pyx_v_self->dc);
+  __pyx_v_self->dc = ((PyObject*)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_7__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_7__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_6__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 2, __pyx_L1_error)
+
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_9__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_9__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("hessian (wrapper)", 0);
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_8__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 4, __pyx_L1_error)
+
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.CalibCoeffs.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pyx":64
+ * cdef class FluxParams:
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,special_modes,extra_PN_terms):             # <<<<<<<<<<<<<<
+ *         self.Tlm = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_special_modes = 0;
+  PyObject *__pyx_v_extra_PN_terms = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_special_modes,&__pyx_n_s_extra_PN_terms,0};
+    PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
-        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-        CYTHON_FALLTHROUGH;
-        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_special_modes)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_extra_PN_terms)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 1); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 2); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 3); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 4); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 5); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 6); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 7); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 8); __PYX_ERR(1, 13, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, 9); __PYX_ERR(1, 13, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, 1); __PYX_ERR(1, 64, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hessian") < 0)) __PYX_ERR(1, 13, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 64, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 13, __pyx_L3_error)
+    }
+    __pyx_v_special_modes = values[0];
+    __pyx_v_extra_PN_terms = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("hessian", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 13, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 64, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams___cinit__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), __pyx_v_special_modes, __pyx_v_extra_PN_terms);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_special_modes, PyObject *__pyx_v_extra_PN_terms) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  __Pyx_memviewslice __pyx_t_6 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_7 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_10;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":65
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,special_modes,extra_PN_terms):
+ *         self.Tlm = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.rho_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
+  __pyx_t_1 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 65, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tlm, 0);
+  __pyx_v_self->Tlm = __pyx_t_6;
+  __pyx_t_6.memview = NULL;
+  __pyx_t_6.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":66
+ *     def __cinit__(self,special_modes,extra_PN_terms):
+ *         self.Tlm = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.rho_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
+  __pyx_t_5 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 66, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rho_coeffs, 0);
+  __pyx_v_self->rho_coeffs = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":67
+ *         self.Tlm = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.rho_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.f_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4);
+  __pyx_t_5 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 67, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rho_coeffs_log, 0);
+  __pyx_v_self->rho_coeffs_log = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":68
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.rho_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.f_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_1);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 68, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->f_coeffs, 0);
+  __pyx_v_self->f_coeffs = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":69
+ *         self.rho_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.delta_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
+  __pyx_t_5 = 0;
+  __pyx_t_1 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_complex128); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 69, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->f_coeffs_vh, 0);
+  __pyx_v_self->f_coeffs_vh = __pyx_t_8;
+  __pyx_t_8.memview = NULL;
+  __pyx_t_8.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":70
+ *         self.f_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.f_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.delta_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.rholm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
+  __pyx_t_5 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_complex128); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 70, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->delta_coeffs, 0);
+  __pyx_v_self->delta_coeffs = __pyx_t_8;
+  __pyx_t_8.memview = NULL;
+  __pyx_t_8.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":71
+ *         self.f_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.rholm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.deltalm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4);
+  __pyx_t_5 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_complex128); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->delta_coeffs_vh, 0);
+  __pyx_v_self->delta_coeffs_vh = __pyx_t_8;
+  __pyx_t_8.memview = NULL;
+  __pyx_t_8.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":72
+ *         self.delta_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.delta_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.rholm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.deltalm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_complex128); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(1, 72, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rholm, 0);
+  __pyx_v_self->rholm = __pyx_t_9;
+  __pyx_t_9.memview = NULL;
+  __pyx_t_9.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":73
+ *         self.delta_coeffs_vh = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.complex128)
+ *         self.rholm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.deltalm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.prefixes = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes_abs = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_complex128); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(1, 73, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->deltalm, 0);
+  __pyx_v_self->deltalm = __pyx_t_9;
+  __pyx_t_9.memview = NULL;
+  __pyx_t_9.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":74
+ *         self.rholm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.deltalm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         self.prefixes_abs = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.nqc_coeffs = np.zeros((ell_max+1,ell_max+1,3),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_complex128); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(1, 74, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->prefixes, 0);
+  __pyx_v_self->prefixes = __pyx_t_9;
+  __pyx_t_9.memview = NULL;
+  __pyx_t_9.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":75
+ *         self.deltalm = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes_abs = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.nqc_coeffs = np.zeros((ell_max+1,ell_max+1,3),dtype=np.float64)
+ *         self.extra_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 75, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->prefixes_abs, 0);
+  __pyx_v_self->prefixes_abs = __pyx_t_6;
+  __pyx_t_6.memview = NULL;
+  __pyx_t_6.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":76
+ *         self.prefixes = np.zeros((ell_max+1,ell_max+1),dtype=np.complex128)
+ *         self.prefixes_abs = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.nqc_coeffs = np.zeros((ell_max+1,ell_max+1,3),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.extra_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.extra_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
+  __Pyx_INCREF(__pyx_int_3);
+  __Pyx_GIVEREF(__pyx_int_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_3);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 76, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->nqc_coeffs, 0);
+  __pyx_v_self->nqc_coeffs = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":77
+ *         self.prefixes_abs = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.nqc_coeffs = np.zeros((ell_max+1,ell_max+1,3),dtype=np.float64)
+ *         self.extra_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.extra_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.special_modes = special_modes
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
+  __pyx_t_2 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->extra_coeffs, 0);
+  __pyx_v_self->extra_coeffs = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":78
+ *         self.nqc_coeffs = np.zeros((ell_max+1,ell_max+1,3),dtype=np.float64)
+ *         self.extra_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.extra_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)             # <<<<<<<<<<<<<<
+ *         self.special_modes = special_modes
+ *         self.extra_PN_terms = extra_PN_terms
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyInt_From_int(PN_limit); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_1);
+  __pyx_t_2 = 0;
+  __pyx_t_3 = 0;
+  __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 78, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->extra_coeffs_log, 0);
+  __pyx_v_self->extra_coeffs_log = __pyx_t_7;
+  __pyx_t_7.memview = NULL;
+  __pyx_t_7.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":79
+ *         self.extra_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.extra_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.special_modes = special_modes             # <<<<<<<<<<<<<<
+ *         self.extra_PN_terms = extra_PN_terms
+ * 
+ */
+  if (!(likely(PyList_CheckExact(__pyx_v_special_modes))||((__pyx_v_special_modes) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_special_modes)->tp_name), 0))) __PYX_ERR(1, 79, __pyx_L1_error)
+  __pyx_t_2 = __pyx_v_special_modes;
+  __Pyx_INCREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->special_modes);
+  __Pyx_DECREF(__pyx_v_self->special_modes);
+  __pyx_v_self->special_modes = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":80
+ *         self.extra_coeffs_log = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ *         self.special_modes = special_modes
+ *         self.extra_PN_terms = extra_PN_terms             # <<<<<<<<<<<<<<
+ * 
+ * cdef class Dynamics:
+ */
+  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_v_extra_PN_terms); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 80, __pyx_L1_error)
+  __pyx_v_self->extra_PN_terms = __pyx_t_10;
+
+  /* "pyseobnr/eob/utils/containers.pyx":64
+ * cdef class FluxParams:
+ *     @cython.embedsignature(True)
+ *     def __cinit__(self,special_modes,extra_PN_terms):             # <<<<<<<<<<<<<<
+ *         self.Tlm = np.zeros((ell_max+1,ell_max+1),dtype=np.float64)
+ *         self.rho_coeffs = np.zeros((ell_max+1,ell_max+1,PN_limit),dtype=np.float64)
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":31
+ * cdef class FluxParams:
+ *     # Coefficients entering the amplitude residual
+ *     cdef public double[:,:,:] rho_coeffs             # <<<<<<<<<<<<<<
+ *     cdef public double[:,:,:] rho_coeffs_log
+ *     cdef public double[:,:,:] f_coeffs
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->rho_coeffs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 31, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->rho_coeffs, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 31, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_coeffs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 31, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rho_coeffs, 0);
+  __pyx_v_self->rho_coeffs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":32
+ *     # Coefficients entering the amplitude residual
+ *     cdef public double[:,:,:] rho_coeffs
+ *     cdef public double[:,:,:] rho_coeffs_log             # <<<<<<<<<<<<<<
+ *     cdef public double[:,:,:] f_coeffs
+ *     # Notice that f_coeffs_vh are allowed to be complex
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->rho_coeffs_log.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 32, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->rho_coeffs_log, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 32, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_coeffs_log.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 32, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rho_coeffs_log, 0);
+  __pyx_v_self->rho_coeffs_log = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_coeffs_log.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":33
+ *     cdef public double[:,:,:] rho_coeffs
+ *     cdef public double[:,:,:] rho_coeffs_log
+ *     cdef public double[:,:,:] f_coeffs             # <<<<<<<<<<<<<<
+ *     # Notice that f_coeffs_vh are allowed to be complex
+ *     cdef public double complex[:,:,:] f_coeffs_vh
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->f_coeffs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 33, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->f_coeffs, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 33, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.f_coeffs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 33, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->f_coeffs, 0);
+  __pyx_v_self->f_coeffs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.f_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":35
+ *     cdef public double[:,:,:] f_coeffs
+ *     # Notice that f_coeffs_vh are allowed to be complex
+ *     cdef public double complex[:,:,:] f_coeffs_vh             # <<<<<<<<<<<<<<
+ * 
+ *     # Coefficients entering the phase residual
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->f_coeffs_vh.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 35, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->f_coeffs_vh, 3, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 35, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.f_coeffs_vh.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 35, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->f_coeffs_vh, 0);
+  __pyx_v_self->f_coeffs_vh = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.f_coeffs_vh.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":38
+ * 
+ *     # Coefficients entering the phase residual
+ *     cdef public double complex[:,:,:] delta_coeffs             # <<<<<<<<<<<<<<
+ *     cdef public double complex[:,:,:] delta_coeffs_vh
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->delta_coeffs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 38, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->delta_coeffs, 3, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 38, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.delta_coeffs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 38, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->delta_coeffs, 0);
+  __pyx_v_self->delta_coeffs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.delta_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":39
+ *     # Coefficients entering the phase residual
+ *     cdef public double complex[:,:,:] delta_coeffs
+ *     cdef public double complex[:,:,:] delta_coeffs_vh             # <<<<<<<<<<<<<<
+ * 
+ *     # Newtonian prefixes
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->delta_coeffs_vh.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 39, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->delta_coeffs_vh, 3, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 39, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.delta_coeffs_vh.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 39, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->delta_coeffs_vh, 0);
+  __pyx_v_self->delta_coeffs_vh = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.delta_coeffs_vh.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":43
+ *     # Newtonian prefixes
+ *     # For waveform (complex)
+ *     cdef public double complex[:,:] prefixes             # <<<<<<<<<<<<<<
+ *     # For flux (real)
+ *     cdef public double[:,:] prefixes_abs
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->prefixes.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 43, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->prefixes, 2, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 43, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.prefixes.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 43, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->prefixes, 0);
+  __pyx_v_self->prefixes = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.prefixes.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":45
+ *     cdef public double complex[:,:] prefixes
+ *     # For flux (real)
+ *     cdef public double[:,:] prefixes_abs             # <<<<<<<<<<<<<<
+ * 
+ *     # These will hold the *results* of computing various pieces
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->prefixes_abs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 45, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->prefixes_abs, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 45, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.prefixes_abs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 45, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->prefixes_abs, 0);
+  __pyx_v_self->prefixes_abs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.prefixes_abs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":49
+ *     # These will hold the *results* of computing various pieces
+ *     # of the waveform
+ *     cdef public double[:,:] Tlm             # <<<<<<<<<<<<<<
+ *     cdef public double complex[:,:] rholm
+ *     cdef public double complex[:,:] deltalm
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->Tlm.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 49, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->Tlm, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.Tlm.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 49, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tlm, 0);
+  __pyx_v_self->Tlm = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.Tlm.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":50
+ *     # of the waveform
+ *     cdef public double[:,:] Tlm
+ *     cdef public double complex[:,:] rholm             # <<<<<<<<<<<<<<
+ *     cdef public double complex[:,:] deltalm
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->rholm.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 50, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->rholm, 2, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rholm.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 50, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->rholm, 0);
+  __pyx_v_self->rholm = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rholm.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":51
+ *     cdef public double[:,:] Tlm
+ *     cdef public double complex[:,:] rholm
+ *     cdef public double complex[:,:] deltalm             # <<<<<<<<<<<<<<
+ * 
+ *     # Holds nqc coeffs *for the flux*
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->deltalm.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 51, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->deltalm, 2, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 51, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.deltalm.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 51, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->deltalm, 0);
+  __pyx_v_self->deltalm = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.deltalm.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":54
+ * 
+ *     # Holds nqc coeffs *for the flux*
+ *     cdef public double[:,:,:] nqc_coeffs             # <<<<<<<<<<<<<<
+ * 
+ *     # Holds any extra calibration params that will be used in rholm
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->nqc_coeffs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 54, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->nqc_coeffs, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 54, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.nqc_coeffs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 54, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->nqc_coeffs, 0);
+  __pyx_v_self->nqc_coeffs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.nqc_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":58
+ *     # Holds any extra calibration params that will be used in rholm
+ *     # CAVEAT EMPTOR: this does *exactly* what you tell it to.
+ *     cdef public double [:,:,:] extra_coeffs             # <<<<<<<<<<<<<<
+ *     cdef public double [:,:,:] extra_coeffs_log
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->extra_coeffs.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 58, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->extra_coeffs, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 58, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_coeffs.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 58, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->extra_coeffs, 0);
+  __pyx_v_self->extra_coeffs = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":59
+ *     # CAVEAT EMPTOR: this does *exactly* what you tell it to.
+ *     cdef public double [:,:,:] extra_coeffs
+ *     cdef public double [:,:,:] extra_coeffs_log             # <<<<<<<<<<<<<<
+ * 
+ *     cdef public list special_modes
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  if (unlikely(!__pyx_v_self->extra_coeffs_log.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 59, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->extra_coeffs_log, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 59, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_coeffs_log.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 59, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->extra_coeffs_log, 0);
+  __pyx_v_self->extra_coeffs_log = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_coeffs_log.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":61
+ *     cdef public double [:,:,:] extra_coeffs_log
+ * 
+ *     cdef public list special_modes             # <<<<<<<<<<<<<<
+ *     cdef public bint rho_initialized
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_self->special_modes);
+  __pyx_r = __pyx_v_self->special_modes;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(PyList_CheckExact(__pyx_v_value))||((__pyx_v_value) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_value)->tp_name), 0))) __PYX_ERR(2, 61, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->special_modes);
+  __Pyx_DECREF(__pyx_v_self->special_modes);
+  __pyx_v_self->special_modes = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.special_modes.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->special_modes);
+  __Pyx_DECREF(__pyx_v_self->special_modes);
+  __pyx_v_self->special_modes = ((PyObject*)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":62
+ * 
+ *     cdef public list special_modes
+ *     cdef public bint rho_initialized             # <<<<<<<<<<<<<<
+ * 
+ *     # Include more PN information than in SEOBNRv4HM
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_v_self->rho_initialized); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 62, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_initialized.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_value); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(2, 62, __pyx_L1_error)
+  __pyx_v_self->rho_initialized = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.rho_initialized.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":65
+ * 
+ *     # Include more PN information than in SEOBNRv4HM
+ *     cdef public bint extra_PN_terms             # <<<<<<<<<<<<<<
+ * 
+ * cdef class EOBParams:
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_v_self->extra_PN_terms); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 65, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_PN_terms.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_value); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(2, 65, __pyx_L1_error)
+  __pyx_v_self->extra_PN_terms = __pyx_t_1;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.extra_PN_terms.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_2__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 2, __pyx_L1_error)
+
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_4__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_10FluxParams_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 4, __pyx_L1_error)
+
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.FluxParams.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pyx":83
+ * 
+ * cdef class Dynamics:
+ *     def __cinit__(self):             # <<<<<<<<<<<<<<
+ *         self.p_circ = np.zeros(2,dtype=np.float64)
+ * 
+ */
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
+  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
+    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
+  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics___cinit__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics___cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":84
+ * cdef class Dynamics:
+ *     def __cinit__(self):
+ *         self.p_circ = np.zeros(2,dtype=np.float64)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__7, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->p_circ, 0);
+  __pyx_v_self->p_circ = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
+
+  /* "pyseobnr/eob/utils/containers.pyx":83
+ * 
+ * cdef class Dynamics:
+ *     def __cinit__(self):             # <<<<<<<<<<<<<<
+ *         self.p_circ = np.zeros(2,dtype=np.float64)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.Dynamics.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":27
+ * 
+ * cdef class Dynamics:
+ *     cdef public double[:] p_circ             # <<<<<<<<<<<<<<
+ * 
+ * cdef class FluxParams:
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_6hessian(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("hessian", 0);
+  __Pyx_RefNannySetupContext("__get__", 0);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 13, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 13, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 13, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+  if (unlikely(!__pyx_v_self->p_circ.memview)) {PyErr_SetString(PyExc_AttributeError,"Memoryview is not initialized");__PYX_ERR(2, 27, __pyx_L1_error)}
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p_circ, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.hessian", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.Dynamics.p_circ.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":15
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- */
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
-  double __pyx_r;
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
-  double __pyx_t_17;
+  __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("csi", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_csi); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi)) {
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_17 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_17 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_r = __pyx_t_17;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
-  }
-
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":16
- *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- */
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_value, PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(2, 27, __pyx_L1_error)
+  __PYX_XDEC_MEMVIEW(&__pyx_v_self->p_circ, 0);
+  __pyx_v_self->p_circ = __pyx_t_1;
+  __pyx_t_1.memview = NULL;
+  __pyx_t_1.data = NULL;
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
-  __pyx_r = 0;
+  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.Dynamics.p_circ.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":15
- *     cpdef hessian(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_3__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_3__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("csi (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
-        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-        CYTHON_FALLTHROUGH;
-        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 1); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 2); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 3); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 4); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 5); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 6); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 7); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 8); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, 9); __PYX_ERR(1, 15, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "csi") < 0)) __PYX_ERR(1, 15, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 15, __pyx_L3_error)
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("csi", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 15, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_2__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_8csi(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("csi", 0);
-  __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 15, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 15, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 15, __pyx_L1_error) }
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
-  goto __pyx_L0;
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 2, __pyx_L1_error)
+
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.csi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.Dynamics.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
-  __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":17
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_5__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_5__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_4__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_8Dynamics_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("dynamics", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_dynamics); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics)) {
-        __Pyx_XDECREF(__pyx_r);
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 17, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_r = __pyx_t_2;
-        __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
-  }
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":18
- *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(0, 4, __pyx_L1_error)
+
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
   /* function exit code */
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
-  goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = 0;
-  __pyx_L0:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.Dynamics.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":17
- *     cpdef double csi(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+/* "pyseobnr/eob/utils/containers.pyx":92
+ *     A class to hold various EOB related quantities
+ *     """
+ *     def __init__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,             # <<<<<<<<<<<<<<
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  CYTHON_UNUSED PyObject *__pyx_v_physical_params = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_coeffs = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_aligned = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_extra_PN_terms = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_mode_array = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_special_modes = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("dynamics (wrapper)", 0);
+  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_physical_params,&__pyx_n_s_coeffs,&__pyx_n_s_aligned,&__pyx_n_s_extra_PN_terms,&__pyx_n_s_mode_array,&__pyx_n_s_special_modes,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    values[2] = ((PyObject *)Py_True);
+    values[3] = ((PyObject *)Py_True);
+    values[4] = __pyx_k__10;
+    values[5] = __pyx_k__11;
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4484,402 +8982,133 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_physical_params)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_coeffs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 1); __PYX_ERR(1, 17, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, 1); __PYX_ERR(1, 92, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 2); __PYX_ERR(1, 17, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_aligned);
+          if (value) { values[2] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 3); __PYX_ERR(1, 17, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_extra_PN_terms);
+          if (value) { values[3] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 4); __PYX_ERR(1, 17, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mode_array);
+          if (value) { values[4] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 5); __PYX_ERR(1, 17, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_special_modes);
+          if (value) { values[5] = value; kw_args--; }
         }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(1, 92, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 6); __PYX_ERR(1, 17, __pyx_L3_error)
-        }
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 7); __PYX_ERR(1, 17, __pyx_L3_error)
-        }
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 8); __PYX_ERR(1, 17, __pyx_L3_error)
-        }
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, 9); __PYX_ERR(1, 17, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dynamics") < 0)) __PYX_ERR(1, 17, __pyx_L3_error)
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 17, __pyx_L3_error)
+    }
+    __pyx_v_physical_params = values[0];
+    __pyx_v_coeffs = values[1];
+    __pyx_v_aligned = values[2];
+    __pyx_v_extra_PN_terms = values[3];
+    __pyx_v_mode_array = values[4];
+    __pyx_v_special_modes = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("dynamics", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 17, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 92, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
-  return NULL;
+  return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_10dynamics(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("dynamics", 0);
-  __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 17, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 17, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 17, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
-  goto __pyx_L0;
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams___init__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), __pyx_v_physical_params, __pyx_v_coeffs, __pyx_v_aligned, __pyx_v_extra_PN_terms, __pyx_v_mode_array, __pyx_v_special_modes);
 
   /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
-  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":19
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- */
-
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static double __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
-  double __pyx_r;
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams___init__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_physical_params, CYTHON_UNUSED PyObject *__pyx_v_coeffs, CYTHON_UNUSED PyObject *__pyx_v_aligned, CYTHON_UNUSED PyObject *__pyx_v_extra_PN_terms, CYTHON_UNUSED PyObject *__pyx_v_mode_array, CYTHON_UNUSED PyObject *__pyx_v_special_modes) {
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
-  double __pyx_t_17;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("omega", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_omega); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega)) {
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_17 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_17 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_r = __pyx_t_17;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
-  }
-
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":20
- *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- */
+  __Pyx_RefNannySetupContext("__init__", 0);
 
   /* function exit code */
   __pyx_r = 0;
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_WriteUnraisable("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
-  __pyx_r = 0;
-  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":19
- *     cpdef  dynamics(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
+/* "pyseobnr/eob/utils/containers.pyx":98
  *         pass
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
+ * 
+ *     def __cinit__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,             # <<<<<<<<<<<<<<
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_physical_params = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_coeffs = 0;
+  PyObject *__pyx_v_aligned = 0;
+  PyObject *__pyx_v_extra_PN_terms = 0;
+  PyObject *__pyx_v_mode_array = 0;
+  PyObject *__pyx_v_special_modes = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("omega (wrapper)", 0);
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_physical_params,&__pyx_n_s_coeffs,&__pyx_n_s_aligned,&__pyx_n_s_extra_PN_terms,&__pyx_n_s_mode_array,&__pyx_n_s_special_modes,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
+    values[2] = ((PyObject *)Py_True);
+    values[3] = ((PyObject *)Py_True);
+    values[4] = __pyx_k__12;
+    values[5] = __pyx_k__13;
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4890,749 +9119,909 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_physical_params)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_coeffs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 1); __PYX_ERR(1, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 6, 1); __PYX_ERR(1, 98, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 2); __PYX_ERR(1, 19, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_aligned);
+          if (value) { values[2] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 3); __PYX_ERR(1, 19, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_extra_PN_terms);
+          if (value) { values[3] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 4); __PYX_ERR(1, 19, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mode_array);
+          if (value) { values[4] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 5); __PYX_ERR(1, 19, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_special_modes);
+          if (value) { values[5] = value; kw_args--; }
         }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(1, 98, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 6); __PYX_ERR(1, 19, __pyx_L3_error)
-        }
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 7); __PYX_ERR(1, 19, __pyx_L3_error)
-        }
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 8); __PYX_ERR(1, 19, __pyx_L3_error)
-        }
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, 9); __PYX_ERR(1, 19, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "omega") < 0)) __PYX_ERR(1, 19, __pyx_L3_error)
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 19, __pyx_L3_error)
+    }
+    __pyx_v_physical_params = values[0];
+    __pyx_v_coeffs = values[1];
+    __pyx_v_aligned = values[2];
+    __pyx_v_extra_PN_terms = values[3];
+    __pyx_v_mode_array = values[4];
+    __pyx_v_special_modes = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("omega", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 19, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 98, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
-  return NULL;
+  return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_2__cinit__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), __pyx_v_physical_params, __pyx_v_coeffs, __pyx_v_aligned, __pyx_v_extra_PN_terms, __pyx_v_mode_array, __pyx_v_special_modes);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_12omega(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
-  PyObject *__pyx_r = NULL;
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_2__cinit__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_physical_params, CYTHON_UNUSED PyObject *__pyx_v_coeffs, PyObject *__pyx_v_aligned, PyObject *__pyx_v_extra_PN_terms, PyObject *__pyx_v_mode_array, PyObject *__pyx_v_special_modes) {
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  int __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("omega", 0);
-  __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 19, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 19, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 19, __pyx_L1_error) }
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* "pyseobnr/eob/utils/containers.pyx":102
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
+ *         # Physical params (e.g. spins)
+ *         self.p_params = PhysicalParams(physical_params)             # <<<<<<<<<<<<<<
+ *         # Calibration coefficients
+ *         #self.c_coeffs = CalibCoeffs(coeffs)
+ */
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __pyx_v_physical_params); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->p_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->p_params));
+  __pyx_v_self->p_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_t_1);
   __pyx_t_1 = 0;
-  goto __pyx_L0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":106
+ *         #self.c_coeffs = CalibCoeffs(coeffs)
+ *         # Flux/waveform quantities
+ *         self.flux_params = FluxParams(special_modes,extra_PN_terms)             # <<<<<<<<<<<<<<
+ *         # Dynamics related quantities
+ *         self.dynamics = Dynamics()
+ */
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 106, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_v_special_modes);
+  __Pyx_GIVEREF(__pyx_v_special_modes);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_special_modes);
+  __Pyx_INCREF(__pyx_v_extra_PN_terms);
+  __Pyx_GIVEREF(__pyx_v_extra_PN_terms);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_extra_PN_terms);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 106, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->flux_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->flux_params));
+  __pyx_v_self->flux_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":108
+ *         self.flux_params = FluxParams(special_modes,extra_PN_terms)
+ *         # Dynamics related quantities
+ *         self.dynamics = Dynamics()             # <<<<<<<<<<<<<<
+ *         # Mode array to use for generating modes
+ *         self.mode_array = mode_array
+ */
+  __pyx_t_2 = __Pyx_PyObject_CallNoArg(((PyObject *)__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 108, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->dynamics);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->dynamics));
+  __pyx_v_self->dynamics = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":110
+ *         self.dynamics = Dynamics()
+ *         # Mode array to use for generating modes
+ *         self.mode_array = mode_array             # <<<<<<<<<<<<<<
+ *         self.aligned = aligned
+ */
+  if (!(likely(PyList_CheckExact(__pyx_v_mode_array))||((__pyx_v_mode_array) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_mode_array)->tp_name), 0))) __PYX_ERR(1, 110, __pyx_L1_error)
+  __pyx_t_2 = __pyx_v_mode_array;
+  __Pyx_INCREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->mode_array);
+  __Pyx_DECREF(__pyx_v_self->mode_array);
+  __pyx_v_self->mode_array = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":111
+ *         # Mode array to use for generating modes
+ *         self.mode_array = mode_array
+ *         self.aligned = aligned             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_aligned); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 111, __pyx_L1_error)
+  __pyx_v_self->aligned = __pyx_t_3;
+
+  /* "pyseobnr/eob/utils/containers.pyx":98
+ *         pass
+ * 
+ *     def __cinit__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,             # <<<<<<<<<<<<<<
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
+ */
 
   /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
   __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
-  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":21
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
+/* "pyseobnr/eob/utils/containers.pxd":68
+ * 
+ * cdef class EOBParams:
+ *     cdef public PhysicalParams p_params             # <<<<<<<<<<<<<<
+ *     cdef public CalibCoeffs c_coeffs
+ *     cdef public FluxParams flux_params
  */
 
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_q, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_p, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi1_v, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_chi2_v, CYTHON_UNUSED double __pyx_v_m_1, CYTHON_UNUSED double __pyx_v_m_2, CYTHON_UNUSED double __pyx_v_chi_1, CYTHON_UNUSED double __pyx_v_chi_2, CYTHON_UNUSED double __pyx_v_chiL_1, CYTHON_UNUSED double __pyx_v_chiL_2, int __pyx_skip_dispatch) {
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->p_params));
+  __pyx_r = ((PyObject *)__pyx_v_self->p_params);
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
-  PyObject *__pyx_t_12 = NULL;
-  PyObject *__pyx_t_13 = NULL;
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("aux_derivs", 0);
-  /* Check if called by wrapper */
-  if (unlikely(__pyx_skip_dispatch)) ;
-  /* Check if overridden in Python */
-  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
-    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
-      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_aux_derivs); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs)) {
-        __Pyx_XDECREF(__pyx_r);
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
-        __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chi1_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
-        __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_chi2_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = PyFloat_FromDouble(__pyx_v_m_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = PyFloat_FromDouble(__pyx_v_chiL_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_12 = PyFloat_FromDouble(__pyx_v_chiL_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 21, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_13 = __pyx_t_1; __pyx_t_14 = NULL;
-        __pyx_t_15 = 0;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_14);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_15 = 1;
-          }
-        }
-        #if CYTHON_FAST_PYCALL
-        if (PyFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        #if CYTHON_FAST_PYCCALL
-        if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
-          PyObject *__pyx_temp[11] = {__pyx_t_14, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_15, 10+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        } else
-        #endif
-        {
-          __pyx_t_16 = PyTuple_New(10+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_16);
-          if (__pyx_t_14) {
-            __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
-          }
-          __Pyx_GIVEREF(__pyx_t_3);
-          PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_4);
-          PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_15, __pyx_t_4);
-          __Pyx_GIVEREF(__pyx_t_5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_15, __pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_6);
-          PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_7);
-          PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_7);
-          __Pyx_GIVEREF(__pyx_t_8);
-          PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_15, __pyx_t_8);
-          __Pyx_GIVEREF(__pyx_t_9);
-          PyTuple_SET_ITEM(__pyx_t_16, 6+__pyx_t_15, __pyx_t_9);
-          __Pyx_GIVEREF(__pyx_t_10);
-          PyTuple_SET_ITEM(__pyx_t_16, 7+__pyx_t_15, __pyx_t_10);
-          __Pyx_GIVEREF(__pyx_t_11);
-          PyTuple_SET_ITEM(__pyx_t_16, 8+__pyx_t_15, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_16, 9+__pyx_t_15, __pyx_t_12);
-          __pyx_t_3 = 0;
-          __pyx_t_4 = 0;
-          __pyx_t_5 = 0;
-          __pyx_t_6 = 0;
-          __pyx_t_7 = 0;
-          __pyx_t_8 = 0;
-          __pyx_t_9 = 0;
-          __pyx_t_10 = 0;
-          __pyx_t_11 = 0;
-          __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 21, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-        }
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_r = __pyx_t_2;
-        __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        goto __pyx_L0;
-      }
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
-      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
-      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
-        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
-      }
-      #endif
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
-    }
-    #endif
-  }
-
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":22
- *         pass
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass             # <<<<<<<<<<<<<<
- */
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams))))) __PYX_ERR(2, 68, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->p_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->p_params));
+  __pyx_v_self->p_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* function exit code */
-  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_16);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.p_params.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->p_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->p_params));
+  __pyx_v_self->p_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)Py_None);
+
+  /* function exit code */
   __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":69
+ * cdef class EOBParams:
+ *     cdef public PhysicalParams p_params
+ *     cdef public CalibCoeffs c_coeffs             # <<<<<<<<<<<<<<
+ *     cdef public FluxParams flux_params
+ *     cdef public Dynamics dynamics
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->c_coeffs));
+  __pyx_r = ((PyObject *)__pyx_v_self->c_coeffs);
+  goto __pyx_L0;
+
+  /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":21
- *     cpdef double omega(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):
- *         pass
- *     cpdef aux_derivs(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2):             # <<<<<<<<<<<<<<
- *         pass
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs))))) __PYX_ERR(2, 69, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->c_coeffs);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->c_coeffs));
+  __pyx_v_self->c_coeffs = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.c_coeffs.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->c_coeffs);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->c_coeffs));
+  __pyx_v_self->c_coeffs = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":70
+ *     cdef public PhysicalParams p_params
+ *     cdef public CalibCoeffs c_coeffs
+ *     cdef public FluxParams flux_params             # <<<<<<<<<<<<<<
+ *     cdef public Dynamics dynamics
+ *     cdef public list mode_array
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __Pyx_memviewslice __pyx_v_q = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_p = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi1_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_chi2_v = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_v_m_1;
-  double __pyx_v_m_2;
-  double __pyx_v_chi_1;
-  double __pyx_v_chi_2;
-  double __pyx_v_chiL_1;
-  double __pyx_v_chiL_2;
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->flux_params));
+  __pyx_r = ((PyObject *)__pyx_v_self->flux_params);
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams))))) __PYX_ERR(2, 70, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->flux_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->flux_params));
+  __pyx_v_self->flux_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.flux_params.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("aux_derivs (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_q,&__pyx_n_s_p,&__pyx_n_s_chi1_v,&__pyx_n_s_chi2_v,&__pyx_n_s_m_1,&__pyx_n_s_m_2,&__pyx_n_s_chi_1,&__pyx_n_s_chi_2,&__pyx_n_s_chiL_1,&__pyx_n_s_chiL_2,0};
-    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
-        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-        CYTHON_FALLTHROUGH;
-        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-        CYTHON_FALLTHROUGH;
-        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_q)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 1); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi1_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 2); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi2_v)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 3); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 4); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 5); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 6); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chi_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 7); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_1)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 8); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_chiL_2)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, 9); __PYX_ERR(1, 21, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "aux_derivs") < 0)) __PYX_ERR(1, 21, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
-      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
-      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
-      values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
-      values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
-      values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
-      values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-    }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi1_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi1_v.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi2_v = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chi2_v.memview)) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chiL_1 = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_chiL_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-    __pyx_v_chiL_2 = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_chiL_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L3_error)
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("aux_derivs", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(1, 21, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
   __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2);
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->flux_params);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->flux_params));
+  __pyx_v_self->flux_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":71
+ *     cdef public CalibCoeffs c_coeffs
+ *     cdef public FluxParams flux_params
+ *     cdef public Dynamics dynamics             # <<<<<<<<<<<<<<
+ *     cdef public list mode_array
+ *     cdef public bint aligned
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_14aux_derivs(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, __Pyx_memviewslice __pyx_v_chi1_v, __Pyx_memviewslice __pyx_v_chi2_v, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_chiL_1, double __pyx_v_chiL_2) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self->dynamics));
+  __pyx_r = ((PyObject *)__pyx_v_self->dynamics);
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("aux_derivs", 0);
-  __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(1, 21, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(1, 21, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi1_v.memview)) { __Pyx_RaiseUnboundLocalError("chi1_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_chi2_v.memview)) { __Pyx_RaiseUnboundLocalError("chi2_v"); __PYX_ERR(1, 21, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_chi1_v, __pyx_v_chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_chiL_1, __pyx_v_chiL_2, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 21, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics))))) __PYX_ERR(2, 71, __pyx_L1_error)
+  __pyx_t_1 = __pyx_v_value;
+  __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->dynamics);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->dynamics));
+  __pyx_v_self->dynamics = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)__pyx_t_1);
   __pyx_t_1 = 0;
-  goto __pyx_L0;
 
   /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.aux_derivs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.dynamics.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
   __pyx_L0:;
-  __PYX_XDEC_MEMVIEW(&__pyx_v_q, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_p, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi1_v, 1);
-  __PYX_XDEC_MEMVIEW(&__pyx_v_chi2_v, 1);
-  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd":5
- * from pyseobnr.eob.utils.containers cimport EOBParams
- * cdef class Hamiltonian_v5PHM_C:
- *     cdef public EOBParams EOBpars             # <<<<<<<<<<<<<<
- *     cpdef _call(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
- *     cpdef grad(self, double[:]q,double[:]p,double[:]chi1_v,double[:]chi2_v,double m_1,double m_2,double chi_1,double chi_2,double chiL_1,double chiL_2)
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_5__del__(PyObject *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__del__", 0);
+  __Pyx_INCREF(Py_None);
+  __Pyx_GIVEREF(Py_None);
+  __Pyx_GOTREF(__pyx_v_self->dynamics);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->dynamics));
+  __pyx_v_self->dynamics = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":72
+ *     cdef public FluxParams flux_params
+ *     cdef public Dynamics dynamics
+ *     cdef public list mode_array             # <<<<<<<<<<<<<<
+ *     cdef public bint aligned
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(PyObject *__pyx_v_self); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(PyObject *__pyx_v_self) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars___get__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_self->EOBpars));
-  __pyx_r = ((PyObject *)__pyx_v_self->EOBpars);
+  __Pyx_INCREF(__pyx_v_self->mode_array);
+  __pyx_r = __pyx_v_self->mode_array;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_2__set__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, PyObject *__pyx_v_value) {
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
-  if (!(likely(((__pyx_v_value) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_value, __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams))))) __PYX_ERR(2, 5, __pyx_L1_error)
+  if (!(likely(PyList_CheckExact(__pyx_v_value))||((__pyx_v_value) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_value)->tp_name), 0))) __PYX_ERR(2, 72, __pyx_L1_error)
   __pyx_t_1 = __pyx_v_value;
   __Pyx_INCREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
-  __Pyx_GOTREF(__pyx_v_self->EOBpars);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
-  __pyx_v_self->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->mode_array);
+  __Pyx_DECREF(__pyx_v_self->mode_array);
+  __pyx_v_self->mode_array = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.EOBpars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.mode_array.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(PyObject *__pyx_v_self); /*proto*/
-static int __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(PyObject *__pyx_v_self) {
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_5__del__(PyObject *__pyx_v_self); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_5__del__(PyObject *__pyx_v_self) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_4__del__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_4__del__(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_4__del__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__del__", 0);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
-  __Pyx_GOTREF(__pyx_v_self->EOBpars);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->EOBpars));
-  __pyx_v_self->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None);
+  __Pyx_GOTREF(__pyx_v_self->mode_array);
+  __Pyx_DECREF(__pyx_v_self->mode_array);
+  __pyx_v_self->mode_array = ((PyObject*)Py_None);
+
+  /* function exit code */
+  __pyx_r = 0;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyseobnr/eob/utils/containers.pxd":73
+ *     cdef public Dynamics dynamics
+ *     cdef public list mode_array
+ *     cdef public bint aligned             # <<<<<<<<<<<<<<
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_1__get__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_1__get__(PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned___get__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned___get__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__get__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_v_self->aligned); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 73, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.aligned.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
+static int __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_2__set__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v_value));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_2__set__(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, PyObject *__pyx_v_value) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__set__", 0);
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_value); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(2, 73, __pyx_L1_error)
+  __pyx_v_self->aligned = __pyx_t_1;
 
   /* function exit code */
   __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.aligned.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_5__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static char __pyx_doc_8pyseobnr_3eob_5utils_10containers_9EOBParams_4__reduce_cython__[] = "EOBParams.__reduce_cython__(self)";
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_5__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_4__reduce_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "(tree fragment)":3
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
-static PyObject *__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static char __pyx_doc_8pyseobnr_3eob_5utils_10containers_9EOBParams_6__setstate_cython__[] = "EOBParams.__setstate_cython__(self, __pyx_state)";
+static PyObject *__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+  __pyx_r = __pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_6__setstate_cython__(((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_5utils_10containers_9EOBParams_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -5640,21 +10029,1038 @@
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyseobnr.eob.utils.containers.EOBParams.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
+ * ctypedef npy_cdouble     complex_t
+ * 
+ * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(1, <void*>a)
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__pyx_v_a) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
+ * 
+ * cdef inline object PyArray_MultiIterNew1(a):
+ *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew2(a, b):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 735, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
+ * ctypedef npy_cdouble     complex_t
+ * 
+ * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(1, <void*>a)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew1", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
+ *     return PyArray_MultiIterNew(1, <void*>a)
+ * 
+ * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
+ * 
+ * cdef inline object PyArray_MultiIterNew2(a, b):
+ *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew3(a, b, c):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 738, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
+ *     return PyArray_MultiIterNew(1, <void*>a)
+ * 
+ * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew2", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
+ *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
+ * 
+ * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
+ * 
+ * cdef inline object PyArray_MultiIterNew3(a, b, c):
+ *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 741, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
+ *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
+ * 
+ * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew3", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
+ *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
+ * 
+ * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
+ * 
+ * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
+ *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 744, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
+ *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
+ * 
+ * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew4", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
+ *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
+ * 
+ * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
+ * 
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d, PyObject *__pyx_v_e) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
+ * 
+ * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
+ *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline tuple PyDataType_SHAPE(dtype d):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 747, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
+ *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
+ * 
+ * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
+ *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew5", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
+ *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
+ * 
+ * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
+ *     if PyDataType_HASSUBARRAY(d):
+ *         return <tuple>d.subarray.shape
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
+ * 
+ * cdef inline tuple PyDataType_SHAPE(dtype d):
+ *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
+ *         return <tuple>d.subarray.shape
+ *     else:
+ */
+  __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
+  if (__pyx_t_1) {
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
+ * cdef inline tuple PyDataType_SHAPE(dtype d):
+ *     if PyDataType_HASSUBARRAY(d):
+ *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
+ *     else:
+ *         return ()
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
+    __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
+    goto __pyx_L0;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
+ * 
+ * cdef inline tuple PyDataType_SHAPE(dtype d):
+ *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
+ *         return <tuple>d.subarray.shape
+ *     else:
+ */
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
+ *         return <tuple>d.subarray.shape
+ *     else:
+ *         return ()             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  /*else*/ {
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(__pyx_empty_tuple);
+    __pyx_r = __pyx_empty_tuple;
+    goto __pyx_L0;
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
+ *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
+ * 
+ * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
+ *     if PyDataType_HASSUBARRAY(d):
+ *         return <tuple>d.subarray.shape
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
+ *     int _import_umath() except -1
+ * 
+ * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
+ *     Py_INCREF(base) # important to do this before stealing the reference below!
+ *     PyArray_SetBaseObject(arr, base)
+ */
+
+static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("set_array_base", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
+ * 
+ * cdef inline void set_array_base(ndarray arr, object base):
+ *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
+ *     PyArray_SetBaseObject(arr, base)
+ * 
+ */
+  Py_INCREF(__pyx_v_base);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
+ * cdef inline void set_array_base(ndarray arr, object base):
+ *     Py_INCREF(base) # important to do this before stealing the reference below!
+ *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object get_array_base(ndarray arr):
+ */
+  (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
+ *     int _import_umath() except -1
+ * 
+ * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
+ *     Py_INCREF(base) # important to do this before stealing the reference below!
+ *     PyArray_SetBaseObject(arr, base)
+ */
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
+ *     PyArray_SetBaseObject(arr, base)
+ * 
+ * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
+ *     base = PyArray_BASE(arr)
+ *     if base is NULL:
+ */
+
+static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
+  PyObject *__pyx_v_base;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  __Pyx_RefNannySetupContext("get_array_base", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
+ * 
+ * cdef inline object get_array_base(ndarray arr):
+ *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
+ *     if base is NULL:
+ *         return None
+ */
+  __pyx_v_base = PyArray_BASE(__pyx_v_arr);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
+ * cdef inline object get_array_base(ndarray arr):
+ *     base = PyArray_BASE(arr)
+ *     if base is NULL:             # <<<<<<<<<<<<<<
+ *         return None
+ *     return <object>base
+ */
+  __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
+  if (__pyx_t_1) {
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
+ *     base = PyArray_BASE(arr)
+ *     if base is NULL:
+ *         return None             # <<<<<<<<<<<<<<
+ *     return <object>base
+ * 
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+    goto __pyx_L0;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
+ * cdef inline object get_array_base(ndarray arr):
+ *     base = PyArray_BASE(arr)
+ *     if base is NULL:             # <<<<<<<<<<<<<<
+ *         return None
+ *     return <object>base
+ */
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
+ *     if base is NULL:
+ *         return None
+ *     return <object>base             # <<<<<<<<<<<<<<
+ * 
+ * # Versions of the import_* functions which are more suitable for
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_base));
+  __pyx_r = ((PyObject *)__pyx_v_base);
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
+ *     PyArray_SetBaseObject(arr, base)
+ * 
+ * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
+ *     base = PyArray_BASE(arr)
+ *     if base is NULL:
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
+ * # Versions of the import_* functions which are more suitable for
+ * # Cython code.
+ * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         __pyx_import_array()
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_import_array(void) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("import_array", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
+ * # Cython code.
+ * cdef inline int import_array() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         __pyx_import_array()
+ *     except Exception:
+ */
+  {
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
+    __Pyx_XGOTREF(__pyx_t_1);
+    __Pyx_XGOTREF(__pyx_t_2);
+    __Pyx_XGOTREF(__pyx_t_3);
+    /*try:*/ {
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
+ * cdef inline int import_array() except -1:
+ *     try:
+ *         __pyx_import_array()             # <<<<<<<<<<<<<<
+ *     except Exception:
+ *         raise ImportError("numpy.core.multiarray failed to import")
+ */
+      __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 942, __pyx_L3_error)
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
+ * # Cython code.
+ * cdef inline int import_array() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         __pyx_import_array()
+ *     except Exception:
+ */
+    }
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    goto __pyx_L8_try_end;
+    __pyx_L3_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
+ *     try:
+ *         __pyx_import_array()
+ *     except Exception:             # <<<<<<<<<<<<<<
+ *         raise ImportError("numpy.core.multiarray failed to import")
+ * 
+ */
+    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
+    if (__pyx_t_4) {
+      __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 943, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GOTREF(__pyx_t_7);
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
+ *         __pyx_import_array()
+ *     except Exception:
+ *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline int import_umath() except -1:
+ */
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 944, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __PYX_ERR(3, 944, __pyx_L5_except_error)
+    }
+    goto __pyx_L5_except_error;
+    __pyx_L5_except_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
+ * # Cython code.
+ * cdef inline int import_array() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         __pyx_import_array()
+ *     except Exception:
+ */
+    __Pyx_XGIVEREF(__pyx_t_1);
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
+    goto __pyx_L1_error;
+    __pyx_L8_try_end:;
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
+ * # Versions of the import_* functions which are more suitable for
+ * # Cython code.
+ * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         __pyx_import_array()
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
+ *         raise ImportError("numpy.core.multiarray failed to import")
+ * 
+ * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         _import_umath()
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_import_umath(void) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("import_umath", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
+ * 
+ * cdef inline int import_umath() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+  {
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
+    __Pyx_XGOTREF(__pyx_t_1);
+    __Pyx_XGOTREF(__pyx_t_2);
+    __Pyx_XGOTREF(__pyx_t_3);
+    /*try:*/ {
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
+ * cdef inline int import_umath() except -1:
+ *     try:
+ *         _import_umath()             # <<<<<<<<<<<<<<
+ *     except Exception:
+ *         raise ImportError("numpy.core.umath failed to import")
+ */
+      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 948, __pyx_L3_error)
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
+ * 
+ * cdef inline int import_umath() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+    }
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    goto __pyx_L8_try_end;
+    __pyx_L3_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
+ *     try:
+ *         _import_umath()
+ *     except Exception:             # <<<<<<<<<<<<<<
+ *         raise ImportError("numpy.core.umath failed to import")
+ * 
+ */
+    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
+    if (__pyx_t_4) {
+      __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 949, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GOTREF(__pyx_t_7);
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
+ *         _import_umath()
+ *     except Exception:
+ *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline int import_ufunc() except -1:
+ */
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 950, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __PYX_ERR(3, 950, __pyx_L5_except_error)
+    }
+    goto __pyx_L5_except_error;
+    __pyx_L5_except_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
+ * 
+ * cdef inline int import_umath() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+    __Pyx_XGIVEREF(__pyx_t_1);
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
+    goto __pyx_L1_error;
+    __pyx_L8_try_end:;
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
+ *         raise ImportError("numpy.core.multiarray failed to import")
+ * 
+ * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         _import_umath()
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
+ *         raise ImportError("numpy.core.umath failed to import")
+ * 
+ * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         _import_umath()
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_import_ufunc(void) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("import_ufunc", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
+ * 
+ * cdef inline int import_ufunc() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+  {
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
+    __Pyx_XGOTREF(__pyx_t_1);
+    __Pyx_XGOTREF(__pyx_t_2);
+    __Pyx_XGOTREF(__pyx_t_3);
+    /*try:*/ {
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
+ * cdef inline int import_ufunc() except -1:
+ *     try:
+ *         _import_umath()             # <<<<<<<<<<<<<<
+ *     except Exception:
+ *         raise ImportError("numpy.core.umath failed to import")
+ */
+      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 954, __pyx_L3_error)
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
+ * 
+ * cdef inline int import_ufunc() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+    }
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    goto __pyx_L8_try_end;
+    __pyx_L3_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
+ *     try:
+ *         _import_umath()
+ *     except Exception:             # <<<<<<<<<<<<<<
+ *         raise ImportError("numpy.core.umath failed to import")
+ * 
+ */
+    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
+    if (__pyx_t_4) {
+      __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 955, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GOTREF(__pyx_t_7);
+
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
+ *         _import_umath()
+ *     except Exception:
+ *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
+ * 
+ * cdef extern from *:
+ */
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 956, __pyx_L5_except_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __PYX_ERR(3, 956, __pyx_L5_except_error)
+    }
+    goto __pyx_L5_except_error;
+    __pyx_L5_except_error:;
+
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
+ * 
+ * cdef inline int import_ufunc() except -1:
+ *     try:             # <<<<<<<<<<<<<<
+ *         _import_umath()
+ *     except Exception:
+ */
+    __Pyx_XGIVEREF(__pyx_t_1);
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
+    goto __pyx_L1_error;
+    __pyx_L8_try_end:;
+  }
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
+ *         raise ImportError("numpy.core.umath failed to import")
+ * 
+ * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
+ *     try:
+ *         _import_umath()
+ */
+
+  /* function exit code */
+  __pyx_r = 0;
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
+ * 
+ * 
+ * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.timedelta64)`
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
+ *     bool
+ *     """
+ *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
+ * 
+ * 
+ * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.timedelta64)`
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
+ * 
+ * 
+ * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.datetime64)`
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("is_datetime64_object", 0);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
+ *     bool
+ *     """
+ *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
+ * 
+ * 
+ * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.datetime64)`
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
+ * 
+ * 
+ * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy datetime64 object
+ */
+
+static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
+  npy_datetime __pyx_r;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+ *     also needed.  That can be found using `get_datetime64_unit`.
+ *     """
+ *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
+ * 
+ * 
+ * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy datetime64 object
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+ * 
+ * 
+ * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ */
+
+static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
+  npy_timedelta __pyx_r;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ *     """
+ *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+ * 
+ * 
+ * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+ * 
+ * 
+ * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ */
+
+static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
+  NPY_DATETIMEUNIT __pyx_r;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ *     """
+ *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
+ */
+  __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
+  goto __pyx_L0;
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+ * 
+ * 
+ * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
 /* "View.MemoryView":123
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
@@ -5850,15 +11256,15 @@
     /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(0, 134, __pyx_L1_error)
 
     /* "View.MemoryView":133
  *         self.itemsize = itemsize
@@ -5882,15 +11288,15 @@
     /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(0, 137, __pyx_L1_error)
 
     /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
@@ -6009,15 +11415,15 @@
     /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(0, 149, __pyx_L1_error)
 
     /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
@@ -6283,15 +11689,15 @@
       /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 177, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 177, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_ERR(0, 177, __pyx_L1_error)
 
       /* "View.MemoryView":176
  * 
@@ -6527,15 +11933,15 @@
     /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 193, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(0, 193, __pyx_L1_error)
 
     /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
@@ -7261,15 +12667,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -7317,15 +12723,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -9046,15 +14452,15 @@
     /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(0, 420, __pyx_L1_error)
 
     /* "View.MemoryView":419
  * 
@@ -10094,15 +15500,15 @@
       /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 497, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 497, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_ERR(0, 497, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -10456,15 +15862,15 @@
     /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(0, 522, __pyx_L1_error)
 
     /* "View.MemoryView":521
  *     @cname('getbuffer')
@@ -11005,15 +16411,15 @@
     /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(0, 572, __pyx_L1_error)
 
     /* "View.MemoryView":570
  *     @property
@@ -11122,15 +16528,15 @@
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__14, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__29, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":578
@@ -12160,15 +17566,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -12216,15 +17622,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -12573,17 +17979,17 @@
  *             else:
  */
         __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 684, __pyx_L1_error)
         __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
-            __Pyx_INCREF(__pyx_slice__17);
-            __Pyx_GIVEREF(__pyx_slice__17);
-            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__17);
+            __Pyx_INCREF(__pyx_slice__32);
+            __Pyx_GIVEREF(__pyx_slice__32);
+            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__32);
           }
         }
         __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 684, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "View.MemoryView":685
  *             if not seen_ellipsis:
@@ -12608,15 +18014,15 @@
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__17); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 687, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__32); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 687, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":688
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
@@ -12748,17 +18154,17 @@
  * 
  *     return have_slices or nslices, tuple(result)
  */
     __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
-        __Pyx_INCREF(__pyx_slice__17);
-        __Pyx_GIVEREF(__pyx_slice__17);
-        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__17);
+        __Pyx_INCREF(__pyx_slice__32);
+        __Pyx_GIVEREF(__pyx_slice__32);
+        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__32);
       }
     }
     __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "View.MemoryView":697
  * 
@@ -12877,15 +18283,15 @@
       /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __PYX_ERR(0, 705, __pyx_L1_error)
 
       /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
@@ -15061,15 +20467,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -15117,15 +20523,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(0, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -18394,15 +23800,15 @@
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__21, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__36, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
@@ -18687,102 +24093,1164 @@
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
+static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams __pyx_vtable_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_PhysicalParams(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)o);
+  p->__pyx_vtab = __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+  p->chi1_v.data = NULL;
+  p->chi1_v.memview = NULL;
+  p->chi2_v.data = NULL;
+  p->chi2_v.memview = NULL;
+  p->lN.data = NULL;
+  p->lN.memview = NULL;
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1__cinit__(o, a, k) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_PhysicalParams(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)o;
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  __PYX_XDEC_MEMVIEW(&p->chi1_v, 1);
+  __PYX_XDEC_MEMVIEW(&p->chi2_v, 1);
+  __PYX_XDEC_MEMVIEW(&p->lN, 1);
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_1(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_1(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_1_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_2(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_2(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3m_2_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_nu(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_nu(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2nu_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_M(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_M(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1M_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_1(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_1(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_1_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_2(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_2(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3X_2_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_delta(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_delta(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5delta_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_1(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_1(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_1_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_2(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_2(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_2_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_S(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_S(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_S_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_A(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_A(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5chi_A_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_1a_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_ap(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_ap(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2ap_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_am(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_am(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2am_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_L(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_L(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_L_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_L(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_L(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_L_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a1(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a1(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a1_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a2(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a2(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2a2_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_H_val(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_H_val(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5H_val_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_v(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_v(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi1_v_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_v(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_v(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_6chi2_v_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_lN(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_lN(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2lN_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5omega_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega_circ(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega_circ(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_10omega_circ_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_5utils_10containers_PhysicalParams[] = {
+  {"update_spins", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_3update_spins, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_2update_spins},
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_5__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_7__setstate_cython__, METH_O, 0},
+  {0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_5utils_10containers_PhysicalParams[] = {
+  {(char *)"m_1", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_1, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_1, (char *)0, 0},
+  {(char *)"m_2", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_2, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_m_2, (char *)0, 0},
+  {(char *)"nu", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_nu, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_nu, (char *)0, 0},
+  {(char *)"M", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_M, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_M, (char *)0, 0},
+  {(char *)"X_1", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_1, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_1, (char *)0, 0},
+  {(char *)"X_2", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_2, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_X_2, (char *)0, 0},
+  {(char *)"delta", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_delta, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_delta, (char *)0, 0},
+  {(char *)"chi_1", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_1, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_1, (char *)0, 0},
+  {(char *)"chi_2", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_2, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_2, (char *)0, 0},
+  {(char *)"chi_S", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_S, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_S, (char *)0, 0},
+  {(char *)"chi_A", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_A, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi_A, (char *)0, 0},
+  {(char *)"a", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a, (char *)0, 0},
+  {(char *)"ap", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_ap, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_ap, (char *)0, 0},
+  {(char *)"am", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_am, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_am, (char *)0, 0},
+  {(char *)"chi1_L", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_L, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_L, (char *)0, 0},
+  {(char *)"chi2_L", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_L, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_L, (char *)0, 0},
+  {(char *)"a1", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a1, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a1, (char *)0, 0},
+  {(char *)"a2", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a2, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_a2, (char *)0, 0},
+  {(char *)"H_val", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_H_val, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_H_val, (char *)0, 0},
+  {(char *)"chi1_v", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_v, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi1_v, (char *)0, 0},
+  {(char *)"chi2_v", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_v, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_chi2_v, (char *)0, 0},
+  {(char *)"lN", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_lN, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_lN, (char *)0, 0},
+  {(char *)"omega", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega, (char *)0, 0},
+  {(char *)"omega_circ", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega_circ, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_omega_circ, (char *)0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PyTypeObject __pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pyseobnr.eob.utils.containers.PhysicalParams", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_PhysicalParams, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
+  0, /*tp_doc*/
+  0, /*tp_traverse*/
+  0, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_8pyseobnr_3eob_5utils_10containers_PhysicalParams, /*tp_methods*/
+  0, /*tp_members*/
+  __pyx_getsets_8pyseobnr_3eob_5utils_10containers_PhysicalParams, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_8pyseobnr_3eob_5utils_10containers_PhysicalParams, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
+
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)o);
+  p->dc = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_1__cinit__(o, a, k) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)o;
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->dc);
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static int __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)o;
+  if (p->dc) {
+    e = (*v)(p->dc, a); if (e) return e;
+  }
+  return 0;
+}
+
+static int __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyObject *o) {
+  PyObject* tmp;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)o;
+  tmp = ((PyObject*)p->dc);
+  p->dc = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+static PyObject *__pyx_sq_item_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyObject *o, Py_ssize_t i) {
+  PyObject *r;
+  PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
+  r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
+  Py_DECREF(x);
+  return r;
+}
+
+static int __pyx_mp_ass_subscript_8pyseobnr_3eob_5utils_10containers_CalibCoeffs(PyObject *o, PyObject *i, PyObject *v) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_5__setitem__(o, i, v);
+  }
+  else {
+    PyErr_Format(PyExc_NotImplementedError,
+      "Subscript deletion not supported by %.200s", Py_TYPE(o)->tp_name);
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_dc(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_dc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_2dc_5__del__(o);
+  }
+}
+
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_5utils_10containers_CalibCoeffs[] = {
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_7__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_9__setstate_cython__, METH_O, 0},
+  {0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_5utils_10containers_CalibCoeffs[] = {
+  {(char *)"dc", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_dc, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_dc, (char *)0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PySequenceMethods __pyx_tp_as_sequence_CalibCoeffs = {
+  0, /*sq_length*/
+  0, /*sq_concat*/
+  0, /*sq_repeat*/
+  __pyx_sq_item_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*sq_item*/
+  0, /*sq_slice*/
+  0, /*sq_ass_item*/
+  0, /*sq_ass_slice*/
+  0, /*sq_contains*/
+  0, /*sq_inplace_concat*/
+  0, /*sq_inplace_repeat*/
+};
+
+static PyMappingMethods __pyx_tp_as_mapping_CalibCoeffs = {
+  0, /*mp_length*/
+  __pyx_pw_8pyseobnr_3eob_5utils_10containers_11CalibCoeffs_3__getitem__, /*mp_subscript*/
+  __pyx_mp_ass_subscript_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*mp_ass_subscript*/
+};
+
+static PyTypeObject __pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pyseobnr.eob.utils.containers.CalibCoeffs", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  &__pyx_tp_as_sequence_CalibCoeffs, /*tp_as_sequence*/
+  &__pyx_tp_as_mapping_CalibCoeffs, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  0, /*tp_doc*/
+  __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_traverse*/
+  __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_methods*/
+  0, /*tp_members*/
+  __pyx_getsets_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_8pyseobnr_3eob_5utils_10containers_CalibCoeffs, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
+
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_Dynamics(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)o);
+  p->p_circ.data = NULL;
+  p->p_circ.memview = NULL;
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_1__cinit__(o, __pyx_empty_tuple, NULL) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_Dynamics(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)o;
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  __PYX_XDEC_MEMVIEW(&p->p_circ, 1);
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_8Dynamics_p_circ(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_8Dynamics_p_circ(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_6p_circ_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_5utils_10containers_Dynamics[] = {
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_3__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_8Dynamics_5__setstate_cython__, METH_O, 0},
+  {0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_5utils_10containers_Dynamics[] = {
+  {(char *)"p_circ", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_8Dynamics_p_circ, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_8Dynamics_p_circ, (char *)0, 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PyTypeObject __pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pyseobnr.eob.utils.containers.Dynamics", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_Dynamics, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
+  0, /*tp_doc*/
+  0, /*tp_traverse*/
+  0, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_8pyseobnr_3eob_5utils_10containers_Dynamics, /*tp_methods*/
+  0, /*tp_members*/
+  __pyx_getsets_8pyseobnr_3eob_5utils_10containers_Dynamics, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_8pyseobnr_3eob_5utils_10containers_Dynamics, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
 
-static PyObject *__pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyTypeObject *t, PyObject *a, PyObject *k) {
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p;
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_FluxParams(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
   } else {
     o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
   }
   if (unlikely(!o)) return 0;
-  p = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o);
-  p->__pyx_vtab = __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
-  p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
-  if (unlikely(__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_1__cinit__(o, a, k) < 0)) goto bad;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)o);
+  p->special_modes = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  p->rho_coeffs.data = NULL;
+  p->rho_coeffs.memview = NULL;
+  p->rho_coeffs_log.data = NULL;
+  p->rho_coeffs_log.memview = NULL;
+  p->f_coeffs.data = NULL;
+  p->f_coeffs.memview = NULL;
+  p->f_coeffs_vh.data = NULL;
+  p->f_coeffs_vh.memview = NULL;
+  p->delta_coeffs.data = NULL;
+  p->delta_coeffs.memview = NULL;
+  p->delta_coeffs_vh.data = NULL;
+  p->delta_coeffs_vh.memview = NULL;
+  p->prefixes.data = NULL;
+  p->prefixes.memview = NULL;
+  p->prefixes_abs.data = NULL;
+  p->prefixes_abs.memview = NULL;
+  p->Tlm.data = NULL;
+  p->Tlm.memview = NULL;
+  p->rholm.data = NULL;
+  p->rholm.memview = NULL;
+  p->deltalm.data = NULL;
+  p->deltalm.memview = NULL;
+  p->nqc_coeffs.data = NULL;
+  p->nqc_coeffs.memview = NULL;
+  p->extra_coeffs.data = NULL;
+  p->extra_coeffs.memview = NULL;
+  p->extra_coeffs_log.data = NULL;
+  p->extra_coeffs_log.memview = NULL;
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_1__cinit__(o, a, k) < 0)) goto bad;
   return o;
   bad:
   Py_DECREF(o); o = 0;
   return NULL;
 }
 
-static void __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o) {
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
+static void __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_FluxParams(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)o;
   #if CYTHON_USE_TP_FINALIZE
   if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
     if (PyObject_CallFinalizerFromDealloc(o)) return;
   }
   #endif
   PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->EOBpars);
+  Py_CLEAR(p->special_modes);
+  __PYX_XDEC_MEMVIEW(&p->rho_coeffs, 1);
+  __PYX_XDEC_MEMVIEW(&p->rho_coeffs_log, 1);
+  __PYX_XDEC_MEMVIEW(&p->f_coeffs, 1);
+  __PYX_XDEC_MEMVIEW(&p->f_coeffs_vh, 1);
+  __PYX_XDEC_MEMVIEW(&p->delta_coeffs, 1);
+  __PYX_XDEC_MEMVIEW(&p->delta_coeffs_vh, 1);
+  __PYX_XDEC_MEMVIEW(&p->prefixes, 1);
+  __PYX_XDEC_MEMVIEW(&p->prefixes_abs, 1);
+  __PYX_XDEC_MEMVIEW(&p->Tlm, 1);
+  __PYX_XDEC_MEMVIEW(&p->rholm, 1);
+  __PYX_XDEC_MEMVIEW(&p->deltalm, 1);
+  __PYX_XDEC_MEMVIEW(&p->nqc_coeffs, 1);
+  __PYX_XDEC_MEMVIEW(&p->extra_coeffs, 1);
+  __PYX_XDEC_MEMVIEW(&p->extra_coeffs_log, 1);
   (*Py_TYPE(o)->tp_free)(o);
 }
 
-static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_FluxParams(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
-  if (p->EOBpars) {
-    e = (*v)(((PyObject *)p->EOBpars), a); if (e) return e;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)o;
+  if (p->special_modes) {
+    e = (*v)(p->special_modes, a); if (e) return e;
   }
   return 0;
 }
 
-static int __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C(PyObject *o) {
+static int __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_FluxParams(PyObject *o) {
   PyObject* tmp;
-  struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)o;
-  tmp = ((PyObject*)p->EOBpars);
-  p->EOBpars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)Py_None); Py_INCREF(Py_None);
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)o;
+  tmp = ((PyObject*)p->special_modes);
+  p->special_modes = ((PyObject*)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   return 0;
 }
 
-static PyObject *__pyx_getprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars(PyObject *o, CYTHON_UNUSED void *x) {
-  return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_1__get__(o);
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_1__get__(o);
 }
 
-static int __pyx_setprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
   if (v) {
-    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_3__set__(o, v);
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10rho_coeffs_3__set__(o, v);
   }
   else {
-    return __pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7EOBpars_5__del__(o);
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs_log(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs_log(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14rho_coeffs_log_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8f_coeffs_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs_vh(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs_vh(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_11f_coeffs_vh_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12delta_coeffs_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs_vh(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs_vh(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15delta_coeffs_vh_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_8prefixes_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes_abs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes_abs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12prefixes_abs_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_Tlm(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_Tlm(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3Tlm_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rholm(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rholm(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5rholm_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_deltalm(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_deltalm(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_7deltalm_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_nqc_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_nqc_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_10nqc_coeffs_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_12extra_coeffs_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs_log(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs_log(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_16extra_coeffs_log_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_special_modes(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_special_modes(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_13special_modes_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_initialized(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_initialized(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_15rho_initialized_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_PN_terms(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_PN_terms(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_14extra_PN_terms_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
   }
 }
 
-static PyMethodDef __pyx_methods_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C[] = {
-  {"_call", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_3_call, METH_VARARGS|METH_KEYWORDS, 0},
-  {"grad", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_5grad, METH_VARARGS|METH_KEYWORDS, 0},
-  {"hessian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_7hessian, METH_VARARGS|METH_KEYWORDS, 0},
-  {"csi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_9csi, METH_VARARGS|METH_KEYWORDS, 0},
-  {"dynamics", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_11dynamics, METH_VARARGS|METH_KEYWORDS, 0},
-  {"omega", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_13omega, METH_VARARGS|METH_KEYWORDS, 0},
-  {"aux_derivs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_15aux_derivs, METH_VARARGS|METH_KEYWORDS, 0},
-  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_17__reduce_cython__, METH_NOARGS, 0},
-  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_19__setstate_cython__, METH_O, 0},
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_5utils_10containers_FluxParams[] = {
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_3__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_10FluxParams_5__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
-static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C[] = {
-  {(char *)"EOBpars", __pyx_getprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars, __pyx_setprop_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_EOBpars, (char *)0, 0},
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_5utils_10containers_FluxParams[] = {
+  {(char *)"rho_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs, (char *)0, 0},
+  {(char *)"rho_coeffs_log", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs_log, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_coeffs_log, (char *)0, 0},
+  {(char *)"f_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs, (char *)0, 0},
+  {(char *)"f_coeffs_vh", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs_vh, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_f_coeffs_vh, (char *)0, 0},
+  {(char *)"delta_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs, (char *)0, 0},
+  {(char *)"delta_coeffs_vh", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs_vh, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_delta_coeffs_vh, (char *)0, 0},
+  {(char *)"prefixes", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes, (char *)0, 0},
+  {(char *)"prefixes_abs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes_abs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_prefixes_abs, (char *)0, 0},
+  {(char *)"Tlm", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_Tlm, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_Tlm, (char *)0, 0},
+  {(char *)"rholm", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rholm, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rholm, (char *)0, 0},
+  {(char *)"deltalm", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_deltalm, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_deltalm, (char *)0, 0},
+  {(char *)"nqc_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_nqc_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_nqc_coeffs, (char *)0, 0},
+  {(char *)"extra_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs, (char *)0, 0},
+  {(char *)"extra_coeffs_log", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs_log, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_coeffs_log, (char *)0, 0},
+  {(char *)"special_modes", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_special_modes, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_special_modes, (char *)0, 0},
+  {(char *)"rho_initialized", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_initialized, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_rho_initialized, (char *)0, 0},
+  {(char *)"extra_PN_terms", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_PN_terms, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_10FluxParams_extra_PN_terms, (char *)0, 0},
   {0, 0, 0, 0, 0}
 };
 
-static PyTypeObject __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = {
+static PyTypeObject __pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Hamiltonian_v5PHM_C", /*tp_name*/
-  sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), /*tp_basicsize*/
+  "pyseobnr.eob.utils.containers.FluxParams", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_dealloc*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -18801,31 +25269,278 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_traverse*/
-  __pyx_tp_clear_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_clear*/
+  __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_traverse*/
+  __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
-  __pyx_methods_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_methods*/
+  __pyx_methods_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_methods*/
   0, /*tp_members*/
-  __pyx_getsets_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_getset*/
+  __pyx_getsets_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, /*tp_new*/
+  __pyx_tp_new_8pyseobnr_3eob_5utils_10containers_FluxParams, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
+
+static PyObject *__pyx_tp_new_8pyseobnr_3eob_5utils_10containers_EOBParams(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)o);
+  p->p_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)Py_None); Py_INCREF(Py_None);
+  p->c_coeffs = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)Py_None); Py_INCREF(Py_None);
+  p->flux_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)Py_None); Py_INCREF(Py_None);
+  p->dynamics = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)Py_None); Py_INCREF(Py_None);
+  p->mode_array = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  if (unlikely(__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_3__cinit__(o, a, k) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_EOBParams(PyObject *o) {
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)o;
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && !_PyGC_FINALIZED(o)) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->p_params);
+  Py_CLEAR(p->c_coeffs);
+  Py_CLEAR(p->flux_params);
+  Py_CLEAR(p->dynamics);
+  Py_CLEAR(p->mode_array);
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static int __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_EOBParams(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)o;
+  if (p->p_params) {
+    e = (*v)(((PyObject *)p->p_params), a); if (e) return e;
+  }
+  if (p->c_coeffs) {
+    e = (*v)(((PyObject *)p->c_coeffs), a); if (e) return e;
+  }
+  if (p->flux_params) {
+    e = (*v)(((PyObject *)p->flux_params), a); if (e) return e;
+  }
+  if (p->dynamics) {
+    e = (*v)(((PyObject *)p->dynamics), a); if (e) return e;
+  }
+  if (p->mode_array) {
+    e = (*v)(p->mode_array, a); if (e) return e;
+  }
+  return 0;
+}
+
+static int __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_EOBParams(PyObject *o) {
+  PyObject* tmp;
+  struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *p = (struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)o;
+  tmp = ((PyObject*)p->p_params);
+  p->p_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->c_coeffs);
+  p->c_coeffs = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->flux_params);
+  p->flux_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->dynamics);
+  p->dynamics = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->mode_array);
+  p->mode_array = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_p_params(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_p_params(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8p_params_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_c_coeffs(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_c_coeffs(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8c_coeffs_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_flux_params(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_flux_params(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_11flux_params_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_dynamics(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_dynamics(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_8dynamics_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_mode_array(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_mode_array(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_3__set__(o, v);
+  }
+  else {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_10mode_array_5__del__(o);
+  }
+}
+
+static PyObject *__pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_aligned(PyObject *o, CYTHON_UNUSED void *x) {
+  return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_1__get__(o);
+}
+
+static int __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_aligned(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
+  if (v) {
+    return __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7aligned_3__set__(o, v);
+  }
+  else {
+    PyErr_SetString(PyExc_NotImplementedError, "__del__");
+    return -1;
+  }
+}
+
+static PyMethodDef __pyx_methods_8pyseobnr_3eob_5utils_10containers_EOBParams[] = {
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_5__reduce_cython__, METH_NOARGS, __pyx_doc_8pyseobnr_3eob_5utils_10containers_9EOBParams_4__reduce_cython__},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_7__setstate_cython__, METH_O, __pyx_doc_8pyseobnr_3eob_5utils_10containers_9EOBParams_6__setstate_cython__},
+  {0, 0, 0, 0}
+};
+
+static struct PyGetSetDef __pyx_getsets_8pyseobnr_3eob_5utils_10containers_EOBParams[] = {
+  {(char *)"p_params", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_p_params, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_p_params, (char *)"p_params: pyseobnr.eob.utils.containers.PhysicalParams", 0},
+  {(char *)"c_coeffs", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_c_coeffs, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_c_coeffs, (char *)"c_coeffs: pyseobnr.eob.utils.containers.CalibCoeffs", 0},
+  {(char *)"flux_params", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_flux_params, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_flux_params, (char *)"flux_params: pyseobnr.eob.utils.containers.FluxParams", 0},
+  {(char *)"dynamics", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_dynamics, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_dynamics, (char *)"dynamics: pyseobnr.eob.utils.containers.Dynamics", 0},
+  {(char *)"mode_array", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_mode_array, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_mode_array, (char *)"mode_array: list", 0},
+  {(char *)"aligned", __pyx_getprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_aligned, __pyx_setprop_8pyseobnr_3eob_5utils_10containers_9EOBParams_aligned, (char *)"aligned: 'bool'", 0},
+  {0, 0, 0, 0, 0}
+};
+
+static PyTypeObject __pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pyseobnr.eob.utils.containers.EOBParams", /*tp_name*/
+  sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  "EOBParams(physical_params, coeffs, aligned=True, extra_PN_terms=True, mode_array=[(2, 2), (2, 1), (3, 3), (3, 2), (4, 4), (4, 3), (5, 5)], special_modes=[(2, 1), (4, 3), (5, 5)])\n\n    A class to hold various EOB related quantities\n    ", /*tp_doc*/
+  __pyx_tp_traverse_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_traverse*/
+  __pyx_tp_clear_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_methods*/
+  0, /*tp_members*/
+  __pyx_getsets_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  __pyx_pw_8pyseobnr_3eob_5utils_10containers_9EOBParams_1__init__, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_8pyseobnr_3eob_5utils_10containers_EOBParams, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -18963,15 +25678,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.array", /*tp_name*/
+  "pyseobnr.eob.utils.containers.array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -19085,15 +25800,15 @@
   {"__reduce_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_1__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw___pyx_MemviewEnum_3__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.Enum", /*tp_name*/
+  "pyseobnr.eob.utils.containers.Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -19349,15 +26064,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C.memoryview", /*tp_name*/
+  "pyseobnr.eob.utils.containers.memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -19490,15 +26205,15 @@
 static struct PyGetSetDef __pyx_getsets__memoryviewslice[] = {
   {(char *)"base", __pyx_getprop___pyx_memoryviewslice_base, 0, (char *)0, 0},
   {0, 0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C._memoryviewslice", /*tp_name*/
+  "pyseobnr.eob.utils.containers._memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -19575,25 +26290,25 @@
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_Hamiltonian_v5PHM_C(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_containers(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_Hamiltonian_v5PHM_C},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_containers},
   {0, NULL}
 };
 #endif
 
 static struct PyModuleDef __pyx_moduledef = {
     PyModuleDef_HEAD_INIT,
-    "Hamiltonian_v5PHM_C",
+    "containers",
     0, /* m_doc */
   #if CYTHON_PEP489_MULTI_PHASE_INIT
     0, /* m_size */
   #else
     -1, /* m_size */
   #endif
     __pyx_methods /* m_methods */,
@@ -19616,121 +26331,138 @@
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s_ASCII, __pyx_k_ASCII, sizeof(__pyx_k_ASCII), 0, 0, 1, 1},
   {&__pyx_kp_s_Buffer_view_does_not_expose_stri, __pyx_k_Buffer_view_does_not_expose_stri, sizeof(__pyx_k_Buffer_view_does_not_expose_stri), 0, 0, 1, 0},
+  {&__pyx_n_s_CalibCoeffs, __pyx_k_CalibCoeffs, sizeof(__pyx_k_CalibCoeffs), 0, 0, 1, 1},
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
+  {&__pyx_n_s_Dynamics, __pyx_k_Dynamics, sizeof(__pyx_k_Dynamics), 0, 0, 1, 1},
   {&__pyx_n_s_EOBParams, __pyx_k_EOBParams, sizeof(__pyx_k_EOBParams), 0, 0, 1, 1},
   {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
   {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
-  {&__pyx_n_s_Hamiltonian_v5PHM_C, __pyx_k_Hamiltonian_v5PHM_C, sizeof(__pyx_k_Hamiltonian_v5PHM_C), 0, 0, 1, 1},
+  {&__pyx_n_s_FluxParams, __pyx_k_FluxParams, sizeof(__pyx_k_FluxParams), 0, 0, 1, 1},
+  {&__pyx_n_u_H_val, __pyx_k_H_val, sizeof(__pyx_k_H_val), 0, 1, 0, 1},
+  {&__pyx_n_s_ImportError, __pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 0, 1, 1},
   {&__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_k_Incompatible_checksums_0x_x_vs_0, sizeof(__pyx_k_Incompatible_checksums_0x_x_vs_0), 0, 0, 1, 0},
   {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
   {&__pyx_kp_s_Indirect_dimensions_not_supporte, __pyx_k_Indirect_dimensions_not_supporte, sizeof(__pyx_k_Indirect_dimensions_not_supporte), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_k_Invalid_mode_expected_c_or_fortr, sizeof(__pyx_k_Invalid_mode_expected_c_or_fortr), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_k_Invalid_shape_in_axis_d_d, sizeof(__pyx_k_Invalid_shape_in_axis_d_d), 0, 0, 1, 0},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_k_MemoryView_of_r_at_0x_x, sizeof(__pyx_k_MemoryView_of_r_at_0x_x), 0, 0, 1, 0},
   {&__pyx_kp_s_MemoryView_of_r_object, __pyx_k_MemoryView_of_r_object, sizeof(__pyx_k_MemoryView_of_r_object), 0, 0, 1, 0},
   {&__pyx_n_b_O, __pyx_k_O, sizeof(__pyx_k_O), 0, 0, 0, 1},
   {&__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_k_Out_of_bounds_on_buffer_access_a, sizeof(__pyx_k_Out_of_bounds_on_buffer_access_a), 0, 0, 1, 0},
+  {&__pyx_n_s_PhysicalParams, __pyx_k_PhysicalParams, sizeof(__pyx_k_PhysicalParams), 0, 0, 1, 1},
   {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
+  {&__pyx_n_u_a1, __pyx_k_a1, sizeof(__pyx_k_a1), 0, 1, 0, 1},
+  {&__pyx_n_u_a2, __pyx_k_a2, sizeof(__pyx_k_a2), 0, 1, 0, 1},
+  {&__pyx_n_s_aligned, __pyx_k_aligned, sizeof(__pyx_k_aligned), 0, 0, 1, 1},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
-  {&__pyx_n_s_aux_derivs, __pyx_k_aux_derivs, sizeof(__pyx_k_aux_derivs), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
-  {&__pyx_n_s_call, __pyx_k_call, sizeof(__pyx_k_call), 0, 0, 1, 1},
-  {&__pyx_n_s_chi1_v, __pyx_k_chi1_v, sizeof(__pyx_k_chi1_v), 0, 0, 1, 1},
-  {&__pyx_n_s_chi2_v, __pyx_k_chi2_v, sizeof(__pyx_k_chi2_v), 0, 0, 1, 1},
-  {&__pyx_n_s_chiL_1, __pyx_k_chiL_1, sizeof(__pyx_k_chiL_1), 0, 0, 1, 1},
-  {&__pyx_n_s_chiL_2, __pyx_k_chiL_2, sizeof(__pyx_k_chiL_2), 0, 0, 1, 1},
+  {&__pyx_n_u_chi1_v, __pyx_k_chi1_v, sizeof(__pyx_k_chi1_v), 0, 1, 0, 1},
+  {&__pyx_n_u_chi2_v, __pyx_k_chi2_v, sizeof(__pyx_k_chi2_v), 0, 1, 0, 1},
   {&__pyx_n_s_chi_1, __pyx_k_chi_1, sizeof(__pyx_k_chi_1), 0, 0, 1, 1},
+  {&__pyx_n_u_chi_1, __pyx_k_chi_1, sizeof(__pyx_k_chi_1), 0, 1, 0, 1},
   {&__pyx_n_s_chi_2, __pyx_k_chi_2, sizeof(__pyx_k_chi_2), 0, 0, 1, 1},
+  {&__pyx_n_u_chi_2, __pyx_k_chi_2, sizeof(__pyx_k_chi_2), 0, 1, 0, 1},
   {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
+  {&__pyx_n_s_coeffs, __pyx_k_coeffs, sizeof(__pyx_k_coeffs), 0, 0, 1, 1},
+  {&__pyx_n_s_complex128, __pyx_k_complex128, sizeof(__pyx_k_complex128), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
-  {&__pyx_n_s_csi, __pyx_k_csi, sizeof(__pyx_k_csi), 0, 0, 1, 1},
+  {&__pyx_n_s_dc, __pyx_k_dc, sizeof(__pyx_k_dc), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
+  {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
-  {&__pyx_n_s_dynamics, __pyx_k_dynamics, sizeof(__pyx_k_dynamics), 0, 0, 1, 1},
   {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
   {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
+  {&__pyx_n_s_extra_PN_terms, __pyx_k_extra_PN_terms, sizeof(__pyx_k_extra_PN_terms), 0, 0, 1, 1},
   {&__pyx_n_s_flags, __pyx_k_flags, sizeof(__pyx_k_flags), 0, 0, 1, 1},
+  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
   {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 0, 1, 0},
-  {&__pyx_n_s_grad, __pyx_k_grad, sizeof(__pyx_k_grad), 0, 0, 1, 1},
-  {&__pyx_n_s_hessian, __pyx_k_hessian, sizeof(__pyx_k_hessian), 0, 0, 1, 1},
   {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
-  {&__pyx_n_s_m_1, __pyx_k_m_1, sizeof(__pyx_k_m_1), 0, 0, 1, 1},
-  {&__pyx_n_s_m_2, __pyx_k_m_2, sizeof(__pyx_k_m_2), 0, 0, 1, 1},
+  {&__pyx_n_u_lN, __pyx_k_lN, sizeof(__pyx_k_lN), 0, 1, 0, 1},
+  {&__pyx_n_u_m_1, __pyx_k_m_1, sizeof(__pyx_k_m_1), 0, 1, 0, 1},
+  {&__pyx_n_u_m_2, __pyx_k_m_2, sizeof(__pyx_k_m_2), 0, 1, 0, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
   {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
+  {&__pyx_n_s_mode_array, __pyx_k_mode_array, sizeof(__pyx_k_mode_array), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
   {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
   {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
   {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
+  {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
+  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
+  {&__pyx_kp_u_numpy_core_multiarray_failed_to, __pyx_k_numpy_core_multiarray_failed_to, sizeof(__pyx_k_numpy_core_multiarray_failed_to), 0, 1, 0, 0},
+  {&__pyx_kp_u_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 1, 0, 0},
   {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
-  {&__pyx_n_s_omega, __pyx_k_omega, sizeof(__pyx_k_omega), 0, 0, 1, 1},
-  {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
+  {&__pyx_n_u_omega, __pyx_k_omega, sizeof(__pyx_k_omega), 0, 1, 0, 1},
   {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
+  {&__pyx_n_s_physical_params, __pyx_k_physical_params, sizeof(__pyx_k_physical_params), 0, 0, 1, 1},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
-  {&__pyx_n_s_q, __pyx_k_q, sizeof(__pyx_k_q), 0, 0, 1, 1},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
   {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
   {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
   {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
   {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
+  {&__pyx_n_s_special_modes, __pyx_k_special_modes, sizeof(__pyx_k_special_modes), 0, 0, 1, 1},
   {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
   {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
   {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
   {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
   {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
   {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
+  {&__pyx_n_s_update_spins, __pyx_k_update_spins, sizeof(__pyx_k_update_spins), 0, 0, 1, 1},
+  {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(3, 944, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 134, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 149, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 152, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 181, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(0, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(0, 615, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(0, 834, __pyx_L1_error)
@@ -19758,288 +26490,430 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__2);
   __Pyx_GIVEREF(__pyx_tuple__2);
 
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__6);
+  __Pyx_GIVEREF(__pyx_tuple__6);
+
+  /* "pyseobnr/eob/utils/containers.pyx":84
+ * cdef class Dynamics:
+ *     def __cinit__(self):
+ *         self.p_circ = np.zeros(2,dtype=np.float64)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_int_2); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(1, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__8);
+  __Pyx_GIVEREF(__pyx_tuple__8);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
+  __Pyx_GIVEREF(__pyx_tuple__14);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
+ *         __pyx_import_array()
+ *     except Exception:
+ *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline int import_umath() except -1:
+ */
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(3, 944, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
+
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
+ *         _import_umath()
+ *     except Exception:
+ *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline int import_ufunc() except -1:
+ */
+  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(3, 950, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
+
   /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 134, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
   /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 137, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__4);
-  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
   /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__5);
-  __Pyx_GIVEREF(__pyx_tuple__5);
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
   /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 177, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__6);
-  __Pyx_GIVEREF(__pyx_tuple__6);
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 177, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
   /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 193, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__8);
-  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__9);
-  __Pyx_GIVEREF(__pyx_tuple__9);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 420, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__10);
-  __Pyx_GIVEREF(__pyx_tuple__10);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 420, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 497, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__11);
-  __Pyx_GIVEREF(__pyx_tuple__11);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 522, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__12);
-  __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 522, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
   /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
   /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__14 = PyTuple_New(1); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 579, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
+  __pyx_tuple__29 = PyTuple_New(1); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__14, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  PyTuple_SET_ITEM(__pyx_tuple__29, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
   /* "View.MemoryView":684
  *         if item is Ellipsis:
  *             if not seen_ellipsis:
  *                 result.extend([slice(None)] * (ndim - len(tup) + 1))             # <<<<<<<<<<<<<<
  *                 seen_ellipsis = True
  *             else:
  */
-  __pyx_slice__17 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__17)) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__17);
-  __Pyx_GIVEREF(__pyx_slice__17);
+  __pyx_slice__32 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__32)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__32);
+  __Pyx_GIVEREF(__pyx_slice__32);
 
   /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 705, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 705, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
-  __pyx_tuple__21 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__35);
+  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__36 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
+
+  /* "pyseobnr/eob/utils/containers.pyx":93
+ *     """
+ *     def __init__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],             # <<<<<<<<<<<<<<
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
+ *         # Needed to get the signature to embed
+ */
+  __pyx_tuple__37 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__38 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  __pyx_tuple__39 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_tuple__40 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_2); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__41 = PyTuple_Pack(2, __pyx_int_4, __pyx_int_4); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_tuple__42 = PyTuple_Pack(2, __pyx_int_4, __pyx_int_3); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  __pyx_tuple__43 = PyTuple_Pack(2, __pyx_int_5, __pyx_int_5); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__27 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
-  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_codeobj__50 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
-  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_5 = PyInt_FromLong(5); if (unlikely(!__pyx_int_5)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
 static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
@@ -20081,33 +26955,68 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C__call;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_grad;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_hessian;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.csi = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_csi;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_dynamics;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.omega = (double (*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_omega;
-  __pyx_vtable_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.aux_derivs = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_19Hamiltonian_v5PHM_C_aux_derivs;
-  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = &__pyx_vtable_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+  __pyx_vtable_8pyseobnr_3eob_5utils_10containers_PhysicalParams.update_spins = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams_update_spins;
+  __pyx_vtable_8pyseobnr_3eob_5utils_10containers_PhysicalParams._compute_derived_quants = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *))__pyx_f_8pyseobnr_3eob_5utils_10containers_14PhysicalParams__compute_derived_quants;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams) < 0) __PYX_ERR(1, 6, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams.tp_dictoffset && __pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (__Pyx_SetVtable(__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams.tp_dict, __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams) < 0) __PYX_ERR(1, 6, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PhysicalParams, (PyObject *)&__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams) < 0) __PYX_ERR(1, 6, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams) < 0) __PYX_ERR(1, 6, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = &__pyx_type_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) < 0) __PYX_ERR(1, 53, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs.tp_dictoffset && __pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_CalibCoeffs, (PyObject *)&__pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) < 0) __PYX_ERR(1, 53, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) < 0) __PYX_ERR(1, 53, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = &__pyx_type_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics) < 0) __PYX_ERR(1, 82, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics.tp_dictoffset && __pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Dynamics, (PyObject *)&__pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics) < 0) __PYX_ERR(1, 82, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics) < 0) __PYX_ERR(1, 82, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = &__pyx_type_8pyseobnr_3eob_5utils_10containers_Dynamics;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams) < 0) __PYX_ERR(1, 62, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams.tp_dictoffset && __pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_FluxParams, (PyObject *)&__pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams) < 0) __PYX_ERR(1, 62, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams) < 0) __PYX_ERR(1, 62, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = &__pyx_type_8pyseobnr_3eob_5utils_10containers_FluxParams;
+  if (PyType_Ready(&__pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams) < 0) __PYX_ERR(1, 88, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_print = 0;
+  __pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_dictoffset && __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams.tp_dictoffset && __pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C.tp_dict, __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Hamiltonian_v5PHM_C, (PyObject *)&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = &__pyx_type_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_EOBParams, (PyObject *)&__pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams) < 0) __PYX_ERR(1, 88, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams) < 0) __PYX_ERR(1, 88, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = &__pyx_type_8pyseobnr_3eob_5utils_10containers_EOBParams;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
   if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
@@ -20166,27 +27075,72 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 9, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
+  #else
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
+  #endif
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
+   if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(3, 199, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
+   if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(3, 222, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
+   if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(3, 226, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
+   if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(3, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_generic) __PYX_ERR(3, 770, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_number) __PYX_ERR(3, 772, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_integer) __PYX_ERR(3, 774, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(3, 776, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(3, 778, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(3, 780, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_floating) __PYX_ERR(3, 782, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(3, 784, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(3, 786, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_character) __PYX_ERR(3, 788, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
+   if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(3, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -20223,19 +27177,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC initHamiltonian_v5PHM_C(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC initHamiltonian_v5PHM_C(void)
+__Pyx_PyMODINIT_FUNC initcontainers(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initcontainers(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void)
+__Pyx_PyMODINIT_FUNC PyInit_containers(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_containers(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -20294,133 +27248,258 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_Hamiltonian_v5PHM_C(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_containers(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   static PyThread_type_lock __pyx_t_2[8];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'Hamiltonian_v5PHM_C' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'containers' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   #if CYTHON_REFNANNY
 __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_Hamiltonian_v5PHM_C(void)", 0);
-  if (__Pyx_check_binary_version() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_containers(void)", 0);
+  if (__Pyx_check_binary_version() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
-  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(1, 2, __pyx_L1_error)
   #ifdef __Pyx_CyFunction_USED
-  if (__pyx_CyFunction_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_CyFunction_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   #ifdef __Pyx_FusedFunction_USED
-  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   #ifdef __Pyx_Coroutine_USED
-  if (__pyx_Coroutine_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_Coroutine_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   #ifdef __Pyx_Generator_USED
-  if (__pyx_Generator_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_Generator_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   #ifdef __Pyx_AsyncGen_USED
-  if (__pyx_AsyncGen_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_AsyncGen_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   #ifdef __Pyx_StopAsyncIteration_USED
-  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
   #if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0 && defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
   PyEval_InitThreads();
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("Hamiltonian_v5PHM_C", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("containers", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
-  if (unlikely(!__pyx_m)) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (unlikely(!__pyx_m)) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
-  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(1, 2, __pyx_L1_error)
   Py_INCREF(__pyx_d);
-  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(1, 2, __pyx_L1_error)
   Py_INCREF(__pyx_b);
-  __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(1, 2, __pyx_L1_error)
   Py_INCREF(__pyx_cython_runtime);
-  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   /*--- Initialize various global constants etc. ---*/
-  if (__Pyx_InitGlobals() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_InitGlobals() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
-  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_pyseobnr__eob__hamiltonian__Hamiltonian_v5PHM_C) {
-    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__pyx_module_is_main_pyseobnr__eob__utils__containers) {
+    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
-    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(1, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C")) {
-      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", __pyx_m) < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
+    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(1, 2, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "pyseobnr.eob.utils.containers")) {
+      if (unlikely(PyDict_SetItemString(modules, "pyseobnr.eob.utils.containers", __pyx_m) < 0)) __PYX_ERR(1, 2, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
-  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   /*--- Constants init code ---*/
-  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   /*--- Global type/function init code ---*/
   (void)__Pyx_modinit_global_init_code();
   (void)__Pyx_modinit_variable_export_code();
   (void)__Pyx_modinit_function_export_code();
-  if (unlikely(__Pyx_modinit_type_init_code() < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
-  if (unlikely(__Pyx_modinit_type_import_code() < 0)) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (unlikely(__Pyx_modinit_type_init_code() < 0)) __PYX_ERR(1, 2, __pyx_L1_error)
+  if (unlikely(__Pyx_modinit_type_import_code() < 0)) __PYX_ERR(1, 2, __pyx_L1_error)
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
-  if (__Pyx_patch_abc() < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_patch_abc() < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   #endif
 
-  /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx":1
- * cimport cython             # <<<<<<<<<<<<<<
- * from pyseobnr.eob.utils.containers cimport EOBParams
+  /* "pyseobnr/eob/utils/containers.pyx":4
+ * cimport cython
+ * cimport numpy as np
+ * import numpy as np             # <<<<<<<<<<<<<<
+ * 
+ * cdef class PhysicalParams:
+ */
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":93
+ *     """
+ *     def __init__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],             # <<<<<<<<<<<<<<
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
+ *         # Needed to get the signature to embed
+ */
+  __pyx_t_1 = PyList_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_tuple__37);
+  __Pyx_INCREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_tuple__38);
+  __Pyx_INCREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_tuple__39);
+  __Pyx_INCREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
+  PyList_SET_ITEM(__pyx_t_1, 3, __pyx_tuple__40);
+  __Pyx_INCREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
+  PyList_SET_ITEM(__pyx_t_1, 4, __pyx_tuple__41);
+  __Pyx_INCREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  PyList_SET_ITEM(__pyx_t_1, 5, __pyx_tuple__42);
+  __Pyx_INCREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  PyList_SET_ITEM(__pyx_t_1, 6, __pyx_tuple__43);
+  __pyx_k__10 = __pyx_t_1;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":94
+ *     def __init__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],
+ *                 special_modes=[(2,1),(4,3),(5,5)]):             # <<<<<<<<<<<<<<
+ *         # Needed to get the signature to embed
+ *         pass
+ */
+  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_tuple__38);
+  __Pyx_INCREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_tuple__42);
+  __Pyx_INCREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_tuple__43);
+  __pyx_k__11 = __pyx_t_1;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":99
+ * 
+ *     def __cinit__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],             # <<<<<<<<<<<<<<
+ *                 special_modes=[(2,1),(4,3),(5,5)]):
+ *         # Physical params (e.g. spins)
+ */
+  __pyx_t_1 = PyList_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 99, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_tuple__37);
+  __Pyx_INCREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_tuple__38);
+  __Pyx_INCREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_tuple__39);
+  __Pyx_INCREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
+  PyList_SET_ITEM(__pyx_t_1, 3, __pyx_tuple__40);
+  __Pyx_INCREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
+  PyList_SET_ITEM(__pyx_t_1, 4, __pyx_tuple__41);
+  __Pyx_INCREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  PyList_SET_ITEM(__pyx_t_1, 5, __pyx_tuple__42);
+  __Pyx_INCREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  PyList_SET_ITEM(__pyx_t_1, 6, __pyx_tuple__43);
+  __pyx_k__12 = __pyx_t_1;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":100
+ *     def __cinit__(self,physical_params,coeffs,aligned=True,extra_PN_terms=True,
+ *                 mode_array=[(2,2),(2,1),(3,3),(3,2),(4,4),(4,3),(5,5)],
+ *                 special_modes=[(2,1),(4,3),(5,5)]):             # <<<<<<<<<<<<<<
+ *         # Physical params (e.g. spins)
+ *         self.p_params = PhysicalParams(physical_params)
+ */
+  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 100, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_tuple__38);
+  __Pyx_INCREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_tuple__42);
+  __Pyx_INCREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_tuple__43);
+  __pyx_k__13 = __pyx_t_1;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyseobnr/eob/utils/containers.pyx":2
  * 
+ * cimport cython             # <<<<<<<<<<<<<<
+ * cimport numpy as np
+ * import numpy as np
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "View.MemoryView":210
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
@@ -20435,71 +27514,71 @@
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(generic);
   __Pyx_DECREF_SET(generic, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(strided);
   __Pyx_DECREF_SET(strided, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect);
   __Pyx_DECREF_SET(indirect, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(contiguous);
   __Pyx_DECREF_SET(contiguous, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect_contiguous);
   __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "View.MemoryView":317
@@ -20575,19 +27654,19 @@
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init pyseobnr.eob.utils.containers", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C");
+    PyErr_SetString(PyExc_ImportError, "init pyseobnr.eob.utils.containers");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -20780,14 +27859,191 @@
     }
     PyErr_Format(PyExc_TypeError,
                  "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                  func_name, more_or_less, num_expected,
                  (num_expected == 1) ? "" : "s", num_found);
 }
 
+/* ArgTypeTest */
+static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
+{
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    else if (exact) {
+        #if PY_MAJOR_VERSION == 2
+        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
+        #endif
+    }
+    else {
+        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
+    }
+    PyErr_Format(PyExc_TypeError,
+        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
+        name, type->tp_name, Py_TYPE(obj)->tp_name);
+    return 0;
+}
+
+/* DictGetItem */
+#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
+    PyObject *value;
+    value = PyDict_GetItemWithError(d, key);
+    if (unlikely(!value)) {
+        if (!PyErr_Occurred()) {
+            if (unlikely(PyTuple_Check(key))) {
+                PyObject* args = PyTuple_Pack(1, key);
+                if (likely(args)) {
+                    PyErr_SetObject(PyExc_KeyError, args);
+                    Py_DECREF(args);
+                }
+            } else {
+                PyErr_SetObject(PyExc_KeyError, key);
+            }
+        }
+        return NULL;
+    }
+    Py_INCREF(value);
+    return value;
+}
+#endif
+
+/* MemviewSliceInit */
+static int
+__Pyx_init_memviewslice(struct __pyx_memoryview_obj *memview,
+                        int ndim,
+                        __Pyx_memviewslice *memviewslice,
+                        int memview_is_new_reference)
+{
+    __Pyx_RefNannyDeclarations
+    int i, retval=-1;
+    Py_buffer *buf = &memview->view;
+    __Pyx_RefNannySetupContext("init_memviewslice", 0);
+    if (unlikely(memviewslice->memview || memviewslice->data)) {
+        PyErr_SetString(PyExc_ValueError,
+            "memviewslice is already initialized!");
+        goto fail;
+    }
+    if (buf->strides) {
+        for (i = 0; i < ndim; i++) {
+            memviewslice->strides[i] = buf->strides[i];
+        }
+    } else {
+        Py_ssize_t stride = buf->itemsize;
+        for (i = ndim - 1; i >= 0; i--) {
+            memviewslice->strides[i] = stride;
+            stride *= buf->shape[i];
+        }
+    }
+    for (i = 0; i < ndim; i++) {
+        memviewslice->shape[i]   = buf->shape[i];
+        if (buf->suboffsets) {
+            memviewslice->suboffsets[i] = buf->suboffsets[i];
+        } else {
+            memviewslice->suboffsets[i] = -1;
+        }
+    }
+    memviewslice->memview = memview;
+    memviewslice->data = (char *)buf->buf;
+    if (__pyx_add_acquisition_count(memview) == 0 && !memview_is_new_reference) {
+        Py_INCREF(memview);
+    }
+    retval = 0;
+    goto no_fail;
+fail:
+    memviewslice->memview = 0;
+    memviewslice->data = 0;
+    retval = -1;
+no_fail:
+    __Pyx_RefNannyFinishContext();
+    return retval;
+}
+#ifndef Py_NO_RETURN
+#define Py_NO_RETURN
+#endif
+static void __pyx_fatalerror(const char *fmt, ...) Py_NO_RETURN {
+    va_list vargs;
+    char msg[200];
+#if PY_VERSION_HEX >= 0x030A0000 || defined(HAVE_STDARG_PROTOTYPES)
+    va_start(vargs, fmt);
+#else
+    va_start(vargs);
+#endif
+    vsnprintf(msg, 200, fmt, vargs);
+    va_end(vargs);
+    Py_FatalError(msg);
+}
+static CYTHON_INLINE int
+__pyx_add_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
+                                   PyThread_type_lock lock)
+{
+    int result;
+    PyThread_acquire_lock(lock, 1);
+    result = (*acquisition_count)++;
+    PyThread_release_lock(lock);
+    return result;
+}
+static CYTHON_INLINE int
+__pyx_sub_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
+                                   PyThread_type_lock lock)
+{
+    int result;
+    PyThread_acquire_lock(lock, 1);
+    result = (*acquisition_count)--;
+    PyThread_release_lock(lock);
+    return result;
+}
+static CYTHON_INLINE void
+__Pyx_INC_MEMVIEW(__Pyx_memviewslice *memslice, int have_gil, int lineno)
+{
+    int first_time;
+    struct __pyx_memoryview_obj *memview = memslice->memview;
+    if (unlikely(!memview || (PyObject *) memview == Py_None))
+        return;
+    if (unlikely(__pyx_get_slice_count(memview) < 0))
+        __pyx_fatalerror("Acquisition count is %d (line %d)",
+                         __pyx_get_slice_count(memview), lineno);
+    first_time = __pyx_add_acquisition_count(memview) == 0;
+    if (unlikely(first_time)) {
+        if (have_gil) {
+            Py_INCREF((PyObject *) memview);
+        } else {
+            PyGILState_STATE _gilstate = PyGILState_Ensure();
+            Py_INCREF((PyObject *) memview);
+            PyGILState_Release(_gilstate);
+        }
+    }
+}
+static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *memslice,
+                                             int have_gil, int lineno) {
+    int last_time;
+    struct __pyx_memoryview_obj *memview = memslice->memview;
+    if (unlikely(!memview || (PyObject *) memview == Py_None)) {
+        memslice->memview = NULL;
+        return;
+    }
+    if (unlikely(__pyx_get_slice_count(memview) <= 0))
+        __pyx_fatalerror("Acquisition count is %d (line %d)",
+                         __pyx_get_slice_count(memview), lineno);
+    last_time = __pyx_sub_acquisition_count(memview) == 1;
+    memslice->data = NULL;
+    if (unlikely(last_time)) {
+        if (have_gil) {
+            Py_CLEAR(memslice->memview);
+        } else {
+            PyGILState_STATE _gilstate = PyGILState_Ensure();
+            Py_CLEAR(memslice->memview);
+            PyGILState_Release(_gilstate);
+        }
+    } else {
+        memslice->memview = NULL;
+    }
+}
+
 /* PyDictVersioning */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
     PyObject *dict = Py_TYPE(obj)->tp_dict;
     return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
 }
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
@@ -20806,19 +28062,14 @@
     PyObject *dict = Py_TYPE(obj)->tp_dict;
     if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
         return 0;
     return obj_dict_version == __Pyx_get_object_dict_version(obj);
 }
 #endif
 
-/* None */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
-    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
-}
-
 /* PyFunctionFastCall */
 #if CYTHON_FAST_PYCALL
 static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
                                                PyObject *globals) {
     PyFrameObject *f;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
     PyObject **fastlocals;
@@ -20973,146 +28224,14 @@
             PyExc_SystemError,
             "NULL result without error in PyObject_Call");
     }
     return result;
 }
 #endif
 
-/* MemviewSliceInit */
-static int
-__Pyx_init_memviewslice(struct __pyx_memoryview_obj *memview,
-                        int ndim,
-                        __Pyx_memviewslice *memviewslice,
-                        int memview_is_new_reference)
-{
-    __Pyx_RefNannyDeclarations
-    int i, retval=-1;
-    Py_buffer *buf = &memview->view;
-    __Pyx_RefNannySetupContext("init_memviewslice", 0);
-    if (unlikely(memviewslice->memview || memviewslice->data)) {
-        PyErr_SetString(PyExc_ValueError,
-            "memviewslice is already initialized!");
-        goto fail;
-    }
-    if (buf->strides) {
-        for (i = 0; i < ndim; i++) {
-            memviewslice->strides[i] = buf->strides[i];
-        }
-    } else {
-        Py_ssize_t stride = buf->itemsize;
-        for (i = ndim - 1; i >= 0; i--) {
-            memviewslice->strides[i] = stride;
-            stride *= buf->shape[i];
-        }
-    }
-    for (i = 0; i < ndim; i++) {
-        memviewslice->shape[i]   = buf->shape[i];
-        if (buf->suboffsets) {
-            memviewslice->suboffsets[i] = buf->suboffsets[i];
-        } else {
-            memviewslice->suboffsets[i] = -1;
-        }
-    }
-    memviewslice->memview = memview;
-    memviewslice->data = (char *)buf->buf;
-    if (__pyx_add_acquisition_count(memview) == 0 && !memview_is_new_reference) {
-        Py_INCREF(memview);
-    }
-    retval = 0;
-    goto no_fail;
-fail:
-    memviewslice->memview = 0;
-    memviewslice->data = 0;
-    retval = -1;
-no_fail:
-    __Pyx_RefNannyFinishContext();
-    return retval;
-}
-#ifndef Py_NO_RETURN
-#define Py_NO_RETURN
-#endif
-static void __pyx_fatalerror(const char *fmt, ...) Py_NO_RETURN {
-    va_list vargs;
-    char msg[200];
-#if PY_VERSION_HEX >= 0x030A0000 || defined(HAVE_STDARG_PROTOTYPES)
-    va_start(vargs, fmt);
-#else
-    va_start(vargs);
-#endif
-    vsnprintf(msg, 200, fmt, vargs);
-    va_end(vargs);
-    Py_FatalError(msg);
-}
-static CYTHON_INLINE int
-__pyx_add_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
-                                   PyThread_type_lock lock)
-{
-    int result;
-    PyThread_acquire_lock(lock, 1);
-    result = (*acquisition_count)++;
-    PyThread_release_lock(lock);
-    return result;
-}
-static CYTHON_INLINE int
-__pyx_sub_acquisition_count_locked(__pyx_atomic_int *acquisition_count,
-                                   PyThread_type_lock lock)
-{
-    int result;
-    PyThread_acquire_lock(lock, 1);
-    result = (*acquisition_count)--;
-    PyThread_release_lock(lock);
-    return result;
-}
-static CYTHON_INLINE void
-__Pyx_INC_MEMVIEW(__Pyx_memviewslice *memslice, int have_gil, int lineno)
-{
-    int first_time;
-    struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (unlikely(!memview || (PyObject *) memview == Py_None))
-        return;
-    if (unlikely(__pyx_get_slice_count(memview) < 0))
-        __pyx_fatalerror("Acquisition count is %d (line %d)",
-                         __pyx_get_slice_count(memview), lineno);
-    first_time = __pyx_add_acquisition_count(memview) == 0;
-    if (unlikely(first_time)) {
-        if (have_gil) {
-            Py_INCREF((PyObject *) memview);
-        } else {
-            PyGILState_STATE _gilstate = PyGILState_Ensure();
-            Py_INCREF((PyObject *) memview);
-            PyGILState_Release(_gilstate);
-        }
-    }
-}
-static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *memslice,
-                                             int have_gil, int lineno) {
-    int last_time;
-    struct __pyx_memoryview_obj *memview = memslice->memview;
-    if (unlikely(!memview || (PyObject *) memview == Py_None)) {
-        memslice->memview = NULL;
-        return;
-    }
-    if (unlikely(__pyx_get_slice_count(memview) <= 0))
-        __pyx_fatalerror("Acquisition count is %d (line %d)",
-                         __pyx_get_slice_count(memview), lineno);
-    last_time = __pyx_sub_acquisition_count(memview) == 1;
-    memslice->data = NULL;
-    if (unlikely(last_time)) {
-        if (have_gil) {
-            Py_CLEAR(memslice->memview);
-        } else {
-            PyGILState_STATE _gilstate = PyGILState_Ensure();
-            Py_CLEAR(memslice->memview);
-            PyGILState_Release(_gilstate);
-        }
-    } else {
-        memslice->memview = NULL;
-    }
-}
-
 /* PyErrFetchRestore */
 #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     tmp_type = tstate->curexc_type;
     tmp_value = tstate->curexc_value;
     tmp_tb = tstate->curexc_traceback;
@@ -21129,67 +28248,14 @@
     *tb = tstate->curexc_traceback;
     tstate->curexc_type = 0;
     tstate->curexc_value = 0;
     tstate->curexc_traceback = 0;
 }
 #endif
 
-/* WriteUnraisableException */
-static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
-                                  CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename,
-                                  int full_traceback, CYTHON_UNUSED int nogil) {
-    PyObject *old_exc, *old_val, *old_tb;
-    PyObject *ctx;
-    __Pyx_PyThreadState_declare
-#ifdef WITH_THREAD
-    PyGILState_STATE state;
-    if (nogil)
-        state = PyGILState_Ensure();
-    else state = (PyGILState_STATE)0;
-#endif
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
-    if (full_traceback) {
-        Py_XINCREF(old_exc);
-        Py_XINCREF(old_val);
-        Py_XINCREF(old_tb);
-        __Pyx_ErrRestore(old_exc, old_val, old_tb);
-        PyErr_PrintEx(1);
-    }
-    #if PY_MAJOR_VERSION < 3
-    ctx = PyString_FromString(name);
-    #else
-    ctx = PyUnicode_FromString(name);
-    #endif
-    __Pyx_ErrRestore(old_exc, old_val, old_tb);
-    if (!ctx) {
-        PyErr_WriteUnraisable(Py_None);
-    } else {
-        PyErr_WriteUnraisable(ctx);
-        Py_DECREF(ctx);
-    }
-#ifdef WITH_THREAD
-    if (nogil)
-        PyGILState_Release(state);
-#endif
-}
-
-/* ExtTypeTest */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
-    }
-    if (likely(__Pyx_TypeCheck(obj, type)))
-        return 1;
-    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
-                 Py_TYPE(obj)->tp_name, type->tp_name);
-    return 0;
-}
-
 /* RaiseException */
 #if PY_MAJOR_VERSION < 3
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                         CYTHON_UNUSED PyObject *cause) {
     __Pyx_PyThreadState_declare
     Py_XINCREF(type);
     if (!value || value == Py_None)
@@ -21319,84 +28385,109 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
 
-/* ArgTypeTest */
-static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
+/* GetModuleGlobalName */
+#if CYTHON_USE_DICT_VERSIONS
+static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
+#else
+static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
+#endif
 {
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
+    PyObject *result;
+#if !CYTHON_AVOID_BORROWED_REFS
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
+    result = _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *) name)->hash);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
+    } else if (unlikely(PyErr_Occurred())) {
+        return NULL;
     }
-    else if (exact) {
-        #if PY_MAJOR_VERSION == 2
-        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
-        #endif
+#else
+    result = PyDict_GetItem(__pyx_d, name);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
     }
-    else {
-        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
+#endif
+#else
+    result = PyObject_GetItem(__pyx_d, name);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
     }
-    PyErr_Format(PyExc_TypeError,
-        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
-        name, type->tp_name, Py_TYPE(obj)->tp_name);
-    return 0;
+    PyErr_Clear();
+#endif
+    return __Pyx_GetBuiltinName(name);
 }
 
-/* PyObjectCall2Args */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
-    PyObject *args, *result = NULL;
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyFunction_FastCall(function, args, 2);
-    }
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyCFunction_FastCall(function, args, 2);
+/* KeywordStringCheck */
+static int __Pyx_CheckKeywordStrings(
+    PyObject *kwdict,
+    const char* function_name,
+    int kw_allowed)
+{
+    PyObject* key = 0;
+    Py_ssize_t pos = 0;
+#if CYTHON_COMPILING_IN_PYPY
+    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
+        goto invalid_keyword;
+    return 1;
+#else
+    while (PyDict_Next(kwdict, &pos, &key, 0)) {
+        #if PY_MAJOR_VERSION < 3
+        if (unlikely(!PyString_Check(key)))
+        #endif
+            if (unlikely(!PyUnicode_Check(key)))
+                goto invalid_keyword_type;
     }
+    if ((!kw_allowed) && unlikely(key))
+        goto invalid_keyword;
+    return 1;
+invalid_keyword_type:
+    PyErr_Format(PyExc_TypeError,
+        "%.200s() keywords must be strings", function_name);
+    return 0;
+#endif
+invalid_keyword:
+    PyErr_Format(PyExc_TypeError,
+    #if PY_MAJOR_VERSION < 3
+        "%.200s() got an unexpected keyword argument '%.200s'",
+        function_name, PyString_AsString(key));
+    #else
+        "%s() got an unexpected keyword argument '%U'",
+        function_name, key);
     #endif
-    args = PyTuple_New(2);
-    if (unlikely(!args)) goto done;
-    Py_INCREF(arg1);
-    PyTuple_SET_ITEM(args, 0, arg1);
-    Py_INCREF(arg2);
-    PyTuple_SET_ITEM(args, 1, arg2);
-    Py_INCREF(function);
-    result = __Pyx_PyObject_Call(function, args, NULL);
-    Py_DECREF(args);
-    Py_DECREF(function);
-done:
-    return result;
+    return 0;
 }
 
 /* PyObjectCallMethO */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
     PyObject *self, *result;
     PyCFunction cfunc;
@@ -21451,14 +28542,233 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
+/* PyObjectCallNoArg */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, NULL, 0);
+    }
+#endif
+#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
+    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
+#else
+    if (likely(PyCFunction_Check(func)))
+#endif
+    {
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
+            return __Pyx_PyObject_CallMethO(func, NULL);
+        }
+    }
+    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
+}
+#endif
+
+/* ExtTypeTest */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    if (likely(__Pyx_TypeCheck(obj, type)))
+        return 1;
+    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
+                 Py_TYPE(obj)->tp_name, type->tp_name);
+    return 0;
+}
+
+/* GetTopmostException */
+#if CYTHON_USE_EXC_INFO_STACK
+static _PyErr_StackItem *
+__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
+{
+    _PyErr_StackItem *exc_info = tstate->exc_info;
+    while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
+           exc_info->previous_item != NULL)
+    {
+        exc_info = exc_info->previous_item;
+    }
+    return exc_info;
+}
+#endif
+
+/* SaveResetException */
+#if CYTHON_FAST_THREAD_STATE
+static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
+    #if CYTHON_USE_EXC_INFO_STACK
+    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
+    *type = exc_info->exc_type;
+    *value = exc_info->exc_value;
+    *tb = exc_info->exc_traceback;
+    #else
+    *type = tstate->exc_type;
+    *value = tstate->exc_value;
+    *tb = tstate->exc_traceback;
+    #endif
+    Py_XINCREF(*type);
+    Py_XINCREF(*value);
+    Py_XINCREF(*tb);
+}
+static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    #if CYTHON_USE_EXC_INFO_STACK
+    _PyErr_StackItem *exc_info = tstate->exc_info;
+    tmp_type = exc_info->exc_type;
+    tmp_value = exc_info->exc_value;
+    tmp_tb = exc_info->exc_traceback;
+    exc_info->exc_type = type;
+    exc_info->exc_value = value;
+    exc_info->exc_traceback = tb;
+    #else
+    tmp_type = tstate->exc_type;
+    tmp_value = tstate->exc_value;
+    tmp_tb = tstate->exc_traceback;
+    tstate->exc_type = type;
+    tstate->exc_value = value;
+    tstate->exc_traceback = tb;
+    #endif
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+}
+#endif
+
+/* PyErrExceptionMatches */
+#if CYTHON_FAST_THREAD_STATE
+static int __Pyx_PyErr_ExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
+    Py_ssize_t i, n;
+    n = PyTuple_GET_SIZE(tuple);
+#if PY_MAJOR_VERSION >= 3
+    for (i=0; i<n; i++) {
+        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
+    }
+#endif
+    for (i=0; i<n; i++) {
+        if (__Pyx_PyErr_GivenExceptionMatches(exc_type, PyTuple_GET_ITEM(tuple, i))) return 1;
+    }
+    return 0;
+}
+static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err) {
+    PyObject *exc_type = tstate->curexc_type;
+    if (exc_type == err) return 1;
+    if (unlikely(!exc_type)) return 0;
+    if (unlikely(PyTuple_Check(err)))
+        return __Pyx_PyErr_ExceptionMatchesTuple(exc_type, err);
+    return __Pyx_PyErr_GivenExceptionMatches(exc_type, err);
+}
+#endif
+
+/* GetException */
+#if CYTHON_FAST_THREAD_STATE
+static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
+#else
+static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
+#endif
+{
+    PyObject *local_type, *local_value, *local_tb;
+#if CYTHON_FAST_THREAD_STATE
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    local_type = tstate->curexc_type;
+    local_value = tstate->curexc_value;
+    local_tb = tstate->curexc_traceback;
+    tstate->curexc_type = 0;
+    tstate->curexc_value = 0;
+    tstate->curexc_traceback = 0;
+#else
+    PyErr_Fetch(&local_type, &local_value, &local_tb);
+#endif
+    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
+#if CYTHON_FAST_THREAD_STATE
+    if (unlikely(tstate->curexc_type))
+#else
+    if (unlikely(PyErr_Occurred()))
+#endif
+        goto bad;
+    #if PY_MAJOR_VERSION >= 3
+    if (local_tb) {
+        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
+            goto bad;
+    }
+    #endif
+    Py_XINCREF(local_tb);
+    Py_XINCREF(local_type);
+    Py_XINCREF(local_value);
+    *type = local_type;
+    *value = local_value;
+    *tb = local_tb;
+#if CYTHON_FAST_THREAD_STATE
+    #if CYTHON_USE_EXC_INFO_STACK
+    {
+        _PyErr_StackItem *exc_info = tstate->exc_info;
+        tmp_type = exc_info->exc_type;
+        tmp_value = exc_info->exc_value;
+        tmp_tb = exc_info->exc_traceback;
+        exc_info->exc_type = local_type;
+        exc_info->exc_value = local_value;
+        exc_info->exc_traceback = local_tb;
+    }
+    #else
+    tmp_type = tstate->exc_type;
+    tmp_value = tstate->exc_value;
+    tmp_tb = tstate->exc_traceback;
+    tstate->exc_type = local_type;
+    tstate->exc_value = local_value;
+    tstate->exc_traceback = local_tb;
+    #endif
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+#else
+    PyErr_SetExcInfo(local_type, local_value, local_tb);
+#endif
+    return 0;
+bad:
+    *type = 0;
+    *value = 0;
+    *tb = 0;
+    Py_XDECREF(local_type);
+    Py_XDECREF(local_value);
+    Py_XDECREF(local_tb);
+    return -1;
+}
+
+/* PyObjectCall2Args */
+static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
+    PyObject *args, *result = NULL;
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(function)) {
+        PyObject *args[2] = {arg1, arg2};
+        return __Pyx_PyFunction_FastCall(function, args, 2);
+    }
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(function)) {
+        PyObject *args[2] = {arg1, arg2};
+        return __Pyx_PyCFunction_FastCall(function, args, 2);
+    }
+    #endif
+    args = PyTuple_New(2);
+    if (unlikely(!args)) goto done;
+    Py_INCREF(arg1);
+    PyTuple_SET_ITEM(args, 0, arg1);
+    Py_INCREF(arg2);
+    PyTuple_SET_ITEM(args, 1, arg2);
+    Py_INCREF(function);
+    result = __Pyx_PyObject_Call(function, args, NULL);
+    Py_DECREF(args);
+    Py_DECREF(function);
+done:
+    return result;
+}
+
 /* BytesEquals */
 static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
 #if CYTHON_COMPILING_IN_PYPY
     return PyObject_RichCompareBool(s1, s2, equals);
 #else
     if (s1 == s2) {
         return (equals == Py_EQ);
@@ -21770,39 +29080,14 @@
     if (decode_func) {
         return decode_func(cstring, length, errors);
     } else {
         return PyUnicode_Decode(cstring, length, encoding, errors);
     }
 }
 
-/* PyErrExceptionMatches */
-#if CYTHON_FAST_THREAD_STATE
-static int __Pyx_PyErr_ExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
-    Py_ssize_t i, n;
-    n = PyTuple_GET_SIZE(tuple);
-#if PY_MAJOR_VERSION >= 3
-    for (i=0; i<n; i++) {
-        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
-    }
-#endif
-    for (i=0; i<n; i++) {
-        if (__Pyx_PyErr_GivenExceptionMatches(exc_type, PyTuple_GET_ITEM(tuple, i))) return 1;
-    }
-    return 0;
-}
-static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err) {
-    PyObject *exc_type = tstate->curexc_type;
-    if (exc_type == err) return 1;
-    if (unlikely(!exc_type)) return 0;
-    if (unlikely(PyTuple_Check(err)))
-        return __Pyx_PyErr_ExceptionMatchesTuple(exc_type, err);
-    return __Pyx_PyErr_GivenExceptionMatches(exc_type, err);
-}
-#endif
-
 /* GetAttr3 */
 static PyObject *__Pyx_GetAttr3Default(PyObject *d) {
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     if (unlikely(!__Pyx_PyErr_ExceptionMatches(PyExc_AttributeError)))
         return NULL;
     __Pyx_PyErr_Clear();
@@ -21810,49 +29095,14 @@
     return d;
 }
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *o, PyObject *n, PyObject *d) {
     PyObject *r = __Pyx_GetAttr(o, n);
     return (likely(r)) ? r : __Pyx_GetAttr3Default(d);
 }
 
-/* GetModuleGlobalName */
-#if CYTHON_USE_DICT_VERSIONS
-static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
-#else
-static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
-#endif
-{
-    PyObject *result;
-#if !CYTHON_AVOID_BORROWED_REFS
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
-    result = _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *) name)->hash);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    } else if (unlikely(PyErr_Occurred())) {
-        return NULL;
-    }
-#else
-    result = PyDict_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-#endif
-#else
-    result = PyObject_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-    PyErr_Clear();
-#endif
-    return __Pyx_GetBuiltinName(name);
-}
-
 /* RaiseTooManyValuesToUnpack */
 static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
     PyErr_Format(PyExc_ValueError,
                  "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
 }
 
 /* RaiseNeedMoreValuesToUnpack */
@@ -21863,144 +29113,14 @@
 }
 
 /* RaiseNoneIterError */
 static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
 }
 
-/* GetTopmostException */
-#if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem *
-__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
-{
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
-           exc_info->previous_item != NULL)
-    {
-        exc_info = exc_info->previous_item;
-    }
-    return exc_info;
-}
-#endif
-
-/* SaveResetException */
-#if CYTHON_FAST_THREAD_STATE
-static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
-    *type = exc_info->exc_type;
-    *value = exc_info->exc_value;
-    *tb = exc_info->exc_traceback;
-    #else
-    *type = tstate->exc_type;
-    *value = tstate->exc_value;
-    *tb = tstate->exc_traceback;
-    #endif
-    Py_XINCREF(*type);
-    Py_XINCREF(*value);
-    Py_XINCREF(*tb);
-}
-static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    tmp_type = exc_info->exc_type;
-    tmp_value = exc_info->exc_value;
-    tmp_tb = exc_info->exc_traceback;
-    exc_info->exc_type = type;
-    exc_info->exc_value = value;
-    exc_info->exc_traceback = tb;
-    #else
-    tmp_type = tstate->exc_type;
-    tmp_value = tstate->exc_value;
-    tmp_tb = tstate->exc_traceback;
-    tstate->exc_type = type;
-    tstate->exc_value = value;
-    tstate->exc_traceback = tb;
-    #endif
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-}
-#endif
-
-/* GetException */
-#if CYTHON_FAST_THREAD_STATE
-static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
-#else
-static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
-#endif
-{
-    PyObject *local_type, *local_value, *local_tb;
-#if CYTHON_FAST_THREAD_STATE
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    local_type = tstate->curexc_type;
-    local_value = tstate->curexc_value;
-    local_tb = tstate->curexc_traceback;
-    tstate->curexc_type = 0;
-    tstate->curexc_value = 0;
-    tstate->curexc_traceback = 0;
-#else
-    PyErr_Fetch(&local_type, &local_value, &local_tb);
-#endif
-    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
-#if CYTHON_FAST_THREAD_STATE
-    if (unlikely(tstate->curexc_type))
-#else
-    if (unlikely(PyErr_Occurred()))
-#endif
-        goto bad;
-    #if PY_MAJOR_VERSION >= 3
-    if (local_tb) {
-        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
-            goto bad;
-    }
-    #endif
-    Py_XINCREF(local_tb);
-    Py_XINCREF(local_type);
-    Py_XINCREF(local_value);
-    *type = local_type;
-    *value = local_value;
-    *tb = local_tb;
-#if CYTHON_FAST_THREAD_STATE
-    #if CYTHON_USE_EXC_INFO_STACK
-    {
-        _PyErr_StackItem *exc_info = tstate->exc_info;
-        tmp_type = exc_info->exc_type;
-        tmp_value = exc_info->exc_value;
-        tmp_tb = exc_info->exc_traceback;
-        exc_info->exc_type = local_type;
-        exc_info->exc_value = local_value;
-        exc_info->exc_traceback = local_tb;
-    }
-    #else
-    tmp_type = tstate->exc_type;
-    tmp_value = tstate->exc_value;
-    tmp_tb = tstate->exc_traceback;
-    tstate->exc_type = local_type;
-    tstate->exc_value = local_value;
-    tstate->exc_traceback = local_tb;
-    #endif
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-#else
-    PyErr_SetExcInfo(local_type, local_value, local_tb);
-#endif
-    return 0;
-bad:
-    *type = 0;
-    *value = 0;
-    *tb = 0;
-    Py_XDECREF(local_type);
-    Py_XDECREF(local_value);
-    Py_XDECREF(local_tb);
-    return -1;
-}
-
 /* SwapException */
 #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     #if CYTHON_USE_EXC_INFO_STACK
     _PyErr_StackItem *exc_info = tstate->exc_info;
     tmp_type = exc_info->exc_type;
@@ -22317,14 +29437,19 @@
             PyFPE_END_PROTECT(result)
             return PyFloat_FromDouble(result);
     }
     return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
 }
 #endif
 
+/* None */
+static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
+    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
+}
+
 /* DivInt[long] */
 static CYTHON_INLINE long __Pyx_div_long(long a, long b) {
     long q = a / b;
     long r = a - q*b;
     q -= ((r != 0) & ((r ^ b) < 0));
     return q;
 }
@@ -22555,44 +29680,62 @@
     return ret;
 }
 
 /* TypeImport */
 #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
@@ -22612,34 +29755,14 @@
     return (PyTypeObject *)result;
 bad:
     Py_XDECREF(result);
     return NULL;
 }
 #endif
 
-/* GetVTable */
-static void* __Pyx_GetVtable(PyObject *dict) {
-    void* ptr;
-    PyObject *ob = PyObject_GetItem(dict, __pyx_n_s_pyx_vtable);
-    if (!ob)
-        goto bad;
-#if PY_VERSION_HEX >= 0x02070000
-    ptr = PyCapsule_GetPointer(ob, 0);
-#else
-    ptr = PyCObject_AsVoidPtr(ob);
-#endif
-    if (!ptr && !PyErr_Occurred())
-        PyErr_SetString(PyExc_RuntimeError, "invalid vtable found for imported type");
-    Py_DECREF(ob);
-    return ptr;
-bad:
-    Py_XDECREF(ob);
-    return NULL;
-}
-
 /* CLineInTraceback */
 #ifndef CYTHON_CLINE_IN_TRACEBACK
 static int __Pyx_CLineForTraceback(CYTHON_UNUSED PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
@@ -22954,14 +30077,168 @@
     cobj = PyCapsule_New(p, sig, NULL);
 #else
     cobj = PyCObject_FromVoidPtr(p, NULL);
 #endif
     return cobj;
 }
 
+/* Declarations */
+#if CYTHON_CCOMPLEX
+  #ifdef __cplusplus
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return ::std::complex< double >(x, y);
+    }
+  #else
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return x + y*(__pyx_t_double_complex)_Complex_I;
+    }
+  #endif
+#else
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      __pyx_t_double_complex z;
+      z.real = x;
+      z.imag = y;
+      return z;
+    }
+#endif
+
+/* Arithmetic */
+#if CYTHON_CCOMPLEX
+#else
+    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+       return (a.real == b.real) && (a.imag == b.imag);
+    }
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
+        z.real = a.real + b.real;
+        z.imag = a.imag + b.imag;
+        return z;
+    }
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
+        z.real = a.real - b.real;
+        z.imag = a.imag - b.imag;
+        return z;
+    }
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
+        z.real = a.real * b.real - a.imag * b.imag;
+        z.imag = a.real * b.imag + a.imag * b.real;
+        return z;
+    }
+    #if 1
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        if (b.imag == 0) {
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else if (fabs(b.real) >= fabs(b.imag)) {
+            if (b.real == 0 && b.imag == 0) {
+                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
+            } else {
+                double r = b.imag / b.real;
+                double s = (double)(1.0) / (b.real + b.imag * r);
+                return __pyx_t_double_complex_from_parts(
+                    (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
+            }
+        } else {
+            double r = b.real / b.imag;
+            double s = (double)(1.0) / (b.imag + b.real * r);
+            return __pyx_t_double_complex_from_parts(
+                (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
+        }
+    }
+    #else
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        if (b.imag == 0) {
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else {
+            double denom = b.real * b.real + b.imag * b.imag;
+            return __pyx_t_double_complex_from_parts(
+                (a.real * b.real + a.imag * b.imag) / denom,
+                (a.imag * b.real - a.real * b.imag) / denom);
+        }
+    }
+    #endif
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
+        z.real = -a.real;
+        z.imag = -a.imag;
+        return z;
+    }
+    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
+       return (a.real == 0) && (a.imag == 0);
+    }
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
+        z.real =  a.real;
+        z.imag = -a.imag;
+        return z;
+    }
+    #if 1
+        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
+          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
+            return sqrt(z.real*z.real + z.imag*z.imag);
+          #else
+            return hypot(z.real, z.imag);
+          #endif
+        }
+        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+            __pyx_t_double_complex z;
+            double r, lnr, theta, z_r, z_theta;
+            if (b.imag == 0 && b.real == (int)b.real) {
+                if (b.real < 0) {
+                    double denom = a.real * a.real + a.imag * a.imag;
+                    a.real = a.real / denom;
+                    a.imag = -a.imag / denom;
+                    b.real = -b.real;
+                }
+                switch ((int)b.real) {
+                    case 0:
+                        z.real = 1;
+                        z.imag = 0;
+                        return z;
+                    case 1:
+                        return a;
+                    case 2:
+                        return __Pyx_c_prod_double(a, a);
+                    case 3:
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, a);
+                    case 4:
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, z);
+                }
+            }
+            if (a.imag == 0) {
+                if (a.real == 0) {
+                    return a;
+                } else if ((b.imag == 0) && (a.real >= 0)) {
+                    z.real = pow(a.real, b.real);
+                    z.imag = 0;
+                    return z;
+                } else if (a.real > 0) {
+                    r = a.real;
+                    theta = 0;
+                } else {
+                    r = -a.real;
+                    theta = atan2(0.0, -1.0);
+                }
+            } else {
+                r = __Pyx_c_abs_double(a);
+                theta = atan2(a.imag, a.real);
+            }
+            lnr = log(r);
+            z_r = exp(lnr * b.real - theta * b.imag);
+            z_theta = theta * b.real + lnr * b.imag;
+            z.real = z_r * cos(z_theta);
+            z.imag = z_r * sin(z_theta);
+            return z;
+        }
+    #endif
+#endif
+
 /* IsLittleEndian */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
 {
   union {
     uint32_t u32;
     uint8_t u8[4];
   } S;
@@ -23724,163 +31001,281 @@
     double value = __pyx_PyFloat_AsDouble(obj);
     if ((value == (double)-1) && PyErr_Occurred())
         return 0;
     *(double *) itemp = value;
     return 1;
 }
 
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_double(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo_double, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 3,
+                                                 &__Pyx_TypeInfo_double, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 3,
+                                                 &__Pyx_TypeInfo___pyx_t_double_complex, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo___pyx_t_double_complex, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* FromPy */
+  static __pyx_t_double_complex __Pyx_PyComplex_As___pyx_t_double_complex(PyObject* o) {
+    Py_complex cval;
+#if !CYTHON_COMPILING_IN_PYPY
+    if (PyComplex_CheckExact(o))
+        cval = ((PyComplexObject *)o)->cval;
+    else
+#endif
+        cval = PyComplex_AsCComplex(o);
+    return __pyx_t_double_complex_from_parts(
+               (double)cval.real,
+               (double)cval.imag);
+}
+
+/* MemviewDtypeToObject */
+  static CYTHON_INLINE PyObject *__pyx_memview_get___pyx_t_double_complex(const char *itemp) {
+    return (PyObject *) __pyx_PyComplex_FromComplex(*(__pyx_t_double_complex *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set___pyx_t_double_complex(const char *itemp, PyObject *obj) {
+    __pyx_t_double_complex value = __Pyx_PyComplex_As___pyx_t_double_complex(obj);
+    if (PyErr_Occurred())
+        return 0;
+    *(__pyx_t_double_complex *) itemp = value;
+    return 1;
+}
+
 /* Declarations */
   #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return ::std::complex< double >(x, y);
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      return ::std::complex< float >(x, y);
     }
   #else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return x + y*(__pyx_t_double_complex)_Complex_I;
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      return x + y*(__pyx_t_float_complex)_Complex_I;
     }
   #endif
 #else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      __pyx_t_float_complex z;
       z.real = x;
       z.imag = y;
       return z;
     }
 #endif
 
 /* Arithmetic */
   #if CYTHON_CCOMPLEX
 #else
-    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        return (a.real == b.real) && (a.imag == b.imag);
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real + b.real;
         z.imag = a.imag + b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real - b.real;
         z.imag = a.imag - b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real * b.real - a.imag * b.imag;
         z.imag = a.real * b.imag + a.imag * b.real;
         return z;
     }
     #if 1
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else if (fabs(b.real) >= fabs(b.imag)) {
+            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else if (fabsf(b.real) >= fabsf(b.imag)) {
             if (b.real == 0 && b.imag == 0) {
-                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
+                return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.imag);
             } else {
-                double r = b.imag / b.real;
-                double s = (double)(1.0) / (b.real + b.imag * r);
-                return __pyx_t_double_complex_from_parts(
+                float r = b.imag / b.real;
+                float s = (float)(1.0) / (b.real + b.imag * r);
+                return __pyx_t_float_complex_from_parts(
                     (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
             }
         } else {
-            double r = b.real / b.imag;
-            double s = (double)(1.0) / (b.imag + b.real * r);
-            return __pyx_t_double_complex_from_parts(
+            float r = b.real / b.imag;
+            float s = (float)(1.0) / (b.imag + b.real * r);
+            return __pyx_t_float_complex_from_parts(
                 (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
         }
     }
     #else
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
         } else {
-            double denom = b.real * b.real + b.imag * b.imag;
-            return __pyx_t_double_complex_from_parts(
+            float denom = b.real * b.real + b.imag * b.imag;
+            return __pyx_t_float_complex_from_parts(
                 (a.real * b.real + a.imag * b.imag) / denom,
                 (a.imag * b.real - a.real * b.imag) / denom);
         }
     }
     #endif
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex a) {
+        __pyx_t_float_complex z;
         z.real = -a.real;
         z.imag = -a.imag;
         return z;
     }
-    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
+    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex a) {
        return (a.real == 0) && (a.imag == 0);
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex a) {
+        __pyx_t_float_complex z;
         z.real =  a.real;
         z.imag = -a.imag;
         return z;
     }
     #if 1
-        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
+        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex z) {
           #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
-            return sqrt(z.real*z.real + z.imag*z.imag);
+            return sqrtf(z.real*z.real + z.imag*z.imag);
           #else
-            return hypot(z.real, z.imag);
+            return hypotf(z.real, z.imag);
           #endif
         }
-        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-            __pyx_t_double_complex z;
-            double r, lnr, theta, z_r, z_theta;
+        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+            __pyx_t_float_complex z;
+            float r, lnr, theta, z_r, z_theta;
             if (b.imag == 0 && b.real == (int)b.real) {
                 if (b.real < 0) {
-                    double denom = a.real * a.real + a.imag * a.imag;
+                    float denom = a.real * a.real + a.imag * a.imag;
                     a.real = a.real / denom;
                     a.imag = -a.imag / denom;
                     b.real = -b.real;
                 }
                 switch ((int)b.real) {
                     case 0:
                         z.real = 1;
                         z.imag = 0;
                         return z;
                     case 1:
                         return a;
                     case 2:
-                        return __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_float(a, a);
                     case 3:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, a);
+                        z = __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_float(z, a);
                     case 4:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, z);
+                        z = __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_float(z, z);
                 }
             }
             if (a.imag == 0) {
                 if (a.real == 0) {
                     return a;
                 } else if ((b.imag == 0) && (a.real >= 0)) {
-                    z.real = pow(a.real, b.real);
+                    z.real = powf(a.real, b.real);
                     z.imag = 0;
                     return z;
                 } else if (a.real > 0) {
                     r = a.real;
                     theta = 0;
                 } else {
                     r = -a.real;
-                    theta = atan2(0.0, -1.0);
+                    theta = atan2f(0.0, -1.0);
                 }
             } else {
-                r = __Pyx_c_abs_double(a);
-                theta = atan2(a.imag, a.real);
+                r = __Pyx_c_abs_float(a);
+                theta = atan2f(a.imag, a.real);
             }
-            lnr = log(r);
-            z_r = exp(lnr * b.real - theta * b.imag);
+            lnr = logf(r);
+            z_r = expf(lnr * b.real - theta * b.imag);
             z_theta = theta * b.real + lnr * b.imag;
-            z.real = z_r * cos(z_theta);
-            z.imag = z_r * sin(z_theta);
+            z.real = z_r * cosf(z_theta);
+            z.imag = z_r * sinf(z_theta);
             return z;
         }
     #endif
 #endif
 
 /* MemviewSliceCopyTemplate */
   static __Pyx_memviewslice
@@ -23945,14 +31340,90 @@
     __Pyx_XDECREF(shape_tuple);
     __Pyx_XDECREF(temp_int);
     __Pyx_XDECREF(array_obj);
     __Pyx_RefNannyFinishContext();
     return new_mvs;
 }
 
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(long) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(long) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(long) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(long),
+                                     little, !is_unsigned);
+    }
+}
+
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+    }
+}
+
 /* CIntFromPyVerify */
   #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
 #define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
 #define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
     {\
@@ -24359,90 +31830,14 @@
     return (long) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to long");
     return (long) -1;
 }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
-    }
-}
-
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(long) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(long) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(long) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(long),
-                                     little, !is_unsigned);
-    }
-}
-
 /* CIntFromPy */
   static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const char neg_one = (char) -1, const_zero = (char) 0;
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/hamiltonian/hamiltonian.py` & `pyseobnr-0.2.0/pyseobnr/eob/hamiltonian/hamiltonian.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/utils/containers.pxd` & `pyseobnr-0.2.0/pyseobnr/eob/utils/containers.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/utils/containers.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/utils/containers.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/utils/math_ops_opt.py` & `pyseobnr-0.2.0/pyseobnr/eob/utils/math_ops_opt.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/utils/utils_precession_opt.py` & `pyseobnr-0.2.0/pyseobnr/eob/utils/utils_precession_opt.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/utils/waveform_ops.py` & `pyseobnr-0.2.0/pyseobnr/eob/utils/waveform_ops.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/waveform/compute_MR.py` & `pyseobnr-0.2.0/pyseobnr/eob/waveform/compute_MR.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/waveform/compute_hlms.py` & `pyseobnr-0.2.0/pyseobnr/eob/waveform/compute_hlms.py`

 * *Files 2% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 """
 
 from copy import deepcopy
 from typing import Any, Dict
 
 import numpy as jnp
 from lalinference.imrtgr import nrutils
-from pygsl import spline
+from pygsl_lite import spline
 from pyseobnr.auxiliary.mode_mixing.auxiliary_functions_modemixing import *
 from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
 from scipy.optimize import root_scalar
 from scipy.signal import argrelmax, argrelmin
 
 from ..fits.EOB_fits import *
 from ..fits.IV_fits import InputValueFits
@@ -101,15 +101,15 @@
     chi1,
     chi2,
     t_attach,
     f_nyquist,
     lmax_nyquist,
     mixed_modes=[(3, 2), (4, 3)],
     final_state=None,
-    qnm_rotation=0.,
+    qnm_rotation=0.0,
 ):
     """This computes the IMR modes given the inspiral modes and the
     attachment time.
 
     Args:
         t (np.ndarray): The interpolated time array of the inspiral modes
         hlms (np.ndarray): Dictionary containing the inspiral modes
@@ -239,17 +239,17 @@
         # with a minimum in the ampliutde close to the attachment point,
         # we directly use the Input Value fits for the frequency,
         # instead of reading its value from the inspiral phase.
         # If the NQCs were *not* applied this would lead to a
         # discontinuity, and one would need to go back to the
         # previous prescription.
 
-        if m%2 == 1:
+        if m % 2 == 1:
             IVfits = InputValueFits(m1, m2, [0.0, 0.0, chi1], [0.0, 0.0, chi2])
-            omega_max = IVfits.omega()[ell,m]
+            omega_max = IVfits.omega()[ell, m]
 
         attach_params = dict(
             amp=amp_max,
             damp=damp_max,
             omega=omega_max,
             final_mass=final_mass,
             final_spin=final_spin,
@@ -323,15 +323,15 @@
     final_mass,
     final_spin,
     t_match,
     t_ringdown,
     fits_dict,
     f_nyquist,
     lmax_nyquist,
-    qnm_rotation = 0.,
+    qnm_rotation=0.0,
 ):
     """
     Computes the (3,2) and (4,3) modes, including mode-mixing in the ringdown.
     See Sec. II C of the https://dcc.ligo.org/DocDB/0186/T2300060/001/SEOBNRv5HM.pdf, especially Eqs.(71, 72)
 
     Args:
         m1 (float): mass of the primary
@@ -346,15 +346,15 @@
         final_spin (float): dimensionless spin of the remnant
         t_match (float): inspiral time at which the merger-ringdown waveform is attached
         t_ringdown (np.ndarray): rindgown time array
         fits_dict (dict): dictionary of fit coefficients in the ringdown anzatz
         f_nyquist (float): Nyquist frequency, needed for checking that RD frequency is resolved
         lmax_nyquist (int): Determines for which modes the nyquist test is applied for
         qnm_rotation (float): Factor rotating the QNM mode frequency in the co-precessing frame (Eq. 33 of Hamilton et al.)
-        
+
 
     Returns:
         np.ndarray: the merger-ringdown waveform for the mixed modes
 
     """
     # Get spheroidal input values
     # These are constructed from spherical input values
@@ -404,22 +404,26 @@
     # with a minimum in the ampliutde close to the attachment point,
     # we directly use the Input Value fits for the frequency,
     # instead of reading its value from the inspiral phase.
     # If the NQCs were *not* applied this would lead to a
     # discontinuity, and one would need to go back to the
     # previous prescription.
 
-    if m%2 == 1:
+    if m % 2 == 1:
         IVfits = InputValueFits(m1, m2, [0.0, 0.0, chi1], [0.0, 0.0, chi2])
-        om = IVfits.omega()[ell,m]
-        om_mm =  IVfits.omega()[m,m]
+        om = IVfits.omega()[ell, m]
+        om_mm = IVfits.omega()[m, m]
 
     # Spherical mode we need in the ringdown
     attach_params = dict(
-        amp=h_mm, damp=hd_mm, omega=om_mm, final_mass=final_mass, final_spin=final_spin,
+        amp=h_mm,
+        damp=hd_mm,
+        omega=om_mm,
+        final_mass=final_mass,
+        final_spin=final_spin,
     )
 
     hmm_spherical_ringdown = compute_MR_mode_free(
         t_ringdown,
         m1,
         m2,
         chi1,
@@ -444,19 +448,39 @@
     # Ampltidue at peak
     h_ellm0 = h_ellm0_nu(ell, m, final_spin, h, h_mm, phi_lm, phi_mm)
     # Phase at peak
     ph_ellm0 = phi_ellm0(ell, m, final_spin, h, h_mm, phi_lm, phi_mm)
 
     # Time derivative of amplitude at peak
     hd_ellm0 = hdot_ellm0_nu(
-        ell, m, final_spin, h, h_mm, hd, hd_mm, om, om_mm, phi_lm, phi_mm,
+        ell,
+        m,
+        final_spin,
+        h,
+        h_mm,
+        hd,
+        hd_mm,
+        om,
+        om_mm,
+        phi_lm,
+        phi_mm,
     )
     # Frequency at peak
     om_ellm0 = omega_ellm0(
-        ell, m, final_spin, h, h_mm, hd, hd_mm, om, om_mm, phi_lm, phi_mm,
+        ell,
+        m,
+        final_spin,
+        h,
+        h_mm,
+        hd,
+        hd_mm,
+        om,
+        om_mm,
+        phi_lm,
+        phi_mm,
     )
 
     attach_params.update(
         amp=h_ellm0,
         damp=hd_ellm0,
         omega=om_ellm0,
         final_mass=final_mass,
@@ -544,16 +568,14 @@
             m % 2
             and np.abs(m_1 - m_2) < 1e-4
             and np.abs(chi_1) < 1e-4
             and np.abs(chi_2) < 1e-4
         ) or (m % 2 and np.abs(m_1 - m_2) < 1e-4 and np.abs(chi_1 - chi_2) < 1e-4):
             continue
 
-
-
         else:
 
             # Compute the NQC coeffs
             NQC_coeffs = EOBCalculateNQCCoefficients_freeattach(
                 amp,
                 phase,
                 r,
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/waveform/waveform.c` & `pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.c`

 * *Files 2% similar despite different names*

```diff
@@ -1,27 +1,27 @@
-/* Generated by Cython 0.29.33 */
+/* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
             "./pyseobnr/eob/utils",
-            "/local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/core/include"
+            "/local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.waveform.waveform",
         "sources": [
             "pyseobnr/eob/waveform/waveform.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.waveform.waveform"
@@ -33,16 +33,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_33"
-#define CYTHON_HEX_VERSION 0x001D21F0
+#define CYTHON_ABI "0_29_34"
+#define CYTHON_HEX_VERSION 0x001D22F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -227,15 +227,15 @@
   #elif !defined(CYTHON_USE_ASYNC_SLOTS)
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYLONG_INTERNALS
     #define CYTHON_USE_PYLONG_INTERNALS 0
   #elif !defined(CYTHON_USE_PYLONG_INTERNALS)
-    #define CYTHON_USE_PYLONG_INTERNALS 1
+    #define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
@@ -266,15 +266,15 @@
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
+    #define CYTHON_USE_DICT_VERSIONS ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
@@ -1141,195 +1141,195 @@
  * ctypedef float s
  * ctypedef double d             # <<<<<<<<<<<<<<
  * ctypedef float complex c
  * ctypedef double complex z
  */
 typedef double __pyx_t_5scipy_6linalg_11cython_blas_d;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":689
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":696
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":703
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":713
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":717
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":721
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":724
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1448,42 +1448,42 @@
   int derivative;
 };
 struct __pyx_fuse_1__pyx_opt_args_5scipy_7special_14cython_special_spherical_kn {
   int __pyx_n;
   int derivative;
 };
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":728
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":732
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2665,20 +2665,28 @@
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
 /* TypeImport.proto */
 #ifndef __PYX_HAVE_RT_ImportType_proto
 #define __PYX_HAVE_RT_ImportType_proto
+#if __STDC_VERSION__ >= 201112L
+#include <stdalign.h>
+#endif
+#if __STDC_VERSION__ >= 201112L || __cplusplus >= 201103L
+#define __PYX_GET_STRUCT_ALIGNMENT(s) alignof(s)
+#else
+#define __PYX_GET_STRUCT_ALIGNMENT(s) sizeof(void*)
+#endif
 enum __Pyx_ImportType_CheckSize {
    __Pyx_ImportType_CheckSize_Error = 0,
    __Pyx_ImportType_CheckSize_Warn = 1,
    __Pyx_ImportType_CheckSize_Ignore = 2
 };
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
+static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyObject *dict);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
@@ -16262,15 +16270,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_result, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -16279,29 +16287,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":734
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -16312,15 +16320,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -16329,29 +16337,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":737
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -16362,15 +16370,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -16379,29 +16387,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":740
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -16412,15 +16420,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -16429,29 +16437,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":743
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -16462,15 +16470,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -16479,29 +16487,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":746
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -16512,212 +16520,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":750
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":753
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":749
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":928
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":934
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":936
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":932
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -16733,15 +16741,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -16749,53 +16757,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 942, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":943
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 944, __pyx_L5_except_error)
@@ -16803,30 +16811,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":941
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":940
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -16841,15 +16849,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -16865,15 +16873,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -16881,53 +16889,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 948, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":949
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 950, __pyx_L5_except_error)
@@ -16935,30 +16943,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":947
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":946
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -16973,15 +16981,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -16997,15 +17005,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -17013,53 +17021,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 954, __pyx_L3_error)
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":955
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":956
+      /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 956, __pyx_L5_except_error)
@@ -17067,30 +17075,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":953
+    /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":952
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -17105,176 +17113,176 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":978
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":966
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":993
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":981
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1003
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":996
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1010
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1006
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+/* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1017
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":1013
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -31963,26 +31971,26 @@
  * 
  *         # when the amplitude at merger is too small a positive sign is better
  */
   __pyx_tuple__6 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 2380, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__6);
   __Pyx_GIVEREF(__pyx_tuple__6);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":944
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(2, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__7);
   __Pyx_GIVEREF(__pyx_tuple__7);
 
-  /* "../../../../local/tmp/sossokine/build-env-10if7lw0/lib/python3.9/site-packages/numpy/__init__.pxd":950
+  /* "../../../../local/tmp/sossokine/build-env-x4kh4ujn/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(2, 950, __pyx_L1_error)
@@ -32435,68 +32443,88 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams->tp_dict); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT(PyArray_Descr),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 199, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 222, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayMultiIterObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 226, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT(PyArrayObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 770, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 772, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 774, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 776, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 778, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 780, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 782, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 784, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 786, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT(PyObject),
+  __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 788, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT(PyUFuncObject),
+  __Pyx_ImportType_CheckSize_Ignore);
    if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
@@ -34591,28 +34619,28 @@
                             "BaseException");
             goto bad;
         }
         PyException_SetCause(value, fixed_cause);
     }
     PyErr_SetObject(type, value);
     if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
+#if CYTHON_FAST_THREAD_STATE
         PyThreadState *tstate = __Pyx_PyThreadState_Current;
         PyObject* tmp_tb = tstate->curexc_traceback;
         if (tb != tmp_tb) {
             Py_INCREF(tb);
             tstate->curexc_traceback = tb;
             Py_XDECREF(tmp_tb);
         }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
 #endif
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
@@ -36516,44 +36544,62 @@
     return ret;
 }
 
 /* TypeImport */
     #ifndef __PYX_HAVE_RT_ImportType
 #define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
+    Py_ssize_t itemsize;
 #ifdef Py_LIMITED_API
     PyObject *py_basicsize;
+    PyObject *py_itemsize;
 #endif
     result = PyObject_GetAttrString(module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
         PyErr_Format(PyExc_TypeError,
             "%.200s.%.200s is not a type object",
             module_name, class_name);
         goto bad;
     }
 #ifndef Py_LIMITED_API
     basicsize = ((PyTypeObject *)result)->tp_basicsize;
+    itemsize = ((PyTypeObject *)result)->tp_itemsize;
 #else
     py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
     if (!py_basicsize)
         goto bad;
     basicsize = PyLong_AsSsize_t(py_basicsize);
     Py_DECREF(py_basicsize);
     py_basicsize = 0;
     if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
         goto bad;
+    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
+    if (!py_itemsize)
+        goto bad;
+    itemsize = PyLong_AsSsize_t(py_itemsize);
+    Py_DECREF(py_itemsize);
+    py_itemsize = 0;
+    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
 #endif
-    if ((size_t)basicsize < size) {
+    if (itemsize) {
+        if (size % alignment) {
+            alignment = size % alignment;
+        }
+        if (itemsize < (Py_ssize_t)alignment)
+            itemsize = (Py_ssize_t)alignment;
+    }
+    if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         goto bad;
     }
     if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
```

### Comparing `pyseobnr-0.1/pyseobnr/eob/waveform/waveform.pxd` & `pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/eob/waveform/waveform.pyx` & `pyseobnr-0.2.0/pyseobnr/eob/waveform/waveform.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/generate_waveform.py` & `pyseobnr-0.2.0/pyseobnr/generate_waveform.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/pyseobnr/models/SEOBNRv5HM.py` & `pyseobnr-0.2.0/pyseobnr/models/SEOBNRv5HM.py`

 * *Files 1% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 from copy import deepcopy
 from typing import Any, Callable, Dict
 
 import lal
 import numpy as np
 import quaternion
 import scri
-from pygsl import spline
+from pygsl_lite import spline
 from pyseobnr.eob.dynamics.integrate_ode import augment_dynamics, compute_dynamics_opt
 from pyseobnr.eob.dynamics.integrate_ode_prec import compute_dynamics_quasiprecessing
 from pyseobnr.eob.dynamics.postadiabatic_C import Kerr_ISCO, compute_combined_dynamics
 from pyseobnr.eob.dynamics.postadiabatic_C_fast import (
     compute_combined_dynamics as compute_combined_dynamics_fast,
 )
 from pyseobnr.eob.dynamics.postadiabatic_C_prec import (
@@ -144,15 +144,15 @@
         self.step_back = self.settings.get("step_back", 250.0)
         self.chi_S = (self.chi_1 + self.chi_2) / 2
         self.chi_A = (self.chi_1 - self.chi_2) / 2
         self.ap = self.m_1 * self.chi_1 + self.m_2 * self.chi_2
         self.am = self.m_1 * self.chi_1 - self.m_2 * self.chi_2
         self.dt = self.settings["dt"]
         self.delta_T = self.dt / (self.M * lal.MTSUN_SI)
-        self.f_nyquist = 0.5/self.delta_T
+        self.f_nyquist = 0.5 / self.delta_T
 
         # print(f"In SI units, dt = {self.dt}. In geometric units, with M={self.M}, delta_T={self.delta_T}")
         self.prefixes = compute_newtonian_prefixes(self.m_1, self.m_2)
 
         self.tplspin = (1 - 2 * self.nu) * self.chi_S + (self.m_1 - self.m_2) / (
             self.m_1 + self.m_2
         ) * self.chi_A
@@ -300,15 +300,20 @@
         dc["a6"] = a6_fit
         dc["dSO"] = dSO_fit
 
         cfs = CalibCoeffs(dc)
         self.H.calibration_coeffs = cfs
 
     def _evaluate_model(self):
-        r_ISCO, _ = Kerr_ISCO(self.chi_1, self.chi_2, self.m_1, self.m_2,)
+        r_ISCO, _ = Kerr_ISCO(
+            self.chi_1,
+            self.chi_2,
+            self.m_1,
+            self.m_2,
+        )
         if self.NR_deltaT > 0:
             r_stop = 0.98 * r_ISCO
         else:
             r_stop = -1
         try:
             # Step 1: compute the dynamics
             # This includes both the initial conditions
@@ -505,15 +510,18 @@
 
             # Step 8: interpolate the modes onto the desired spacing
             t_new = np.arange(dynamics[0, 0], dynamics[-1, 0], self.delta_T)
 
             t_original = dynamics[:, 0]
             phi_orb = dynamics[:, 2]
             hlms_interp = interpolate_modes_fast(
-                t_original, t_new, hlms_joined, phi_orb,
+                t_original,
+                t_new,
+                hlms_joined,
+                phi_orb,
             )
             del hlms_joined
             # Step 9: construct the full IMR waveform
             t_full, hlms_full = compute_IMR_modes(
                 t_new,
                 hlms_interp,
                 t_fine,
@@ -605,20 +613,19 @@
 
         self.nu = self.m_1 * self.m_2 / (self.m_1 + self.m_2) ** 2
 
         self.omega_start = omega_start
 
         # Do not use a omega_start which implies r0< 10.5, if that is
         # the case change starting frequency to correspond to r0=10.5M
-        if (self.omega_start)**(-2./3.) < 10.5:
-            self.omega_start = (10.5)**(-3./2.)
+        if (self.omega_start) ** (-2.0 / 3.0) < 10.5:
+            self.omega_start = (10.5) ** (-3.0 / 2.0)
 
         self.f_start = omega_start / (self.M * lal.MTSUN_SI * np.pi)
 
-
         # Deal with reference and starting frequencies
         if omega_ref:
             self.omega_ref = omega_ref
             self.f_ref = omega_ref / (self.M * lal.MTSUN_SI * np.pi)
         else:
             self.omega_ref = omega_start
             self.f_ref = self.f_start
@@ -642,15 +649,15 @@
         self.backend = self.settings.get("backend", "dopri5")
         # z-component because LN_0 = [0,0,1]
         self.chi_S = (chi1_z + chi2_z) / 2.0
         self.chi_A = (chi1_z - chi2_z) / 2.0
 
         self.dt = self.settings["dt"]
         self.delta_T = self.dt / (self.M * lal.MTSUN_SI)
-        self.f_nyquist = 0.5/self.delta_T
+        self.f_nyquist = 0.5 / self.delta_T
 
         self.prefixes = compute_newtonian_prefixes(self.m_1, self.m_2)
 
         self.tplspin = (1 - 2 * self.nu) * self.chi_S + (self.m_1 - self.m_2) / (
             self.m_1 + self.m_2
         ) * self.chi_A
 
@@ -871,15 +878,17 @@
                     self.chi1_v,
                     self.chi2_v,
                     self.eob_pars,
                     rtol=1e-8,  # 1e-11,
                     atol=1e-8,  # 1e-12,
                     step_back=self.step_back,
                     initial_conditions=self.settings["initial_conditions"],
-                    initial_conditions_postadiabatic_type=self.settings["initial_conditions_postadiabatic_type"],
+                    initial_conditions_postadiabatic_type=self.settings[
+                        "initial_conditions_postadiabatic_type"
+                    ],
                 )
             else:
                 (
                     dynamics_low,
                     dynamics_fine,
                     t_PN,
                     dyn_PN,
@@ -972,15 +981,20 @@
             chi2LN_om_r10M = tmp[1]
             chi1_om_r10M = tmp[4:7]
             chi2_om_r10M = tmp[7:10]
             LN_om_r10M = tmp[10:13]
 
             # Step 2, ii): compute the reference point based on Kerr r_ISCO of remnant
             # with final spin
-            r_ISCO, _ = Kerr_ISCO(chi1LN_om_r10M, chi2LN_om_r10M, self.m_1, self.m_2,)
+            r_ISCO, _ = Kerr_ISCO(
+                chi1LN_om_r10M,
+                chi2LN_om_r10M,
+                self.m_1,
+                self.m_2,
+            )
 
             self.r_ISCO = r_ISCO
             r_fine = dynamics_fine[:, 1]
 
             if r_ISCO < r_fine[-1]:
                 # In some corners of parameter space r_ISCO can be *after*
                 # the end of the dynamics. In those cases just use the last
@@ -1141,28 +1155,31 @@
             if np.isnan(dynamics_low[:, 1:]).any():
                 raise ValueError
 
             # Step 6: compute the modes in the inspiral
             hlms_low = compute_hlms_new(dynamics_low[:, 1:], self.eob_pars)
 
             # Apply the NQC corrections to inspiral modes
-            #t_low = dynamics_low[:, 0]
+            # t_low = dynamics_low[:, 0]
             omega_orb_low = dynamics_low[:, 6]
 
             # Polar dynamics, r,pr,omega_orb
             polar_dynamics_low = [dynamics_low[:, 1], dynamics_low[:, 3], omega_orb_low]
             apply_nqc_corrections(hlms_low, nqc_coeffs, polar_dynamics_low)
 
             # Step 7: Concatenate low and high sampling modes
             hlms_joined = concatenate_modes(hlms_low, hlms_fine)
 
             t_new = np.arange(dynamics[0, 0], dynamics[-1, 0], self.delta_T)
             # Step 8: interpolate the modes onto the desired spacing
             hlms_interp = interpolate_modes_fast(
-                dynamics[:, 0], t_new, hlms_joined, dynamics[:, 2],
+                dynamics[:, 0],
+                t_new,
+                hlms_joined,
+                dynamics[:, 2],
             )
 
             idx = np.argmin(np.abs(t_new - t_attach))
 
             # Sep 8.9) Compute the quaternions necessary to rotate the inspiral part of the waveform
             #          as well as the Euler angles at the attachment point
 
@@ -1332,15 +1349,15 @@
 
                 qTot = qJ2P * np.conjugate(quatI2J) * qI02I
 
                 alphaTot, betaTot, gammaTot = quaternion.as_euler_angles(qTot).T
 
                 sYlm = custom_swsh(betaTot, alphaTot, self.max_ell_returned)
                 # Construct polarizations
-                hpc = np.zeros(imr_full[(2, 2)].size, dtype=np.complex)
+                hpc = np.zeros(imr_full[(2, 2)].size, dtype=complex)
                 for ell, emm in imr_full.keys():
                     # sYlm = SWSH(qTot,-2,[ell,emm])
                     hpc += (
                         sYlm[ell, emm] * imr_full[(ell, emm)]
                         + sYlm[ell, -emm] * pow(-1, ell) * imr_full[(ell, emm)].conj()
                     )
```

### Comparing `pyseobnr-0.1/pyseobnr.egg-info/SOURCES.txt` & `pyseobnr-0.2.0/pyseobnr.egg-info/SOURCES.txt`

 * *Files 7% similar despite different names*

```diff
@@ -25,22 +25,16 @@
 pyseobnr.egg-info/not-zip-safe
 pyseobnr.egg-info/requires.txt
 pyseobnr.egg-info/top_level.txt
 pyseobnr/auxiliary/__init__.py
 pyseobnr/auxiliary/external_models/__init__.py
 pyseobnr/auxiliary/external_models/default_settings.py
 pyseobnr/auxiliary/external_models/external_models.py
-pyseobnr/auxiliary/interpolate/README.md
 pyseobnr/auxiliary/interpolate/__init__.py
-pyseobnr/auxiliary/interpolate/_cubic.py
-pyseobnr/auxiliary/interpolate/_ppoly.c
-pyseobnr/auxiliary/interpolate/_ppoly.pyx
-pyseobnr/auxiliary/interpolate/interpolate.py
 pyseobnr/auxiliary/interpolate/vector_spline.py
-pyseobnr/auxiliary/interpolate/tests/test_spline.py
 pyseobnr/auxiliary/mode_mixing/__init__.py
 pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py
 pyseobnr/auxiliary/sanity_checks/EOB_matches.py
 pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py
 pyseobnr/auxiliary/sanity_checks/NRSur_matches.py
 pyseobnr/auxiliary/sanity_checks/NR_mismatches.py
 pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py
```

### Comparing `pyseobnr-0.1/setup.py` & `pyseobnr-0.2.0/setup.py`

 * *Files 8% similar despite different names*

```diff
@@ -38,17 +38,14 @@
               include_dirs=[np.get_include(),"pyseobnr/eob/utils","pyseobnr/eob/hamiltonian"],
               extra_compile_args=['-O3']
     ),
     Extension("pyseobnr.eob.dynamics.postadiabatic_C_fast", ["pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx"],
               include_dirs=[np.get_include(),"pyseobnr/eob/utils","pyseobnr/eob/hamiltonian"],
               extra_compile_args=['-O3']
               ),
-    Extension("pyseobnr.auxiliary.interpolate._ppoly", ["pyseobnr/auxiliary/interpolate/_ppoly.pyx"],
-              include_dirs=[np.get_include()],
-              extra_compile_args = ["-flto", "-O3", "-ftree-vectorize"]),
     Extension("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", ["pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx"],
              include_dirs=[np.get_include(),"pyseobnr/eob/utils","pyseobnr/eob/hamiltonian"],
              extra_compile_args=['-O3']
     ),
     Extension("pyseobnr.eob.hamiltonian.Ham_AvgS2precess_simple_cython_PA_AD", ["pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx"],
              include_dirs=[np.get_include(),"pyseobnr/eob/utils","pyseobnr/eob/hamiltonian"],
              extra_compile_args=['-O3'],
```

### Comparing `pyseobnr-0.1/test/regression_tests/regenerate_SEOBNRv5HM.py` & `pyseobnr-0.2.0/test/regression_tests/regenerate_SEOBNRv5HM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/test/regression_tests/regenerate_SEOBNRv5PHM.py` & `pyseobnr-0.2.0/test/regression_tests/regenerate_SEOBNRv5PHM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/test/regression_tests/template_v5HM_tests.jinja` & `pyseobnr-0.2.0/test/regression_tests/template_v5HM_tests.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/test/regression_tests/template_v5PHM_tests.jinja` & `pyseobnr-0.2.0/test/regression_tests/template_v5PHM_tests.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/test/regression_tests/test_SEOBNRv5HM.py` & `pyseobnr-0.2.0/test/regression_tests/test_SEOBNRv5HM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.1/test/regression_tests/test_SEOBNRv5PHM.py` & `pyseobnr-0.2.0/test/regression_tests/test_SEOBNRv5PHM.py`

 * *Files identical despite different names*

